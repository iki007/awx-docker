"use strict";(self.webpackChunk_ansible_ansible_ui=self.webpackChunk_ansible_ansible_ui||[]).push([[2005],{82005:(e,t,n)=>{n.r(t),n.d(t,{default:()=>IT});var a=n(84976);let s=function(e){return e[e.Button=0]="Button",e[e.Link=1]="Link",e[e.Switch=2]="Switch",e[e.Dropdown=3]="Dropdown",e[e.Seperator=4]="Seperator",e}({}),o=function(e){return e[e.None=0]="None",e[e.Single=1]="Single",e[e.Multiple=2]="Multiple",e}({});var i=n(96998),r=n(96553),l=n(96540),c=n(64372),d=n(9929),u=n(76445),m=n(82780),p=n(69724),h=n(71521);const b={xs:Number(h.A.value.replace("px","")),sm:Number(m.A.value.replace("px","")),md:Number(u.A.value.replace("px","")),lg:Number(d.A.value.replace("px","")),xl:Number(p.A.value.replace("px","")),xxl:Number(c.A.value.replace("px",""))};function f(e){const t=function(){const[e,t]=(0,l.useState)((()=>window.innerWidth<=b.sm?"xs":window.innerWidth<=b.md?"sm":window.innerWidth<=b.lg?"md":window.innerWidth<=b.xl?"lg":window.innerWidth<=b.xxl?"xl":"xxl")),n=(0,l.useCallback)((()=>{window.innerWidth<=b.sm?t("xs"):window.innerWidth<=b.md?t("sm"):window.innerWidth<=b.lg?t("md"):window.innerWidth<=b.xl?t("lg"):window.innerWidth<=b.xxl?t("xl"):t("xxl")}),[]);return(0,l.useEffect)((()=>{const e=n;return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[n]),(0,l.useEffect)((()=>n()),[n]),e}();switch(e){case"xs":return!0;case"sm":switch(t){case"sm":case"md":case"lg":case"xl":case"xxl":return!0;default:return!1}case"md":switch(t){case"md":case"lg":case"xl":case"xxl":return!0;default:return!1}case"lg":switch(t){case"lg":case"xl":case"xxl":return!0;default:return!1}case"xl":switch(t){case"xl":case"xxl":return!0;default:return!1}case"xxl":return"xxl"===t}}var g=n(72583),y=n(96728),x=n(25226),j=n(47441),_=n(63892),v=n(87413),w=n(71902),k=n(69901),S=n(20689),C=n(77459),T=n(67723),I=n(32389),A=n(50780);let D=function(e){return e.Default="default",e.Green="green",e.Success="success",e.Blue="blue",e.Info="info",e.Red="red",e.Danger="danger",e.Yellow="yellow",e.Orange="orange",e.Warning="warning",e.Grey="grey",e.Disabled="disabled",e}({});function E(e){switch(e){case"default":return;case"green":case"success":return P;case"red":case"danger":return R;case"yellow":case"orange":case"warning":return B;case"blue":case"info":return F;case"grey":case"disabled":return N}}const P="var(--pf-v5-global--success-color--100)",R="var(--pf-v5-global--danger-color--100)",B="var(--pf-v5-global--warning-color--100)",F="var(--pf-v5-global--info-color--100)",N="var(--pf-v5-global--disabled-color--100)",$="var(--pf-v5-global--danger-color--100)";function M(e){const t=(0,l.useId)();return L(e)||t}function L(e){return"string"==typeof e?e.toLowerCase().replace(/ /g,"-").replace(/_/g,"-").replace(/\./g,"-"):e.id?e.id:e.name?e.name.toLowerCase().replace(/ /g,"-").replace(/_/g,"-").replace(/\./g,"-"):e.title?e.title.toLowerCase().replace(/ /g,"-").replace(/_/g,"-").replace(/\./g,"-"):e.label?e.label.toLowerCase().replace(/ /g,"-").replace(/_/g,"-").replace(/\./g,"-"):void 0}var O=n(86866),z=n(74848);const H={by:"by",cancelText:"Cancel",canceledText:"Canceled",cardView:"Card view",clearAllFilters:"Clear all filters",clickToRefresh:"Click to refresh",closeText:"Close",confirmText:"Confirm",countMore:"{count} more",documentation:"Documentation",errorText:"Error",filter:"Filter",listView:"List view",manageColumns:"Manage columns",moreInformation:"More information",noItemsFound:"No items found",noResultsFound:"No results found",noResultsMatchCriteria:"No results match this filter criteria. Clear all filters and try again.",noSelection:"No selection",noSelections:"No selections",noneSelectedText:"None - Please make a selection below.",ofText:"of",pendingText:"Pending",pleaseFixValidationErrors:"Please fix validation errors.",processingText:"Processing",selectNone:"Select none",selectedText:"Selected",showLess:"Show less",sort:"Sort",submitText:"Submit",submittingText:"Submitting",successText:"Success",tableView:"Table view",unknownError:"Unknown error",validating:"Validating..."},q=(0,l.createContext)([H,()=>alert("Use FrameworkTranslationsProvider")]);function U(e){const t=(0,l.useState)(H);return(0,z.jsx)(q.Provider,{value:t,children:e.children})}function W(){return(0,l.useContext)(q)}function J(e,t){if("selection"in e)switch(e.selection){case o.None:if(e.isHidden)return e.isHidden();break;case o.Single:if(e.isHidden)return!t||e.isHidden(t)}return!1}function V(){const[e]=W();return(0,l.useCallback)(((t,n,a)=>{if("selection"in t)switch(t.selection){case o.None:if("string"==typeof t.isDisabled)return t.isDisabled;if(t.isDisabled)return t.isDisabled();break;case o.Single:if("string"==typeof t.isDisabled)return t.isDisabled;if(t.isDisabled)return n?t.isDisabled(n):e.noSelection;break;case o.Multiple:if("string"==typeof t.isDisabled)return t.isDisabled;if(t.isDisabled)return a?t.isDisabled(a):e.noSelections}}),[e.noSelection,e.noSelections])}function G(e){const{action:t,wrapper:n,selectedItem:a,iconOnly:s}=e,i=V()(t,a),r=n??l.Fragment,c=!!a&&t.isSwitchOn(a),d=i||(t.tooltip?t.tooltip:s?c?t.label:t.labelOff??t.label:void 0),u=(0,l.useId)();let m=t.label;s&&!0!==t.showPinnedLabel&&(m=void 0);let p=t.labelOff;return s&&!0!==t.showPinnedLabel&&(p=void 0),(0,z.jsx)(r,{children:(0,z.jsx)("div",{"data-cy":"toggle-switch",style:{marginLeft:s?16:void 0,marginRight:s?16:void 0},children:(0,z.jsx)(x.m,{content:d,trigger:d?void 0:"manual",children:(0,z.jsx)(O.d,{id:u,"aria-label":t.ariaLabel(c),label:m,labelOff:p,isChecked:c,hasCheckIcon:!0,isDisabled:!!i,onChange:()=>{switch(t.selection){case o.None:t.onToggle(!c);break;case o.Single:a&&t.onToggle(a,!c)}},isReversed:void 0!==t?.isReversed?t.isReversed:s})})})})}const Y=A.Ay.div.withConfig({componentId:"ans__sc-uji20a-0"})(["--pf-v5-c-dropdown__menu-item-icon--Width:",";--pf-v5-c-dropdown__menu-item-icon--MarginRight:",";--pf-v5-c-dropdown__menu-item--Color:",";"],(({$hasSwitches:e})=>e?"40px":void 0),(({$hasSwitches:e})=>e?"16px":void 0),(({$isDanger:e})=>e?"var(--pf-v5-global--danger-color--100)":void 0)),K=A.Ay.div.withConfig({componentId:"ans__sc-uji20a-1"})(["margin-left:16px;margin-right:16px;margin-bottom:16px;"]);function Z(e){const{icon:t,iconOnly:n,isDisabled:a,label:i,onOpen:r,position:c,selectedItem:d,selectedItems:u,tooltip:m,variant:p}=e;let{actions:h}=e;h=h.filter((e=>!J(e,d))),h=function(e){let t=[...e];for(;t.length>0&&t[0].type===s.Seperator;)t.shift();for(;t.length>0&&t[t.length-1].type===s.Seperator;)t.pop();return t=function(e){const t=[];let n;for(const a of e)a.type===s.Seperator&&n&&n.type===s.Seperator||t.push(a),n=a;return t}(t),t}(h);const[b,f]=(0,l.useState)(!1),w=(0,l.useMemo)((()=>!h.every((e=>!("selection"in e)||e.selection!==o.Multiple))),[h]),k=(0,l.useMemo)((()=>void 0!==h.find((e=>e.type!==s.Seperator&&void 0!==e.icon))),[h]),T=(0,l.useMemo)((()=>void 0!==h.find((e=>e.type!==s.Seperator&&e.type===s.Switch))),[h]);(0,l.useEffect)((()=>{r?.(i??"default",b)}),[b,i,r,e]);const I=L(e.label??"actions-dropdown");if(0===h.length)return(0,z.jsx)(z.Fragment,{});const A=p===g.Ak.primary||w&&!!u?.length,D=p===g.Ak.primary&&!w&&!!u?.length,E=Boolean(!i&&!t),P=t;let R;R=a||m||(n?i:void 0);const B=n&&P?(0,z.jsx)(y.I,{children:(0,z.jsx)(P,{})}):i,F=(0,z.jsxs)(g.$n,{"data-cy":I,icon:P?(0,z.jsx)(y.I,{children:(0,z.jsx)(P,{})}):void 0,style:{backgroundColor:"#f0f0f0"},isAriaDisabled:!0,children:[B,(0,z.jsx)("span",{style:{paddingLeft:"16px"},children:(0,z.jsx)(S.bD,{"aria-hidden":!0})})]});return(0,z.jsx)(x.m,{content:R,trigger:R?void 0:"manual",children:a?F:(0,z.jsx)(j.m,{isOpen:b,onSelect:()=>f(!1),onOpenChange:e=>f(e),popperProps:{appendTo:()=>document.body,preventOverflow:!0,enableFlip:!0,position:c},toggle:e=>(0,z.jsx)(_.S,{ref:e,"data-cy":I,id:E?"toggle-kebab":"toggle-dropdown",className:E?"toggle-kebab":"toggle-dropdown",isDisabled:!!a,"aria-label":E?"kebab dropdown toggle":"dropdown toggle",variant:D?"secondary":A?"primary":"plain",onClick:()=>f(!b),isExpanded:b,style:A&&!i?{color:"var(--pf-v5-global--Color--light-100)"}:{},icon:P?(0,z.jsx)(y.I,{children:(0,z.jsx)(P,{})}):void 0,children:B??(0,z.jsx)(C.bz,{})}),children:(0,z.jsx)(v.Q,{children:h.map(((e,t)=>(0,z.jsx)(X,{action:e,selectedItems:u??[],selectedItem:d,hasIcons:k,hasSwitches:T,index:t},"label"in e?e.label:`action-${t}`)))})})})}function X(e){const{action:t,selectedItems:n,selectedItem:a,hasIcons:i,hasSwitches:r,index:l}=e,{t:c}=(0,I.Bd)(),d=V()(t,a,n);switch(t.type){case s.Button:{let e,s=t.icon;!s&&i&&(s=Q),e=d||(t.tooltip?t.tooltip:t.icon?t.label:void 0);let l=!!d;return t.selection!==o.Multiple||n.length||(e=c("Select at least one item from the list"),l=!0),(0,z.jsx)(x.m,{content:e,trigger:e?void 0:"manual",children:(0,z.jsx)(Y,{$hasSwitches:r,$isDanger:Boolean(t.isDanger),children:(0,z.jsxs)(w.t,{id:L(t),"data-cy":L(t)?.split(".").join("-"),isAriaDisabled:l,onClick:()=>{switch(t.selection){case o.None:t.onClick();break;case o.Single:a&&t.onClick(a);break;case o.Multiple:n&&t.onClick(n)}},style:{color:t.isDanger&&!d?E(D.Danger):void 0},children:[s?(0,z.jsx)(y.I,{size:"lg",iconSize:"md",style:{paddingRight:".5rem"},children:(0,z.jsx)(s,{})}):void 0,t.label]})})},t.label)}case s.Link:{let e=t.icon;!e&&i&&(e=Q);const n=d||t.tooltip;let s;switch(t.selection){case o.None:s=t.href;break;case o.Single:s=a?t.href(a):"";break;default:s=""}return(0,z.jsx)(x.m,{content:n,trigger:n?void 0:"manual",children:(0,z.jsxs)(w.t,{to:s,isAriaDisabled:Boolean(d),"data-cy":L(t)?.split(".").join("-"),style:{color:t.isDanger&&!d?E(D.Danger):void 0},children:[e?(0,z.jsx)(y.I,{size:"lg",iconSize:"md",style:{paddingRight:".5rem"},children:(0,z.jsx)(e,{})}):void 0,t.label]})},t.label)}case s.Switch:return(0,z.jsx)(K,{children:(0,z.jsx)(G,{action:t,selectedItem:a})});case s.Dropdown:{const e=t.label;return(0,z.jsx)(Z,{label:t.label,actions:t.actions,selectedItem:a,selectedItems:n,isDisabled:d,tooltip:e},t.label)}case s.Seperator:return(0,z.jsx)(k.c,{component:"li"},`separator-${l}`)}}const Q=()=>(0,z.jsx)(T.GQ,{style:{opacity:0}});var ee=n(30666),te=n(53926);function ne(e){const{action:t,isSecondary:n,wrapper:i,iconOnly:r,selectedItem:c,selectedItems:d}=e,u=V()(t,c,d),m=i??l.Fragment,p=t.icon;let h;const{t:b}=(0,I.Bd)();h=u||(t.tooltip?t.tooltip:r?t.label:void 0);let f=!!u;t.selection!==o.Multiple||d&&d.length||(h=b("Select at least one item from the list"),f=!0);let y,j=t.variant??g.Ak.secondary;if(n&&[g.Ak.primary,g.Ak.danger].includes(j)&&(j=g.Ak.secondary),j===g.Ak.primary&&t.isDanger&&(j=g.Ak.danger),r&&(j=g.Ak.plain),t.type===s.Link)switch(t.selection){case o.None:y=t.href;break;case o.Single:y=c?t.href(c):"";break;default:y=""}const _=M(t),v=r&&p?(0,z.jsx)(p,{}):t.label;return(0,z.jsx)(m,{children:(0,z.jsx)(x.m,{content:h,trigger:h?void 0:"manual",children:(0,z.jsx)(g.$n,{id:_,"data-cy":_,variant:j,isDanger:t.isDanger,icon:p?(0,z.jsx)(p,{}):void 0,isAriaDisabled:f,onClick:()=>{if(t.type!==s.Link)switch(t.selection){case o.None:t.onClick();break;case o.Single:c&&t.onClick(c);break;case o.Multiple:d&&t.onClick(d)}},"aria-label":r?t.label:"",ouiaId:_,component:t.type===s.Link?e=>(0,z.jsx)(a.N_,{...e,to:y}):void 0,children:v})})})}function ae(e){const{actions:t,selectedItems:n,selectedItem:a,wrapper:s,iconOnly:o,onOpen:i}=e;return 0===t.length?(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(ee.B,{hasGutter:!o,style:{alignItems:"baseline"},children:t.map(((e,t)=>(0,z.jsx)(se,{action:e,selectedItem:a,selectedItems:n,wrapper:s,iconOnly:o,onOpen:i},t)))})}function se(e){const{action:t,selectedItems:n,selectedItem:a,wrapper:o,onOpen:i}=e,r=V();switch(t.type){case s.Seperator:return(0,z.jsx)(z.Fragment,{});case s.Button:return(0,z.jsx)(ne,{action:t,selectedItem:a,selectedItems:n,iconOnly:e.iconOnly,wrapper:o});case s.Link:return(0,z.jsx)(ne,{action:t,selectedItem:a,selectedItems:n,iconOnly:e.iconOnly,wrapper:o,isLink:!0});case s.Switch:return(0,z.jsx)(G,{action:t,selectedItem:a,wrapper:o,iconOnly:e.iconOnly});case s.Dropdown:{const s=r(t,a,n);let o;return o=s||(t.tooltip?t.tooltip:t.label),(0,z.jsx)(Z,{icon:t.icon,label:t.label,actions:t.actions,selectedItem:a,selectedItems:n,iconOnly:e.iconOnly,position:te.nU.right,tooltip:o,isDisabled:s,variant:t.variant,onOpen:i})}}}function oe(e){const{actions:t,selectedItem:n,iconOnly:a,onOpen:s}=e,o=f("never"!==e.collapse&&"always"!==e.collapse?e.collapse??"lg":"lg"),c="never"!==e.collapse&&("always"===e.collapse||!o),d=(0,l.useMemo)((()=>t.filter((e=>!J(e,n)))),[t,n]),u=(0,l.useMemo)((()=>c?[]:d?.filter(ie)),[c,d]),m=(0,l.useMemo)((()=>c?d:d?.filter((e=>!ie(e)))??[]),[c,d]),[p,h]=(0,l.useState)({});(0,l.useEffect)((()=>{Object.values(p).find((e=>e))?s?.(!0):s?.(!1)}),[s,p]);const b=(0,l.useCallback)(((e,t)=>{h((n=>(n[e]!==t&&((n={...n})[e]=t),n)))}),[]);return(0,z.jsxs)(i.s,{flexWrap:{default:"nowrap"},spaceItems:{default:a?"spaceItemsNone":"spaceItemsMd"},justifyContent:{default:"justifyContentFlexEnd"},children:[void 0!==u&&u.length>0&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(ae,{...e,actions:u,onOpen:b})}),m.length>0&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(Z,{...e,actions:m,onOpen:b})})]})}function ie(e){return"isPinned"in e&&e.isPinned}var re=n(95026),le=n(86043),ce=n(69211);const de=(0,l.createContext)({addAlert:()=>null,removeAlert:()=>null,replaceAlert:()=>null,removeAlerts:()=>null});function ue(){return(0,l.useContext)(de)}function me(e){const[t,n]=(0,l.useState)([]),[a]=(0,l.useState)((()=>{function e(e){n((t=>t.filter((t=>t!==e))))}return{addAlert:function(t){Number.isInteger(t.timeout)&&(setTimeout((()=>e(t)),t.timeout),delete t.timeout),n((e=>{const n=e.findIndex((e=>e===t));if(-1!==n){const a=[...e];return a[n]=t,a}return[...e,t]}))},removeAlert:e,removeAlerts:function(e){n((t=>e?t.filter(e):[]))},replaceAlert:function(t,a){n((n=>{const s=n.findIndex((e=>e===t));if(-1!==s){Number.isInteger(a.timeout)&&(setTimeout((()=>e(a)),a.timeout),delete a.timeout);const t=[...n];return t[s]=a,t}return n}))}}}));return(0,z.jsxs)(de.Provider,{value:a,children:[(0,z.jsx)(re._,{"data-cy":"alert-toaster",isToast:!0,isLiveRegion:!0,children:t.map(((e,t)=>(0,l.createElement)(le.F,{...e,key:e.key??e.id??t,actionClose:(0,z.jsx)(ce.X,{onClose:()=>a.removeAlert(e)})})))}),e.children]})}class pe extends l.Component{constructor(...e){return super(...e),this.state={hasError:!1},this}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?(0,z.jsx)("h1",{children:this.props.message}):this.props.children}}function he(e){const{bytes:t}=e;if(0===t)return(0,z.jsx)(z.Fragment,{children:"0"});if(!+t)return(0,z.jsx)(z.Fragment,{});const n=e.decimals?e.decimals:0,a=n<0?0:n,s=Math.floor(Math.log(t)/Math.log(1024));return(0,z.jsx)(z.Fragment,{children:`${parseFloat((t/Math.pow(1024,s)).toFixed(a))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}`})}var be=n(95645),fe=n(12451);function ge(e=!0){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)(!1),s=ue(),o={variant:"success",title:t("Copied to clipboard"),timeout:e},i={variant:"danger",title:t("Failed to copy to clipboard")},r={variant:"warning",title:t("Clipboard is not supported in this browser.")};return{copySuccess:n,writeToClipboard:e=>{(async()=>{if(navigator.clipboard)try{await navigator.clipboard.writeText(e),s.addAlert(o),a(!0)}catch(e){s.removeAlert(o),s.addAlert(i)}else s.addAlert(r)})().catch((()=>{s.removeAlert(o),s.addAlert(i)}))}}}function ye(e){const{writeToClipboard:t}=ge(),{t:n}=(0,I.Bd)();return e.text?(0,z.jsx)(be.Ck,{hoverTip:n("Copy to clipboard"),clickTip:n("Successfully copied to clipboard!"),variant:"inline-compact",textAriaLabel:n("Copyable input"),toggleAriaLabel:n("Show content"),style:{display:"flex",flexWrap:"nowrap",borderRadius:4},onCopy:()=>{t(e.text??"")},children:(0,z.jsx)(fe.P,{content:e.text,style:{minWidth:e.minWidth}})}):(0,z.jsx)(z.Fragment,{})}var xe=n(93973),je=n(96285),_e=n(59324);const ve=(0,l.createContext)([{},()=>null]);function we(){const[e]=(0,l.useContext)(ve);return e}function ke(e){const[t,n]=(0,l.useState)((()=>{const t=localStorage.getItem("user-preferences");let n={};if(t)try{n=JSON.parse(t)}catch(e){}return n={refreshInterval:e.defaultRefreshInterval,theme:"system",tableLayout:"comfortable",formColumns:"multiple",formLayout:"vertical",dateFormat:"date-time",dataEditorFormat:"yaml",...n},n})),a=(0,l.useCallback)((e=>{localStorage.setItem("user-preferences",JSON.stringify(e)),n(e)}),[]),s=(0,l.useMemo)((()=>"light"!==t.theme&&"dark"!==t.theme?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":t.theme),[t.theme]);return(0,l.useEffect)((()=>{n((e=>e.activeTheme===s?e:{...e,activeTheme:s})),"dark"===s?document.documentElement.classList.add("pf-v5-theme-dark"):document.documentElement.classList.remove("pf-v5-theme-dark")}),[s]),(0,z.jsx)(_e.BE,{value:{refreshInterval:t.refreshInterval?1e3*t.refreshInterval:0},children:(0,z.jsx)(ve.Provider,{value:[t,a],children:e.children})})}function Se(e){return e?("string"==typeof e&&(e=new Date(e)),e.toLocaleString()):""}function Ce(e){const t=new Date(e.value);return(0,z.jsxs)(ee.B,{hasGutter:!0,children:[(0,z.jsx)(xe.o,{children:t.toLocaleDateString()}),(0,z.jsx)(xe.o,{children:t.toLocaleTimeString()})]})}const Te=A.Ay.span.withConfig({componentId:"ans__sc-1htknlx-0"})(["white-space:nowrap;"]);function Ie(e){const{t}=(0,I.Bd)(),[n]=W(),{author:a,onClick:s}=e,[o,i]=(0,l.useState)(null),r=we(),c=r.dateFormat?r.dateFormat:"date-time",d=(0,l.useCallback)(((e,n)=>{let a;a="number"==typeof e?je.c9.fromMillis(e):je.c9.fromISO(e),"since"===n?je.c9.now().toMillis()-a.toMillis()<6e4?i(t("Less than a minute ago")):i(a.toRelative()):i(Se(a.toJSDate()))}),[t]);return(0,l.useEffect)((()=>{if(d(e.value,c),"since"===c){const t=setInterval((()=>d(e.value,c)),1e3);return()=>clearTimeout(t)}}),[c,e.value,d]),e.value?(0,z.jsxs)(Te,{className:"date-time",children:[o,a&&(0,z.jsxs)("span",{children:[" ",n.by," "]}),s?(0,z.jsx)(g.$n,{variant:"link",isInline:!0,onClick:s,children:a}):(0,z.jsx)("span",{children:a})]}):(0,z.jsx)(z.Fragment,{})}function Ae(e){const t=(0,l.useMemo)((()=>new Date(e.start??0).valueOf()),[e.start]),n=(0,l.useMemo)((()=>new Date(e.finish??0).valueOf()),[e.finish]),[a,s]=(0,l.useState)(Math.max(0,n-t.valueOf()));(0,l.useEffect)((()=>{const a=setInterval((()=>{t&&(e.finish?s(Math.max(0,n-t)):s(Math.max(0,Date.now()-t)))}),1e3);return()=>clearTimeout(a)}),[t,n,e.finish]);const o=Math.floor(a/1e3),i=Math.floor(o%60),r=Math.floor(o/60%60),c=Math.floor(o/60/60%24),d=Math.floor(o/60/60/24);return t?(0,z.jsxs)(ee.B,{children:[0!==d&&(0,z.jsxs)(xe.o,{children:[d,"d"," "]}),0!==c&&(0,z.jsxs)(xe.o,{children:[c,"h"," "]}),0!==r&&(0,z.jsxs)(xe.o,{children:[r,"m"," "]}),(0,z.jsxs)(xe.o,{children:[i,"s"]})]}):(0,z.jsx)(z.Fragment,{})}var De=n(21982),Ee=n(55639);function Pe(e){return(0,z.jsx)(De.o,{numLabels:e.numLabels??999,style:e.noWrap?{flexWrap:"nowrap"}:void 0,children:e.labels?e.labels.map((e=>(0,z.jsx)(Ee.J,{children:e},e))):e.labelsWithLinks.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:e.link,children:e.name})},e.name)))})}var Re=n(47767);function Be(e){const t={};e.color&&(t.color=E(e.color)),e.size&&(t.size=e.size);let n=0;if(e.padRight)switch(e.size){case"sm":case"md":n=6;break;case"lg":n=8;break;case"xl":n=12}let a=0;if(e.padLeft)switch(e.size){case"sm":case"md":a=6;break;case"lg":a=8;break;case"xl":a=12}const s=l.Children.toArray(e.children).map((e=>(0,l.isValidElement)(e)?(0,l.cloneElement)(e,t):e));return(0,z.jsx)("div",{style:{paddingRight:n,paddingLeft:a},children:s})}function Fe(e){const t=(0,Re.Zp)();return(0,z.jsxs)(i.s,{spaceItems:{default:"spaceItemsNone"},flexWrap:{default:"nowrap"},alignItems:{default:"alignItemsBaseline"},children:[e.icon&&(void 0===e?.iconAlign||e.iconAlign&&"right"!==e.iconAlign)&&(0,z.jsx)(r.Z,{alignSelf:{default:"alignSelfCenter"},children:(0,z.jsx)(Be,{size:e.iconSize??"sm",color:e.iconColor??e.color,padRight:!0,children:e.icon})}),e.text&&(0,z.jsx)(r.Z,{style:{maxWidth:"100%"},children:(0,z.jsx)("div",{style:{maxWidth:e.maxWidth??"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:e.color?E(e.color):void 0},children:e.disableLinks||!e.to&&!e.onClick?(0,z.jsx)(z.Fragment,{children:e.text}):(0,z.jsx)("a",{style:{color:e.color?E(e.color):void 0},href:e.to,onClick:n=>{if(n.preventDefault(),e.onClick)e.onClick();else{if(!e.to)return;t(e.to)}},children:e.text})})}),e.icon&&"right"===e.iconAlign&&(0,z.jsx)(r.Z,{alignSelf:{default:"alignSelfCenter"},children:(0,z.jsx)(Be,{size:e.iconSize??"sm",padLeft:!0,color:e.iconColor??e.color,children:e.icon})})]})}var Ne=n(39033);function $e(e){const t=(0,l.useRef)(null),[n,a]=(0,l.useState)({width:t.current?.clientWidth??0,height:t.current?.clientWidth??0}),s=(0,l.useCallback)((()=>a((e=>{const n={width:t.current?.clientWidth??0,height:t.current?.clientHeight??0};return n.width!==e.width||n.height!==e.height?n:e}))),[]);return(0,l.useEffect)((()=>s()),[t,s]),(0,Ne.A)(t,(()=>s())),(0,z.jsx)(Me,{ref:t,className:e.className,style:{height:e.height},children:(0,z.jsx)(Le,{children:e.children(n)})})}const Me=A.Ay.div.withConfig({componentId:"ans__sc-1ef4xf5-0"})(["width:100%;height:100%;flex-grow:1;align-self:stretch;justify-self:stretch;position:relative;"]),Le=A.Ay.div.withConfig({componentId:"ans__sc-1ef4xf5-1"})(["position:absolute;"]);var Oe=n(63802);function ze(e){const t=(0,l.useRef)(null),[n,a]=(0,l.useState)(!1),[s,o]=(0,l.useState)(!1),i=(0,l.useCallback)((()=>{if(!t.current)return;a(t.current.scrollTop>0);const e=t.current.scrollHeight-t.current.scrollTop-t.current.clientHeight-1;o(e>.1)}),[]);(0,l.useEffect)((()=>i()),[i,e.children]),(0,Ne.A)(t,(()=>i()));const r=["scrollable-inner"];e.borderTop&&r.push("border-top"),e.borderBottom&&r.push("border-bottom");const c=r.join(" ");return(0,z.jsxs)("div",{className:`scrollable-outer ${e.className}`,style:e.style,children:[(0,z.jsx)("div",{className:c,ref:t,onScroll:i,children:e.children}),n&&(0,z.jsx)("div",{className:"scrollable-shadow-top"}),s&&(0,z.jsx)("div",{className:"scrollable-shadow-bottom"})]})}const He=(0,l.createContext)({columns:1}),qe=69.25;function Ue(e){const t=(0,l.useRef)(null),[n,a]=(0,l.useState)(1);return(0,l.useLayoutEffect)((()=>{a(Math.max(1,Math.floor((t.current?.clientWidth??0)/qe)))}),[]),(0,Ne.A)(t,(e=>{a(Math.max(1,Math.floor((e.contentRect.width??0)/qe)))})),(0,z.jsx)(He.Provider,{value:{columns:n},children:(0,z.jsx)(ze,{children:(0,z.jsx)(Oe.d8,{isWidthLimited:!0,children:(0,z.jsx)("div",{ref:t,style:{display:"grid",gap:16,gridTemplateColumns:`repeat(${n}, 1fr)`},children:e.children})})})})}var We=n(60915),Je=n(14398),Ve=n(22069),Ge=n(30465),Ye=n(72972),Ke=n(89015),Ze=n(55589),Xe=n(90678),Qe=n(73113),et=n(40167),tt=n(7019);const nt=A.Ay.button.withConfig({componentId:"ans__sc-t3yesn-0"})(["background:none;border:none;padding:0;margin:0;cursor:pointer;color:inherit;opacity:0.6;&:hover{opacity:1;}"]);function at(e){const{help:t,title:n,docLink:a}=e,[s]=W();return t?(0,z.jsx)(Ze.A,{headerContent:n,bodyContent:(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[Array.isArray(t)?t.map(((e,t)=>(0,z.jsx)(Qe.a,{children:e},t))):(0,z.jsx)(Qe.a,{children:t}),a&&(0,z.jsx)(Qe.a,{children:(0,z.jsx)(g.$n,{icon:(0,z.jsx)(et._,{}),variant:"link",onClick:()=>window.open(a,"_blank"),isInline:!0,type:"button",children:s.documentation})})]}),children:(0,z.jsx)(st,{type:"button",children:(0,z.jsx)(y.I,{size:"sm",children:(0,z.jsx)(tt.eT,{})})})}):(0,z.jsx)(z.Fragment,{})}const st=(0,A.Ay)(nt).withConfig({componentId:"ans__sc-y0ppp2-0"})(["margin-left:4px;"]),ot=90;function it(e){const t=M(e),n=(0,l.useContext)(He);let s={xxs:3,xs:4,sm:6,md:8,lg:12,xl:16,xxl:24}[e.width||"md"];s>n.columns&&(s=n.columns);const[o,c]=(0,l.useState)("true"===localStorage.getItem("db-"+t+"-collapsed"));let d={xs:2,sm:3,md:4,lg:6,xl:8,xxl:12,none:void 0}[e.height||"none"];o&&(d=void 0);const u=d?ot*d+16*(d-1):void 0;let m={xs:2,sm:3,md:4,lg:6,xl:8,xxl:12,none:d}[e.height||"none"];o&&(m=void 0);const p=m?ot*m+16*(m-1):void 0;return(0,z.jsxs)(We.Z,{id:t,isFlat:!0,isRounded:!0,style:{transition:"box-shadow 0.25s",gridColumn:`span ${s}`,gridRow:m?`span ${m}`:void 0,minHeight:p,maxHeight:u,maxWidth:"100%",...e.style},isCompact:e.isCompact,className:"page-dashboard-card","data-cy":t,children:[(e.title||e.linkText)&&(0,z.jsxs)(Je.a,{children:[(0,z.jsxs)(i.s,{spaceItems:{default:"spaceItemsLg"},alignItems:{default:"alignItemsCenter"},justifyContent:{default:"justifyContentFlexEnd"},children:[(0,z.jsxs)(r.Z,{grow:{default:"grow"},children:[e.supertitle&&(0,z.jsx)(Ve.E,{"data-cy":"card-main",component:"small",style:{opacity:.8},children:e.supertitle}),(0,z.jsxs)("div",{children:[(0,z.jsx)(Ge.h,{"data-cy":"card-title",headingLevel:"h3",size:"xl",style:{display:"inline-block",verticalAlign:"-0.15em",lineHeight:"1.2"},children:e.title}),(0,z.jsx)(at,{help:e.help,title:e.helpTitle,docLink:e.helpDocLink})]}),e.subtitle&&(0,z.jsx)(Ve.E,{"data-cy":"card-subtitle",component:"small",style:{opacity:.8},children:e.subtitle})]}),e.headerControls&&(0,z.jsx)(r.Z,{children:e.headerControls}),(0,z.jsx)(r.Z,{children:(0,z.jsx)(Ve.E,{"data-cy":"card-link-text",component:"small",children:e.linkText&&(0,z.jsx)(a.N_,{to:e.to,children:e.linkText})})}),e.canCollapse&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(Ke.D0,{style:{transform:o?"rotate(0deg)":"rotate(90deg)",transition:"transform"},onClick:()=>{return c(e=!o),void localStorage.setItem("db-"+t+"-collapsed",e?"true":"false");var e}})})]}),e.description&&!o&&(0,z.jsx)("span",{style:{opacity:.8,paddingTop:6},children:e.description})]}),!o&&e.children,!o&&e.footerActionButton&&(0,z.jsx)(Ye.w,{style:{textAlign:"end"},children:(0,z.jsx)(g.$n,{variant:"link",icon:e.footerActionButton.icon?e.footerActionButton.icon:null,onClick:()=>{e.footerActionButton?.onClick()},children:e.footerActionButton.title})})]})}var rt=n(66941),lt=n(22702),ct=n(37752),dt=n(14431),ut=n(81917),mt=n(64138),pt=n(77290),ht=n(74982);function bt(e){return e.horizontal?(0,z.jsx)(xt,{children:e.legend.map(((t,n)=>0===t.count&&!0!==e.allowZero?(0,z.jsx)(l.Fragment,{},n):(0,z.jsxs)(jt,{children:[(0,z.jsx)(ft,{id:`${e.id}-${t.label.toLowerCase().replace(/ /g,"-")}-count`,color:t.color}),!1===e.showLegendCount?null:(0,z.jsx)(gt,{count:t.count}),(0,z.jsx)(yt,{label:t.label,link:t.link})]},n)))}):(0,z.jsx)(_t,{children:e.legend.map(((t,n)=>0===t.count&&!0!==e.allowZero?(0,z.jsx)(l.Fragment,{},n):(0,z.jsxs)(l.Fragment,{children:[(0,z.jsx)(ft,{color:t.color}),!1===e.showLegendCount?null:(0,z.jsx)(gt,{id:`${e.id}-${t.label.toLowerCase().replace(/ /g,"-")}-count`,count:t.count}),(0,z.jsx)(yt,{label:t.label,link:t.link})]},n)))})}function ft(e){return(0,z.jsx)(vt,{id:e.id,style:{backgroundColor:e.color}})}function gt(e){return(0,z.jsx)(wt,{id:e.id,children:e.count})}function yt(e){return(0,z.jsx)(kt,{children:e.link?(0,z.jsx)(a.N_,{to:e.link,style:{textDecoration:"none"},children:e.label}):e.label})}const xt=A.Ay.div.withConfig({componentId:"ans__sc-vp55ln-0"})(["display:flex;flex-wrap:wrap;flex-direction:row;align-items:center;justify-content:center;gap:20px;"]),jt=A.Ay.div.withConfig({componentId:"ans__sc-vp55ln-1"})(["display:flex;flex-direction:row;align-items:center;justify-content:center;gap:6px;"]),_t=A.Ay.div.withConfig({componentId:"ans__sc-vp55ln-2"})(["display:grid;grid-template-columns:auto auto auto;row-gap:6px;column-gap:6px;align-items:center;"]),vt=A.Ay.div.withConfig({componentId:"ans__sc-vp55ln-3"})(["width:10px;height:10px;border-radius:2px;margin-right:4px;"]),wt=A.Ay.div.withConfig({componentId:"ans__sc-vp55ln-4"})(["font-size:small;line-height:1em;text-align:center;"]),kt=A.Ay.div.withConfig({componentId:"ans__sc-vp55ln-5"})(["font-size:small;line-height:1em;"]),St=(0,rt.g)("voronoi","cursor");function Ct(e){const{allowZero:t,xLabel:n,yLabel:a,minDomain:s,onlyIntegerTicks:o}=e;let{groups:i}=e;i=t?i:i.filter((e=>{for(const t of e.values)if(0!==t.value)return!0;return!1}));const r=i.filter((e=>!!e.label)).map(((e,t)=>({childName:`${t}`,name:e.label,symbol:{fill:e.color,type:"square"}}))),c=i.filter((e=>!!e.label)).map((e=>({label:e.label,count:e.values.reduce(((e,t)=>e+t.value),0),color:e.color,link:e.link}))),d=(0,l.useMemo)((()=>{const e={};for(const t of i)for(const n of t.values)e[n.label]=(e[n.label]??0)+n.value;return Object.values(e).reduce(((e,t)=>t>e?t:e),0)}),[i]),u={top:(e.padding?.top??4)+16,bottom:(e.padding?.bottom??32)+16,left:(e.padding?.left??12)+9.5*Math.round(d).toString().length+16,right:(e.padding?.right??0)+16};return(0,z.jsxs)("div",{style:{height:e.height,display:"flex",flexGrow:1,minHeight:"100%"},children:[a&&(0,z.jsx)(It,{label:a,paddingTop:u.top,paddingBottom:u.bottom}),(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1,gap:16},children:[(0,z.jsx)("div",{style:{height:"100%",margin:-16},children:(0,z.jsx)($e,{className:"page-chart",children:t=>(0,z.jsxs)(lt.t,{padding:u,colorScale:i.map((e=>e.color)),height:t.height,width:t.width,minDomain:s,maxDomain:{y:d},containerComponent:(0,z.jsx)(St,{cursorDimension:"x",labels:e=>e.datum.y.toString(),labelComponent:(0,z.jsx)(ct.t,{legendData:r,cornerRadius:8}),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:50}),children:[(0,z.jsx)(dt.c,{fixLabelOverlap:!0}),(0,z.jsx)(dt.c,{dependentAxis:!0,showGrid:!0,tickFormat:!1===o?void 0:e=>Number.isInteger(e)?e:""}),"lineChart"===e.variant&&i.map(((e,t)=>(0,z.jsx)(ut.B,{name:t.toString(),style:{data:{strokeWidth:3,stroke:e.color}},data:e.values.map((e=>({x:e.label,y:e.value}))),interpolation:"monotoneX"},t))),"lineChart"===e.variant&&i.map(((e,t)=>(0,z.jsx)(mt.B,{name:"scatter-"+t,data:e.values.map((e=>({x:e.label,y:e.value}))),size:({active:e})=>e?6:3,style:{data:{fill:e.color}}},"scatter-"+t))),(!e.variant||"stackedAreaChart"===e.variant)&&(0,z.jsx)(pt.R,{children:i.map(((e,t)=>(0,z.jsx)(ht.s,{name:t.toString(),data:e.values.map((e=>({x:e.label,y:e.value}))),interpolation:"monotoneX",style:{data:{strokeWidth:2}}},t)))}),(!e.variant||"stackedAreaChart"===e.variant)&&(0,z.jsx)(pt.R,{children:i.map(((e,t)=>(0,z.jsx)(mt.B,{name:"scatter-"+t,data:e.values.map((e=>({x:e.label,y:e.value}))),size:({active:e})=>e?6:3},"scatter-"+t)))})]})})}),n&&(0,z.jsx)(Tt,{label:n,paddingLeft:u.left,paddingRight:u.right}),(0,z.jsx)(bt,{id:e.id??"chart",legend:c,horizontal:!0,showLegendCount:e.showLegendCount,allowZero:e.allowZero})]})]})}function Tt(e){return(0,z.jsx)("span",{style:{maxHeight:"1em",display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.paddingLeft,paddingRight:e.paddingRight},children:e.label})}function It(e){return(0,z.jsx)("div",{style:{maxWidth:"1em",display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.paddingLeft,paddingBottom:e.paddingBottom,paddingTop:e.paddingTop,marginRight:16},children:(0,z.jsx)("span",{style:{transform:"rotate(-90deg)",whiteSpace:"nowrap"},children:e.label})})}var At=n(32034),Dt=n(78755),Et=n(1319),Pt=n(31358);const Rt=A.Ay.button.withConfig({componentId:"ans__sc-nrtpwt-0"})(["padding:var(--pf-v5-global--spacer--xs);margin:-(var(--pf-v5-global--spacer--xs));font-size:var(--pf-v5-global--FontSize--sm);--pf-v5-c-form__group-label-help--Color:var(--pf-v5-global--Color--200);--pf-v5-c-form__group-label-help--hover--Color:var(--pf-v5-global--Color--100);"]);function Bt(e){const{ariaLabel:t="",content:n,header:a,id:s="",maxWidth:o="",...i}=e,[r]=W();return n?(0,z.jsx)(Ze.A,{bodyContent:n,headerContent:a,hideOnOutsideClick:!0,id:s,"data-cy":s,maxWidth:o,...i,children:(0,z.jsx)(Rt,{"aria-label":t??r.moreInformation,"aria-haspopup":"true",className:"pf-v5-c-form__group-label-help",onClick:e=>e.preventDefault(),type:"button",children:(0,z.jsx)(Pt.NT,{})})}):null}function Ft(e){const t=M(e),{label:n,children:a,helpText:s,isEmpty:o}=e;return null==a||""===a||o?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)(At.W,{style:{gridColumn:e.fullWidth?"span 3":void 0},children:[n&&(0,z.jsxs)(Dt.X,{"data-cy":`label-${t}`,children:[n,s?(0,z.jsx)(Bt,{header:n,content:s}):null]}),(0,z.jsx)(Nt,{id:t,"data-cy":t,children:a})]})}const Nt=(0,A.Ay)(Et.d).withConfig({componentId:"ans__sc-1b9cf5c-0"})(["opacity:0.8;"]);var $t=n(84693);function Mt(e){const{disablePadding:t,alertPrompts:n}=e,a=we(),s=e.labelOrientation??a.formLayout,o=e.numberOfColumns?e.numberOfColumns:a.formColumns,i=e.isCompact;let r=(0,z.jsxs)(Lt,{variant:"light",padding:{default:"noPadding"},children:[n&&n.length>0&&n.map(((e,t)=>(0,z.jsx)(le.F,{style:{margin:12},isInline:!0,title:e,variant:"warning","data-cy":e},t))),(0,z.jsx)($t.B,{orientation:{sm:s,md:s,lg:s,xl:s,"2xl":s},columnModifier:"multiple"===o?{default:"1Col",sm:"1Col",md:"2Col",lg:"2Col",xl:"3Col","2xl":"3Col"}:"two"===o?{default:"1Col",sm:"1Col",md:"2Col",lg:"2Col",xl:"3Col","2xl":"2Col"}:void 0,style:{maxWidth:1200,padding:t?void 0:24},isCompact:i,children:e.children})]});return e.disableScroll||(r=(0,z.jsx)(ze,{children:r})),r}const Lt=(0,A.Ay)(Oe.d8).withConfig({componentId:"ans__sc-188gpnd-0"})(["background-color:transparent;"]);let Ot=function(e){return e.Table="table",e.List="list",e.Cards="cards",e}({}),zt=function(e){return e.description="description",e.expanded="expanded",e.hidden="hidden",e}({}),Ht=function(e){return e.name="name",e.subtitle="subtitle",e.description="description",e.hidden="hidden",e.primary="primary",e.secondary="secondary",e}({}),qt=function(e){return e.name="name",e.subtitle="subtitle",e.description="description",e.hidden="hidden",e}({}),Ut=function(e){return e.hidden="hidden",e}({}),Wt=function(e){return e.hidden="hidden",e}({}),Jt=function(e){return e.last="last",e}({});function Vt(e){const{item:t,column:n}=e;if(!n)return(0,z.jsx)(z.Fragment,{});switch(n.type){case"text":return(0,z.jsx)(Fe,{text:n.value(t),to:n.to?.(t)});case"description":return(0,z.jsx)("div",{style:{minWidth:200,whiteSpace:"normal"},children:n.value(t)});case"datetime":return(0,z.jsx)(Ie,{value:n.value(t)});case"count":return(0,z.jsx)(z.Fragment,{children:n.value(t)??"-"});case"labels":return(0,z.jsx)(Pe,{labels:n.value(t)??[]});default:return(0,z.jsx)(z.Fragment,{children:n.cell(t)})}}function Gt(e){return(0,l.useMemo)((()=>e.filter((e=>e.modal!==Ut.hidden))),[e])}function Yt(e){return e=function(e){return(0,l.useMemo)((()=>e.map((e=>({...e,table:e.table===zt.expanded?void 0:e.table})))),[e])}(e=function(e){return(0,l.useMemo)((()=>e.map((e=>({...e,sort:void 0})))),[e])}(e=(0,l.useMemo)((()=>e.filter((e=>e.dashboard!==Wt.hidden))),[e])))}function Kt(e){const{item:t,columns:n,children:a}=e,s=(0,l.useMemo)((()=>n.filter((e=>{if(!t)return!1;if("value"in e&&e.value){const n=e.value(t);if(null==n||"string"==typeof n&&0===n.trim().length)return!1}return!0}))),[n,t]),o=(0,l.useMemo)((()=>s.filter((e=>e.priority!==Jt.last))),[s]),i=(0,l.useMemo)((()=>s.filter((e=>e.priority===Jt.last))),[s]);return t&&s.length?(0,z.jsxs)(z.Fragment,{children:[o.map((e=>(0,z.jsx)(Ft,{helpText:e.helpText,label:e.header,children:(0,z.jsx)(Vt,{column:e,item:t})},e.id??e.header))),a||null,i.map((e=>(0,z.jsx)(Ft,{label:e.header,children:(0,z.jsx)(Vt,{column:e,item:t})},e.id??e.header)))]}):null}var Zt=n(15301),Xt=n(69620),Qt=n(10981),en=n(79214),tn=n(9598),nn=n(19202),an=n(31003),sn=n(16506);const on=e=>{const t=["json"],n=["non_field_errors"],a=[],s=[];switch(typeof e){case"string":a.push({message:e});break;case"object":if(null===e)break;if(Array.isArray(e)){for(const t of e)"string"==typeof t&&a.push({message:t});break}for(const o of t)if(o in e&&"object"==typeof e[o]&&null!==e[o])for(const t in e[o]){const i=e[o][t];if(n.includes(t)){if("string"==typeof i)a.push({message:i});else if(Array.isArray(i))for(const e of i)"string"==typeof e&&a.push({message:e})}else if("string"==typeof i)s.push({name:t,message:i});else if(Array.isArray(i))for(const e of i)"string"==typeof e&&s.push({name:t,message:e})}else e instanceof Error&&a.push({message:e.message})}return{genericErrors:a,fieldErrors:s}};var rn=n(33675),ln=n(86130),cn=n(33905),dn=n(75279),un=n(97796),mn=n(22204),pn=n(57691),hn=n(75189),bn=n(97192),fn=n(15402),gn=n(36645),yn=n(60199),xn=n(75364),jn=n(90523),_n=n(5924),vn=n(30769),wn=n(52565),kn=n(5335),Sn=n(64490),Cn=n(80427),Tn=n(72457),In=n(93070),An=n(99780),Dn=n(81855);function En(e){const[t,n]=(0,l.useState)(!1),a=f("sm"),[s]=W(),{pageItems:o,selectedItems:i,selectItems:r,unselectAll:c,maxSelections:d}=e,u=void 0!==e.itemCount&&e.itemCount>0&&o&&o.length>0&&(o??[]).every((e=>i?.includes(e))),m=(0,l.useCallback)((()=>{u?c?.():r?.(o??[])}),[u,c,r,o]),p=(0,l.useMemo)((()=>a?i&&i.length>0?`${i.length} selected`:"":i&&i.length>0?`${i.length}`:""),[a,i]),h=(0,l.useMemo)((()=>o?.filter((e=>!i?.includes(e)))),[o,i]),b=(0,l.useMemo)((()=>Boolean(d&&i&&h&&!u&&i?.length+h.length>d)),[u,d,i,h]),g=(0,l.useMemo)((()=>{const e=i?i.length:0;return(0,z.jsx)(Tn.C,{splitButtonItems:[(0,z.jsx)(In.J,{id:"select-all",ouiaId:"select-all","data-cy":"select-all","aria-label":"Select all",isChecked:!!u||e>0&&null,onChange:m,children:p},"select-all")],onToggle:(e,t)=>n(t),isDisabled:b})}),[i,u,m,p,b]),y=(0,l.useMemo)((()=>(0,z.jsx)(An.t,{id:"select-none",ouiaId:"select-none",onClick:()=>{c?.(),n(!1)},children:e.selectNoneText??s.selectNone},"select-none")),[e.selectNoneText,s.selectNone,c]),x=(0,l.useMemo)((()=>(0,z.jsx)(An.t,{id:"select-page",ouiaId:"select-page",onClick:()=>{r?.(o??[]),n(!1)},children:`Select ${o?.length??0} page items`},"select-page")),[r,o]),j=(0,l.useMemo)((()=>i&&i.length>0?[y,x]:[x]),[y,x,i]);return(0,z.jsx)("div",{style:{marginLeft:-8},children:(0,z.jsx)(Dn.m,{isOpen:t,toggle:g,dropdownItems:j,style:{zIndex:400}})})}var Pn=n(39095),Rn=n(62913),Bn=n(47931),Fn=n(34091),Nn=n(80168),$n=n(87604),Mn=n(20628),Ln=n(44703),On=n(22563),zn=n(5049),Hn=n(38517),qn=n(1709),Un=n(55318),Wn=n(78110),Jn=n(97862),Vn=n(92539),Gn=n(79426),Yn=n(81995),Kn=n(44397);function Zn(e,t){const[n,a]=(0,l.useState)((()=>e));(0,l.useEffect)((()=>a(e)),[e]);const s=(0,l.useCallback)((e=>{t?t(e):a(e)}),[t]);return[n,s]}function Xn(e){const{t}=(0,I.Bd)(),{id:n,icon:a,placeholder:s,values:o,onSelect:i,options:r,variant:c,disableClearSelection:d,maxChipSize:u,queryLabel:m,compareOptionValues:p}=e,[h,b]=Zn(e.open??!1,e.setOpen),[f,g]=Zn(e.searchValue??"",e.setSearchValue),y=(0,l.useRef)(null),j=(0,l.useMemo)((()=>{const e=[];for(const t of o??[]){const n=r.find((e=>p?p(e.value,t):e.value===t));n?e.push(n):m&&void 0!==t&&e.push({label:m(t),value:t})}return e}),[r,m,o,p]),v=(0,l.useMemo)((()=>j.map((e=>e.label))),[j]),w=(0,l.useCallback)(((e,t)=>{i((e=>{const n=r.find((e=>void 0!==e.key?e.key===t:e.label===t));return n&&(void 0!==e?.find((e=>p?p(e,n.value):e===n.value))?e=e.filter((e=>p?!p(e,n.value):e!==n.value)):(e=e?[...e]:[]).push(n.value)),e}))}),[i,r,p]),S=(0,l.useRef)(null);(0,l.useEffect)((()=>{h||g("")}),[h,g]);const C=(0,l.useMemo)((()=>{const t=r.filter((e=>""===f||e.label.toLowerCase().includes(f.toLowerCase())));return e.disableSortOptions||t.sort(((e,t)=>e.label.toLowerCase().localeCompare(t.label.toLowerCase()))),t}),[r,e.disableSortOptions,f]),T=(0,l.useMemo)((()=>{if(r.some((e=>!!e.group))){const e={};for(const t of C){const n=t.group??"";e[n]||(e[n]=[]),e[n].push(t)}return e}}),[r,C]);return(0,z.jsxs)(On.l,{id:`${n}-select`,selected:v,onSelect:w,isOpen:h,onOpenChange:b,toggle:t=>(0,z.jsx)(x.m,{content:e.isDisabled,trigger:e.isDisabled?void 0:"manual",children:(0,z.jsx)(_.S,{id:n,ref:t,onClick:()=>b(!h),isExpanded:h,onKeyDown:e=>{switch(e.key){case"Tab":case"Enter":case"Shift":break;default:b(!0),setTimeout((()=>{S.current&&(S.current.focus(),S.current.value=e.key)}),1)}},"data-cy":n,icon:a,isDisabled:!!e.isDisabled,isFullWidth:!0,style:{paddingTop:2,paddingBottom:4,minHeight:36},children:j.length>0?(0,z.jsx)(z.Fragment,{children:"count"===c?(0,z.jsx)(Mn.v,{isReadOnly:d,onClick:()=>i((()=>[])),style:{marginTop:-4,marginBottom:-4},children:j.length}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ln.I,{numChips:99,children:j.map((t=>(0,z.jsx)(Mn.v,{isReadOnly:e.disableClearChips,textMaxWidth:u,style:{marginTop:-2,marginBottom:-2},onClick:()=>i((e=>e?.filter((e=>e!==t.value)))),children:t.label},t.label)))}),!d&&(0,z.jsx)(Kn.AX,{role:"button","aria-hidden":!0,onClick:()=>i((()=>[])),style:{verticalAlign:"middle",marginLeft:8}})]})}):(0,z.jsx)("span",{style:{opacity:.7},children:s})})}),popperProps:{appendTo:()=>document.body,preventOverflow:!0,enableFlip:!0},innerRef:y,children:[(0,z.jsx)(zn.K,{children:(0,z.jsx)(Hn.a,{"data-cy":"search-input",children:(0,z.jsx)(qn.D,{id:`${n}-search`,ref:S,value:f,onChange:(e,t)=>g(t),onClear:e=>{e.stopPropagation(),g("")},resultsCount:C.length!==r.length?`${C.length} / ${r.length}`:void 0,onKeyDown:e=>{switch(e.key){case"ArrowDown":case"Tab":{e.preventDefault(),e.stopPropagation();const t=y?.current?.querySelector("li button:not(:disabled),li input:not(:disabled)");t&&t.focus();break}}}})})}),(0,z.jsx)(k.c,{}),0===C.length?(0,z.jsx)(z.Fragment,{children:e.isLoading?(0,z.jsx)(Un.a,{style:{padding:16},children:(0,z.jsx)(Wn.y,{size:"lg"})}):(0,z.jsx)(Jn.O,{isDisabled:!0,children:t("No results found")},"no result")}):(0,z.jsx)(ea,{children:T?(0,z.jsx)(z.Fragment,{children:Object.keys(T).map((e=>(0,z.jsx)(Vn.s,{label:e,children:(0,z.jsx)(Qn,{searchRef:S,options:C,selectedOptions:j})},e)))}):(0,z.jsx)(Qn,{searchRef:S,options:C,selectedOptions:j})}),e.footer&&(0,z.jsx)(Gn.N,{children:e.footer})]})}function Qn(e){return(0,z.jsx)(Yn.B,{onKeyDown:t=>{"Tab"===t.key&&(t.preventDefault(),t.stopPropagation(),e.searchRef.current?.focus())},children:e.options.map((t=>{const n=L(t);return(0,z.jsx)(Jn.O,{id:n,icon:t.icon,value:void 0!==t.key?t.key:t.label,description:t.description?(0,z.jsx)("div",{style:{maxWidth:300},children:t.description}):void 0,hasCheckbox:!0,isSelected:e.selectedOptions.includes(t),"data-cy":n,children:t.label},void 0!==t.key?t.key:t.label)}))})}const ea=(0,A.Ay)(ze).withConfig({componentId:"ans__sc-1lefq0e-0"})(["max-height:40vh;"]);function ta(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)(!1),[s,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(),[u,m]=(0,l.useState)(0),[p,h]=(0,l.useState)(),[b,f]=(0,l.useState)(!1),y=(0,l.useRef)(),[x,j]=(0,l.useState)(""),_=(0,l.useCallback)((0,Bn.sg)((e=>j(e)),200),[]),v=(0,l.useRef)(e.queryOptions).current,w=(0,l.useRef)(null),k=(0,l.useCallback)((()=>{w.current&&w.current.abort();const e=new AbortController;return w.current=e,a((()=>(o(!1),d(void 0),h((e=>e||void 0)),v({next:y.current,signal:e.signal,search:x}).then((t=>{e.signal.aborted||(y.current=t.next,t.remaining||o(!0),h((n=>{if(e.signal.aborted)return n;let a=[...n??[],...t.options];const s=new Set;return a=a.filter((e=>!s.has(e.value)&&(s.add(e.value),!0))),a.sort(((e,t)=>{const n=e.label.toLowerCase(),a=t.label.toLowerCase();return n<a?-1:n>a?1:0})),m(t.remaining+a.length),a})))})).catch((n=>{e.signal.aborted||d(n instanceof Error?n:new Error(t("Unknown error")))})).finally((()=>{e.signal.aborted||a(!1)})),!0))),()=>e.abort()}),[v,x,t]),S=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),k()}),[k]),C=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),m(0),h([]),y.current=void 0,k()}),[k]);(0,l.useEffect)((()=>{b&&(m(0),h([]),y.current=void 0,k())}),[b,k]);const T=(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[(0,z.jsxs)(i.s,{children:[(0,z.jsx)(r.Z,{grow:{default:"grow"},children:(0,z.jsxs)(Fn.l,{children:[e.onBrowse&&(0,z.jsx)(Nn.a,{children:(0,z.jsx)(g.$n,{id:"browse",onClick:t=>{t.preventDefault(),t.stopPropagation(),f(!1),e.onBrowse?.()},children:t("Browse")})}),!s&&(0,z.jsx)(Nn.a,{children:(0,z.jsx)(g.$n,{id:"load-more",isLoading:n,onClick:S,isDisabled:n,children:t(n?"Loading...":"Load more")})})]})}),!s&&0!==u&&(0,z.jsx)(r.Z,{children:t("Loaded {{count}} of {{total}}",{count:p?.length??0,total:u})})]}),e.footer]});return c?(0,z.jsx)(na,{id:e.id,variant:"secondary",isDanger:!0,icon:(0,z.jsx)($n.Ci,{}),iconPosition:"right",onClick:C,children:"function"==typeof e.queryErrorText?e.queryErrorText(c):e.queryErrorText??t("Error loading options")}):(0,z.jsx)(Xn,{id:e.id,icon:e.icon,placeholder:e.placeholder,options:p??[],values:e.values,onSelect:e.onSelect,variant:e.variant,footer:T,open:b,setOpen:f,searchValue:x,setSearchValue:_,isLoading:n,disableClearSelection:e.disableClearSelection,disableClearChips:e.disableClearChips,queryLabel:e.queryLabel,compareOptionValues:e.compareOptionValues})}const na=(0,A.Ay)(g.$n).withConfig({componentId:"ans__sc-5pya1j-0"})(["width:100%;text-align:left;"]);var aa=n(17334),sa=n.n(aa);function oa(e){const{t}=(0,I.Bd)(),{id:n,icon:a,value:s,onSelect:o,options:r,placeholder:c,queryLabel:d}=e,[u,m]=Zn(e.open??!1,e.setOpen);(0,l.useEffect)((()=>{u&&setTimeout((()=>w.current?.focus()),1)}),[u]);const[p,h]=Zn(e.searchValue??"",e.setSearchValue),b=(0,l.useRef)(null),f=(0,l.useMemo)((()=>r.find((e=>s===e.value))),[r,s]),j=(0,l.useMemo)((()=>{let e=f?.label;return e||void 0===s||""===s||null===s||(e=d?.(s)),e}),[d,f?.label,s]),v=(0,l.useCallback)(((e,t)=>{const n=r.find((e=>void 0!==e.key?e.key===t:e.label===t));n&&(o(n.value),m(!1))}),[o,r,m]),w=(0,l.useRef)(null);(0,l.useEffect)((()=>{u||h("")}),[u,h]),(0,l.useEffect)((()=>{e.disableAutoSelect||!e.isRequired||f||1!==r.length||o(r[0].value)}),[o,r,e.disableAutoSelect,e.isRequired,f]);const S=(0,l.useMemo)((()=>{let t=r;return e.setSearchValue||(t=t.filter((e=>""===p||e.label.toLowerCase().includes(p.toLowerCase())))),e.disableSortOptions||(t=t.sort(((e,t)=>{const n=e.label.toLowerCase(),a=t.label.toLowerCase();return n<a?-1:n>a?1:0}))),t}),[r,e.disableSortOptions,e.setSearchValue,p]),C=(0,l.useMemo)((()=>{if(r.some((e=>!!e.group))){const e={};for(const t of S){const n=t.group??"";e[n]||(e[n]=[]),e[n].push(t)}return e}}),[r,S]);return(0,z.jsx)(la.Provider,{value:{open:u,setOpen:m},children:(0,z.jsxs)(On.l,{id:`${n}-select`,selected:f,onSelect:v,isOpen:u,onOpenChange:m,toggle:e.toggle??(t=>(0,z.jsx)(x.m,{content:e.isDisabled,trigger:e.isDisabled?void 0:"manual",children:(0,z.jsxs)(i.s,{flexWrap:{default:"nowrap"},children:[(0,z.jsx)(_.S,{id:n,"data-cy":n,ref:t,icon:a??f?.icon,onClick:()=>m(!u),isExpanded:u,isDisabled:!!e.isDisabled,style:{pointerEvents:e.isDisabled?"unset":void 0,cursor:e.isDisabled?"not-allowed":void 0},onKeyDown:e=>{switch(e.key){case"Tab":case"Shift":break;default:e.preventDefault(),1===e.key.length&&h(e.key),m(!0),setTimeout((()=>{w.current&&1===e.key.length&&(w.current.value=e.key+w.current.value)}),1)}},isFullWidth:!0,children:j||(0,z.jsx)("span",{style:{opacity:.7},children:c})}),!e.isRequired&&j&&(0,z.jsx)(g.$n,{variant:"control","data-cy":"reset",onClick:()=>{m(!1),o(null),null!==t&&"current"in t&&t.current?.focus()},children:(0,z.jsx)(y.I,{size:"md",style:{opacity:.7},children:(0,z.jsx)(Kn.AX,{"aria-hidden":!0,style:{padding:0,margin:0}})})})]})})),popperProps:{appendTo:()=>document.body,preventOverflow:!0,enableFlip:!0},shouldFocusToggleOnSelect:!0,innerRef:b,children:[(0,z.jsx)(zn.K,{children:(0,z.jsx)(Hn.a,{"data-cy":"search-input",children:(0,z.jsx)(qn.D,{id:`${n}-search`,ref:w,value:p,onChange:(e,t)=>h(t),onClear:e=>{e.stopPropagation(),h("")},resultsCount:S.length!==r.length?`${S.length} / ${r.length}`:void 0,onKeyDown:e=>{switch(e.key){case"ArrowDown":case"Tab":{e.preventDefault(),e.stopPropagation();const t=b?.current?.querySelector("li button:not(:disabled),li input:not(:disabled)");t&&t.focus();break}}}})})}),(0,z.jsx)(k.c,{}),0===S.length?(0,z.jsx)(z.Fragment,{children:e.isLoading?(0,z.jsx)(Un.a,{style:{padding:16},children:(0,z.jsx)(Wn.y,{size:"lg"})}):(0,z.jsx)(Jn.O,{isDisabled:!0,children:t("No results found")},"no result")}):(0,z.jsx)(ra,{children:C?(0,z.jsx)(z.Fragment,{children:Object.keys(C).map((e=>(0,z.jsx)(Vn.s,{label:e,children:(0,z.jsx)(ia,{searchRef:w,options:C[e]})},e)))}):(0,z.jsx)(ia,{searchRef:w,options:S})}),e.footer&&(0,z.jsx)(Gn.N,{children:e.footer})]})})}function ia(e){return(0,z.jsx)(Yn.B,{onKeyDown:t=>{"Tab"===t.key&&(t.preventDefault(),t.stopPropagation(),e.searchRef.current?.focus())},children:e.options.map((e=>{const t=L(e);return(0,z.jsx)(Jn.O,{id:t,icon:e.icon,value:void 0!==e.key?e.key:e.label,description:e.description,"data-cy":t,children:e.label},void 0!==e.key?e.key:e.label)}))})}const ra=(0,A.Ay)(ze).withConfig({componentId:"ans__sc-rtowq-0"})(["max-height:40vh;"]),la=(0,l.createContext)({open:!1,setOpen:()=>{}});function ca(e){const{t}=(0,I.Bd)(),{queryOptions:n,writeInOption:a}=e,[s,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(),[p,h]=(0,l.useState)(0),[b,f]=(0,l.useState)(),[y,x]=(0,l.useState)(!1),j=(0,l.useRef)(),[_,v]=(0,l.useState)(""),w=(0,l.useCallback)(sa()((e=>v(e)),200),[]),k=(0,l.useRef)(e.onSelect).current,S=(0,l.useRef)(null),C=(0,l.useCallback)((()=>{S.current&&S.current.abort();const e=new AbortController;return S.current=e,o((()=>(d(!1),m(void 0),f((e=>e||void 0)),n({next:j.current,signal:e.signal,search:_}).then((t=>{e.signal.aborted||(j.current=t.next,t.remaining||d(!0),f((e=>{let n=[...e??[],...t.options];const s=new Set;return n=n.filter((e=>!s.has(e.value)&&(s.add(e.value),!0))),n.sort(((e,t)=>{const n=e.label.toLowerCase(),a=t.label.toLowerCase();return n<a?-1:n>a?1:0})),_||0!==t.remaining||1!==n.length||k(n[0].value),h(t.remaining+n.length),a&&t.remaining+n.length===0&&n.push(a(_)),n})))})).catch((n=>{e.signal.aborted||m(n instanceof Error?n:new Error(t("Unknown error")))})).finally((()=>{e.signal.aborted||o(!1)})),!0))),()=>e.abort()}),[k,n,_,t,a]),T=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),C()}),[C]),A=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),h(0),f([]),x(!0),j.current=void 0,C()}),[C]);(0,l.useEffect)((()=>{y&&(h(0),f([]),j.current=void 0,C())}),[y,C]),(0,l.useEffect)((()=>{u&&x(!1)}),[u]);const D=(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[(0,z.jsxs)(i.s,{children:[(0,z.jsx)(r.Z,{grow:{default:"grow"},children:(0,z.jsxs)(Fn.l,{children:[!c&&(0,z.jsx)(Nn.a,{children:(0,z.jsx)(g.$n,{id:"load-more",isLoading:s,onClick:T,isDisabled:s,children:t(s?"Loading...":"Load more")})}),e.onBrowse&&(0,z.jsx)(Nn.a,{children:(0,z.jsx)(g.$n,{id:"browse",onClick:t=>{t.preventDefault(),t.stopPropagation(),x(!1),e.onBrowse?.()},variant:"secondary",children:t("Browse")})})]})}),!c&&0!==p&&(0,z.jsx)(r.Z,{children:t("Loaded {{count}} of {{total}}",{count:b?.length??0,total:p})})]}),e.footer]});return(0,z.jsx)(oa,{id:e.id,icon:e.icon,placeholder:e.placeholder,options:b??[],value:e.value,onSelect:e.onSelect,isDisabled:e.isDisabled,footer:D,open:y,setOpen:x,searchValue:_,setSearchValue:w,isLoading:s,queryLabel:e.queryLabel,disableAutoSelect:!0,isRequired:e.isRequired,toggle:u?n=>(0,z.jsx)(da,{ref:n,id:e.id,variant:"secondary",isDanger:!0,icon:(0,z.jsx)($n.Ci,{}),onClick:A,children:"function"==typeof e.queryErrorText?e.queryErrorText(u):e.queryErrorText??t("Error loading options")}):void 0})}const da=(0,A.Ay)(g.$n).withConfig({componentId:"ans__sc-1tz9dy4-0"})(["width:100%;text-align:left;"]);var ua=n(91753),ma=n(77740),pa=n(73828);let ha=function(e){return e.LastHour="lastHour",e.Last24Hours="last24hours",e.LastWeek="last7days",e.LastMonth="last30days",e}({});function ba(e){const{filterValues:t,setFilterValues:n,placeholder:a,isRequired:s,defaultValue:o}=e,i=t&&t.length>0?t[0]:void 0,r=e.options.find((e=>e.value===i));s&&!r&&n((()=>[o??e.options[0].value]));const[c,d]=(0,l.useState)((()=>{if(t&&t.length>1)return t[1]})),[u,m]=(0,l.useState)((()=>{if(t&&t.length>2)return t[2]}));return(0,l.useEffect)((()=>{if(r&&r.isCustom){const e=[r.value];c&&(e.push(c),u&&e.push(u)),n((()=>e))}}),[r,c,u,n]),(0,z.jsxs)(wn.T,{children:[(0,z.jsx)(oa,{value:r?.value??"",onSelect:function(t){null!==t&&e.options.find((e=>e.value===t))&&n((()=>[t]))},options:e.options,placeholder:a,disableSortOptions:!0}),r&&r.isCustom&&(0,z.jsx)(fa,{to:u,setTo:m,from:c,setFrom:d})]})}function fa(e){const{to:t,setTo:n,from:a,setFrom:s}=e,{t:o}=(0,I.Bd)(),i=a?new Date(a):void 0;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ma.l,{value:a,onChange:(e,t)=>{s(t)},"aria-label":"Start date",placeholder:"YYYY-MM-DD","data-cy":"toolbar-date-picker"}),(0,z.jsx)("div",{style:{alignSelf:"baseline",padding:6},children:o("to")}),(0,z.jsx)(ma.l,{value:t,onChange:(e,t)=>{n(t)},isDisabled:!i||!(0,ua.v)(i),rangeStart:i,validators:[e=>i?(0,ua.v)(i)&&e>=i?"":o('The "to" date must be after the "from" date'):""],"aria-label":"End date",placeholder:o("now"),invalidFormatText:o("Invalid date format")}),void 0!==t&&(0,z.jsx)(g.$n,{variant:"control",style:{alignSelf:"flex-start"},onClick:()=>n(void 0),children:(0,z.jsx)(pa.I$,{})})]})}var ga=n(35253),ya=n(53642),xa=n(37039),ja=n(35630),_a=n(48067),va=n(86161);function wa(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)("");let s=e.placeholder;if(!s)switch(e.comparison){case"contains":s=t("contains");break;case"startsWith":s=t("starts with");break;case"endsWith":s=t("ends with");break;case"equals":s=t("equals")}return(0,z.jsxs)(ga.M,{children:[(0,z.jsx)(ya.b,{children:(0,z.jsxs)(xa.f,{"data-cy":"text-input",style:{minWidth:220},children:[(0,z.jsx)(ja.Q,{id:e.id,value:n,onChange:(e,t)=>{a("string"==typeof e?e:t)},onKeyUp:t=>{n&&"Enter"===t.key&&(e.addFilter(n),a(""))},placeholder:s}),""!==n&&(0,z.jsx)(_a.N,{children:(0,z.jsx)(g.$n,{variant:"plain","aria-label":"clear filter",onClick:()=>a(""),style:{opacity:n?void 0:0},tabIndex:-1,children:(0,z.jsx)(Kn.AX,{})})})]})}),(0,z.jsx)(ya.b,{children:(0,z.jsx)(g.$n,{variant:n?"primary":"control","data-cy":"apply-filter","aria-label":"apply filter",onClick:()=>{e.addFilter(n),a("")},tabIndex:-1,isDisabled:!n,children:(0,z.jsx)(va.fl,{})})})]})}function ka(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)(e.value??"");let s=e.placeholder??"";if(!s)switch(e.comparison){case"contains":s=t("contains");break;case"startsWith":s=t("starts with");break;case"endsWith":s=t("ends with");break;case"equals":s=t("equals")}const o=(0,l.useCallback)(sa()((t=>e.setValue(t)),200),[]);return(0,l.useEffect)((()=>{e.hasKey||a("")}),[e.hasKey]),(0,z.jsx)(ga.M,{children:(0,z.jsx)(ya.b,{children:(0,z.jsxs)(xa.f,{"data-cy":"text-input",style:{minWidth:220},children:[(0,z.jsx)(ja.Q,{id:e.id,value:n,onChange:(e,t)=>{"string"==typeof e?(a(e),o(e)):(a(t),o(t))},placeholder:s}),""!==n&&(0,z.jsx)(_a.N,{children:(0,z.jsx)(g.$n,{variant:"plain","aria-label":"clear filter",onClick:()=>{a(""),e.setValue("")},style:{opacity:n?void 0:0},tabIndex:-1,children:(0,z.jsx)(Kn.AX,{})})})]})})})}var Sa=n(21135);function Ca(e){const[t,n]=(0,l.useState)(!1),{activeGroup:a,setActiveGroup:s}=(0,l.useContext)(Ta);return(0,l.useEffect)((()=>{t&&s(e.id)}),[t,s,e.id]),(0,l.useEffect)((()=>{a!==e.id&&n(!1)}),[a,e.id]),(0,z.jsx)(Sa.h,{...e,isExpanded:t,onToggle:e=>{n(!t)}})}const Ta=(0,l.createContext)({activeGroup:"",setActiveGroup:()=>{}});let Ia=function(e){return e[e.SingleText=0]="SingleText",e[e.MultiText=1]="MultiText",e[e.SingleSelect=2]="SingleSelect",e[e.MultiSelect=3]="MultiSelect",e[e.DateRange=4]="DateRange",e[e.AsyncSingleSelect=5]="AsyncSingleSelect",e[e.AsyncMultiSelect=6]="AsyncMultiSelect",e}({});function Aa(e){const{toolbarFilters:t,filterState:n,setFilterState:a}=e,[s,o]=(0,l.useState)((()=>t&&t?.length>0?t[0].key:"")),i=t?.find((e=>e.key===s));if(!i)return(0,z.jsx)(z.Fragment,{});if(!t)return(0,z.jsx)(z.Fragment,{});if(0===t.length)return(0,z.jsx)(z.Fragment,{});let r=1===t.length;return t.length>=1&&(t[0].type!==Ia.SingleSelect||!t[0].isPinned||void 0!==n[t[0].key]&&0!==n[t[0].key]?.length||(r=!1)),(0,z.jsx)(z.Fragment,{children:1===t.length?(0,z.jsxs)(wn.T,{children:[r&&(0,z.jsx)("div",{style:{marginTop:6,marginRight:6,whiteSpace:"nowrap"},children:t[0].label}),(0,z.jsx)(Ea,{id:"filter-input",filter:i,filterState:n,setFilterState:a,"data-cy":i,limitFiltersToOneOrOperation:e.limitFiltersToOneOrOperation})]}):(0,z.jsxs)(wn.T,{children:[(0,z.jsx)(oa,{id:"filter",value:s,onSelect:o,icon:(0,z.jsx)(Rn.YG,{}),options:t.map((e=>({label:e.label,value:e.key}))),placeholder:"","data-cy":i,disableSortOptions:!0,isRequired:!0}),(0,z.jsx)(Ea,{id:"filter-input",filter:i,filterState:n,setFilterState:a,"data-cy":i,limitFiltersToOneOrOperation:e.limitFiltersToOneOrOperation})]})})}function Da(e){const{toolbarFilters:t,setFilterState:n,filterState:a}=e,[s]=W(),o=!f("md");if(!t)return(0,z.jsx)(z.Fragment,{});if(0===t.length)return(0,z.jsx)(z.Fragment,{});const i=t.filter((e=>!e.isPinned)),r=t.filter((e=>!!e.isPinned));return(0,z.jsx)(Ca,{toggleIcon:(0,z.jsx)(Rn.YG,{}),breakpoint:"md",id:"filters",children:(0,z.jsxs)(Sn.$,{variant:"button-group",style:{flexWrap:"wrap",gap:8},children:[o&&(0,z.jsx)(wn.T,{variant:"label",children:s.filter}),(0,z.jsx)(Aa,{toolbarFilters:i,setFilterState:n,filterState:a,limitFiltersToOneOrOperation:e.limitFiltersToOneOrOperation}),r?.map((t=>(0,z.jsx)(Aa,{toolbarFilters:[t],setFilterState:n,filterState:a,limitFiltersToOneOrOperation:e.limitFiltersToOneOrOperation},t.key))),t?.map((e=>{const t=a?.[e.key]||[];return e.isPinned&&e.type===Ia.SingleSelect||e.isPinned&&e.type===Ia.DateRange?null:(0,z.jsx)(Pn.E,{categoryName:e.label,chips:[...t.map((t=>{switch(e.type){case Ia.SingleSelect:case Ia.MultiSelect:case Ia.DateRange:return e.options?.find((e=>e.value===t))?.label??t;case Ia.AsyncSingleSelect:case Ia.AsyncMultiSelect:return{key:t,node:e.queryLabel(t)};default:return t}}))],deleteChip:(t,a)=>{n?.((t=>{const n={...t};switch(a="string"==typeof a?a:a.key,e.type){case Ia.SingleSelect:case Ia.MultiSelect:case Ia.DateRange:a=e.options.find((e=>e.label===a))?.value??a}let s=t[e.key];return s&&(s=s.filter((e=>e!==a)),0===s.length?delete n[e.key]:n[e.key]=s),n}))},deleteChipGroup:()=>{n?.((t=>{const n={...t};return delete n[e.key],n}))},showToolbarItem:!1,children:(0,z.jsx)(z.Fragment,{})},e.label)}))]})})}function Ea(e){const{filter:t,filterState:n,setFilterState:a}=e,s=n?.[t.key],o=(0,l.useCallback)((e=>{a((n=>{const a={...n},s=a[t.key]??[];return a[t.key]=e(s),a}))}),[t.key,a]),i=(0,l.useCallback)((e=>{a((n=>{const a={...n},s=a[t.key]??[];return a[t.key]=[...s,e],a}))}),[t.key,a]);let r=!1;if(n)for(const e in n){if(e===t.key)continue;const a=n[e];if(a&&a?.length>=2){r=!0;break}}switch(t.type){case Ia.SingleText:return(0,z.jsx)(ka,{id:e.id??t.key,placeholder:t.placeholder,comparison:t.comparison,setValue:e=>o((()=>e?[e]:[])),value:s&&s?.length>0?s[0]:"",hasKey:!!n?.[t.key]},t.key);case Ia.MultiText:return r&&e.limitFiltersToOneOrOperation?(0,z.jsx)(ka,{id:e.id??t.key,placeholder:t.placeholder,comparison:t.comparison,setValue:e=>o((()=>e?[e]:[])),value:s&&s?.length>0?s[0]:"",hasKey:!!n?.[t.key]},t.key):(0,z.jsx)(wa,{id:e.id??t.key,addFilter:i,placeholder:t.placeholder,comparison:t.comparison},t.key);case Ia.SingleSelect:return(0,z.jsx)(oa,{id:e.id??t.key,placeholder:t.placeholder,value:s&&s?.length>0?s[0]:"",onSelect:e=>o((()=>[e])),options:t.options,isRequired:t.isRequired||!t.isPinned,disableSortOptions:t.disableSortOptions},t.key);case Ia.AsyncSingleSelect:return(0,z.jsx)(ca,{id:e.id??t.key,value:s&&s?.length>0?s[0]:"",onSelect:e=>o((()=>[e])),placeholder:t.placeholder||"",queryOptions:t.queryOptions,queryErrorText:t.queryErrorText,queryPlaceholder:t.queryPlaceholder,isRequired:t.isRequired,footer:t.openBrowse?(0,z.jsx)(la.Consumer,{children:e=>(0,z.jsx)(g.$n,{variant:"link",onClick:()=>{e.setOpen(!1),t.openBrowse?.((e=>o((()=>[e]))),s&&s.length>0?s[0]:void 0)},children:"Browse"})}):void 0,queryLabel:t.queryLabel,disableSortOptions:t.disableSortOptions},t.key);case Ia.AsyncMultiSelect:return r&&e.limitFiltersToOneOrOperation?(0,z.jsx)(ca,{id:e.id??t.key,value:s&&s?.length>0?s[0]:"",onSelect:e=>o((()=>[e])),placeholder:t.placeholder||"",queryOptions:t.queryOptions,queryErrorText:t.queryErrorText,queryPlaceholder:t.queryPlaceholder,isRequired:t.isRequired,footer:t.openBrowse?(0,z.jsx)(g.$n,{variant:"link",onClick:()=>{t.openBrowse?.((e=>o((()=>[e.length?e[0]:""]))),s&&s.length>0?s:void 0)},children:"Browse"}):void 0,queryLabel:t.queryLabel,disableSortOptions:t.disableSortOptions},t.key):(0,z.jsx)(ta,{id:e.id??t.key,values:s,onSelect:o,placeholder:t.placeholder||"",queryOptions:t.queryOptions,queryErrorText:t.queryErrorText,queryPlaceholder:t.queryPlaceholder,footer:t.openBrowse?(0,z.jsx)(g.$n,{variant:"link",onClick:()=>{t.openBrowse?.((e=>o((()=>e))),s)},children:"Browse"}):void 0,variant:"count",disableClearSelection:!0,queryLabel:t.queryLabel,disableSortOptions:t.disableSortOptions},t.key);case Ia.MultiSelect:return r&&e.limitFiltersToOneOrOperation?(0,z.jsx)(oa,{id:e.id??t.key,placeholder:t.placeholder,value:s&&s?.length>0?s[0]:"",onSelect:e=>o((()=>[e])),options:t.options,disableSortOptions:t.disableSortOptions},t.key):(0,z.jsx)(Xn,{id:e.id??t.key,placeholder:t.placeholder,values:s,onSelect:o,options:t.options,variant:"count",disableClearSelection:!0,disableSortOptions:t.disableSortOptions},t.key);case Ia.DateRange:return(0,z.jsx)(ba,{id:e.id??t.key,label:t.label,placeholder:t.placeholder??"",filterValues:s,setFilterValues:o,options:t.options,isRequired:t.isRequired,defaultValue:t.defaultValue},t.key)}}var Pa=n(48860),Ra=n(249),Ba=n(11683),Fa=n(9530),Na=n(71850),$a=n(57085);function Ma(e){const{sort:t,setSort:n,sortDirection:a,setSortDirection:s,sortOptions:o}=e,i=o?.find((e=>e.value===t)),r=i?i.type:void 0,[c]=W(),d=(0,l.useMemo)((()=>{switch(r){case"text":switch(a){case"asc":return(0,z.jsx)(Pa.vu,{});case"desc":return(0,z.jsx)(Ra.h$,{})}break;case"number":switch(a){case"asc":return(0,z.jsx)(Ba.Qh,{});case"desc":return(0,z.jsx)(Fa.Wb,{})}break;default:switch(a){case"asc":return(0,z.jsx)(Na.$z,{});case"desc":return(0,z.jsx)($a.SA,{})}}return(0,z.jsx)(z.Fragment,{})}),[a,r]);return!o||o.length<=0?(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(Ca,{breakpoint:"2xl",toggleIcon:d,id:"sort",children:(0,z.jsxs)(Sn.$,{variant:"filter-group",style:{flexWrap:"wrap",gap:8},children:[(0,z.jsx)(wn.T,{variant:"label",children:c.sort}),(0,z.jsx)(wn.T,{children:(0,z.jsxs)(ee.B,{children:[(0,z.jsx)(La,{sortOptions:o,sort:t,setSort:n,setSortDirection:s}),(0,z.jsx)(g.$n,{variant:"control",icon:d,onClick:()=>{s?.("asc"===a?"desc":"asc")}})]})})]})})}function La(e){const{sortOptions:t,sort:n,setSort:a,setSortDirection:s}=e,o=(0,l.useCallback)((e=>{if(e){const o=t.find((t=>t.value===e));o&&n!==e&&o.defaultDirection&&s?.(o.defaultDirection),a?.(e)}}),[t,a,s,n]);return(0,z.jsx)(oa,{id:"toolbar-sort-select-expand",placeholder:"",value:n,onSelect:o,options:t.map((e=>({label:e.label,value:e.value}))),isRequired:!0})}var Oa=n(80313),za=n(11326),Ha=n(79727),qa=n(19845),Ua=n(82855),Wa=n(98730);function Ja(e){const{viewType:t,setViewType:n,openColumnModal:a}=e,[s]=W();let o=0;e.disableTableView||o++,e.disableCardView||o++,e.disableListView||o++;let i=(0,z.jsx)(Ha.Kb,{});return t===Ot.Cards&&(i=(0,z.jsx)(qa.jx,{})),t===Ot.List&&(i=(0,z.jsx)(Ua.kp,{})),(0,z.jsx)(Ca,{breakpoint:"md",toggleIcon:i,id:"view",children:(0,z.jsx)(Sn.$,{variant:"button-group",style:{justifyContent:"end",marginRight:0},children:(0,z.jsx)(wn.T,{children:(0,z.jsxs)(ee.B,{hasGutter:!0,children:[a&&(0,z.jsx)(x.m,{content:s.manageColumns,children:(0,z.jsx)(g.$n,{variant:"plain",icon:(0,z.jsx)(Wa.jn,{}),onClick:a})}),o>1&&(0,z.jsx)(Oa.O,{"data-cy":"table-view-toggle","aria-label":"table view toggle",children:[!e.disableTableView&&Ot.Table,!e.disableListView&&Ot.List,!e.disableCardView&&Ot.Cards].filter((e=>e)).map((e=>{switch(e){case Ot.Cards:return(0,z.jsx)(za.d,{icon:(0,z.jsx)(qa.jx,{}),isSelected:t===Ot.Cards,onClick:()=>n?.(Ot.Cards),"aria-label":"card view","data-cy":"card-view"},"card-view");case Ot.List:return(0,z.jsx)(za.d,{icon:(0,z.jsx)(Ua.kp,{}),isSelected:t===Ot.List,onClick:()=>n?.(Ot.List),"aria-label":"list view","data-cy":"list-view"},"list-view");case Ot.Table:return(0,z.jsx)(za.d,{icon:(0,z.jsx)(Ha.Kb,{}),isSelected:t===Ot.Table,onClick:()=>n?.(Ot.Table),"aria-label":"table view","data-cy":"table-view"},"table-view")}}))})]})})})})}const Va=A.Ay.div.withConfig({componentId:"ans__sc-v3z3s3-0"})(["display:flex;flex-grow:1;justify-content:end;flex-wrap:wrap;"]),Ga=(0,A.Ay)(_n.P).withConfig({componentId:"ans__sc-v3z3s3-1"})(["& > .pf-v5-c-toolbar__content-section{row-gap:16px;justify-content:end;}"]);function Ya(e){const{itemCount:t,page:n,perPage:a,setPage:s,setPerPage:i,toolbarFilters:r,selectedItems:c,filterState:d,setFilterState:u,openColumnModal:m,sort:p,setSort:h,sortDirection:b,setSortDirection:g,sortOptions:y,clearAllFilters:x,perPageOptions:j}=e,_=(0,l.useCallback)((()=>{x?x():u&&u({})}),[u,x]),v=f("md"),w=f("xxl"),{viewType:k,setViewType:S}=e;let{toolbarActions:C}=e;C=C??[];const[T,I]=(0,l.useState)(""),A=(0,l.useCallback)(((e,t)=>s?s(t):null),[s]),D=(0,l.useCallback)(((e,t)=>i?i(t):null),[i]),E=void 0!==r,P=void 0!==C&&C.length>0,R=!0===e.showSelect||void 0!==c&&C&&C.find((e=>"selection"in e&&e.selection===o.Multiple));return R||E||P?void 0===t?(0,z.jsx)(vn.M,{className:"page-table-toolbar border-bottom",style:{paddingBottom:v?void 0:8,paddingTop:v?void 0:8},children:(0,z.jsx)(Ga,{children:(0,z.jsx)(wn.T,{style:{width:"100%"},children:(0,z.jsx)(kn.E,{height:"36px"})})})}):(0,z.jsx)(Ta.Provider,{value:{activeGroup:T,setActiveGroup:I},children:(0,z.jsx)(vn.M,{ouiaId:"page-toolbar","data-cy":"page-toolbar",clearAllFilters:_,className:"page-table-toolbar border-bottom",style:{paddingBottom:v?void 0:8,paddingTop:v?void 0:8},inset:{default:"insetMd",sm:"insetMd",md:"insetMd",lg:"insetMd",xl:"insetLg","2xl":"insetLg"},children:(0,z.jsxs)(Ga,{style:{paddingRight:w?12:4},children:[R&&(0,z.jsx)(Sn.$,{children:(0,z.jsx)(wn.T,{variant:"bulk-select",children:(0,z.jsx)(En,{...e})})}),d&&u&&(0,z.jsx)(Da,{toolbarFilters:r,filterState:d,setFilterState:u,limitFiltersToOneOrOperation:e.limitFiltersToOneOrOperation}),e.toolbarContent,(0,z.jsx)(Sn.$,{variant:"button-group",children:(0,z.jsx)(oe,{actions:C,selectedItems:c,wrapper:wn.T})}),(0,z.jsxs)(Va,{children:[(0,z.jsx)(Ma,{sort:p,setSort:h,sortDirection:b,setSortDirection:g,sortOptions:y}),k&&S&&(0,z.jsx)(Ja,{disableTableView:e.disableTableView,disableListView:e.disableListView,disableCardView:e.disableCardView,viewType:k,setViewType:S,openColumnModal:m}),!e.disablePagination&&!e.autoHidePagination&&w&&(0,z.jsx)(wn.T,{visibility:{default:"hidden","2xl":"visible"},style:{marginLeft:24,alignSelf:"center"},children:(0,z.jsx)(Cn.d,{variant:Cn.A.top,isCompact:!0,itemCount:t,perPage:a,page:n,onSetPage:A,onPerPageSelect:D,perPageOptions:j,style:{marginTop:-8,marginBottom:-8}})})]})]})})}):(0,z.jsx)(l.Fragment,{})}function Ka(e){const{t}=(0,I.Bd)(),n=t("Something went wrong"),a=t("Please refresh the page by using the button below."),s=t("Refresh"),{titleProp:o,message:i}=e;return(0,z.jsxs)(rn.p,{isFullHeight:!0,children:[(0,z.jsx)(ln.o,{titleText:(0,z.jsx)(z.Fragment,{children:o||n}),icon:(0,z.jsx)(cn.q,{icon:an.$Q,color:"var(--pf-v5-global--danger-color--100)"}),headingLevel:"h2"}),(0,z.jsx)(dn.h,{children:i}),(0,z.jsxs)(un.s,{children:[(0,z.jsx)(dn.h,{children:a}),(0,z.jsx)(g.$n,{variant:"primary",onClick:()=>window.location.reload(),children:s})]})]})}var Za=n(56862),Xa=n(3913);function Qa(e){const{title:t,description:n,icon:a,button:s,footNote:o,image:i,variant:r,style:l}=e;return(0,z.jsxs)(rn.p,{variant:r||rn.s.full,style:l,isFullHeight:!0,children:[a&&(0,z.jsx)(cn.q,{icon:a}),(0,z.jsx)(ln.o,{titleText:(0,z.jsx)(z.Fragment,{children:t}),headingLevel:"h4","data-cy":"empty-state-title"}),(0,z.jsx)(dn.h,{"data-cy":e.description,children:n}),(0,z.jsxs)(un.s,{children:[s&&(0,z.jsx)(mn.c,{children:s}),i&&(0,z.jsxs)(z.Fragment,{children:[" ",(0,z.jsx)("br",{})," ",(0,z.jsx)(dn.h,{children:i})]}),o&&(0,z.jsx)(dn.h,{children:o})]})]})}function es(e){const{button:t,description:n,title:a,variant:s,icon:o}=e;return(0,z.jsx)(Qa,{icon:o??(t?Za.GY:Xa.IN),title:a,description:n,button:t,variant:s})}const ts=(0,l.createContext)({dialogs:[],clearDialogs:()=>{},pushDialog:e=>{},popDialog:()=>{}});function ns(e){const[t,n]=(0,l.useState)([]),a=(0,l.useCallback)((()=>n((e=>e.length?[]:e))),[n]),s=(0,l.useCallback)((e=>n((t=>[...t,e]))),[n]),o=(0,l.useCallback)((()=>n((e=>e.slice(0,-1)))),[n]),i=(0,l.useMemo)((()=>({dialogs:t,clearDialogs:a,pushDialog:s,popDialog:o})),[a,t,o,s]);return(0,z.jsxs)(ts.Provider,{value:i,children:[t.length>0&&t[t.length-1],e.children]})}function as(){return(0,l.useContext)(ts)}function ss(){const{dialogs:e,clearDialogs:t,pushDialog:n}=as(),a=(0,l.useMemo)((()=>e.length>0?e[e.length-1]:void 0),[e]),s=(0,l.useCallback)((e=>{t(),void 0!==e&&n(e)}),[t,n]);return(0,l.useMemo)((()=>[a,s]),[a,s])}function os(e,t,n){const[a,s]=(0,l.useState)((()=>n?n.reduce(((e,n)=>(e[`item-${t(n)}`]=n,e)),{}):{}));(0,l.useEffect)((()=>{s((n=>{let a=!1;return e.forEach((e=>{const s=`item-${t(e)}`;n[s]&&n[s]!==e&&(a=!0,n[s]=e)})),a?{...n}:n}))}),[e,t]);const o=(0,l.useCallback)((e=>{s((n=>{const a=`item-${t(e)}`;return n[a]!==e&&((n={...n})[a]=e),n}))}),[t]),i=(0,l.useCallback)((e=>{s((n=>{const a=`item-${t(e)}`;return n[a]&&delete(n={...n})[a],n}))}),[t]),r=(0,l.useCallback)((e=>{const n=`item-${t(e)}`;return void 0!==a[n]}),[t,a]),c=(0,l.useCallback)((e=>{s((n=>{n={...n};for(const a of e)n[`item-${t(a)}`]=a;return n}))}),[t]),d=(0,l.useRef)(e);(0,l.useEffect)((()=>{d.current=e}),[e]);const u=(0,l.useCallback)((()=>c(d.current)),[c]),m=(0,l.useCallback)((e=>{for(const t of e)i(t)}),[i]),p=(0,l.useCallback)((()=>{s((e=>Object.keys(e).length>0?{}:e))}),[]),h=(0,l.useMemo)((()=>Object.values(a)),[a]),b=(0,l.useMemo)((()=>h.length===e.length),[e.length,h.length]);return(0,l.useMemo)((()=>({selectedItems:h,selectItem:o,unselectItem:i,isSelected:r,selectItems:c,selectAll:u,unselectAll:p,allSelected:b,keyFn:t,unselectItems:m})),[b,r,t,u,o,c,h,p,i,m])}function is(e){const[t,n]=(0,l.useState)([]),[a,s]=(0,l.useState)(1),[o,i]=(0,l.useState)(10);return(0,l.useEffect)((()=>{n((t=>{const n=e.slice((a-1)*o,a*o);if(t.length!==n.length)return n;let s=0;for(const e of n)if(t[s++]!==e)return n;return t}))}),[a,o,e]),(0,l.useEffect)((()=>{a>Math.ceil(e.length/o)&&s(1)}),[a,o,e.length]),(0,l.useMemo)((()=>({paged:t,page:a,setPage:s,perPage:o,setPerPage:i})),[a,t,o])}var rs=n(11269);function ls(e){const{t}=(0,I.Bd)(),{columns:n,keyFn:a,items:s,setItems:o,isSelected:i,selectItem:r,unselectItem:c,allSelected:d,selectAll:u,unselectAll:m,hideColumnHeaders:p,isSelectableWithCheckbox:h}=e,[b,f]=(0,l.useState)(null),[g,y]=(0,l.useState)(null),[x,j]=(0,l.useState)(!1),_=(0,l.useRef)(null),v=e=>{if(_.current){const t=_.current.getBoundingClientRect();return e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height}return!1},w=e=>{v(e)||k()},k=()=>{_.current&&Array.from(_.current.children).forEach((e=>{e.classList.remove(rs.A.modifiers.ghostRow),e.setAttribute("aria-pressed","false")})),y(null),f(null),j(!1)},S=e=>{const t=e.target;t.classList.remove(rs.A.modifiers.ghostRow),t.setAttribute("aria-pressed","false"),y(null),f(null),j(!1)},C=e=>{if(_.current){e.dataTransfer.effectAllowed="move";const t=e.currentTarget.id,n=Array.from(_.current.children).findIndex((t=>t.id===e.currentTarget.id));e.currentTarget.setAttribute("aria-pressed","true"),y(t),f(n)}},T=(0,l.useCallback)((e=>{const t=s.findIndex((t=>a(t)===a(e))),n=[...s];n[t]=e,o(n)}),[s,o,a]);return(0,z.jsxs)(hn.X,{"aria-label":t("Table with draggable rows"),className:x?rs.A.modifiers.dragOver:"",variant:"compact",gridBreakPoint:"",children:[!p&&(0,z.jsx)(fn.d,{children:(0,z.jsxs)(gn.Tr,{children:[(0,z.jsx)(yn.Th,{}),h&&(0,z.jsx)(yn.Th,{select:{onSelect:(e,t)=>{t?u():m()},isSelected:d}}),n.map(((e,t)=>(0,z.jsx)(yn.Th,{children:e.header},t)))]})}),(0,z.jsx)(bn.N,{ref:_,onDragOver:e=>{e.preventDefault();const t=e.target.closest("tr");if(!(t&&_.current&&_.current.contains(t)&&t.id!==g))return null;{const e=t.id,n=Array.from(_.current.children).findIndex((t=>t.id===e));if(n!==b&&g){const e=((e,t,n)=>{const s=e.findIndex((e=>a(e)===t));if(s===n)return e;const o=e.splice(s,1);return e.splice(n,0,o[0]),e})([...s],g,n);o(e)}}return null},onDragLeave:e=>{v(e)||f(null)},children:s.map(((e,t)=>{const s=a(e);return(0,z.jsxs)(gn.Tr,{id:s.toString(),draggable:!0,onDrop:w,onDragEnd:S,onDragStart:C,children:[(0,z.jsx)(xn.Td,{draggableRow:{id:`draggable-row-${s.toString()}`}}),h&&(0,z.jsx)(xn.Td,{select:{rowIndex:t,variant:"checkbox",onSelect:(t,n)=>{n?r(e):c(e)},isSelected:i(e)}}),n.map((t=>(0,z.jsx)(xn.Td,{children:t.cell(e,T)},t.header)))]},s)}))})]})}function cs(e){const[t,n]=ss(),[a]=(0,l.useState)((()=>e.keyFn)),[s]=(0,l.useState)((()=>e.saveFn)),[o]=(0,l.useState)((()=>e.loadFn)),[i,r]=(0,l.useState)((()=>{try{const t=localStorage.getItem(e.id);if("string"==typeof t){const e=JSON.parse(t);if(Array.isArray(e)&&e.every((e=>"object"==typeof e))&&e.every((e=>"key"in e&&"enabled"in e)))return e}}catch{}})),c=(0,l.useMemo)((()=>i?e.items.map((e=>{if(o){const t=i.find((t=>t.key===a(e)));t&&t.state&&o(e,t.state)}return e})).sort(((e,t)=>{const n=i.findIndex((t=>t.key===a(e))),s=i.findIndex((e=>e.key===a(t)));return-1===n&&-1===s?0:-1===n?1:-1===s?-1:n-s})):e.items),[i,a,o,e.items]),d=(0,l.useMemo)((()=>i?c.filter((e=>{const t=i.find((t=>t.key===a(e)));return!t||t.enabled})):c),[c,i,a]),u=(0,l.useCallback)(((t,n)=>{const o=t.map((e=>({key:a(e),enabled:n.includes(e),state:s?s(e):void 0})));r(o),localStorage.setItem(e.id,JSON.stringify(o)),e.onSubmit&&e.onSubmit(t)}),[a,e,s]);return{openManageItems:()=>n((0,z.jsx)(ds,{...e,keyFn:a,items:c,defaultSelectedItems:d,onApplyChanges:u})),managedItems:d}}function ds(e){const{t}=(0,I.Bd)(),{title:n,description:a,columns:s,onApplyChanges:o}=e,[i]=(0,l.useState)((()=>e.keyFn)),[r,c]=ss(),d=()=>c(void 0),[u,m]=(0,l.useState)((()=>e.items)),{selectedItems:p,isSelected:h,selectItem:b,unselectItem:f,allSelected:y,selectAll:x,unselectAll:j}=os(u,i,e.defaultSelectedItems);return(0,z.jsxs)(Zt.a,{title:n,"aria-label":n,ouiaId:n,description:(0,z.jsx)("div",{style:{marginBottom:16},children:a}),variant:e.variant??Zt.d.medium,isOpen:!0,onClose:d,actions:[(0,z.jsx)(g.$n,{variant:"primary",onClick:()=>{o(u,p),c(void 0)},children:t`Apply`},"apply"),(0,z.jsx)(g.$n,{variant:"link",onClick:d,children:t`Cancel`},"cancel")],hasNoBodyWrapper:!0,children:[(0,z.jsx)(k.c,{}),(0,z.jsx)(Xt.H,{style:{padding:0},children:(0,z.jsx)(ls,{keyFn:i,items:u,setItems:m,columns:s,isSelected:h,selectItem:b,unselectItem:f,allSelected:y,selectAll:x,unselectAll:j,hideColumnHeaders:e.hideColumnHeaders,isSelectableWithCheckbox:!0!==e.hideSelection})}),(0,z.jsx)(k.c,{})]})}function us(){return(0,z.jsx)(hn.X,{gridBreakPoint:"",className:"page-table",children:(0,z.jsx)(bn.N,{children:new Array(10).fill(0).map(((e,t)=>(0,z.jsx)(gn.Tr,{children:(0,z.jsx)(xn.Td,{children:(0,z.jsx)(kn.E,{height:"27px"})})},t)))})})}function ms(e){const{setPage:t,setPerPage:n}=e,a=(0,l.useCallback)(((e,n)=>t(n)),[t]),s=(0,l.useCallback)(((e,t)=>n(t)),[n]),o=!f("md");return(0,z.jsx)(Cn.d,{"data-cy":"pagination",variant:Cn.A.bottom,itemCount:e.itemCount,page:e.page,perPage:e.perPage,onSetPage:a,onPerPageSelect:s,perPageOptions:e.perPageOptions,style:{...e.style,boxShadow:"none",zIndex:400,paddingTop:o?4:6,paddingBottom:o?4:6},className:"border-top bg-lighten"})}function ps(e){const t=e.size??350,n=(0,l.useRef)(null),[a,s]=(0,l.useState)("1fr"),o=(0,l.useCallback)((n=>{let a=Math.min(e.maxColumns??12,Math.max(Math.floor(n/t),1));a<1&&(a=1),s((()=>new Array(a).fill("1fr").join(" ")))}),[e.maxColumns,t]);return(0,Ne.A)(n,(e=>o(e.contentRect.width))),(0,l.useLayoutEffect)((()=>{o(n.current?.clientWidth??0)}),[o]),(0,z.jsx)("div",{ref:n,style:{display:"grid",gridAutoRows:"1fr",gridTemplateColumns:a,gap:16},children:e.children})}var hs=n(83873),bs=n(6229),fs=n(983);const gs=A.Ay.small.withConfig({componentId:"ans__sc-yvzhys-0"})(["opacity:0.7;"]),ys=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-1"})(["display:flex;flex-wrap:nowrap;max-width:100%;"]),xs=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-2"})(["margin-bottom:16px;"]),js=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-3"})(["display:flex;flex-wrap:wrap;align-items:center;gap:16px;max-width:100%;"]),_s=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-4"})(["max-width:100%;"]),vs=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-5"})(["display:flex;flex-direction:row;align-items:end;gap:16px;"]),ws=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-6"})(["flex-grow:1;"]),ks=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-7"})(["display:flex;gap:16px;margin-top:8px;flex-wrap:wrap;"]),Ss=A.Ay.div.withConfig({componentId:"ans__sc-yvzhys-8"})(["display:flex;gap:6px;align-items:baseline;"]);function Cs(e){const{item:t,itemToCardFn:n,isSelected:a,selectItem:s,unselectItem:o,itemActions:i,showSelect:c,defaultCardSubtitle:d}=e,u=(0,l.useMemo)((()=>n(t)),[t,n]),m=!!a?.(t),p=(0,l.useCallback)((()=>{a?.(t)?o?.(t):s?.(t)}),[a,t,s,o]),h=void 0!==i&&i.length>0,b=c||h;return(0,z.jsxs)(We.Z,{id:u.id,ouiaId:u.id,isFlat:!0,isLarge:!0,isRounded:!0,isSelectable:m,isSelected:m,style:{transition:"box-shadow 0.25s",cursor:"default",maxWidth:"100%"},children:[(0,z.jsx)(Je.a,{...b&&{actions:{actions:(0,z.jsxs)(z.Fragment,{children:[i&&i.length&&(0,z.jsx)(oe,{actions:i,position:te.nU.right,selectedItem:t,iconOnly:!0,collapse:"always"}),c&&(0,z.jsx)(hs.S,{isChecked:a?.(t),onChange:p,id:"check-1"})]}),hasNoOffset:!1,className:void 0}},style:{display:"flex",flexWrap:"nowrap",maxWidth:"100%"},children:(0,z.jsxs)(ys,{children:[(0,z.jsxs)(js,{children:[u.iconAboveTitle?null:u.icon&&(0,z.jsx)(Be,{size:"xl",children:u.icon}),(0,z.jsxs)(_s,{children:[u.iconAboveTitle?(0,z.jsx)(xs,{children:u.icon&&(0,z.jsx)(Be,{size:"xl",children:u.icon})}):null,(0,z.jsx)(bs.Z,{children:(0,z.jsx)(fe.P,{content:u.title})}),u.subtitle?(0,z.jsx)(Ve.E,{component:"small",style:{opacity:.7},children:u.subtitle}):d&&(0,z.jsx)(Ve.E,{component:"small",style:{opacity:.7},children:d})]})]}),u.badge&&u.badgeTooltip&&(0,z.jsx)(r.Z,{children:(0,z.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,z.jsx)(Ze.A,{headerContent:u.badgeTooltipTitle,bodyContent:u.badgeTooltip,children:(0,z.jsx)(Ee.J,{color:u.badgeColor,children:u.badge})})})}),u.badge&&!u.badgeTooltip&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(Ee.J,{color:u.badgeColor,children:u.badge})})]})}),u.cardBody,u.labels&&(0,z.jsx)(Ye.w,{children:(0,z.jsx)(vs,{children:(0,z.jsx)(ws,{children:u.labels&&(0,z.jsx)(De.o,{numLabels:999,children:u.labels.map((e=>(0,z.jsx)(Ee.J,{color:e.color,icon:e.icon,variant:e.variant,children:(0,z.jsx)(fe.P,{content:e.label,style:{minWidth:0}})},e.label)))})})})}),u.alertTitle&&(0,z.jsx)(le.F,{title:u.alertTitle,isInline:!0,variant:u.alertVariant,children:u.alertContent})]},u.id??u.title)}function Ts(e){const{keyFn:t,pageItems:n,tableColumns:a,isSelected:s,selectItem:o,unselectItem:i,rowActions:r,showSelect:c,defaultSubtitle:d}=e,u=function(e,t){const n=(0,l.useMemo)((()=>{let t,n,a;const s=[];let o;const i=[];for(const r of e)if("hidden"!==r.card)switch(r.type){case"description":a||(a=r);break;case"labels":o||(o=r);break;case"count":s.push(r);break;default:switch(r.card){case"name":t=r;break;case"subtitle":n=r;break;case"description":a=r;break;default:i.push(r)}}return{nameColumn:t,subtitleColumn:n,descriptionColumn:a,countColumns:s,cardColumns:i,labelColumn:o}}),[e]),{nameColumn:a,subtitleColumn:s,descriptionColumn:o,countColumns:i,cardColumns:r,labelColumn:c}=n;return(0,l.useMemo)((()=>e=>{let n=!!o;o?.value&&!o.value(e)&&(n=!1);const l=r.filter((t=>!t.value||t.value(e))),d={id:t(e),icon:a?.icon?.(e),title:(0,z.jsx)(Vt,{column:a,item:e}),subtitle:s&&(!s.value||s.value(e))&&(0,z.jsx)(Vt,{column:s,item:e}),cardBody:(0,z.jsx)(fs.b,{children:(0,z.jsxs)($t.B,{isCompact:!0,children:[n&&o&&(0,z.jsx)(Ft,{children:"description"===o.type?(0,z.jsx)("div",{children:o.value(e)}):(0,z.jsx)(Vt,{column:o,item:e})},o.id??o.header),l.map((t=>(0,z.jsx)(Ft,{label:t.header,children:(0,z.jsx)(Vt,{column:t,item:e})},t.id??t.header))),i.length>0&&(0,z.jsx)(Ft,{children:(0,z.jsx)(ks,{children:i.map(((t,n)=>(0,z.jsxs)(Ss,{children:[(0,z.jsx)(Vt,{column:t,item:e}),(0,z.jsx)(gs,{children:t.header})]},n)))})},"count-columns")]})}),labels:c&&c.value(e)?.map((e=>({label:e})))};return n||0!==l.length||0!==i.length||(d.cardBody=void 0),d}),[r,i,o,c,a,s,t])}(a,t),m=(0,l.useMemo)((()=>(0,z.jsx)(ps,{size:400,children:n?.map((e=>(0,z.jsx)(Cs,{item:e,itemToCardFn:u,isSelected:s,selectItem:o,unselectItem:i,itemActions:r,showSelect:c,defaultCardSubtitle:d},t(e))))})),[n,t,u,s,o,i,r,c,d]);return(0,z.jsx)(Oe.d8,{style:{flexGrow:1},children:m})}var Is=n(41259),As=n(45608),Ds=n(67546),Es=n(53283),Ps=n(83691),Rs=n(43631),Bs=n(87705);function Fs(e){const{keyFn:t,pageItems:n,tableColumns:a,isSelected:s,selectItem:o,unselectItem:r,rowActions:c,defaultSubtitle:d,showSelect:u}=e,m=function(e,t,n,a,s,o,r,c){const d=(0,l.useMemo)((()=>{let t,n,a;const s=[];let o;const i=[],r=[];for(const l of e)if("hidden"!==l.list)switch(l.type){case"description":a||(a=l);break;case"labels":o||(o=l);break;case"count":s.push(l);break;default:switch(l.list){case"name":t=l;break;case"subtitle":n=l;break;case"description":a=l;break;case"secondary":r.push(l);break;default:i.push(l)}}return{nameColumn:t,subtitleColumn:n,descriptionColumn:a,countColumns:s,primaryColumns:i,secondaryColumns:r,labelColumn:o}}),[e]),u=(0,l.useCallback)((e=>{n?.(e)?s?.(e):a?.(e)}),[n,a,s]),{nameColumn:m,subtitleColumn:p,descriptionColumn:h,countColumns:b,primaryColumns:f,secondaryColumns:g,labelColumn:y}=d;return(0,l.useCallback)((e=>{const a=t(e),s=n?.(e);return(0,z.jsx)(As.e,{"aria-labelledby":`data-list-${a}`,isExpanded:s,children:(0,z.jsxs)(Ds._,{children:[c&&(0,z.jsx)(Es.$,{"aria-labelledby":`data-list-check-${a}`,name:`data-list-check-${a}`,isChecked:n?.(e),onClick:()=>u(e),"data-cy":"data-list-check"}),(0,z.jsx)(Ps.j,{dataListCells:[(0,z.jsx)(Rs.Z,{width:5,children:(0,z.jsx)(i.s,{children:(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[(0,z.jsxs)(i.s,{alignItems:{default:"alignItemsCenter"},children:[m?.icon&&(0,z.jsx)(Be,{size:"xl",children:m?.icon(e)}),(0,z.jsxs)(Xe.B,{children:[(0,z.jsx)(Ge.h,{headingLevel:"h2",style:{marginTop:-4,fontWeight:"bold"},"data-cy":"data-list-name",children:(0,z.jsx)("span",{id:`data-list-${a}`,children:(0,z.jsx)(Vt,{column:m,item:e})})}),p?(0,z.jsx)(Ve.E,{component:"small",style:{opacity:.7},children:(0,z.jsx)(Vt,{column:p,item:e})}):r&&(0,z.jsx)(Ve.E,{component:"small",style:{opacity:.7},children:r})]})]}),(h||f.length>0||b.length>0||y)&&(0,z.jsxs)($t.B,{isCompact:!0,children:[h&&(!h.value||h.value(e))&&(0,z.jsx)(At.W,{children:(0,z.jsx)(Et.d,{children:(0,z.jsx)(Vt,{column:h,item:e})})},h.header),f.map((t=>t.value&&!t.value(e)?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{style:{whiteSpace:"nowrap",opacity:.6},children:t.header}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(Vt,{column:t,item:e})})]},t.header))),b.length>0&&(0,z.jsx)(At.W,{children:(0,z.jsx)(Et.d,{children:(0,z.jsx)("div",{style:{display:"flex",gap:16,marginTop:8,flexWrap:"wrap"},children:b.map(((t,n)=>(0,z.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"baseline"},children:[(0,z.jsx)(Vt,{column:t,item:e}),(0,z.jsx)("small",{style:{opacity:.7},children:t.header})]},n)))})})},"counts"),y&&(0,z.jsx)(At.W,{children:(0,z.jsx)(Et.d,{children:(0,z.jsx)(Vt,{column:y,item:e})})},y.header)]})]})})},"primary"),g.length>0?(0,z.jsx)(Rs.Z,{children:(0,z.jsx)($t.B,{isCompact:!0,children:g.map((t=>t.value&&!t.value(e)?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{style:{whiteSpace:"nowrap",opacity:.6},children:t.header}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(Vt,{column:t,item:e})})]},t.header)))})},"secondary"):null]}),o&&(0,z.jsx)(Bs.x,{"aria-labelledby":"check-action-item1 check-action-action1",id:"check-action-action1","aria-label":"Actions",isPlainButtonAction:!0,style:{whiteSpace:"nowrap"},"data-cy":"data-list-action",children:(0,z.jsx)(oe,{actions:o,position:te.nU.right,selectedItem:e,iconOnly:!0,collapse:"always"})})]})},a)}),[t,n,c,m,p,r,f,h,b,y,g,o,u])}(a,t,s,o,r,c,d,u);return(0,z.jsx)(Is.Tr,{"aria-label":"TODO",style:{marginTop:-1,maxWidth:"100%",overflow:"hidden"},children:n?.map(m)})}const Ns=A.Ay.div.withConfig({componentId:"ans__sc-gsg551-0"})(["flex:1;"]);function $s(e){const{id:t,toolbarActions:n,filterState:a,error:s,itemCount:r}=e,c=e.showSelect||void 0!==n?.find((e=>"selection"in e&&e.selection===o.Multiple)),d=!e.disableTableView,u=!e.disableListView,[m,p]=(0,l.useState)((()=>{switch(e.id?localStorage.getItem(e.id+"-view"):void 0){case"table":return Ot.Table;case"list":return Ot.List;case"cards":return Ot.Cards}return e.defaultTableView??(d?Ot.Table:u?Ot.List:Ot.Cards)})),h=(0,l.useCallback)((t=>{p(t),e.id&&localStorage.setItem(e.id+"-view",t)}),[e.id]),{openColumnManagement:b,managedColumns:f}=function(e,t,n,a,s){const{t:o}=(0,I.Bd)(),i=(0,l.useMemo)((()=>{const e=[{header:o("Name"),cell:e=>e.header}];return n||e.push({header:o("Table"),cell:(e,t)=>(0,z.jsx)(oa,{value:e.table??"",onSelect:n=>{switch(n){case"":t({...e,table:void 0});break;case zt.description:case zt.expanded:case zt.hidden:t({...e,table:n})}},placeholder:o("Column"),options:[{value:"",label:o("Column"),description:o("Show the column in the table.")},{value:zt.description,label:o("Description"),description:o("Show the column when the item is expanded as a full width description.")},{value:zt.expanded,label:o("Expanded"),description:o("Show the column when the item is expanded as a detail.")},{value:zt.hidden,label:o("Hidden"),description:o("Hide the column.")}],isRequired:!0})}),a||e.push({header:o("List"),cell:(e,t)=>(0,z.jsx)(oa,{value:e.list??"",onSelect:n=>{switch(n){case"":t({...e,list:void 0});break;case"name":case"subtitle":case"description":case"primary":case"secondary":case"hidden":t({...e,list:n})}},options:[{value:"name",label:o("Name"),description:o("Show the column as the name of the list item.")},{value:"subtitle",label:o("Subtitle"),description:o("Show the column as the subtitle under the name on the list.")},{value:"description",label:o("Description"),description:o("Show the column as the list item description.")},{value:"primary",label:o("Left side"),description:o("Show the column on the left side of the list.")},{value:"secondary",label:o("Right side"),description:o("Show the column on the right side of the list.")},{value:"hidden",label:o("Hidden"),description:o("Hide the column on the list.")}],placeholder:o("Left side"),isRequired:!0})}),s||e.push({header:o("Card"),cell:(e,t)=>(0,z.jsx)(oa,{value:e.card??"",onSelect:n=>{switch(n){case"":t({...e,card:void 0});break;case"name":case"subtitle":case"description":case"hidden":t({...e,card:n})}},placeholder:o("Detail"),options:[{value:"name",label:o("Name"),description:o("Show the column as the name on the card.")},{value:"subtitle",label:o("Subtitle"),description:o("Show the column as the subtitle under the name on the card.")},{value:"description",label:o("Description"),description:o("Show the column as the card description.")},{value:"",label:o("Detail"),description:o("Show the column one of the details on the card.")},{value:"hidden",label:o("Hidden"),description:o("Hide the column on the card.")}],isRequired:!0})}),e}),[s,a,n,o]),r=(0,l.useCallback)(((e,t)=>{"object"==typeof t&&null!==t&&("table"in t&&"string"==typeof t.table?e.table=t.table:e.table=void 0,"list"in t&&"string"==typeof t.list?e.list=t.list:e.list=void 0,"card"in t&&"string"==typeof t.card?e.card=t.card:e.card=void 0)}),[]),c=(0,l.useCallback)((e=>{const{table:t,list:n,card:a}=e;return{table:t,list:n,card:a}}),[]),{openManageItems:d,managedItems:u}=cs({id:e,title:o("Manage Columns"),description:o("Manage the order, placement, and format of columns."),items:t,keyFn:e=>e.id??e.header,columns:i,loadFn:r,saveFn:c,hideSelection:!0});return{openColumnManagement:d,managedColumns:u}}((t??"")+"-columns",e.tableColumns,m!==Ot.Table,m!==Ot.List,m!==Ot.Cards),y=(x=e.tableColumns,(0,l.useMemo)((()=>{const e=[];for(const t of x)if(t.sort){if(t.defaultSort){e.push({label:t.header,value:t.sort,type:"text",defaultDirection:t.defaultSortDirection});continue}switch(t.type){case"count":e.push({label:t.header,value:t.sort,type:"number",defaultDirection:t.defaultSortDirection});break;case"text":e.push({label:t.header,value:t.sort,type:"text",defaultDirection:t.defaultSortDirection});break;default:e.push({label:t.header,value:t.sort,defaultDirection:t.defaultSortDirection})}}return e}),[x]));var x,j;if(s)return(0,z.jsx)(Ka,{titleProp:e.errorStateTitle,message:s.message});if(0===r&&0===Object.keys(a??{}).length)return(0,z.jsx)(es,{title:e.emptyStateTitle,description:e.emptyStateDescription,icon:e.emptyStateNoDataIcon,button:e.emptyStateButtonClick&&(0,z.jsx)(g.$n,{"data-cy":e.emptyStateButtonText?(j=e.emptyStateButtonText,j.toLowerCase().split(" ").join("-")):"create-resource",variant:"primary",onClick:e.emptyStateButtonClick,icon:e.emptyStateButtonIcon?e.emptyStateButtonIcon:null,children:e.emptyStateButtonText})||e.emptyStateActions&&(0,z.jsx)(i.s,{justifyContent:{default:"justifyContentCenter"},children:(0,z.jsx)(oe,{actions:e.emptyStateActions})})});let _=e.topContent;return _&&(_=(0,z.jsx)(Oe.d8,{variant:"light",padding:{default:"noPadding"},style:{borderBottom:"thin solid var(--pf-v5-global--BorderColor--100)"},children:e.topContent})),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ya,{...e,openColumnModal:e.id?b:void 0,showSelect:c,viewType:m,setViewType:h,sortOptions:y,limitFiltersToOneOrOperation:e.limitFiltersToOneOrOperation}),m===Ot.Table&&(0,z.jsx)(z.Fragment,{children:e.scrollTopContent?(0,z.jsxs)(ze,{children:[_,!e.hideTable&&(0,z.jsx)(Ms,{...e,tableColumns:f})]}):(0,z.jsxs)(z.Fragment,{children:[_,!e.hideTable&&(0,z.jsx)(Ms,{...e,tableColumns:f})]})}),m===Ot.List&&(0,z.jsx)(z.Fragment,{children:e.scrollTopContent?(0,z.jsxs)(ze,{children:[_,(0,z.jsx)(Oe.d8,{padding:{default:"noPadding"},children:!e.hideTable&&(0,z.jsx)(Fs,{...e,showSelect:c,tableColumns:f})})]}):(0,z.jsxs)(z.Fragment,{children:[_,(0,z.jsx)(ze,{children:(0,z.jsx)(Oe.d8,{padding:{default:"noPadding"},children:!e.hideTable&&(0,z.jsx)(Fs,{...e,showSelect:c,tableColumns:f})})})]})}),m===Ot.Cards&&(0,z.jsx)(z.Fragment,{children:e.scrollTopContent?(0,z.jsxs)(ze,{children:[_,!e.hideTable&&(0,z.jsx)(Ts,{...e,showSelect:c,tableColumns:f})]}):(0,z.jsxs)(z.Fragment,{children:[_,(0,z.jsx)(ze,{children:!e.hideTable&&(0,z.jsx)(Ts,{...e,showSelect:c,tableColumns:f})})]})}),!e.disablePagination&&(!e.autoHidePagination||(e.itemCount??0)>e.perPage)&&(0,z.jsx)(ms,{...e,topBorder:!e.autoHidePagination})]})}function Ms(e){const{pageItems:t,selectItem:n,unselectItem:a,isSelected:s,isSelectMultiple:i,keyFn:r,rowActions:c,toolbarActions:d,itemCount:u,clearAllFilters:m,onSelect:p,unselectAll:h,maxSelections:b}=e,f=function(e){return(0,l.useMemo)((()=>e.filter((e=>e.table!==zt.hidden&&e.table!==zt.description&&e.table!==zt.expanded))),[e])}(e.tableColumns),y=(x=e.tableColumns,(0,l.useMemo)((()=>x.filter((e=>e.table!==zt.hidden&&e.table===zt.description))),[x]));var x;const j=function(e){return(0,l.useMemo)((()=>e.filter((e=>e.table!==zt.hidden&&e.table===zt.expanded))),[e])}(e.tableColumns),_=(0,l.useMemo)((()=>{const t=[];if(y.length)for(const e of y)"value"in e?t.push((t=>{const n=e.value?.(t);if(n)return(0,z.jsx)("div",{children:n},e.id??e.header)})):t.push((t=>e.cell(t)));if(j.length&&t.push((e=>j.some((t=>void 0!==t.value?.(e)))?(0,z.jsx)(Mt,{disablePadding:!0,numberOfColumns:"multiple",labelOrientation:"vertical",isCompact:!0,disableScroll:!0,children:(0,z.jsx)(Kt,{item:e,columns:j},r(e))}):null)),e.expandedRow&&t.push(e.expandedRow),0!==t.length)return e=>0===t.map((t=>t(e))).filter((e=>null!=e)).length?null:(0,z.jsx)(Xe.B,{hasGutter:!0,children:t.map((t=>t(e)))})}),[y,j,r,e.expandedRow]),[v]=W(),w=e.showSelect||void 0!==d?.find((e=>"selection"in e&&e.selection===o.Multiple)),k=(0,l.useRef)(null),[S,C]=(0,l.useState)({left:0,right:0,top:0,bottom:0}),T=(0,l.useCallback)((e=>{e&&C({top:e.scrollTop,bottom:e.scrollHeight-e.clientHeight-e.scrollTop,left:e.scrollLeft,right:e.scrollWidth-e.clientWidth-e.scrollLeft})}),[]),I=(0,l.useCallback)((e=>T(e.currentTarget)),[T]);(0,Ne.A)(k,(()=>T(k.current))),(0,l.useEffect)((()=>T(k.current)),[T]);const A=we();let D;return D=void 0===e.itemCount||void 0===t?(0,z.jsx)(us,{}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(hn.X,{"aria-label":"Simple table",ouiaId:"simple-table",variant:e.compact||"compact"===A.tableLayout?"compact":void 0,borders:!e.borderless,gridBreakPoint:"",isStickyHeader:!0,className:"page-table",children:[(0,z.jsx)(Ls,{...e,showSelect:w,scrollLeft:S.left>0,scrollRight:S.right>1,tableColumns:f,onSelect:p,expandedRow:_}),(0,z.jsx)(bn.N,{children:t.map(((o,l)=>(0,z.jsx)(Os,{columns:f,item:o,isItemSelected:s?.(o),isSelectMultiple:i,selectItem:n,unselectItem:a,rowActions:c,rowIndex:l,showSelect:w,scrollLeft:S.left>0,scrollRight:S.right>1,unselectAll:h,onSelect:p,expandedRow:_,isLastRow:l===t.length-1,disableLastRowBorder:e.disableLastRowBorder,maxSelections:b,selectedItems:e.selectedItems,defaultExpandedRows:e.defaultExpandedRows},r?r(o):l)))})]}),0===u&&(0,z.jsxs)(rn.p,{isFullHeight:!0,children:[(0,z.jsx)(ln.o,{titleText:(0,z.jsx)(z.Fragment,{children:v.noResultsFound}),icon:(0,z.jsx)(cn.q,{icon:e.emptyStateIcon??pn.WI}),headingLevel:"h2"}),(0,z.jsx)(dn.h,{children:v.noResultsMatchCriteria}),(0,z.jsx)(un.s,{children:m&&(0,z.jsx)(mn.c,{children:(0,z.jsx)(g.$n,{variant:"primary",onClick:m,children:v.clearAllFilters})})})]})]}),e.scrollTopContent||(D=(0,z.jsx)(Ns,{className:"pf-v5-c-scroll-inner-wrapper",ref:k,onScroll:I,style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"},children:D})),D}function Ls(e){const{tableColumns:t,rowActions:n,sort:a,setSort:s,sortDirection:o,setSortDirection:i,showSelect:r,onSelect:c,expandedRow:d}=e,u=(0,l.useCallback)(((e,t)=>{if(t.sort)return{onSort:(e,n,a)=>{t.sort&&(s?.(t.sort),i?.(a))},sortBy:{index:t.sort===a?e:void 0,direction:t.sort===a?o:void 0,defaultDirection:t.defaultSortDirection},columnIndex:e}}),[s,i,a,o]);return(0,z.jsx)(fn.d,{children:(0,z.jsxs)(gn.Tr,{className:"bg-lighten",children:[d&&(0,z.jsx)(yn.Th,{style:{padding:0},className:"bg-lighten"}),(r||c)&&(0,z.jsx)(yn.Th,{isStickyColumn:!0,stickyMinWidth:"0px",hasRightBorder:e.scrollLeft,"data-cy":"selections-column-header",className:e.scrollLeft?"bg-lighten-2":"bg-lighten",children:" "}),t.map(((e,t)=>(0,z.jsx)(yn.Th,{sort:u(t,e),modifier:"nowrap",style:{minWidth:0===e.minWidth?"1%":void 0!==e.minWidth?e.minWidth:void 0,maxWidth:void 0!==e.maxWidth?e.maxWidth:void 0,width:e.fullWidth?"100%":void 0},"data-cy":L(e.header+"-column-header"),className:"bg-lighten",children:e.header},e.header))),void 0!==n&&(0,z.jsx)(xn.Td,{isActionCell:!0,isStickyColumn:!0,stickyMinWidth:"0px",style:{right:0,padding:0,paddingRight:0,zIndex:302},className:e.scrollRight?"pf-m-border-left bg-lighten-2":"bg-lighten","data-cy":"action-column-header",children:" "})]})})}function Os(e){const{columns:t,unselectAll:n,selectItem:a,unselectItem:s,isItemSelected:o,isSelectMultiple:i,item:r,rowActions:c,rowIndex:d,showSelect:u,onSelect:m,expandedRow:p,disableLastRowBorder:h,maxSelections:b,selectedItems:f}=e,g=p?.(r),[y,x]=(0,l.useState)(!!e.defaultExpandedRows&&!!g),j=we(),_=(0,l.useCallback)((e=>f?.length===b&&!f?.includes(e)),[b,f]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(gn.Tr,{style:{boxShadow:"unset",borderBottom:y||e.isLastRow&&h?"unset":void 0,cursor:m?"pointer":"default"},"data-cy":!("id"in r)||"string"!=typeof r.id&&"number"!=typeof r.id?`row-${d}`:`row-id-${r.id.toString()}`,className:o?"selected":void 0,onClick:()=>{m&&(i||n?.(),i&&o?s?.(r):a?.(r),m(r))},children:[p&&(0,z.jsx)(xn.Td,{expand:g?{rowIndex:d,isExpanded:y,onToggle:()=>x((e=>!e))}:void 0,style:{paddingLeft:g?8:4},"data-cy":"expand-column-cell"}),u&&(0,z.jsx)(yn.Th,{select:void 0!==o?{onSelect:(e,t)=>{t?a?.(r):s?.(r)},isSelected:o,isDisabled:!(!b||!f)&&_(r)}:void 0,isStickyColumn:e.scrollLeft,stickyMinWidth:"0px",hasRightBorder:e.scrollLeft,"data-cy":"checkbox-column-cell",className:e.scrollLeft?"bg-lighten":void 0}),m&&(0,z.jsx)(xn.Td,{select:{rowIndex:d,isSelected:o??!1,variant:i?"checkbox":"radio",isDisabled:!(!b||!f)&&_(r)},isStickyColumn:e.scrollLeft,stickyMinWidth:"0px",hasRightBorder:e.scrollLeft,"data-cy":"checkbox-column-cell",className:e.scrollLeft?"bg-lighten":void 0}),(0,z.jsx)(zs,{columns:t,item:r,rowActions:c,scrollLeft:e.scrollLeft,scrollRight:e.scrollRight})]}),p&&y&&g&&(0,z.jsxs)(gn.Tr,{isExpanded:y,style:{boxShadow:"unset"},className:o?"selected":void 0,children:[(0,z.jsx)(xn.Td,{}),u&&(0,z.jsx)(yn.Th,{isStickyColumn:e.scrollLeft,stickyMinWidth:"0px",hasRightBorder:e.scrollLeft,className:e.scrollLeft?"bg-lighten":void 0}),m&&(0,z.jsx)(xn.Td,{isStickyColumn:!0,stickyMinWidth:"0px",hasRightBorder:e.scrollLeft}),(0,z.jsx)(xn.Td,{colSpan:t.length,style:{paddingBottom:"compact"===j.tableLayout?12:24,paddingTop:0},children:(0,z.jsx)(jn.o,{children:g})}),void 0!==c&&c.length>0&&(0,z.jsx)(xn.Td,{isActionCell:!0,isStickyColumn:e.scrollRight,stickyMinWidth:"0px",style:{right:0,padding:0,paddingRight:0},className:e.scrollRight?"pf-m-border-left bg-lighten":void 0,children:" "})]})]})}function zs(e){const{columns:t,item:n,rowActions:a}=e,[s,o]=(0,l.useState)(!1);return(0,z.jsxs)(l.Fragment,{children:[t.map((e=>(0,z.jsx)(xn.Td,{dataLabel:e.header,modifier:"nowrap",style:{width:0===e.minWidth?"0%":void 0},"data-cy":L(e.header+"-column-cell"),children:(0,z.jsx)(Vt,{item:n,column:e})},e.header))),void 0!==a&&a.length>0&&(0,z.jsx)(xn.Td,{isActionCell:!0,isStickyColumn:e.scrollRight,stickyMinWidth:"0px",style:{right:0,padding:0,paddingRight:8,zIndex:s?400:void 0},"data-cy":"actions-column-cell",className:e.scrollRight?"pf-m-border-left bg-lighten":void 0,children:(0,z.jsx)(oe,{actions:a,selectedItem:n,position:te.nU.right,iconOnly:!0,onOpen:o})})]})}function Hs(){const e=(0,l.useRef)(new AbortController);return(0,l.useEffect)((()=>{const t=e.current;return()=>t.abort()}),[]),e.current}function qs(e){const{title:t,items:n,keyFn:a,actionColumns:s,actionFn:o,onComplete:i,onClose:r,processingText:c,isDanger:d,errorAdapter:u=on,description:m}=e,{t:p}=(0,I.Bd)(),[h]=W(),[b,f]=(0,l.useState)(!0),[y,x]=(0,l.useState)(!1),[j,_]=(0,l.useState)(0),[v,w]=(0,l.useState)(""),[k,S]=(0,l.useState)(),C=Hs(),[T,A]=ss(),D=(0,l.useCallback)((()=>{x(!0),C.abort(),f(!1),S((e=>{const t={...e};for(const e of n){const n=a(e);void 0===t[n]&&(t[n]=p("Cancelled"))}return t}))}),[C,n,a,p]),E=(0,l.useCallback)((()=>{A(void 0),r?.(y?"canceled":v?"failures":"success",n.filter((e=>null===k?.[a(e)])),n.filter((e=>null!==k?.[a(e)])),n.filter((e=>void 0===k?.[a(e)])))}),[v,y,n,a,r,A,k]);(0,l.useEffect)((()=>{!async function(){const e=(0,sn.A)(5);let t=0;const s=[];await Promise.all(n.map((n=>e((async()=>{if(C.signal.aborted)return;const e=a(n);try{await o(n,C.signal),C.signal.aborted||S((t=>({...t??{},[e]:null}))),s.push(n)}catch(t){const{genericErrors:n,fieldErrors:a}=u(t),s=[...n,...a.filter((e=>e.message))];if(!C.signal.aborted){if(t instanceof Error){const t="string"==typeof s[0].message&&1===s.length?s[0].message:p("Unknown error");S((n=>({...n??{},[e]:t})))}else S((t=>({...t??{},[e]:p("Unknown error")})));w(h.errorText)}}finally{C.signal.aborted||_(++t)}}))))),C.signal.aborted||f(!1),i?.(s)}()}),[C,o,n,a,i,h.errorText,p,u]);const B=is(n),N=Gt(s);return(0,z.jsxs)(Zt.a,{titleIconVariant:d?"warning":void 0,title:t,ouiaId:t,"aria-label":t,description:m,variant:Zt.d.medium,isOpen:!0,onClose:()=>{D(),E()},actions:b?[(0,z.jsx)(g.$n,{variant:"link",onClick:D,children:h.cancelText},"cancel")]:[(0,z.jsx)(g.$n,{variant:"secondary",onClick:E,children:h.closeText},"close")],hasNoBodyWrapper:!0,children:[(0,z.jsx)(Xt.H,{style:{paddingBottom:0,paddingLeft:0,paddingRight:0},children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",maxHeight:560,overflow:"hidden",borderTop:"thin solid var(--pf-v5-global--BorderColor--100)"},children:(0,z.jsx)($s,{pageItems:[...B.paged],itemCount:n.length,tableColumns:[...N,{header:p("Status"),cell:e=>{const t=a(e),n=k?.[t];return void 0===n?(0,z.jsxs)("span",{style:{color:F},children:[(0,z.jsx)(tn.tU,{}),"  ",h.pendingText]}):null===n?(0,z.jsxs)("span",{style:{color:P},children:[(0,z.jsx)(nn.C1,{}),"  ",h.successText]}):(0,z.jsxs)("span",{style:{color:R},children:[(0,z.jsx)(an.$Q,{}),"  ",k?.[t]]})}}],keyFn:a,compact:!0,errorStateTitle:"",emptyStateTitle:p("No items"),autoHidePagination:!0,disableBodyPadding:!0,...B},"status")})}),(0,z.jsx)(Xt.H,{style:{paddingTop:0},children:(0,z.jsx)(Qt.k,{"data-cy":"progress",value:j/n.length*100,title:C.signal.aborted?h.canceledText:v?h.errorText:b?c??h.processingText:h.successText,size:Qt.j.lg,variant:v||y?en.Zl.danger:j===n.length?en.Zl.success:void 0})})]})}function Us(e=on){const[t,n]=ss(),[a,s]=(0,l.useState)();return(0,l.useEffect)((()=>{if(a){const t=(e,t,n,o)=>{s(void 0),a.onClose?.(e,t,n,o)};n((0,z.jsx)(qs,{...a,errorAdapter:a.errorAdapter??e,onClose:t}))}else n(void 0)}),[a,n,e]),s}var Ws=n(99851);function Js(e,t){return void 0===e&&void 0===t?0:null==e?1:null==t||e<t?-1:e>t?1:0}const Vs=A.Ay.div.withConfig({componentId:"ans__sc-1mz1nzi-0"})(["display:flex;flex-direction:column;max-height:560px;overflow:hidden;border-top:thin solid var(--pf-v5-global--BorderColor--100);"]),Gs=A.Ay.div.withConfig({componentId:"ans__sc-1mz1nzi-1"})(["margin-left:32px;height:64px;display:flex;align-items:center;"]);function Ys(e){const{title:t,items:n,keyFn:a,prompt:s,alertPrompts:o,confirmationColumns:i,isItemNonActionable:r,onConfirm:c,onClose:d,confirmText:u,actionButtonText:m,isDanger:p}=e,[h,b]=ss(),[f]=W(),j=(0,l.useCallback)((()=>{b(void 0),d?.()}),[d,b]),_=is((0,l.useMemo)((()=>r&&n.some(r)?n.sort(((e,t)=>Js(r(e),r(t)))):n),[n,r])),[v,w]=(0,l.useState)(!u),k=(0,l.useMemo)((()=>r&&n.some(r)?[{header:"",cell:e=>r(e)?(0,z.jsx)(x.m,{content:r(e),trigger:r(e)?void 0:"manual",children:(0,z.jsx)(y.I,{status:"warning",children:(0,z.jsx)(Ws.Pi,{})})}):null},...i]:i),[i,r,n]),S=(0,l.useMemo)((()=>r?n.filter((e=>!r(e))):n),[r,n]),C=Gt(k);return(0,z.jsx)(Zt.a,{titleIconVariant:p?"warning":void 0,title:t,"aria-label":t,ouiaId:t,description:s,variant:Zt.d.medium,isOpen:!0,onClose:j,actions:[(0,z.jsx)(g.$n,{id:"submit",ouiaId:"submit",variant:p?"danger":"primary",onClick:()=>{j(),c()},isAriaDisabled:!v,children:m},"submit"),(0,z.jsx)(g.$n,{id:"cancel",variant:"link",onClick:d,children:f.cancelText},"cancel")],hasNoBodyWrapper:!0,children:n.length>0&&(0,z.jsxs)(Xt.H,{style:{paddingLeft:0,paddingRight:0},children:[(0,z.jsxs)(Vs,{children:[o&&o.length>0&&o.map(((e,t)=>(0,z.jsx)(le.F,{"data-cy":"alert-toaster",isInline:!0,title:e,variant:"warning"},t))),(0,z.jsx)($s,{pageItems:_.paged,itemCount:n.length,tableColumns:C,keyFn:a,compact:!0,errorStateTitle:"Error",emptyStateTitle:"No items",autoHidePagination:!0,disableBodyPadding:!0,..._},"items")]}),u&&S.length>0&&(0,z.jsx)(Gs,{children:(0,z.jsx)(hs.S,{id:"confirm",ouiaId:"confirm",label:u,isChecked:v,onChange:(e,t)=>w(t)})})]})})}function Ks(e=on){const t=function(){const[e,t]=ss(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{if(n){const e=()=>{a(void 0),n.onClose?.()};t((0,z.jsx)(Ys,{...n,onClose:e}))}else t(void 0)}),[n,t]),a}(),n=Us();return(0,l.useCallback)((a=>{const s={...a,errorAdapter:e};return a.isItemNonActionable&&void 0!==a.isItemNonActionable&&(s.items=a.items.filter((e=>void 0!==a.isItemNonActionable&&!a.isItemNonActionable(e)))),t({...a,onConfirm:()=>n(s)})}),[n,t,e])}function Zs(e){const{view:t,tableColumns:n,toolbarFilters:a,maxSelections:s,labelForSelectedItems:o,isCompact:i}=e,[r]=W();return void 0===t.itemCount&&void 0===t.error?(0,z.jsx)(kn.E,{height:"80px"}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(ee.B,{hasGutter:!0,children:[(0,z.jsx)(xe.o,{style:{fontWeight:"bold",whiteSpace:"nowrap"},children:o??r.selectedText}),t.selectedItems.length>0?(0,z.jsx)(De.o,{children:t.selectedItems.map(((e,a)=>n&&n.length>0?(0,z.jsx)(Ee.J,{onClose:()=>t.unselectItem(e),children:(0,z.jsx)(Vt,{item:e,column:n.find((e=>"name"===e.card||"name"===e.list))??n[0]})},a):(0,z.jsx)(z.Fragment,{})))}):(0,z.jsx)(xe.o,{style:{fontStyle:"italic"},children:r.noneSelectedText})]}),(0,z.jsx)($s,{tableColumns:n,toolbarFilters:a,...t,emptyStateTitle:e.emptyStateTitle??r.noItemsFound,errorStateTitle:e.errorStateTitle??r.errorText,showSelect:!0,disableCardView:!0,disableListView:!0,compact:i,disableBodyPadding:!0,maxSelections:s})]})}function Xs(e){const{title:t,description:n,view:a,tableColumns:s,toolbarFilters:o,emptyStateTitle:i,errorStateTitle:r,confirmText:c,cancelText:d,onSelect:u,maxSelections:m,allowZeroSelections:p}=e,[h,b]=ss();let f=(0,l.useCallback)((()=>b(void 0)),[b]);e.onClose&&(f=e.onClose);const[y]=W(),x=Gt(s);return(0,z.jsx)(Zt.a,{title:t,"aria-label":t,ouiaId:t,description:n,isOpen:!0,onClose:f,variant:Zt.d.medium,tabIndex:0,actions:[(0,z.jsx)(g.$n,{variant:"primary",id:"submit",onClick:()=>{f(),u(a.selectedItems)},isAriaDisabled:0===a.selectedItems.length&&!p,children:c??y.confirmText},"submit"),(0,z.jsx)(g.$n,{id:"cancel",variant:"link",onClick:f,children:d??y.cancelText},"cancel")],hasNoBodyWrapper:!0,children:(0,z.jsx)(Xt.H,{style:{overflow:"hidden"},children:(0,z.jsx)(Zs,{view:a,tableColumns:x,toolbarFilters:o,emptyStateTitle:i,errorStateTitle:r,maxSelections:m,isCompact:!0})})})}function Qs(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)();return(0,z.jsxs)(rn.p,{isFullHeight:!0,children:[(0,z.jsx)(ln.o,{titleText:(0,z.jsx)(z.Fragment,{children:e("Page not found")}),icon:(0,z.jsx)(cn.q,{icon:an.$Q}),headingLevel:"h2"}),(0,z.jsx)(dn.h,{children:e("We could not find that page.")}),(0,z.jsx)(un.s,{children:(0,z.jsx)(mn.c,{children:(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[(0,z.jsx)(g.$n,{onClick:()=>t(-1),children:e("Return to previous page")}),(0,z.jsx)(g.$n,{component:e=>(0,z.jsx)(a.N_,{to:"/",...e}),children:e("Return to dashboard")})]})})})]})}const eo=({error:e})=>"string"==typeof e?null:Array.isArray(e)&&e.length>1?(0,z.jsx)("ul",{children:e.map(((e,t)=>(0,z.jsx)("li",{children:e},t)))}):l.isValidElement(e)?(0,z.jsx)(z.Fragment,{children:e}):null;function to({error:e,isMd:t,onCancel:n}){const{t:a}=(0,I.Bd)();if(!e)return null;const s=Array.isArray(e)&&e.length>1,o=t&&n?{paddingLeft:"24px"}:void 0,i="string"==typeof e?e:Array.isArray(e)&&e.length>0?e.length>1?a("Errors"):String(e[0]):a("Error");return(0,z.jsx)(le.F,{variant:"danger",title:i,isInline:!0,style:o,isExpandable:s,children:(0,z.jsx)(eo,{error:e})})}var no=n(35600),ao=n(73133),so=n(30620),oo=n(49785);function io(e){const{isSubmitting:t,errors:n}=(0,oo.lN)(),{clearErrors:a}=(0,oo.mN)(),s=n&&Object.keys(n).length>0;return(0,z.jsx)(g.$n,{onClick:()=>{s&&a()},"data-cy":"Submit",type:"submit",isDisabled:t,isLoading:t,isDanger:s,variant:s?"secondary":void 0,style:e.style,children:e.children})}function ro(e){return(0,z.jsx)(g.$n,{"data-cy":"Cancel",type:"button",variant:"link",onClick:e.onCancel,children:e.children})}const lo=(0,A.Ay)(Oe.d8).withConfig({componentId:"ans__sc-1ab9c11-0"})(["margin-block-end:var(--pf-v5-global--spacer--xl);"]),co=(0,A.Ay)(no.K).withConfig({componentId:"ans__sc-1ab9c11-1"})(["&&{margin-block-start:unset;}"]);function uo(e){const{errorAdapter:t=on,isWizard:n=!1}=e,{form:a,handleSubmit:s,error:o,setError:i,handleSubmitError:r,setFieldError:c}=function(e,t,n=!1){const a=(0,oo.mN)({defaultValues:e??{}}),{handleSubmit:s,setError:o}=a,[i,r]=(0,l.useState)(null);return{form:a,handleSubmit:s,error:i,setError:r,handleSubmitError:e=>{const{genericErrors:a,fieldErrors:s}=t(e);if(a.length>0){const e=a.map((e=>e.message));r(e),n&&o("root",{message:e.join(" ")})}else r(null);s.length>0&&s.forEach((e=>{o(e.name,{message:"string"==typeof e.message?e.message:void 0})}))},setFieldError:o}}(e.defaultValue,t,n),[d]=(0,l.useContext)(ve),[u]=W(),m=f("md"),p=!e.isVertical&&"horizontal"===d.formLayout,h=!e.singleColumn&&"multiple"===d.formColumns;let b=e.children;return!0!==e.disableGrid&&(b=(0,z.jsx)(mo,{isVertical:e.isVertical,singleColumn:e.singleColumn,children:e.children})),(0,z.jsx)(oo.Op,{...a,children:(0,z.jsxs)(ao.l,{onKeyDown:t=>{"Enter"===t.key&&e.disableSubmitOnEnter&&t.preventDefault()},onSubmit:s((async t=>{i(null);try{await e.onSubmit(t,(e=>i(e)),c)}catch(e){r(e)}})),isHorizontal:p,autoComplete:e.autoComplete,style:{display:"flex",flexDirection:"column",flexGrow:1,height:"100%",maxHeight:"100%",overflow:"hidden",gap:0},children:[o&&(0,z.jsx)(to,{error:o,isMd:m,onCancel:e.onCancel}),(0,z.jsx)(ze,{children:(0,z.jsx)(lo,{variant:"light",isFilled:!0,isWidthLimited:!0,padding:{default:e.disablePadding?"noPadding":"padding"},style:{maxWidth:h?void 0:880},children:b})}),e.footer?e.footer:(0,z.jsx)(Oe.d8,{variant:"light",isFilled:!1,className:"bg-lighten border-top",children:(0,z.jsxs)(co,{children:[(0,z.jsx)(io,{children:e.submitText}),e.additionalActions,e.onCancel&&(0,z.jsx)(ro,{onCancel:e.onCancel,children:e.cancelText??u.cancelText})]})})]})})}function mo(e){const[t]=(0,l.useContext)(ve),n=!e.isVertical&&"horizontal"===t.formLayout,a=!e.singleColumn&&"multiple"===t.formColumns,s=a?n?12:6:12,o=a?6:12,i=a?6:12,r=a?4:12;return(0,z.jsx)(so.x,{hasGutter:!0,span:12,sm:12,md:s,lg:o,xl:i,xl2:r,className:e.className,children:e.children})}var po=n(72635);function ho(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}function bo(e,t){return"string"==typeof e&&!0===t?{value:!0,message:(0,po.t)("{{label}} is required.",{label:fo(ho(e.toLocaleLowerCase()))})}:void 0}function fo(e){const t=["Red Hat"];for(const n of t)e=e.replace(ho(n.toLocaleLowerCase()),n);return e}function go(e){const{name:t,readOnly:n,validate:a}=e,{control:i,setValue:r,formState:{isSubmitting:l}}=(0,oo.xW)(),{t:c}=(0,I.Bd)(),d=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:t,control:i,defaultValue:e.defaultValue,shouldUnregister:!0,render:({field:{onChange:a,value:i},fieldState:{error:d}})=>{const u=d?.message;return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(hs.S,{name:t,id:e.id??t.split(".").join("-"),"data-cy":e.id??t.split(".").join("-"),"aria-label":e.label,className:e.className,label:(0,z.jsxs)("div",{style:{display:"flex"},children:[(0,z.jsxs)("div",{children:[e.label,e.labelHelp&&(0,z.jsx)(at,{title:e.labelHelpTitle,help:e.labelHelp})]}),(0,z.jsx)("div",{style:{marginTop:-6,marginBottom:-6},children:(0,z.jsx)(oe,{actions:[{label:c("Reset to default"),type:s.Button,selection:o.None,onClick:()=>{r(t,e.defaultValue)},isHidden:()=>!e.enableReset||i===e.defaultValue}],position:te.nU.right})})]}),isChecked:!!i,onChange:a,readOnly:n||l,isDisabled:e.isDisabled,isRequired:e.isRequired,description:u?(0,z.jsx)("span",{style:{color:E(D.Danger)},children:u}):e.description})})},rules:{required:d,validate:a}})}var yo=n(4068),xo=n(8028),jo=n(13331),_o=n(32017),vo=n.n(_o),wo=n(65363),ko=n.n(wo),So=n(20382),Co=n(88890),To=n(78343);function Io(e){const t=M(e),{language:n,value:a,onChange:s,setError:o,isReadOnly:i}=e,[r,c]=(0,l.useState)(!1),d=(0,l.useRef)(null),u=(0,l.useRef)(null),m=(0,l.useCallback)((e=>{if(!d.current)return;d.current.style.minHeight=`${Eo+Bo}px`;const t=e.split("\n").length;d.current.style.height=`${t*Eo+Bo}px`}),[]),p=(0,l.useRef)({});(0,l.useEffect)((()=>{if(u.current){const t=Co.editor.create(u.current,{lineNumbers:e.lineNumbers?"on":"off",lineDecorationsWidth:e.lineNumbers?void 0:0,theme:"data-editor-dark",padding:{top:Po,bottom:Ro},fontSize:14,fontFamily:"RedHatMono",scrollBeyondLastLine:!1,minimap:{enabled:!1},renderLineHighlightOnlyWhenFocus:!0,scrollbar:{alwaysConsumeMouseWheel:!1}});return p.current.editor=t,()=>t.dispose()}}),[e.lineNumbers]),(0,l.useEffect)((()=>{const e=p?.current?.editor;if(!e)return;const t=e.getModel();if(!t)return;const n=t.onDidChangeContent((()=>{const t=e.getValue()??"";s(t),m(t)}));return()=>n.dispose()}),[s,m]),(0,l.useEffect)((()=>{const e=p?.current?.editor;e&&e.getValue()!==a&&(e.setValue(a),m(a))}),[a,m]),(0,l.useEffect)((()=>{const e=p?.current?.editor;e&&e.updateOptions({readOnly:i})}),[i]);const[h,b]=(0,l.useState)(!1);(0,l.useEffect)((()=>{const e=p?.current?.editor;if(!e)return;const t=e.getModel();if(!t)return;Co.editor.setModelLanguage(t,n);const a=Co.editor.onDidChangeMarkers((()=>{const e=Co.editor.getModelMarkers({owner:t.getLanguageId(),resource:t.uri});b(e.length>0),o(e.length>0?e.map((e=>e.message)).join("\n"):void 0)}));return()=>a.dispose()}),[n,o]),(0,Ne.A)(u,(()=>{const e=p?.current?.editor;e&&(e.layout(),c(!0))}));const f=we();return(0,l.useEffect)((()=>{const e=p?.current?.editor;e&&e.updateOptions({theme:"dark"===f.activeTheme?"data-editor-dark":"data-editor-light"})}),[f.activeTheme]),(0,z.jsx)(Ao,{className:e.className,"aria-invalid":h?"true":void 0,ref:d,children:(0,z.jsx)(Do,{id:t,"data-cy":t,ref:u,className:"data-editor","aria-disabled":r?"false":"true"})})}const Ao=A.Ay.div.withConfig({componentId:"ans__sc-4io6jl-0"})(["position:relative;min-height:33px;"]),Do=A.Ay.div.withConfig({componentId:"ans__sc-4io6jl-1"})(["position:absolute;inset:0;"]),Eo=21,Po=6,Ro=6,Bo=Po+Ro;let Fo,No,$o;window.MonacoEnvironment={getWorker:function(e,t){switch(t){case"editorWorkerService":return Fo||(Fo=new Worker(new URL(n.p+n.u(1821),n.b),{type:void 0})),Fo;case"json":return No||(No=new Worker(new URL(n.p+n.u(4444),n.b),{type:void 0})),No;case"yaml":return $o||($o=new Worker(new URL(n.p+n.u(2063),n.b),{type:void 0})),$o;default:throw new Error(`Unknown label ${t}`)}}},Co.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0}),(0,To.f)(Co,{validate:!0,format:!0,schemas:[{uri:"",fileMatch:[],schema:{type:"object",properties:{},additionalProperties:!0}}]}),Co.editor.defineTheme("data-editor-dark",{base:"vs-dark",inherit:!0,colors:{"editor.background":"#00000000","minimap.background":"#00000000","scrollbarSlider.background":"#FFFFFF22","editor.outline":"#00000000","editor.lineHighlightBorder":"#00000000","editor.lineHighlightBackground":"#00000000","editorLineNumber.foreground":"#FFFFFF88","editorBracketMatch.border":"#00000000","editorBracketMatch.background":"#FFFFFF00"},rules:[{token:"",background:"#222222"}]}),Co.editor.defineTheme("data-editor-light",{base:"vs",inherit:!0,colors:{"editor.background":"#FFFFFF00","minimap.background":"#FFFFFF00","scrollbarSlider.background":"#FFFFFF22","editor.outline":"#00000000","editor.lineHighlightBorder":"#ffffff00","editor.lineHighlightBackground":"#ffffff00","editorLineNumber.foreground":"#00000088","editorBracketMatch.border":"#ffffff00","editorBracketMatch.background":"#00000000"},rules:[]});var Mo=n(25501);function Lo(e){const{t}=(0,I.Bd)(),n=ue(),{onDrop:a}=e,s=(0,l.useCallback)((e=>{if(!e||0===e.length)return;const s=e[0],o=new FileReader;o.onload=()=>{const e=o.result;if("string"==typeof e){const s={variant:"success",title:t("File uploaded"),timeout:!0};n.addAlert(s),a(e)}},o.onerror=()=>{const e={variant:"danger",title:t("Failed to upload file"),children:t("Unable to upload")};n.addAlert(e)},o.readAsText(s)}),[t,n,a]),{getRootProps:o,getInputProps:i}=(0,Mo.VB)({onDrop:s,noClick:!0,accept:e.accept??{"application/json":[".json"],"text/yaml":[".yaml",".yml"]}});return(0,z.jsxs)("div",{id:"code-editor-dropzone",...o({disabled:!0}),style:{width:"100%",height:"100%"},children:[(0,z.jsx)("input",{id:"code-editor-dropzone-input",...i(),ref:e.inputRef}),e.children]})}var Oo=n(90333);function zo(e){return(0,z.jsx)(y.I,{size:e.size??"md",children:(0,z.jsx)(Oo.RM,{"data-cy":"expandable",style:{transform:e.isExpanded?"rotate(0deg)":"left"===e.direction?"rotate(90deg)":"rotate(-90deg)",transition:"transform 0.2s",alignSelf:"center"},onClick:()=>e.setExpanded(!e.isExpanded),"aria-label":e.isExpanded?(0,po.t)("Collapse"):(0,po.t)("Expand")})})}function Ho(e,t,n="txt"){const a=new Blob(t.split("/n"),{type:"text/plain"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=e+"."+n,document.body.appendChild(s),s.click(),document.body.removeChild(s)}var qo=n(56780),Uo=n(61864),Wo=n(59257),Jo=n(9937);function Vo(e){const{children:t,helperText:n,helperTextInvalid:a,isRequired:s,labelHelp:o,labelHelpTitle:i,label:r}=e;return(0,z.jsxs)(qo.g,{id:`${e.fieldId}-form-group`,fieldId:e.fieldId,label:(0,z.jsxs)(z.Fragment,{children:[e.icon,r]}),labelIcon:o?(0,z.jsx)(at,{title:i,help:o}):void 0,labelInfo:e.additionalControls,isRequired:s,"data-cy":`${e.fieldId}-form-group`,children:[t,(n||a)&&(0,z.jsx)(Uo.e,{children:(0,z.jsx)(Wo.E,{children:(0,z.jsx)(Jo.j,{variant:a?"error":void 0,children:a||n})})})]})}function Go(e){const{t}=(0,I.Bd)(),{name:n,format:a,disableCopy:i,disableUpload:r,disableDownload:c,disableExpand:d,validate:u,isArray:m}=e,p=M(e),{formState:{isSubmitting:h,isValidating:b},setError:f,getValues:g,clearErrors:y,control:x}=(0,oo.xW)(),j=we().dataEditorFormat??"yaml",[_,v]=(0,l.useState)(j),[w,k]=(0,l.useState)(!e.defaultCollapsed),[S,C]=(0,l.useState)((()=>{const e=g(n);return"string"==typeof e?e:Xo(e,j)})),T=ue(),{writeToClipboard:A}=ge(),D=(0,l.useCallback)((()=>A(Xo(Zo(g(n),m),_))),[g,m,_,n,A]),E=(0,l.useCallback)((e=>{C(Xo(Zo(e,m),_))}),[m,_]),P=(0,l.useRef)(null),R=(0,l.useCallback)((()=>P.current?.click()),[]),B=(0,l.useCallback)((()=>{const e="json"===_?"json":"yaml";Ho(n||"data",Xo(Zo(g(n),m),_),e),T.addAlert({variant:"success",title:t("File downloaded"),timeout:!0})}),[T,g,m,_,n,t]);(0,l.useLayoutEffect)((()=>{const e=Xo(Zo(g(n),m),_);C(e)}),[g,m,_,n]);const{setValue:F,formState:{defaultValues:N}}=(0,oo.xW)(),$=bo(e.label,e.isRequired),L=ko()(N,e.name);return(0,z.jsx)(oo.xI,{name:n,control:x,shouldUnregister:!0,render:({field:{value:n,name:l,onChange:g},fieldState:{error:x}})=>(0,z.jsxs)(Vo,{fieldId:p,icon:!d&&(0,z.jsx)(zo,{isExpanded:w,setExpanded:k}),label:e.label,labelHelpTitle:e.labelHelpTitle??e.label,labelHelp:e.labelHelp,additionalControls:(0,z.jsx)(Ko,{handleCopy:!i&&D,handleUpload:!r&&R,handleDownload:!c&&B,language:_,setLanguage:v,children:e.additionalControls}),helperText:e.helperText,helperTextInvalid:!(u&&b)&&x?.message?.split("\n"),isRequired:e.isRequired,children:[w&&(0,z.jsxs)("div",{style:{display:"flex"},children:[(0,z.jsx)(Lo,{onDrop:E,isDisabled:h||e.isReadOnly,inputRef:P,children:(0,z.jsx)(Io,{"data-cy":p,id:p,name:l,language:_,value:S,onChange:function(e){try{const t=Zo(e,m);if("object"===a)return void g(t);g(Xo(t,a)),y(l)}catch(e){e instanceof Error&&f(l,{message:e.message})}},setError:e=>{e?f(l,{message:e}):y(l)},isReadOnly:e.isReadOnly||h,className:e.isReadOnly?"pf-v5-c-form-control pf-m-disabled":"pf-v5-c-form-control"})}),(0,z.jsx)(oe,{actions:[{label:t("Undo changes"),type:s.Button,selection:o.None,onClick:()=>{F(e.name,L),C(""),setTimeout((()=>{C(Xo(Zo(L,m),_))}),0)},isHidden:()=>!e.enableUndo||vo()(n,L)},{label:t("Reset to default"),type:s.Button,selection:o.None,onClick:()=>{F(e.name,e.defaultValue),C(""),setTimeout((()=>{C(Xo(Zo(e.defaultValue,m),_))}),0)},isHidden:()=>!e.enableReset||vo()(n,e.defaultValue)}],position:te.nU.right})]}),!w&&(0,z.jsx)("div",{className:"pf-v5-c-form-control"})]}),rules:{required:$,validate:e.validate}})}function Yo(e){const{t}=(0,I.Bd)(),{handleCopy:n,handleDownload:a,handleUpload:s}=e;return n||a||s?(0,z.jsxs)(i.s,{spaceItems:{default:"spaceItemsMd"},children:[n&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(nt,{id:"copy-button","data-cy":"copy-button","aria-label":t("Copy to clipboard"),type:"button",onClick:n,children:(0,z.jsx)(y.I,{size:"md",children:(0,z.jsx)(yo.Td,{})})})}),s&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(nt,{id:"upload-button","data-cy":"upload-button","aria-label":t("Upload from file"),type:"button",onClick:s,children:(0,z.jsx)(y.I,{size:"md",children:(0,z.jsx)(xo.JM,{})})})}),a&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(nt,{id:"download-button","data-cy":"download-button","aria-label":t("Download file"),type:"button",onClick:a,children:(0,z.jsx)(y.I,{size:"md",children:(0,z.jsx)(jo.s3,{})})})})]}):(0,z.jsx)(z.Fragment,{})}function Ko(e){const{t}=(0,I.Bd)(),{handleCopy:n,handleDownload:a,handleUpload:s,language:o,setLanguage:l}=e;return(0,z.jsxs)(i.s,{spaceItems:{default:"spaceItemsLg"},children:[(0,z.jsx)(r.Z,{children:e.children}),(0,z.jsx)(Yo,{handleCopy:n,handleDownload:a,handleUpload:s}),(0,z.jsx)(r.Z,{align:{default:"alignRight"},children:(0,z.jsxs)(Oa.O,{isCompact:!0,children:[(0,z.jsx)(za.d,{id:"toggle-yaml","data-cy":"toggle-yaml","aria-label":t("Toggle to YAML"),isSelected:"yaml"===o,text:"YAML",type:"button",onChange:()=>l("yaml")}),(0,z.jsx)(za.d,{id:"toggle-json","data-cy":"toggle-json","aria-label":t("Toggle to JSON"),isSelected:"json"===o,text:"JSON",type:"button",onChange:()=>l("json")})]})})]})}function Zo(e,t){if(null==e)return t?[]:{};if("string"==typeof e)try{e=JSON.parse(e)}catch{try{e=So.Ay.load(e)}catch(e){return e instanceof Error||e instanceof So.tB?new Error(e.message):{}}}return t?Array.isArray(e)?e:[]:Array.isArray(e)?{}:e}function Xo(e,t){if(null==e)return"";switch(t){case"json":return JSON.stringify(e,null,2);case"yaml":{const t=So.Ay.dump(e).trimEnd();switch(t){case"null":case"{}":case"[]":return"";default:return t}}default:return""}}var Qo=n(5029),ei=n(18960);function ti(e){const{name:t,label:n,labelHelpTitle:a,labelHelp:i,additionalControls:r,placeholderText:c,options:d,footer:u,helperText:m,isDisabled:p,isReadOnly:h,isRequired:b,validate:f,fieldNameToResetOnFieldChange:y}=e,x=M(e),{t:j}=(0,I.Bd)(),{control:_,setValue:v,formState:{isSubmitting:w,isValidating:k,defaultValues:S},resetField:C}=(0,oo.xW)(),[T,A]=(0,l.useState)(!1),D=(0,l.useCallback)((()=>A(!T)),[T]),[E]=W(),P=bo(e.label,e.isRequired),R=ko()(S,e.name);return(0,z.jsx)(oo.xI,{name:t,control:_,defaultValue:e.defaultValue,shouldUnregister:!0,render:({field:{onChange:t,value:l},fieldState:{error:_}})=>{""===l&&1===d.length&&b&&t(d[0].value);const S=_?.message?f&&k?E.validating:_?.message:void 0,I=d.find((e=>e.value===l));return(0,z.jsx)(Vo,{fieldId:x,label:n,labelHelpTitle:a??n,labelHelp:i,additionalControls:r,helperText:m,helperTextInvalid:S,isRequired:b,children:(0,z.jsxs)("div",{style:{display:"flex"},children:[(0,z.jsx)(Qo.l,{id:x,itemID:x,placeholderText:c,variant:"single","aria-describedby":`${x}-form-group`,selections:I?.label,onSelect:(n,a)=>{const s=d.find((e=>e.label===a.toString()))?.value;t(s),y&&C(y),e.onChange&&e.onChange(s),A(!1)},isOpen:T,onToggle:D,onClear:b?void 0:()=>{t(null),A(!1)},maxHeight:280,validated:S?"error":void 0,isDisabled:p||h||w,hasPlaceholderStyle:!0,footer:u,ouiaId:"menu-select","data-cy":x,children:d.map((e=>{const t=L(e);return(0,z.jsx)(ei.O,{id:t,value:e.label,label:e.label,description:e.description,"data-cy":t,children:e.label},e.label)}))}),(0,z.jsx)(oe,{actions:[{label:j("Undo changes"),type:s.Button,selection:o.None,onClick:()=>{v(e.name,R)},isHidden:()=>!e.enableUndo||l===R},{label:j("Reset to default"),type:s.Button,selection:o.None,onClick:()=>{v(e.name,e.defaultValue)},isHidden:()=>!e.enableReset||l===e.defaultValue}],variant:g.Ak.control,position:te.nU.right})]})})},rules:{required:P,validate:f}})}function ni(e){const{name:t,helperText:n,validate:a,additionalControls:s,label:o,labelHelp:i,labelHelpTitle:r,labelOn:l,labelOff:c}=e,{control:d,formState:{isSubmitting:u,isValidating:m}}=(0,oo.xW)(),p=M(e);return(0,z.jsx)(oo.xI,{name:t,control:d,shouldUnregister:!0,render:({field:{onChange:e,value:t},fieldState:{error:d}})=>{const h=a&&m?void 0:d?.message;return(0,z.jsx)(Vo,{fieldId:p,"data-cy":p+"-form-group",label:o,labelHelpTitle:r??o,labelHelp:i,helperText:n,helperTextInvalid:h,additionalControls:s,children:(0,z.jsx)(O.d,{"data-cy":p+"-toggle","aria-label":o,isChecked:t,onChange:t=>e(t),isDisabled:u,label:l,labelOff:c})})}})}var ai=n(65843),si=n(5600),oi=n(73796);function ii(e){const{type:t,name:n,label:a,labelHelpTitle:s,labelHelp:o,additionalControls:i,placeholder:r,button:c,helperText:d,isDisabled:u,isReadOnly:m,isRequired:p,validate:h,minLength:b,maxLength:f,min:y,max:x,pattern:j,selectTitle:_,selectOpen:v,selectValue:w,autoFocus:k,autoComplete:S,disableAutoResize:C}=e,T=M(e),{control:I,setValue:A,formState:{isSubmitting:D,isValidating:E}}=(0,oo.xW)(),[P,R]=(0,l.useState)(!1),[B]=W(),F=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:n,control:I,shouldUnregister:!0,render:({field:{onChange:e,value:n,name:l},fieldState:{error:b}})=>{const f=b?.message?h&&E?B.validating:b?.message:void 0;return(0,z.jsx)(Vo,{fieldId:T,label:a,labelHelpTitle:s??a,labelHelp:o,additionalControls:i,helperText:d,helperTextInvalid:f,isRequired:p,children:(0,z.jsxs)(ga.M,{children:[(0,z.jsx)(ya.b,{isFill:!0,children:(0,z.jsx)(ai.fs,{id:T,placeholder:r,onChange:(t,n)=>function(t){e(t.trimStart())}(n),value:n??"","aria-describedby":T?`${T}-form-group`:void 0,validated:f?"error":void 0,type:"password"===t?P?"text":"password":t,readOnlyVariant:m?"default":void 0,isDisabled:u,autoFocus:k,autoComplete:S||"off","data-cy":T,autoResize:void 0===C||!C})}),"password"===t&&(0,z.jsx)(g.$n,{variant:"control",onClick:()=>R(!P),isDisabled:u||m,children:P?(0,z.jsx)(si.bM,{}):(0,z.jsx)(oi.G3,{})}),_&&(0,z.jsx)(g.$n,{ouiaId:`lookup-${l}-button`,variant:"control",onClick:()=>v?.((e=>{if(w){const t=w(e);A(l,t,{shouldValidate:!0})}}),_),"aria-label":"Options menu",isDisabled:u||D,children:(0,z.jsx)(pn.WI,{})}),c&&c]})})},rules:{required:F,validate:h,minLength:"string"==typeof a&&"number"==typeof b?{value:b,message:`${ho(a.toLocaleLowerCase())} must be at least ${b} characters.`}:b,maxLength:"string"==typeof a&&"number"==typeof f?{value:f,message:`${ho(a.toLocaleLowerCase())} cannot be greater than ${f} characters.`}:f,min:"string"!=typeof a||"number"!=typeof y&&"string"!=typeof y?b:{value:y,message:`${ho(a.toLocaleLowerCase())} must be less than ${y}.`},max:"string"!=typeof a||"number"!=typeof x&&"string"!=typeof x?b:{value:x,message:`${ho(a.toLocaleLowerCase())} cannot be greater than ${x}.`},pattern:j}})}var ri=n(23285);function li(e){const{type:t,name:n,label:a,labelHelpTitle:i,labelHelp:r,additionalControls:c,placeholder:d,button:u,helperText:m,isDisabled:p,isReadOnly:h,isRequired:b,validate:f,minLength:y,maxLength:x,min:j,max:_,pattern:v,selectTitle:w,selectOpen:k,selectValue:S,autoFocus:C,autoComplete:T}=e,A=M(e),{t:D}=(0,I.Bd)(),{control:E,setValue:P,formState:{isSubmitting:R,isValidating:B,defaultValues:F}}=(0,oo.xW)(),[N,$]=(0,l.useState)(!1),[L]=W(),O=bo(e.label,e.isRequired),H=ko()(F,e.name);return(0,z.jsx)(oo.xI,{name:n,control:E,shouldUnregister:!0,defaultValue:e.defaultValue,render:({field:{onChange:n,value:l,name:y},fieldState:{error:x}})=>{const v=x?.message?f&&B?L.validating:x?.message:void 0;let I=l;if("datetime-local"===t&&l){const e=new Date(l);I=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,16)}return(0,z.jsx)(Vo,{fieldId:A,label:a,labelHelpTitle:i??a,labelHelp:r,additionalControls:c,helperText:m,helperTextInvalid:v,isRequired:b,children:(0,z.jsxs)(ga.M,{children:[(0,z.jsx)(ya.b,{isFill:!0,children:(0,z.jsx)(ri.ks,{id:A,placeholder:d,onChange:(t,a)=>function(t){switch(e.type){case"datetime-local":n(new Date(t).toISOString());break;case"number":{let e=Number(t);if(""===t||isNaN(e))return P(y,null),void n(null);void 0!==_&&e>Number(_)&&(e=Number(_)),void 0!==j&&e<Number(j)&&(e=Number(j)),P(y,e),n(e);break}default:n(t.trimStart())}}(a),value:I??"","aria-describedby":A?`${A}-form-group`:void 0,validated:v?"error":void 0,type:"password"===t?N?"text":"password":t,readOnlyVariant:h?"default":void 0,isDisabled:p,autoFocus:C,autoComplete:T||"off","data-cy":A})}),"password"===t&&(0,z.jsx)(g.$n,{variant:"control",onClick:()=>$(!N),isDisabled:p||h,children:N?(0,z.jsx)(si.bM,{}):(0,z.jsx)(oi.G3,{})}),w&&(0,z.jsx)(g.$n,{ouiaId:`lookup-${y}-button`,variant:"control",onClick:()=>k?.((e=>{if(S){const t=S(e);P(y,t,{shouldValidate:!0})}}),w),"aria-label":"Options menu",isDisabled:p||R,children:(0,z.jsx)(pn.WI,{"data-cy":"lookup-button"})}),u,(0,z.jsx)(oe,{actions:[{label:D("Undo changes"),type:s.Button,selection:o.None,onClick:()=>{P(e.name,H)},isHidden:()=>!e.enableUndo||l===H},{label:D("Reset to default"),type:s.Button,selection:o.None,onClick:()=>{P(e.name,e.defaultValue)},isHidden:()=>!e.enableReset||l===e.defaultValue}],variant:g.Ak.control,position:te.nU.right})]})})},rules:{required:O,validate:f,minLength:"string"==typeof a&&"number"==typeof y?{value:y,message:`${ho(a.toLocaleLowerCase())} must be at least ${y} characters.`}:y,maxLength:"string"==typeof a&&"number"==typeof x?{value:x,message:`${ho(a.toLocaleLowerCase())} cannot be greater than ${x} characters.`}:x,min:"string"!=typeof a||"number"!=typeof j&&"string"!=typeof j?y:{value:j,message:`${ho(a.toLocaleLowerCase())} must be greater or equal to ${j}.`},max:"string"!=typeof a||"number"!=typeof _&&"string"!=typeof _?_:{value:_,message:`${ho(a.toLocaleLowerCase())} cannot be greater than ${_}.`},pattern:v}})}const ci=(0,l.createContext)({isOpen:!1,setState:()=>({})});function di(){return(0,l.useContext)(ci)}function ui(e){const t=f("xl"),[n,a]=(0,l.useState)((()=>t)),s=(0,l.useCallback)((e=>{void 0!==e.isOpen&&a(e.isOpen)}),[]);return(0,l.useEffect)((()=>s({isOpen:t})),[t,s]),(0,z.jsx)(ci.Provider,{value:{isOpen:n,setState:s},children:e.children})}const mi=(0,l.createContext)([{},()=>{}]);function pi(e){const[t,n]=(0,l.useState)({}),a=(0,l.useCallback)((e=>{n(hi("",e))}),[]),s=(0,l.useMemo)((()=>[t,a]),[t,a]);return(0,z.jsx)(mi.Provider,{value:s,children:e.children})}function hi(e,t){const n={};return t.forEach((t=>{const a=(e+"/"+t.path).replace("//","/");"id"in t&&"string"==typeof t.id&&(n[t.id]=a),"children"in t&&Object.assign(n,hi(a,t.children))})),n}var bi=n(55401),fi=n(30130),gi=n(41829),yi=n(89483),xi=n(54290),ji=n(16253),_i=n(27215),vi=n(69148),wi=n(35900),ki=n(63640),Si=n(787),Ci=n(87216),Ti=n(39843),Ii=n(89352);const Ai=(0,l.createContext)({notificationsDrawerOpen:!1,setNotificationsDrawerOpen:()=>{throw new Error("PageNotificationsContext not implemented")},notificationGroups:{},setNotificationGroups:()=>{throw new Error("PageNotificationsContext not implemented")}});function Di(){return(0,l.useContext)(Ai)}function Ei(e){const[t,n]=(0,l.useState)(!1),[a,s]=(0,l.useState)({});return(0,z.jsx)(Ai.Provider,{value:{notificationGroups:a,setNotificationGroups:s,notificationsDrawerOpen:t,setNotificationsDrawerOpen:n},children:e.children})}function Pi(e){const{t}=(0,I.Bd)(),{notificationsDrawerOpen:n,setNotificationsDrawerOpen:a}=Di(),s=(0,l.useRef)(null),{notificationGroups:o}=Di();return(0,z.jsx)(bi._s,{isExpanded:n,onExpand:()=>a(!0),children:(0,z.jsx)(fi.z,{panelContent:(0,z.jsx)(gi.X,{children:(0,z.jsxs)(yi.v,{"data-cy":"notifications-drawer",children:[(0,z.jsx)(xi.E,{title:t("Notifications"),children:(0,z.jsx)(ji.s,{onClick:function(){a(!1),s.current?.focus()}})}),(0,z.jsx)(_i.j,{children:(0,z.jsx)(vi.y,{children:Object.values(o).map(((e,t)=>(0,z.jsx)(Bi,{group:e},t)))})})]})}),children:(0,z.jsx)(Ri,{children:e.children})})})}const Ri=(0,A.Ay)(wi.J).withConfig({componentId:"ans__sc-m9he8-0"})(["max-height:100%;"]);function Bi(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)(!0);return(0,z.jsx)(ki.O,{title:e.group.title,isExpanded:n,count:e.group.notifications.length,onExpand:(e,t)=>a(t),children:(0,z.jsxs)(Si.j,{isHidden:!n,children:[e.group.notifications.map(((e,t)=>(0,z.jsx)(Fi,{notification:e},t))),0===e.group.notifications.length&&(0,z.jsxs)(rn.p,{variant:rn.s.full,children:[(0,z.jsx)(ln.o,{headingLevel:"h2",titleText:t("No notifications")}),(0,z.jsx)(dn.h,{children:t("There are currently no notifications.")})]})]})})}function Fi(e){const t="info"===e.notification.variant?void 0:e.notification.variant,n=(0,Re.Zp)(),{setNotificationsDrawerOpen:a}=Di(),s=e.notification.timestamp?new Date(e.notification.timestamp):void 0,o=s?`${s.toLocaleDateString()} ${s.toLocaleTimeString()}`:void 0;return(0,z.jsxs)(Ci.M,{variant:e.notification.variant,onClick:()=>{n(e.notification.to),a(!1)},children:[(0,z.jsx)(Ti.x,{title:e.notification.title,variant:t}),(0,z.jsx)(Ii.e,{timestamp:o,children:e.notification.description})]})}const Ni=(0,l.createContext)({tabBreadcrumb:{},setTabBreadcrumb:()=>{}});function $i(e){const[t,n]=(0,l.useState)();return(0,z.jsx)(Ni.Provider,{value:{tabBreadcrumb:t,setTabBreadcrumb:n},children:e.children})}const Mi=()=>(0,l.useContext)(Ni);function Li(e){return(0,z.jsx)(U,{children:(0,z.jsx)(ke,{defaultRefreshInterval:e.defaultRefreshInterval,children:(0,z.jsx)(pi,{children:(0,z.jsx)(ns,{children:(0,z.jsx)(me,{children:(0,z.jsx)(ui,{children:(0,z.jsx)(Ei,{children:(0,z.jsx)($i,{children:e.children})})})})})})})})}var Oi=n(92697),zi=n(86726);function Hi(e){const t=(0,Re.Zp)();return e.breadcrumbs?(0,z.jsx)(Oi.Q,{style:e.style,children:e.breadcrumbs.map(((e,n)=>e.label?(0,z.jsx)(zi.J,{"data-cy":e.label,id:e.id,component:e.component,isActive:void 0===e.to,children:e.to?(0,z.jsx)("a",{href:e.to,"data-cy":e.label,onClick:n=>{n.preventDefault(),e.to&&t(e.to)},children:e.label}):e.label},n):(0,z.jsx)(l.Fragment,{},n)))}):(0,z.jsx)(l.Fragment,{})}function qi(e){const{title:t,description:n,controls:a,headerActions:s,footer:o}=e,c=f("lg"),d=f("xl"),u=f("md"),[m]=W(),{tabBreadcrumb:p}=Mi(),h=(0,l.useMemo)((()=>{const t=[];return e.breadcrumbs&&(t.push(...e.breadcrumbs),p&&t.push(p)),t}),[e.breadcrumbs,p]);return(0,z.jsx)(Oe.d8,{variant:Oe.zC.light,className:"bg-lighten border-bottom",style:{paddingTop:d?16:12,paddingBottom:d?16:12},children:(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[(0,z.jsxs)(i.s,{flexWrap:{default:"nowrap"},alignItems:{default:"alignItemsStretch"},children:[(0,z.jsxs)(r.Z,{grow:{default:"grow"},children:[h.length>0&&(0,z.jsx)(Hi,{breadcrumbs:h?.length?h:void 0,style:{paddingBottom:c?6:4}}),t?e.titleHelp?(0,z.jsx)(Ze.A,{headerContent:e.titleHelpTitle??e.title,bodyContent:(0,z.jsxs)(Xe.B,{hasGutter:!0,children:["string"==typeof e.titleHelp?(0,z.jsx)(Qe.a,{children:e.titleHelp}):e.titleHelp.map(((e,t)=>(0,z.jsx)(Qe.a,{children:e},t))),e.titleDocLink&&(0,z.jsx)(Qe.a,{children:(0,z.jsx)(g.$n,{icon:(0,z.jsx)(et._,{}),variant:"link",onClick:()=>window.open(e.titleDocLink,"_blank"),isInline:!0,children:m.documentation})})]}),position:"bottom-start",children:(0,z.jsxs)(Ge.h,{"data-cy":"page-title",headingLevel:"h1",children:[t,(0,z.jsx)(g.$n,{variant:"link",style:{padding:0,marginTop:1,marginLeft:8,verticalAlign:"top"},children:(0,z.jsx)(tt.eT,{})})]})}):(0,z.jsx)(Ge.h,{"data-cy":"page-title",headingLevel:"h1",children:t}):(0,z.jsx)(Ge.h,{headingLevel:"h1",children:(0,z.jsx)(kn.E,{width:"160px"})}),u&&n&&(0,z.jsx)("div",{"data-cy":"app-description",style:{paddingTop:d?4:2,opacity:.8},children:n})]}),t&&(s||a)&&(0,z.jsxs)(i.s,{"data-cy":"manage-view",direction:{default:"column"},spaceItems:{default:"spaceItemsSm",xl:"spaceItemsMd"},justifyContent:{default:"justifyContentCenter"},children:[a&&(0,z.jsx)(r.Z,{grow:{default:"grow"},children:a}),s&&(0,z.jsx)(r.Z,{children:s})]})]}),o]})})}function Ui(e){const[t]=W();return(0,z.jsx)(pe,{message:t.errorText,children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"100%"},children:e.children})})}var Wi=n(98345),Ji=n(83156),Vi=n(6112),Gi=n(70772),Yi=n(1953),Ki=n(81505),Zi=n(93309);function Xi(e){const t=f("sm");return(0,z.jsxs)(Wi.Q,{display:{default:"inline"},style:{borderBottom:"1px solid #fff4",paddingRight:0},children:[(0,z.jsx)(Qi,{}),t&&(0,z.jsx)(Ji.j,{children:(0,z.jsx)(Vi.V,{component:e=>(0,z.jsx)(a.N_,{...e,to:"/"}),children:e.brand})}),(0,z.jsx)(Gi.r,{style:{marginLeft:0,minHeight:0},children:(0,z.jsx)(vn.M,{id:"toolbar","data-cy":"toolbar",inset:{default:"insetNone"},style:{padding:0},children:(0,z.jsx)(_n.P,{children:e.children})})})]})}function Qi(){const e=di();return(0,z.jsx)(Yi.u,{onClick:()=>e.setState({isOpen:!e.isOpen}),children:(0,z.jsx)(Ki.Y,{"data-cy":"nav-toggle",variant:"plain","aria-label":"Global navigation",children:(0,z.jsx)(Zi.U4,{})})})}var er=n(34505);function tr(){const{setNotificationsDrawerOpen:e,notificationGroups:t}=Di(),n=Object.values(t).reduce(((e,t)=>e+t.notifications.length),0);return(0,z.jsx)(er.v,{"data-cy":"notification-badge",variant:0===n?"read":"unread",count:n,onClick:()=>e((e=>!e))})}var nr=n(62500),ar=n(57561);function sr(){const[e,t]=(0,l.useContext)(ve);return"dark"===e.activeTheme?(0,z.jsx)(g.$n,{"data-cy":"settings-icon",variant:"plain",onClick:()=>t({...e,theme:"light"}),children:(0,z.jsx)(nr.rR,{})}):(0,z.jsx)(g.$n,{"data-cy":"theme-icon",variant:"plain",onClick:()=>t({...e,theme:"dark"}),children:(0,z.jsx)(ar.gL,{})})}var or=n(91424),ir=n(84837),rr=n(73073),lr=n(69545),cr=n(58797),dr=n(6422),ur=n(59377);function mr(e){const{navigation:t}=e,n=di();return(0,z.jsx)(ir.Ey,{isSidebarOpen:n.isOpen,className:"bg-lighten",children:(0,z.jsx)(rr.m,{children:(0,z.jsx)(lr.so,{"data-cy":"page-navigation",className:"side-nav",children:(0,z.jsx)(cr.c,{children:(0,z.jsx)(pr,{baseRoute:e.basename??"",items:t})})})})})}function pr(e){return(0,z.jsx)(z.Fragment,{children:e.items.filter((e=>!("hidden"in e)||!0!==e.hidden)).map(((t,n)=>(0,z.jsx)(hr,{item:t,baseRoute:e.baseRoute},t.id??t.label??n)))})}function hr(e){const{item:t}=e,[n,a]=(0,l.useState)((()=>"true"===localStorage.getItem("default-nav-expanded")||"true"===localStorage.getItem((t.id??t.label)+"-expanded")));let s;if("id"in e.item)s=e.item.id;else if("children"in e.item){const t=e.item.children.find((e=>""===e.path));t&&"id"in t&&(s=t.id)}const o=function(){const e=(0,Re.Zp)(),t=f("xl"),n=di();return(0,l.useCallback)((a=>{e(a),t||n.setState({isOpen:!n.isOpen})}),[e,t,n])}();let c=e.baseRoute+"/"+t.path;if(c=c.replace("//","/"),"/"===t.path&&"children"in t)return(0,z.jsx)(pr,{items:t.children,baseRoute:""});const d="children"in t&&t.children?.find((e=>e.label)),u={fontSize:"small",opacity:.5,textAlign:"left"};if(!d&&"label"in t){let e="/"+c;e=e.replace("//","/");const n=!t.href&&location.pathname.startsWith(e);return(0,z.jsxs)(dr.j,{id:s,href:t.href||c,isActive:n,className:n?"bg-lighten":void 0,onClick:()=>t.href?window.open(t.href,"_blank"):o(c),target:t.href?"_blank":"","data-cy":s,style:{display:"flex",alignItems:"stretch",flexDirection:"column"},children:[(0,z.jsxs)(i.s,{children:[(0,z.jsx)(r.Z,{grow:{default:"grow"},children:t.label}),"badge"in t&&t.badge&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(Ee.J,{isCompact:!0,variant:"outline",color:t.badgeColor,children:t.badge})}),"href"in t&&t.href&&(0,z.jsx)("span",{className:"pf-v5-c-nav__toggle",children:(0,z.jsx)("span",{className:"pf-v5-c-nav__toggle-icon",children:(0,z.jsx)(et._,{})})})]}),t.subtitle&&(0,z.jsx)("div",{style:u,children:t.subtitle})]})}return d&&void 0!==t.label?t.label?(0,z.jsx)(ur.M,{title:(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:{textAlign:"left"},children:t.label}),t.subtitle&&(0,z.jsx)("div",{style:u,children:t.subtitle})]}),isExpanded:n,onExpand:(e,n)=>(e=>{a(e),localStorage.setItem((t.id??t.label)+"-expanded",e?"true":"false")})(n),children:(0,z.jsx)(pr,{items:t.children,baseRoute:c})}):(0,z.jsx)(pr,{items:t.children,baseRoute:c}):null}function br(e){const{navigation:t,masthead:n}=e,a=(0,l.useMemo)((()=>[{path:e.basename??"/",element:(0,z.jsx)(or.Y,{header:n,sidebar:(0,z.jsx)(mr,{navigation:t,basename:e.basename}),children:(0,z.jsx)(Pi,{children:(0,z.jsxs)("div",{style:{maxHeight:"100%",overflow:"hidden",height:"100%",display:"flex",flexDirection:"column"},children:[e.banner,(0,z.jsx)("div",{style:{flexGrow:1,overflow:"hidden"},children:(0,z.jsx)(Re.sv,{})})]})})}),children:t.filter((({href:e})=>!e))},{path:"*",element:(0,z.jsx)(Qs,{})}]),[n,t,e.banner,e.basename]),[s,o]=(0,l.useContext)(mi);return(0,l.useEffect)((()=>o(a)),[a,o]),(0,z.jsx)(Re.BV,{children:a.map(fr)})}function fr(e){return(0,z.jsx)(Re.qh,{path:e.path,element:e.element,children:e.children?.map(fr)},e.path)}function gr(){const e=(0,l.useContext)(mi)[0];return(0,l.useCallback)(((t,n)=>{let a=e[t]??"";const s=n?.params,o=n?.query;return a?(s&&(a=Object.keys(s).reduce(((e,t)=>{let n=s[t];if(void 0===n)return e;n=encodeURIComponent(n.toString());const a=":"+t,o=new RegExp(a+"(?!.*"+a+")","g");return e.replace(o,n)}),a)),o&&(a=`${a}?${Object.keys(o).map((e=>{let t=o[e];return void 0===t?"":(t=encodeURIComponent(t.toString()),`${e}=${t}`)})).join("&").replace("/&&/g","&")}`)):console.error(`Page id ${t} not found`),a}),[e])}function yr(){const e=(0,Re.Zp)(),t=gr();return(0,l.useCallback)(((n,a)=>{const s=t(n,a);s&&e(s)}),[e,t])}function xr(){const e=function(){const[e,t]=(0,l.useState)(!0);return(0,l.useEffect)((()=>()=>{t(!1)}),[]),e}(),[t,n]=(0,l.useState)(e?window.location:void 0),a=(0,l.useCallback)((()=>{n(window.location)}),[]);(0,l.useEffect)((()=>{if(e)return t||a(),window.addEventListener("popstate",a),()=>{window.removeEventListener("popstate",a)}}),[e,t,a]);const s=(0,l.useCallback)((e=>{window.history.replaceState(null,"",e),a()}),[a]),o=(0,l.useCallback)((e=>{window.history.replaceState(null,"",e),a()}),[a]);return{location:t,push:s,update:o}}function jr(){const e=xr(),t=e.location?.pathname||"/",n=(0,l.useMemo)((()=>{let t=e.location?.search;return t&&t.includes("?specPath=")?t=t.substring(0,t.indexOf("?specPath=")):t&&t.includes("&specPath=")&&(t=t.substring(0,t.indexOf("&specPath="))),new URLSearchParams(t??"/")}),[e.location?.search]),a=(0,l.useCallback)((n=>{const a=n.toString();a?e.update("?"+a):e.update(t)}),[e,t]);return[n,a]}const _r=(0,l.createContext)({});function vr(){return(0,l.useContext)(_r)}function wr(e){return void 0!==e?.substeps}function kr(e){const{steps:t,onSubmit:n}=e,[a,s]=(0,l.useState)(!1),[o,i]=(0,l.useState)(null),[r,c]=(0,l.useState)({}),[d,u]=(0,l.useState)(e.defaultValue??{}),[m,p]=(0,l.useState)({}),[h,b]=(0,l.useState)(),[f,g]=jr(),y=(0,l.useMemo)((()=>function(e){return e.reduce(((e,t)=>(e.push(t),wr(t)&&e.push(...t.substeps),e)),[])}(t)),[t]);(0,l.useEffect)((()=>{const e=Sr(t,r);!o&&e.length&&(e[0].substeps?i(e[0].substeps[0]):i(e[0]))}),[o,t,r]);const x=(0,l.useCallback)((async(e={})=>{const a=Cr(t,{...r,...e});if(null===o)return Promise.resolve();if(!wr(o)&&o.validate&&await o.validate(e,r),o?.id===a[a.length-1]?.id){try{await n(r)}catch(e){b(e instanceof Error?e:new Error((0,po.t)("An error occurred.")))}return}const s=a.findIndex((e=>e.id===o?.id)),l=wr(a[s+1])?a[s+2]:a[s+1];return g(new URLSearchParams("")),c((t=>({...t,...e}))),u((t=>({...t,[o?.id]:e}))),i(l),Promise.resolve()}),[o,t,n,g,r,b]),j=(0,l.useCallback)((()=>{const e=Sr(y,r),t=e.findIndex((e=>e.id===o?.id)),n=wr(e[t-1])?e[t-2]:e[t-1];g(new URLSearchParams("")),i(n)}),[o?.id,y,g,r]);return(0,z.jsx)(_r.Provider,{value:{wizardData:r,setWizardData:c,stepData:d,setStepData:u,steps:e.steps,visibleSteps:Sr(t,r),visibleStepsFlattened:Cr(t,r),activeStep:o,setActiveStep:i,stepError:m,setStepError:p,submitError:h,setSubmitError:b,isToggleExpanded:a,setToggleExpanded:s,onNext:x,onBack:j},children:e.children})}function Sr(e,t){return e.filter((e=>function(e,t){return e.hidden&&e.hidden(t)?null:e}(e,t)))}function Cr(e,t){return Sr(e,t).reduce(((e,t)=>(e.push(t),wr(t)&&e.push(...t.substeps),e)),[])}function Tr(e){const{t}=(0,I.Bd)(),{activeStep:n,visibleStepsFlattened:a,setSubmitError:s}=vr(),o=t(n?.id===a[a.length-1].id?"Finish":"Next"),i=wr(a[0])?n?.id===a[1].id:n?.id===a[0].id,r=i?"pf-v5-c-button pf-m-disabled":"pf-v5-c-button pf-m-secondary";return(0,z.jsxs)("footer",{className:"pf-v5-c-wizard__footer border-top bg-lighten","data-cy":"wizard-footer",children:[null!==n&&"inputs"in n?(0,z.jsx)(io,{style:{minWidth:10},children:o}):(0,z.jsx)("button",{"data-cy":"wizard-next",className:"pf-v5-c-button pf-m-primary",type:"submit",onClick:()=>{s(void 0),e.onNext?.()},children:o}),(0,z.jsx)("button",{type:"button","data-cy":"wizard-back",className:r,disabled:i,onClick:()=>{s(void 0),e.onBack?.()},children:t("Back")}),(0,z.jsx)("div",{"data-cy":"wizard-cancel",className:"pf-v5-c-wizard__footer-cancel",children:(0,z.jsx)("button",{className:"pf-v5-c-button pf-m-link",type:"button",onClick:e.onCancel,children:t("Cancel")})})]})}function Ir({onCancel:e,disableGrid:t,errorAdapter:n,isVertical:a,singleColumn:s}){const o=(0,Re.Zp)(),{activeStep:i,stepData:r,onNext:c,onBack:d,submitError:u}=vr(),m=(0,l.useCallback)((()=>{e?e():o(-1)}),[o,e]);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(Dr,{error:u}),null!==i&&("inputs"in i?(0,z.jsxs)(uo,{onSubmit:c,footer:(0,z.jsx)(Tr,{onBack:d,onCancel:m}),defaultValue:r[i.id],errorAdapter:n,disableGrid:t,isVertical:a,singleColumn:s,isWizard:!0,children:[(0,z.jsx)(Ar,{}),i.inputs]},i.id):(0,z.jsxs)("div",{"data-cy":`wizard-section-${i.id}`,style:{display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden"},children:[(0,z.jsx)(Oe.d8,{"aria-label":(0,po.t)("Wizard step content"),hasOverflowScroll:!0,isFilled:!0,variant:"light",children:i?.element}),(0,z.jsx)(Tr,{onNext:()=>{c({})},onBack:d,onCancel:m})]}))]})}function Ar(){const{activeStep:e,setStepError:t}=vr(),{errors:n}=(0,oo.lN)(),a=JSON.stringify(n);return(0,l.useEffect)((()=>{0===Object.keys(n).length?t({}):e&&t({[e.id]:n})}),[n,e,t,a]),null}function Dr(e){const{t}=(0,I.Bd)(),n=e.error;return e.error?e.error instanceof Error?"message"in e.error&&!n.json?(0,z.jsx)(le.F,{variant:"danger",title:e.error.message}):n.json?(0,z.jsx)(le.F,{variant:"danger",title:n.message,isInline:!0,children:Object.values(n.json).map(((e,t)=>(0,z.jsx)("div",{children:e},t)))}):void 0:"string"==typeof e.error?(0,z.jsx)(le.F,{variant:"danger",title:e.error}):(0,z.jsx)(le.F,{variant:"danger",title:t("An error occurred.")}):null}var Er=n(41185),Pr=n(33774);const Rr=A.Ay.div.withConfig({componentId:"ans__sc-1pinhpb-0"})(["background-color:var(--pf-v5-global--BackgroundColor--light-100);color:var(--pf-v5-global--Color--dark-100);.pf-v5-c-wizard__close button{color:var(--pf-v5-global--Color--dark-200);&:hover{color:var(--pf-v5-global--Color--dark-100);}}"]);function Br(e){const{t}=(0,I.Bd)();return(0,z.jsxs)(Rr,{className:(0,Pr.A)([Er.A.wizardHeader,"border-bottom"]),children:[(0,z.jsx)("div",{className:(0,Pr.A)(Er.A.wizardTitle),children:(0,z.jsx)("h2",{"data-cy":"wizard-title",className:(0,Pr.A)(Er.A.wizardTitleText),children:e.title})}),e.onClose&&(0,z.jsx)("div",{className:(0,Pr.A)(Er.A.wizardClose),children:(0,z.jsx)(g.$n,{"data-cy":"wizard-close",variant:"plain","aria-label":t("Close wizard"),onClick:e.onClose,children:(0,z.jsx)(Kn.AX,{"aria-hidden":"true"})})})]})}function Fr(){const{activeStep:e,isToggleExpanded:t,stepError:n,visibleSteps:a,visibleStepsFlattened:s}=vr(),o=t?"pf-v5-c-wizard__nav pf-m-expanded":"pf-v5-c-wizard__nav bg-lighten",i=$r();if(e)return(0,z.jsx)("nav",{className:o,"aria-label":"Steps","data-cy":"wizard-nav",children:(0,z.jsx)("ol",{className:"pf-v5-c-wizard__nav-list",children:a.map((t=>{const a=s.findIndex((e=>t.id===e.id)),o=s.findIndex((t=>t.id===e.id)),r=a>o,l="pf-v5-c-wizard__nav-link"+(e.id===t.id||wr(t)&&t.substeps?.some((t=>t.id===e.id))?" pf-m-current":"")+(r?" pf-m-disabled":"");return(0,z.jsxs)("li",{className:"pf-v5-c-wizard__nav-item","data-cy":`wizard-nav-item-${t.id}`,children:[(0,z.jsxs)("button",{className:l,onClick:()=>i(a),disabled:r,children:[" ",t.label,n[t.id]&&e.id===t.id&&(0,z.jsx)("span",{style:{marginLeft:"8px"},children:(0,z.jsx)(an.$Q,{color:"#C9190B"})})]}),wr(t)?(0,z.jsx)(Nr,{step:t,activeStepIndex:o}):null]},a)}))})})}function Nr(e){const{activeStep:t,stepError:n,visibleStepsFlattened:a}=vr(),{step:s,activeStepIndex:o}=e,i=$r();if(t)return(0,z.jsx)("ol",{className:"pf-v5-c-wizard__nav-list",children:s.substeps.map((e=>{const s=a.findIndex((t=>e.id===t.id)),r=s>o,l="pf-v5-c-wizard__nav-link"+(t.id===e.id?" pf-m-current":"")+(r?" pf-m-disabled":"");return(0,z.jsx)("li",{className:"pf-v5-c-wizard__nav-item","data-cy":`wizard-nav-item-${e.id}`,children:(0,z.jsxs)("button",{className:l,onClick:()=>i(s),disabled:r,children:[" ",e.label,n[e.id]&&t.id===e.id&&(0,z.jsx)("span",{style:{marginLeft:"8px"},children:(0,z.jsx)(an.$Q,{color:"#C9190B"})})]})},e.id)}))})}function $r(){const{setActiveStep:e,visibleStepsFlattened:t}=vr();return(0,l.useCallback)((n=>{const a=t[n];a&&(wr(a)?e(a.substeps[0]):e(a))}),[e,t])}function Mr(){const{t:e}=(0,I.Bd)(),{activeStep:t,isToggleExpanded:n,setToggleExpanded:a}=vr(),s=(0,l.useCallback)((()=>a((e=>!e))),[a]);return(0,z.jsxs)("button",{onClick:s,className:(0,Pr.A)(Er.A.wizardToggle,n&&"pf-m-expanded"),"aria-label":e("Wizard toggle"),"aria-expanded":n,"data-cy":"wizard-toggle",children:[(0,z.jsx)("span",{className:(0,Pr.A)(Er.A.wizardToggleList),children:(0,z.jsxs)("span",{className:(0,Pr.A)(Er.A.wizardToggleListItem),children:[(0,z.jsx)("span",{className:(0,Pr.A)(Er.A.wizardToggleNum),children:1})," ",t?.label]})}),(0,z.jsx)("span",{className:(0,Pr.A)(Er.A.wizardToggleIcon),children:(0,z.jsx)(S.bD,{"aria-hidden":"true"})})]})}function Lr(e){return(0,z.jsx)(kr,{steps:e.steps,defaultValue:e.defaultValue,onSubmit:e.onSubmit,children:(0,z.jsxs)("div",{className:"pf-v5-c-wizard","data-cy":"wizard",style:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"100%",overflow:"hidden"},children:[e.title&&(0,z.jsx)(Br,{title:e.title,onClose:e.onCancel}),(0,z.jsx)(Mr,{}),(0,z.jsxs)("div",{className:"pf-v5-c-wizard__outer-wrap",style:{display:"flex",flexDirection:"column",overflow:"hidden",minHeight:0},children:[(0,z.jsx)(Fr,{}),(0,z.jsx)(Ir,{errorAdapter:e.errorAdapter,onCancel:e.onCancel,disableGrid:e.disableGrid,isVertical:e.isVertical,singleColumn:e.singleColumn})]})]})})}function Or(){return(0,z.jsx)(Oe.d8,{isFilled:!0,variant:"light",children:(0,z.jsx)(Un.a,{children:(0,z.jsx)(Wn.y,{})})})}function zr(e){return(0,z.jsxs)(l.Fragment,{children:[(0,z.jsx)(qi,{breadcrumbs:e.breadcrumbs?[{label:(0,z.jsx)(kn.E,{width:"150px"}),isLoading:!0}]:void 0,title:(0,z.jsx)(kn.E,{width:"200px"})}),e.tabs&&(0,z.jsx)(Oe.d8,{variant:"light",style:{paddingTop:8,paddingBottom:8},children:(0,z.jsx)(kn.E,{width:"150px"})}),(0,z.jsx)(k.c,{}),(0,z.jsx)(Or,{})]})}const Hr=(0,A.i7)(["from{transform:rotate(0);}to{transform:rotate(1turn);}"]),qr=(0,A.Ay)($n.Ci).withConfig({componentId:"ans__sc-1fl89hn-0"})(["animation:"," 1.75s linear infinite;"],Hr);function Ur(e){const{defaultValues:t,disableQueryString:n,ignoreQueryStringKeys:a,filterQueryStringKeys:s}=e,o=function(){const e=(0,l.useRef)({isMounted:!0});return(0,l.useEffect)((()=>()=>{e.current.isMounted=!1}),[]),e}(),[i,r]=jr(),[c,d]=(0,l.useState)((()=>{if(!n){const e=i.get("page");if(e){const t=Number(e);if(Number.isInteger(t))return t}}return 1})),[u,m]=(0,l.useState)((()=>{if(!n){const e=i.get("perPage");if(e){const t=Number(e);if(Number.isInteger(t))return t}}const e=localStorage.getItem("perPage");if(e){const t=Number(e);if(Number.isInteger(t))return t}return 10})),[p,h]=(0,l.useState)((()=>{if(!n){const e=i.get("sort");if(e)return e.startsWith("-")?e.slice(1):e}return t?.sort??""})),[b,f]=(0,l.useState)((()=>{if(!n){const e=i.get("sort");if(e)return e.startsWith("-")?"desc":"asc"}return t?.sortDirection??"asc"})),[g,y]=(0,l.useState)((()=>{const e=t?.filterState??{};for(const t of i.keys()){if(Wr.includes(t))continue;const n=i.get(t);if(n){const a=n.split(",");e[t]=a}}return e})),x=(0,l.useCallback)((()=>y({})),[y]),j=xr();return(0,l.useEffect)((()=>{if(n)return;let e=j.location?.search;e&&e.includes("?specPath=")?e=e.substring(0,e.indexOf("?specPath=")):e&&e.includes("&specPath=")&&(e=e.substring(0,e.indexOf("&specPath=")));const t=new URLSearchParams(e??"/");t.set("page",c.toString()),t.set("perPage",u.toString()),t.set("sort","asc"===b?p:`-${p}`);for(const e of i.keys())Wr.includes(e)||a?.includes(e)||(s?s.includes(e)&&t.delete(e):t.delete(e));for(const e in g)t.set(e,g[e].join(","));r(t)}),[p,b,r,n,c,u,g,a,s,o,i,j.location?.search]),(0,l.useEffect)((()=>{localStorage.setItem("perPage",u.toString())}),[u]),(0,l.useMemo)((()=>({page:c,setPage:d,perPage:u,setPerPage:m,sort:p,setSort:h,sortDirection:b,setSortDirection:f,filterState:g,setFilterState:y,clearAllFilters:x})),[x,g,c,u,p,b])}qr.displayName="RunningIcon";const Wr=["page","perPage","sort"];function Jr(e){const{items:t,keyFn:n,tableColumns:a,toolbarFilters:s,disableQueryString:o}=e,i=Ur({defaultValues:{sort:a&&a.length?a[0].sort:void 0},disableQueryString:o}),{page:r,perPage:c,sort:d,sortDirection:u,filterState:m}=i,p=function(e){const[t,n]=(0,l.useState)(),{direction:a,sortFn:s}=t??{},o=(0,l.useMemo)((()=>e?s?"asc"===a?[...e.sort(s)]:[...e.sort(s).reverse()]:e:[]),[a,e,s]);return(0,l.useMemo)((()=>({sorted:o,sort:t,setSort:n})),[t,o])}(t),{setSort:h}=p;(0,l.useEffect)((()=>h({id:d,sortFn:(e,t)=>function(e,t){if(void 0===e&&void 0===t)return 0;if(void 0===e)return 1;if(void 0===t)return-1;if("string"==typeof e){if("string"==typeof t)return Js(e,t);if("number"==typeof t)return Js(e,t.toString())}else if("number"==typeof e){if("number"==typeof t)return function(e,t){return void 0===e&&void 0===t?0:null==e?1:null==t||e<t?-1:e>t?1:0}(e,t);if("string"==typeof t)return Js(e.toString(),t)}return 0}(ko()(e,d),ko()(t,d)),direction:u})),[d,u,h]);const b=function(e,t){const n=(0,l.useRef)({map:{}}),[a,s]=(0,l.useState)(),o=(0,l.useCallback)((e=>s((()=>e))),[]),[i,r]=(0,l.useState)([]);(0,l.useEffect)((()=>{n.current.map={}}),[a]);const c=(0,l.useCallback)((e=>{const s=t(e);let o=n.current.map[s];return o?o.item!==e&&(o.item=e,o.passes=!a||a(e)):(o={item:e,passes:!a||a(e)},n.current.map[s]=o),o.passes}),[a,t]);return(0,l.useEffect)((()=>{r(a?e.filter(c):e)}),[e,a,c]),(0,l.useMemo)((function(){return{filtered:i,setFilterFn:o}}),[i,o])}(p.sorted,n),{setFilterFn:f}=b;(0,l.useEffect)((()=>{0===Object.keys(m).length?f(void 0):f((e=>{for(const t in m){const n=s?.find((e=>e.key===t));if(n){const a=ko()(e,n.query);if("string"==typeof a){const e=m[t];if(e&&0!==e.length&&!e.includes(a))return!1}}}return!0}))}),[m,f,s]);const g=is(b.filtered),{setPage:y,setPerPage:x}=g;(0,l.useEffect)((()=>y(r)),[r,g,y]),(0,l.useEffect)((()=>x(c)),[c,g,x]);const j=function(e,t){const[n,a]=(0,l.useState)({});(0,l.useEffect)((()=>{a((n=>{let a=!1;const s=e?e.reduce(((e,s)=>{const o=t(s);return e[o]=s,n[o]&&n[o]!==s&&(a=!0,n[o]=s),e}),{}):{},o={};for(const e in n)s[e]||(o[e]=!0);const i=Object.keys(o);if(i.length){a=!0;for(const e of i)delete n[e]}return a?{...n}:n}))}),[e,t]);const s=(0,l.useCallback)((e=>{a((n=>{const a=t(e);return n[a]!==e&&((n={...n})[a]=e),n}))}),[t]),o=(0,l.useCallback)((e=>{a((n=>{const a=t(e);return n[a]&&delete(n={...n})[a],n}))}),[t]),i=(0,l.useCallback)((e=>{for(const t of e)o(t)}),[o]),r=(0,l.useCallback)((e=>{const a=t(e);return void 0!==n[a]}),[t,n]),c=(0,l.useCallback)((e=>{a((n=>{n={...n};for(const a of e)n[t(a)]=a;return n}))}),[t]),d=(0,l.useCallback)((()=>{c(e??[])}),[e,c]),u=(0,l.useCallback)((()=>{a((e=>Object.keys(e).length>0?{}:e))}),[]),m=(0,l.useMemo)((()=>Object.values(n)),[n]),p=(0,l.useMemo)((()=>m.length===e?.length),[e,m.length]);return(0,l.useMemo)((()=>({selectedItems:m,selectItem:s,unselectItem:o,isSelected:r,selectItems:c,selectAll:d,unselectAll:u,allSelected:p,keyFn:t,unselectItems:i})),[p,r,t,d,s,c,m,u,o,i])}(t,n);return(0,l.useMemo)((()=>({itemCount:t?b.filtered.length:void 0,pageItems:t?g.paged:void 0,error:e.error,...i,...j})),[b.filtered.length,t,e.error,g.paged,j,i])}var Vr=n(87725),Gr=n(1347);const Yr="true"===new URLSearchParams(window.location.search).get("pseudolocalization");po.Ay.use({type:"postProcessor",name:"pseudolocalization",process:function(e){return Yr?Array.isArray(e)?["»",...e,"«"]:`»${e}«`:e}}).use(Gr.A).use(Vr.A).use(I.r9).init({detection:{lookupQuerystring:"lang",lookupCookie:"lang",lookupLocalStorage:"lang"},fallbackLng:"en",supportedLngs:["en","es","fr","ja","ko","nl","zh","zu"],interpolation:{escapeValue:!1},postProcess:["pseudolocalization"]});var Kr=n(5912);async function Zr(e){const t=e.statusText;let n,a,s;const o=e.headers.get("content-type");return o?.includes("application/json")?a=await async function(e){try{return await e.json()}catch{return}}(e):o?.includes("text/plain")&&(a=await async function(e){try{const t=await e.text();return function(e){try{return JSON.parse(e)}catch{return}}(t)??t}catch{return}}(e)),"object"==typeof a&&null!==a&&(s=a,n=(0,Kr.As)(a)),new Xr(t,n,e.status,a,s)}class Xr extends Error{constructor(e,t,n,a,s){super(e),Object.setPrototypeOf(this,Xr.prototype),this.name="RequestError",this.details=t,this.statusCode=n,this.body=a,this.json=s}}function Qr(e){return e instanceof Xr}function el(e){const t=document.cookie.split(";").map((e=>e.trim()));for(const n of t)if(n.startsWith(e+"="))return n.slice(e.length+1)}function tl(e){const{url:t,method:n,body:a,signal:s}=e,o={Accepts:"application/json","X-CSRFToken":el("csrftoken")??""};return a&&(o["Content-Type"]="application/json"),fetch(t,{method:n,body:a?JSON.stringify(a):void 0,credentials:"include",headers:{...o,...e.headers},signal:s,redirect:"error"})}async function nl(e,t){return il(e,{signal:t,method:"GET"})}async function al(e,t,n){return il(e,{method:"POST",json:t,signal:n})}async function sl(e,t){return il(e,{method:"PATCH",json:t})}async function ol(e,t){return il(e,{signal:t,method:"DELETE"})}async function il(e,t){const n=t.method,a=t.json,s=t.headers,o=t.signal,i=await tl({url:e,method:n,body:a,headers:s,signal:o});if(!i.ok)throw await Zr(i);return"DELETE"!==n||202!==i.status&&204!==i.status?"POST"===n&&204===i.status?null:i.json():null}function rl(){return nl}function ll(e){return e?.id.toString()}const cl={dedupingInterval:0};function dl(e){if(e&&Object.keys(e).length>0){const t=Object.keys(e).reduce(((t,n)=>(t[n]=e[n].toString(),t)),{});return"?"+new URLSearchParams(t).toString()}return""}const ul={"/pulp/api/v3/":"ordering","/pulp/api/v3/pulp_container/namespaces/":"sort","/v1/imports/":"order_by","/v1/roles/":"order_by","/_ui/v1/":"sort","/_ui/v2/":"order_by","/v3/plugin/ansible/search/collection-versions/":"order_by"},ml={"/v1/imports/":"page","/v1/namespaces/":"page","/v1/roles/":"page","/_ui/v1/":"offset","/_ui/v2/":"page"};function pl(e){let t="sort";Object.entries(ul).forEach((([n,a])=>{e.includes(n)&&(t=a)}));let n="offset";return Object.entries(ml).forEach((([t,a])=>{e.includes(t)&&(n=a)})),{pageKey:n,sortKey:t}}function hl(e,...t){if("/"!==e[0]?.[0])throw new Error("Invalid URL - must start with a slash");let n="";return e.forEach(((a,s)=>{n+=a,s!==e.length-1&&(n+=encodeURIComponent(`${t.shift()??""}`))})),n}function bl(e,t,n){if(e.includes(`?${n}=`)||e.includes(`&${n}=`))throw new Error(`Invalid param - use "${t}", not "${n}" (url: ${e})`)}let fl="/api/galaxy";function gl(e,...t){const n=fl;if(n&&n.endsWith("/"))throw new Error("Invalid HUB_API_PREFIX - must NOT end with a slash");return n+function(e,...t){if("/"!==e[0]?.[0])throw new Error("Invalid URL - must start with a slash");let n="";if(e.forEach(((a,s)=>{if(n+=a,s!==e.length-1){const e=t.shift();e&&"object"==typeof e&&(a.endsWith("?")||a.endsWith("&"))?n+=function(e,t){const{pageKey:n,sortKey:a}=pl(e),s={},o={page:"page_size",offset:"limit"}[n],i=t.page_size||t.limit||10;return Object.entries(t||{}).forEach((([e,t])=>{["page","offset"].includes(e)&&n!==e&&("offset"===e&&"page"===n&&(t=1+~~(t/i)),"page"===e&&"offset"===n&&(t=(t-1)*i),e=n),["page_size","limit"].includes(e)&&o!==e&&(e=o),["sort","ordering","order_by"].includes(e)&&a!==e&&(e=a),s[e]=encodeURIComponent(t)})),dl(s)}(n,e).slice(1):n+=encodeURIComponent(`${e??""}`)}})),n.includes("//"))throw new Error(`Invalid URL - must not contain a double slash (url: ${n})`);if(!n.includes("/?")&&!n.endsWith("/"))throw new Error(n.includes("?")?`Invalid URL - missing slash before "?" (url: ${n})`:`Invalid URL - must end with a slash (url: ${n})`);if(n.indexOf("?")!==n.lastIndexOf("?"))throw new Error(`Invalid URL - multiple "?" (url: ${n})`);if(n.includes("?")){const{pageKey:e,sortKey:t}=pl(n);"page"===e&&(bl(n,"page","offset"),bl(n,"page_size","limit")),"offset"===e&&(bl(n,"offset","page"),bl(n,"limit","page_size")),"sort"===t&&(bl(n,t,"ordering"),bl(n,t,"order_by")),"ordering"===t&&(bl(n,t,"sort"),bl(n,t,"order_by")),"order_by"===t&&(bl(n,t,"sort"),bl(n,t,"ordering"))}return n}(e,...t)}let yl="/api/v2";function xl(e,...t){return yl+hl(e,...t)}const jl=(0,l.createContext)({});function _l(){return(0,l.useContext)(jl)}function vl(e){return e?.disabled?(0,z.jsx)(jl.Provider,{value:{},children:e.children}):(0,z.jsx)(wl,{children:e?.children})}function wl(e){const t=(0,_e.Ay)(xl`/me/`,nl,{dedupingInterval:0,refreshInterval:1e4}),[n,a]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{a((e=>t.error?null:t.data&&t.data.results.length>0?t.data.results[0]:t.isLoading?e:null))}),[t]);const s=t.mutate,o=(0,l.useMemo)((()=>({activeAwxUser:n,refreshActiveAwxUser:()=>{s(void 0)}})),[n,s]);return(0,z.jsx)(jl.Provider,{value:o,children:e.children})}var kl,Sl,Cl,Tl,Il,Al,Dl,El,Pl,Rl,Bl,Fl,Nl,$l,Ml,Ll,Ol,zl,Hl=n(79690),ql=n(41313);function Ul(e){const t=f("md"),[n,a]=(0,l.useState)(!1),s=(0,l.useCallback)((()=>a((e=>!e))),[]),o=(0,l.useCallback)((()=>a((e=>!e))),[]),c=Array.isArray(e.children)?e.children:[e.children];return(0,z.jsx)(Dn.m,{id:e.id,ouiaId:e.id,onSelect:s,toggle:(0,z.jsx)(Tn.C,{toggleIndicator:null,onToggle:o,children:(0,z.jsxs)(i.s,{alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},spaceItems:{default:"spaceItemsSm"},children:[(0,z.jsx)(r.Z,{children:e.icon}),t&&e.label&&(0,z.jsx)(r.Z,{wrap:"nowrap",children:e.label})]})}),isOpen:n,isPlain:!0,dropdownItems:c,position:"right","data-cy":e.id})}function Wl(){return Wl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Wl.apply(null,arguments)}const Jl=function(e){return l.createElement("svg",Wl({xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",id:"awx-logo_svg__Layer_1",height:64,x:0,y:0,viewBox:"0 0 547.21 389.47"},e),kl||(kl=l.createElement("style",null,".awx-logo_svg__st0{display:none}.awx-logo_svg__st1,.awx-logo_svg__st2{display:inline;fill:#faeda1}.awx-logo_svg__st2{fill:#5d2815}.awx-logo_svg__st3{fill:#faeda1}.awx-logo_svg__st4{fill:#5d2815}.awx-logo_svg__st8{fill:#ff4b4b}.awx-logo_svg__st13{fill:#fff}.awx-logo_svg__st14{fill:#a4ce39}")),Sl||(Sl=l.createElement("path",{d:"m416.57 378-46.56-74.5 46.56-74.5h74.77l46.56 74.5-46.56 74.5z",className:"awx-logo_svg__st3"})),Cl||(Cl=l.createElement("path",{d:"m489.95 231.5 45 72-45 72h-72l-45-72 45-72zm2.78-5h-77.54l-1.47 2.35-45 72-1.66 2.65 1.66 2.65 45 72 1.47 2.35h77.54l1.47-2.35 45-72 1.66-2.65-1.66-2.65-45-72z",className:"awx-logo_svg__st4"})),Tl||(Tl=l.createElement("path",{d:"m416.57 231-46.56-74.5L416.57 82h74.77l46.56 74.5-46.56 74.5z",className:"awx-logo_svg__st3"})),Il||(Il=l.createElement("path",{d:"m489.95 84.5 45 72-45 72h-72l-45-72 45-72zm2.78-5h-77.54l-1.47 2.35-45 72-1.66 2.65 1.66 2.65 45 72 1.47 2.35h77.54l1.47-2.35 45-72 1.66-2.65-1.66-2.65-45-72z",className:"awx-logo_svg__st4"})),Al||(Al=l.createElement("path",{d:"m176.57 231-46.56-74.5L176.57 82h74.77l46.56 74.5-46.56 74.5z",className:"awx-logo_svg__st3"})),Dl||(Dl=l.createElement("path",{d:"m249.95 84.5 45 72-45 72h-72l-45-72 45-72zm2.78-5h-77.54l-1.47 2.35-45 72-1.66 2.65 1.66 2.65 45 72 1.47 2.35h77.54l1.47-2.35 45-72 1.66-2.65-1.66-2.65-45-72z",className:"awx-logo_svg__st4"})),El||(El=l.createElement("path",{d:"M56.57 158 10.01 83.5 56.57 9h74.77l46.56 74.5-46.56 74.5z",className:"awx-logo_svg__st3"})),Pl||(Pl=l.createElement("path",{d:"m129.95 11.5 45 72-45 72h-72l-45-72 45-72zm2.78-5H55.19l-1.47 2.35-45 72-1.66 2.65 1.66 2.65 45 72 1.47 2.35h77.53999999999999l1.47-2.35 45-72 1.66-2.65-1.66-2.65-45-72zM250.95 320.5h40v55h-40z",className:"awx-logo_svg__st4"})),l.createElement("path",{d:"M430.45 341h-320c-8.25 0-15-6.75-15-15V136c0-8.25 6.75-15 15-15h320c8.25 0 15 6.75 15 15v190c0 8.25-6.75 15-15 15",style:{fill:"#2d8cce"}}),Rl||(Rl=l.createElement("path",{d:"M318.45 384h-95c-4.12 0-7.5-3.38-7.5-7.5s3.38-7.5 7.5-7.5h95c4.12 0 7.5 3.38 7.5 7.5s-3.37 7.5-7.5 7.5",className:"awx-logo_svg__st4"})),l.createElement("path",{d:"M280.95 320.02h10v49h-10z",style:{fill:"#794532"}}),l.createElement("path",{d:"M95.95 272.5v54l349 1v-6s-132-4-242-13-107-36-107-36",style:{fill:"#026dae"}}),Bl||(Bl=l.createElement("path",{d:"M445.45 326c0 8.25-6.75 15-15 15h-320c-8.25 0-15-6.75-15-15",className:"awx-logo_svg__st8"})),l.createElement("path",{d:"M444.95 185.5v-54c-5.99-10-13.99-9-29.99-9-46.86 0-97.14-.87-144-1-45.41-.13-90.59.13-136 0-13-.04-34 0-39.01 9v6s132 4 242 13 107 36 107 36",style:{fill:"#abdbf7"}}),l.createElement("path",{d:"M95.77 325.95h50.89l8.17 13.71-47.06.29-9-5z",style:{fill:"#cb2d2f"}}),l.createElement("path",{d:"M445.53 326.13h-60.21l9.26 14.71 38.96.27 8.44-5.45z",style:{fill:"#fca2a3"}}),l.createElement("path",{d:"M430.45 341h-320c-8.25 0-15-6.75-15-15V136c0-8.25 6.75-15 15-15h320c8.25 0 15 6.75 15 15v190c0 8.25-6.75 15-15 15z",style:{fill:"none",stroke:"#5d2815",strokeWidth:5,strokeMiterlimit:10}}),Fl||(Fl=l.createElement("path",{d:"M207.93 188.72h24.16l8.7 46.08 12.73-46.08h24.07l12.76 46.02 8.71-46.02h24.04l-18.15 82.32h-24.94l-14.44-51.83-14.38 51.83h-24.95zM325.79 188.72h28.02l14.57 25.32 14.18-25.32h27.74l-25.62 39.87 28.04 42.45h-28.58l-16.26-26.45-16.26 26.45h-28.41l28.4-42.9zM187.02 257.45h-28.88l-4.01 13.59h-25.97l30.94-82.32h27.75l30.93 82.32h-26.64zm-5.28-17.8-9.09-29.59-8.99 29.59z",className:"awx-logo_svg__st13"})),Nl||(Nl=l.createElement("circle",{cx:490.45,cy:83,r:11,className:"awx-logo_svg__st14"})),$l||($l=l.createElement("path",{d:"M490.45 74.5c4.69 0 8.5 3.81 8.5 8.5s-3.81 8.5-8.5 8.5-8.5-3.81-8.5-8.5 3.82-8.5 8.5-8.5m0-5c-7.46 0-13.5 6.04-13.5 13.5s6.04 13.5 13.5 13.5 13.5-6.04 13.5-13.5-6.04-13.5-13.5-13.5",className:"awx-logo_svg__st4"})),Ml||(Ml=l.createElement("circle",{cx:57.45,cy:157,r:11,className:"awx-logo_svg__st14"})),Ll||(Ll=l.createElement("path",{d:"M57.45 148.5c4.69 0 8.5 3.81 8.5 8.5s-3.81 8.5-8.5 8.5-8.5-3.81-8.5-8.5 3.82-8.5 8.5-8.5m0-5c-7.46 0-13.5 6.04-13.5 13.5s6.04 13.5 13.5 13.5 13.5-6.04 13.5-13.5-6.04-13.5-13.5-13.5",className:"awx-logo_svg__st4"})),Ol||(Ol=l.createElement("circle",{cx:491.45,cy:231,r:11,className:"awx-logo_svg__st8"})),zl||(zl=l.createElement("path",{d:"M491.45 222.5c4.69 0 8.5 3.81 8.5 8.5s-3.81 8.5-8.5 8.5-8.5-3.81-8.5-8.5 3.82-8.5 8.5-8.5m0-5c-7.46 0-13.5 6.04-13.5 13.5s6.04 13.5 13.5 13.5 13.5-6.04 13.5-13.5-6.04-13.5-13.5-13.5",className:"awx-logo_svg__st4"})))};var Vl=n(60004),Gl=n(51976),Yl=n(12921),Kl=n(90118);function Zl(e){const[t,n]=ss(),{t:a}=(0,I.Bd)();return(0,z.jsx)(Vl.V,{isOpen:!0,onClose:()=>{n(void 0),e.onClose?.()},trademark:a("Copyright {{fullYear}} Red Hat, Inc.",{fullYear:(new Date).getFullYear()}),brandImageSrc:e.brandImageSrc,brandImageAlt:a("Brand Logo"),productName:"AWX",children:(0,z.jsx)(Gl.n,{children:(0,z.jsxs)(Yl.K,{component:"dl",children:[(0,z.jsx)(Kl.L,{component:"dt",children:a("Version")}),(0,z.jsx)(Kl.L,{component:"dd",children:void 0})]})})})}var Xl=n(50513);function Ql(){const[e,t]=(0,l.useState)(!1),n=(0,l.useCallback)((()=>{t(!0),(0,_e.Tk)((e=>"string"==typeof e)).finally((()=>{t(!1)}))}),[]),[a,s]=(0,l.useState)(0);return(0,l.useLayoutEffect)((()=>{let t,n;return e?(t=requestAnimationFrame((function e(a){void 0===n&&(n=a);const o=a-n;n=a,t=requestAnimationFrame(e),s((e=>e+o/3))})),()=>cancelAnimationFrame(t)):(t=requestAnimationFrame((function e(a){void 0===n&&(n=a);const o=a-n;n=a,t=requestAnimationFrame(e),s((e=>Math.floor(e/360)!==Math.floor((e+o/3)/360)?(cancelAnimationFrame(t),0):e+o/3))})),()=>cancelAnimationFrame(t))}),[e]),(0,z.jsx)(x.m,{content:"Refresh",position:"bottom",entryDelay:1e3,children:(0,z.jsx)(g.$n,{id:"refresh","data-cy":"refresh",onClick:n,variant:"plain",children:(0,z.jsx)(Xl.lO,{style:{transform:`rotateZ(${a}deg)`}})})})}function ec(e,t,n={}){const a=nc();e&&(e+=dl(t));const s=(0,_e.Ay)(e,a,{dedupingInterval:0,...n}),o=(0,l.useCallback)((()=>{s.mutate()}),[s]);let i=s.error;return!i||i instanceof Error||(i=new Error("Unknown error")),(0,l.useMemo)((()=>({data:s.data,error:s.isLoading?void 0:i,refresh:o,isLoading:s.isLoading})),[s.data,s.isLoading,i,o])}function tc(e,t,n){return e?.endsWith("/")&&(e=e.slice(0,e.length-1)),ec(e&&t?`${e}/${t}/`:void 0,void 0,n)}function nc(){const e=(0,l.useRef)({});return(0,l.useEffect)((()=>{const t=e;return()=>t.current.abortController?.abort()}),[]),async(e,t,n)=>{e&&(e+=dl(t));const a=await tl({url:e,method:"GET",signal:n});if(!a.ok)throw await Zr(a);return await a.json()}}const ac=(0,l.createContext)({});function sc(){return(0,l.useContext)(ac).awxConfig}function oc(e){return e?.disabled?(0,z.jsx)(ac.Provider,{value:{awxConfig:void 0,awxConfigError:void 0,refreshAwxConfig:void 0},children:e.children}):(0,z.jsx)(ic,{children:e?.children})}function ic(e){const t=(0,_e.Ay)(xl`/config/`,nl),n=(0,l.useMemo)((()=>({awxConfig:t.data,awxConfigError:t.error,refreshAwxConfig:()=>t.mutate(void 0)})),[t]);return(0,z.jsx)(ac.Provider,{value:n,children:e.children})}var rc=n(44921);const lc=(0,l.createContext)({sendMessage:()=>null,sendJsonMessage:()=>null,lastMessage:null,lastJsonMessage:null,readyState:rc.vj.UNINSTANTIATED,getWebSocket:()=>null,setSubscriptions:()=>null});function cc(e){const[t,n]=(0,l.useState)(null),a=(0,rc.Ay)(t,{shouldReconnect:()=>!0}),[s,o]=(0,l.useState)({});(0,l.useEffect)((()=>{const e=window.location;let t;t="https:"===e.protocol?"wss:":"ws:",t+="//"+e.host,t+="/websocket/",n(t)}),[]);const{sendMessage:i,readyState:r}=a;return(0,l.useEffect)((()=>{const e=el("csrftoken");if(e&&r===rc.vj.OPEN){const t=Object.keys(s).reduce(((e,t)=>(e[t]=Object.keys(s[t]),e)),{});i(JSON.stringify({groups:t,xrftoken:e}))}}),[i,s,r]),(0,z.jsx)(lc.Provider,{value:{...a,setSubscriptions:o},children:e.children})}function dc(e,t){const[n]=(0,l.useState)((()=>e)),{sendMessage:a,lastJsonMessage:s,lastMessage:o,readyState:i,setSubscriptions:r}=(0,l.useContext)(lc);return(0,l.useEffect)((()=>(r((e=>{e={...e};for(const t of Object.keys(n)){let a=e[t];a||(a={},e[t]=a);for(const e of n[t])a[e]=(a[e]??0)+1}return e})),()=>{r((e=>{e={...e};for(const t of Object.keys(n)){const a=e[t];if(a){for(const e of n[t])a[e]=(a[e]??0)-1,0===a[e]&&delete a[e];0===Object.keys(a).length&&delete e[t]}}return e}))})),[n,r]),(0,l.useEffect)((()=>{t(s)}),[s,t]),{sendMessage:a,lastMessage:o,readyState:i}}const uc=(0,l.createContext)({version:void 0});function mc(e){return(0,z.jsx)(uc.Provider,{value:{version:e.version},children:e.children})}function pc(e,t){const{version:n}=(0,l.useContext)(uc)||{version:"2.5"},a=e?.license_info?.license_type;return a&&"open"!==a?`https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/${n}/html/${bc[t]}`:`https://ansible.readthedocs.io/projects/awx/en/latest/${hc[t]}`}const hc={credentialTypes:"userguide/credential_types.html",credentials:"userguide/credentials.html",organizations:"userguide/organizations.html",teams:"userguide/teams.html",users:"userguide/users.html",activityStream:"userguide/main_menu.html#activity-stream",applications:"userguide/applications_auth.html",executionEnvironments:"userguide/execution_environments.html",managementJobs:"userguide/management_jobs.html",notifiers:"userguide/notifications.html",topology:"userguide/topology_viewer.html",workflows:"userguide/workflows.html",eeMigration:"upgrade-migration-guide/upgrade_to_ees.html",jobTemplateSurveys:"userguide/job_templates.html#surveys",index:"userguide/index.html",hosts:"userguide/hosts.html",inventories:"userguide/inventories.html",constructedInventories:"userguide/inventories.html#constructed-inventories",managePlaybooksSC:"userguide/projects.html#manage-playbooks-using-source-control",projects:"userguide/projects.html",templates:"userguide/job_templates.html",workflowVisualizer:"userguide/workflow_templates.html#ug-wf-editor",workflowVisBuild:"userguide/workflow_templates.html#converge-node",jobs:"userguide/jobs.html",schedules:"userguide/scheduling.html"},bc={credentialTypes:"automation_controller_user_guide/assembly-controller-custom-credentials",credentials:"automation_controller_user_guide/controller-credentials",organizations:"automation_controller_user_guide/assembly-controller-organizations",teams:"automation_controller_user_guide/assembly-controller-teams",users:"automation_controller_user_guide/assembly-controller-users",activityStream:"automation_controller_user_guide/assembly-controller-activity-stream",applications:"automation_controller_user_guide/assembly-controller-applications",executionEnvironments:"automation_controller_user_guide/assembly-controller-execution-environments",managementJobs:"automation_controller_user_guide/assembly-controller-management-jobs",notifiers:"automation_controller_user_guide/assembly-controller-notifications",topology:"automation_controller_user_guide/assembly-controller-topology-viewer",workflows:"automation_controller_user_guide/assembly-controller-workflows",eeMigration:"red_hat_ansible_automation_platform_upgrade_and_migration_guide/upgrading-to-ees",jobTemplateSurveys:"automation_controller_user_guide/controller-job-templates#controller-surveys-in-job-templates",index:"automation_controller_user_guide/index",hosts:"automation_controller_user_guide/assembly-controller-hosts",inventories:"automation_controller_user_guide/controller-inventories",constructedInventories:"automation_controller_user_guide/controller-inventories#ref-controller-constructed-inventories",managePlaybooksSC:"automation_controller_user_guide/controller-projects#ref-projects-manage-playbooks-with-source-control",projects:"automation_controller_user_guide/controller-projects",templates:"automation_controller_user_guide/controller-job-templates",workflowVisualizer:"automation_controller_user_guide/controller-workflow-job-templates#controller-workflow-visualizer",workflowVisBuild:"automation_controller_user_guide/controller-workflow-job-templates#controller-build-workflow",jobs:"automation_controller_user_guide/controller-jobs",schedules:"automation_controller_user_guide/controller-schedules"};let fc=function(e){return e.Awx="awx",e.Overview="awx-overview",e.Jobs="awx-jobs",e.JobPage="awx-job-page",e.JobOutput="awx-job-output",e.JobDetails="awx-job-details",e.TemplateLaunchWithPasswordsWizard="awx-template-relaunch-with-passwords-wizard",e.Schedules="awx-schedules",e.CreateSchedule="awx-create-schedule",e.EditSchedule="awx-edit-schedule",e.ActivityStream="awx-activity-stream",e.WorkflowApprovals="awx-workflow-approvals",e.WorkflowApprovalPage="awx-workflow-approval-page",e.WorkflowApprovalDetails="awx-workflow-approval-details",e.WorkflowApprovalWorkflowJobDetails="awx-workflow-approval-workflow-job-details",e.Templates="awx-templates",e.CreateJobTemplate="awx-create-job-template",e.CreateWorkflowJobTemplate="awx-create-workflow-job-template",e.EditJobTemplate="awx-edit-template",e.JobTemplatePage="awx-template-page",e.JobTemplateDetails="awx-template-details",e.JobTemplateScheduleDetails="awx-job-template-schedule-details",e.JobTemplateTeamAccess="awx-job-template-team-access",e.JobTemplateUserAccess="awx-job-template-user-access",e.JobTemplateJobs="awx-job-template-jobs",e.JobTemplateSurvey="awx-job-template-survey",e.AddJobTemplateSurvey="awx-add-job-template-survey",e.EditJobTemplateSurvey="awx-edit-job-template-survey",e.JobTemplateNotifications="awx-job-template-notifications",e.JobTemplateSchedules="awx-job-template-schedules",e.JobTemplateSchedulePage="awx-template-schedule-page",e.JobTemplateScheduleCreate="awx-template-schedule-create",e.JobTemplateScheduleEdit="awx-template-schedule-edit",e.JobTemplateScheduleRules="awx-template-schedule-rules",e.JobTemplateCreateScheduleRules="awx-job-template-create-schedule-rules",e.TemplateLaunchWizard="awx-template-launch-wizard",e.JobTemplateAddTeams="awx-template-add-teams",e.JobTemplateAddUsers="awx-template-add-users",e.WorkflowJobTemplatePage="awx-workflow-job-template-page",e.WorkflowJobTemplateDetails="awx-workflow-job-template-details",e.WorkflowJobTemplateTeamAccess="awx-workflow-job-template-team-access",e.WorkflowJobTemplateUserAccess="awx-workflow-job-template-user-access",e.WorkflowJobTemplateSchedules="awx-workflow-job-template-schedules",e.WorkflowJobTemplateSchedulePage="awx-workflow-job-template-schedule-page",e.WorkflowJobTemplateScheduleDetails="awx-workflow-job-template-schedule-details",e.WorkflowJobTemplateScheduleCreate="awx-workflow-job-template-schedule-create",e.WorkflowJobTemplateScheduleEdit="awx-workflow-job-template-schedule-edit",e.WorkflowJobTemplateCreateScheduleRules="awx-workflow-job-template-create-schedule-rules",e.WorkflowJobTemplateJobs="awx-workflow-job-template-jobs",e.WorkflowJobTemplateSurvey="awx-workflow-job-template-survey",e.AddWorkflowJobTemplateSurvey="awx-add-workflow-job-template-survey",e.EditWorkflowJobTemplateSurvey="awx-edit-workflow-job-template-survey",e.WorkflowJobTemplateNotifications="awx-workflow-job-template-notifications",e.EditWorkflowJobTemplate="awx-edit-workflow-job-template",e.WorkflowVisualizer="awx-workflow-visualizer",e.WorkflowJobTemplateLaunchWizard="awx-workflow-job-template-launch-wizard",e.WorkflowJobTemplateAddTeams="awx-workflow-job-template-add-teams",e.WorkflowJobTemplateAddUsers="awx-workflow-job-template-add-users",e.Credentials="awx-credentials",e.CreateCredential="awx-create-credential",e.EditCredential="awx-edit-credential",e.CredentialPage="awx-credential-page",e.CredentialDetails="awx-credential-details",e.CredentialJobTemplates="awx-credentials-job-templates",e.CredentialTeamAccess="awx-credential-team-access",e.CredentialUserAccess="awx-credential-user-access",e.CredentialAddUsers="awx-credentials-add-users",e.CredentialAddTeams="awx-credentials-add-teams",e.Projects="awx-projects",e.CreateProject="awx-create-project",e.ProjectPage="awx-project-page",e.EditProject="awx-edit-project",e.ProjectDetails="awx-project-details",e.ProjectJobTemplates="awx-project-job-templates",e.ProjectNotifications="awx-project-notifications",e.ProjectScheduleCreate="awx-project-schedule-create",e.ProjectScheduleEdit="awx-project-schedule-edit",e.ProjectSchedules="awx-project-schedules",e.ProjectUsers="awx-project-users",e.ProjectTeams="awx-project-teams",e.ProjectAddUsers="awx-project-add-users",e.ProjectAddTeams="awx-project-add-teams",e.ProjectSchedulePage="awx-project-schedule-page",e.ProjectScheduleDetails="awx-project-schedule-details",e.Inventories="awx-inventories",e.CreateInventory="awx-create-inventory",e.CreateSmartInventory="awx-create-smart-inventory",e.CreateConstructedInventory="awx-create-constructed-inventory",e.EditInventory="awx-edit-inventory",e.InventoryPage="awx-inventory-page",e.InventoryHostPage="awx-inventory-host-page",e.InventoryDetails="awx-inventory-details",e.InventoryGroups="awx-inventory-groups",e.InventoryGroupCreate="awx-inventory-group-create",e.InventoryGroupPage="awx-inventory-group-page",e.InventoryGroupEdit="awx-inventory-group-edit",e.InventoryGroupDetails="awx-inventory-group-details",e.InventoryGroupRelatedGroups="awx-inventory-group-related-groups",e.InventoryGroupRelatedGroupsCreate="awx-inventory-group-related-groups-create",e.InventoryGroupHost="awx-inventory-group-host",e.InventoryGroupHostAdd="awx-inventory-group-host-add",e.InventoryHosts="awx-inventory-hosts",e.InventoryHostAdd="awx-inventory-host-add",e.InventoryHostEdit="awx-inventory-host-edit",e.InventoryHostDetails="awx-inventory-host-details",e.InventoryHostGroups="awx-inventory-host-groups",e.InventoryHostJobs="awx-inventory-host-jobs",e.InventoryHostFacts="awx-inventory-host-facts",e.InventorySources="awx-inventory-sources",e.InventorySourcesAdd="awx-inventory-sources-add",e.InventorySourcePage="awx-inventory-source-page",e.InventorySourceDetail="awx-inventory-source-detail",e.InventorySourceNotifications="awx-inventory-source-notifications",e.InventoryJobs="awx-inventory-jobs",e.InventoryJobTemplates="awx-inventory-job-templates",e.InventorySourceEdit="awx-edit-inventory-source",e.InventorySourceSchedules="awx-inventory-schedules",e.InventorySourceScheduleCreate="awx-inventory-schedule-create",e.InventorySourceScheduleEdit="awx-inventory-schedule-edit",e.InventorySourceSchedulePage="awx-inventory-schedule-page",e.InventorySourceScheduleDetails="awx-inventory-schedule-details",e.InventoryRunCommand="awx-inventory-run-command",e.InventoryTeamAccess="awx-inventory-team-access",e.InventoryUserAccess="awx-inventory-user-access",e.InventoryAddUsers="awx-inventory-add-users",e.InventoryAddTeams="awx-inventory-add-teams",e.Hosts="awx-hosts",e.CreateHost="awx-create-host",e.EditHost="awx-edit-host",e.HostPage="awx-host-page",e.HostDetails="awx-host-details",e.HostFacts="awx-host-facts",e.HostGroups="awx-host-groups",e.HostJobs="awx-host-jobs",e.Access="awx-access",e.Organizations="awx-organizations",e.CreateOrganization="awx-create-organization",e.EditOrganization="awx-edit-organization",e.OrganizationPage="awx-organization-page",e.OrganizationDetails="awx-organization-details",e.OrganizationUsersAccess="awx-organization-users",e.OrganizationTeamsAccess="awx-organization-teams",e.OrganizationExecutionEnvironments="awx-organization-execution-environments",e.OrganizationNotifications="awx-organization-notifications",e.OrganizationAddUsers="awx-organization-add-users",e.OrganizationAddTeams="awx-organization-add-teams",e.Teams="awx-teams",e.CreateTeam="awx-create-team",e.EditTeam="awx-edit-team",e.TeamPage="awx-team-page",e.TeamDetails="awx-team-details",e.TeamMembers="awx-team-access",e.TeamAddMembers="awx-team-member-add",e.TeamRoles="awx-team-roles",e.AddRolesToTeam="awx-add-roles-to-team",e.Users="awx-users",e.CreateUser="awx-create-user",e.EditUser="awx-edit-user",e.UserPage="awx-user-page",e.UserDetails="awx-user-details",e.UserOrganizations="awx-user-organizations",e.UserTeams="awx-user-teams",e.UserRoles="awx-user-roles",e.UserTokens="awx-user-tokens",e.CreateUserToken="awx-user-token-create",e.UserTokenPage="awx-user-token-page",e.UserTokenDetails="awx-user-token-detail",e.AddRolesToUser="awx-add-roles-to-user",e.Roles="awx-roles",e.CreateRole="awx-create-role",e.EditRole="awx-edit-role",e.RolePage="awx-role-page",e.RoleDetails="awx-role-details",e.Administration="awx-administration",e.Infrastructure="awx-infrastructure",e.CredentialTypes="awx-credential-types",e.CredentialTypePage="awx-credential-type-page",e.CredentialTypeDetails="awx-credential-type-details",e.CredentialTypeCredentials="awx-credential-type-credentials",e.CreateCredentialType="awx-create-credential-type",e.EditCredentialType="awx-edit-credential-type",e.NotificationTemplates="awx-notification-templates",e.NotificationTemplatePage="awx-notification-template-page",e.NotificationTemplateDetails="awx-notification-template-details",e.NotificationTemplateTeamAccess="awx-notification-template-team-access",e.NotificationTemplateUserAccess="awx-notification-template-user-access",e.NotificationAddUsers="awx-notification-add-users",e.NotificationAddTeams="awx-notification-add-teams",e.EditNotificationTemplate="awx-edit-notification-template",e.AddNotificationTemplate="awx-add-notification-template",e.ManagementJobs="awx-management-jobs",e.ManagementJobPage="awx-management-job-page",e.ManagementJobSchedules="awx-management-job-schedules",e.ManagementJobSchedulesDetails="awx-management-job-schedules-details",e.ManagementJobNotifications="awx-management-job-notifications",e.ManagementJobSchedulePage="awx-management-job-schedule-page",e.ManagementJobScheduleDetails="awx-management-job-schedule-details",e.ManagementJobScheduleRules="awx-management-job-schedule-rules",e.ManagementJobScheduleEdit="awx-management-job-schedule-edit",e.ManagementJobScheduleCreate="awx-management-job-schedule-create",e.CreateInstanceGroup="awx-create-instance-group",e.EditInstanceGroup="awx-edit-instance-group",e.InstanceGroupPage="awx-instance-group-page",e.InstanceGroupDetails="awx-instance-group-details",e.InstanceGroupInstances="awx-instance-group-instances",e.InstanceGroupInstancesPage="awx-instance-group-instances-page",e.InstanceGroupInstanceDetails="awx-instance-group-instance-details",e.InstanceGroupTeamAccess="awx-instance-group-team-access",e.InstanceGroupUserAccess="awx-instance-group-user-access",e.InstanceGroupJobs="awx-instance-group-jobs",e.InstanceGroups="awx-instance-groups",e.InstanceGroupAddTeams="awx-instance-group-add-teams",e.InstanceGroupAddUsers="awx-instance-group-add-users",e.CreateContainerGroup="awx-create-container-group",e.ContainerGroupDetails="awx-container-group-details",e.ContainerGroupPage="awx-container-group-page",e.EditContainerGroup="awx-container-group-edit",e.Instances="awx-instances",e.AddInstance="awx-add-instance",e.EditInstance="awx-edit-instance",e.InstancePage="awx-instance-page",e.InstanceDetails="awx-instance-details",e.InstancePeers="awx-instance-peers",e.InstanceListenerAddresses="awx-instance-listener-addresses",e.ExecutionEnvironments="awx-execution-environments",e.ExecutionEnvironmentPage="awx-execution-environments-page",e.ExecutionEnvironmentDetails="awx-execution-environments-details",e.ExecutionEnvironmentTemplates="awx-execution-environments-templates",e.CreateExecutionEnvironment="awx-create-execution-environment",e.EditExecutionEnvironment="awx-edit-execution-environment",e.ExecutionEnvironmentTeamAccess="awx-execution-environment-team-access",e.ExecutionEnvironmentUserAccess="awx-execution-environment-user-access",e.ExecutionEnvironmentAddUsers="awx-execution-environment-add-users",e.ExecutionEnvironmentAddTeams="awx-execution-environment-add-teams",e.TopologyView="awx-topology-view",e.Analytics="awx-analytics",e.Reports="awx-reports",e.AutomationCalculator="awx-automation-calculator",e.AnalyticsBuilder="awx-analytics-builder",e.HostMetrics="awx-host-metrics",e.SubscriptionUsage="awx-subscription-usage",e.Settings="awx-settings",e.SettingsPreferences="awx-settings-preferences",e.SettingsSystem="awx-settings-system",e.SettingsJobs="awx-settings-jobs",e.SettingsLogging="awx-settings-logging",e.SettingsCustomizeLogin="awx-settings-customize-login",e.SettingsTroubleshooting="awx-settings-troubleshooting",e.SettingsAuthentication="awx-settings-authentication",e.SettingsCategory="awx-settings-category",e.Login="awx-login",e}({});function gc(){const{t:e}=(0,I.Bd)(),t=function(){const[e,t]=ss(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{if(n){const e=()=>{a(void 0),n.onClose?.()};t((0,z.jsx)(Zl,{...n,onClose:e}))}else t(void 0)}),[n,t]),a}(),n=sc(),a=yr(),{activeAwxUser:s,refreshActiveAwxUser:o}=_l();!function(){const{t:e}=(0,I.Bd)(),t=gr(),{data:n,refresh:a}=ec(xl`/workflow_approvals/`,{page_size:200,status:"pending"});dc({control:["limit_reached_1"],jobs:["status_changed"]},(0,l.useCallback)((e=>{"jobs"===e?.group_name&&"workflow_approval"===e?.type&&a()}),[a]));const{setNotificationGroups:s}=Di();(0,l.useEffect)((()=>{s((a=>(a["workflow-approvals"]={title:e("Workflow Approvals"),notifications:n?.results.map((e=>({title:e.name,description:e.summary_fields.workflow_job?.name,timestamp:e.created,variant:"info",to:t(fc.WorkflowApprovalDetails,{params:{id:e.id}})})))??[]},{...a})))}),[n,t,s,e])}();const i=(0,l.useCallback)((async()=>{await fetch("/api/logout/"),o?.()}),[o]);return(0,z.jsx)(Xi,{brand:(0,z.jsx)(Jl,{style:{height:60}}),children:(0,z.jsxs)(Sn.$,{variant:"icon-button-group",style:{flexGrow:1},children:[(0,z.jsx)(wn.T,{style:{marginLeft:"auto"},children:(0,z.jsx)(Ql,{})}),(0,z.jsx)(wn.T,{children:(0,z.jsx)(sr,{})}),(0,z.jsx)(wn.T,{children:(0,z.jsx)(tr,{})}),(0,z.jsx)(wn.T,{children:(0,z.jsxs)(Ul,{id:"help-menu",icon:(0,z.jsx)(Hl.GA,{}),children:[(0,z.jsx)(An.t,{id:"documentation",icon:(0,z.jsx)(et._,{}),component:"a",href:pc(n,"index"),target:"_blank","data-cy":"masthead-documentation",children:e("Documentation")}),(0,z.jsx)(An.t,{id:"about",onClick:()=>t({brandImageSrc:"/assets/awx-logo.svg"}),"data-cy":"masthead-about",children:e("About")})]})}),(0,z.jsx)(wn.T,{children:(0,z.jsxs)(Ul,{id:"account-menu",icon:(0,z.jsx)(y.I,{size:"lg",children:(0,z.jsx)(ql.rM,{})}),label:s?.username,children:[(0,z.jsx)(An.t,{id:"user-details",label:e("User details"),onClick:()=>a(fc.UserDetails,{params:{id:s?.id}}),children:e("User details")}),(0,z.jsx)(An.t,{id:"logout",label:e("Logout"),onClick:()=>{i()},children:e("Logout")})]})})]})})}var yc=n(53966);function xc(){const{t:e}=(0,I.Bd)();return[{name:"refreshInterval",label:e("Refresh interval"),helpText:e("The refresh interval is the time in seconds between automatic refreshes of the data on the page."),options:[{label:e("5 seconds"),value:5},{label:e("10 seconds"),value:10},{label:e("30 seconds"),value:30},{label:e("1 minute"),value:60},{label:e("5 minutes"),value:300},{label:e("Never"),value:0}],defaultValue:30},{name:"theme",label:e("Color theme"),helpText:e("Select the color theme."),options:[{label:e("System"),value:"system",description:e("Use the system color theme.")},{label:e("Light"),value:"light",description:e("Use the light color theme.")},{label:e("Dark"),value:"dark",description:e("Use the dark color theme.")}],defaultValue:"system"},{name:"tableLayout",label:e("Table layout"),helpText:e("The preferred layout for tables."),options:[{label:e("Compact"),value:"compact",description:e("Reduce spacing and make the table more compact.")},{label:e("Comfortable"),value:"comfortable",description:e("Increase spacing and make the table more comfortable.")}],defaultValue:"comfortable"},{name:"formColumns",label:e("Form columns"),helpText:e("Allows displaying forms and details in a single or multiple columns."),options:[{label:e("Single"),value:"single",description:e("Display forms and details using a single column.")},{label:e("Multiple"),value:"multiple",description:e("Display forms and details using multiple columns.")}],defaultValue:"multiple"},{name:"dateFormat",label:e("Date format"),helpText:e("The preferred date format to display in tables and details."),options:[{label:e("Relative"),value:"since",description:e("Show dates as a relative to the current time.")},{label:e("Date and time"),value:"date-time",description:e("Show dates as date and time.")}],defaultValue:"date-time"},{name:"dataEditorFormat",label:e("Preferred data format"),helpText:e("The preferred data format for editing and displaying data."),options:[{label:e("YAML"),value:"yaml"},{label:e("JSON"),value:"json"}],defaultValue:"yaml"}]}function jc(){const{t:e}=(0,I.Bd)(),[t]=(0,l.useContext)(ve),n=(0,Re.Zp)(),a=(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,icon:yc.oo,label:e("Edit"),onClick:()=>n("./edit"),isPinned:!0}]),[n,e]),i=xc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("User Preferences"),headerActions:(0,z.jsx)(oe,{actions:a,position:te.nU.right})}),(0,z.jsx)(Mt,{children:i.map((e=>(0,z.jsx)(_c,{option:e,value:t[e.name]},e.name)))})]})}function _c(e){const t=e.option.options.find((t=>t.value===e.value))?.label;return(0,z.jsx)(Ft,{label:e.option.label,helpText:e.option.helpText,id:e.option.name.toLowerCase(),children:t})}function vc(e){const t=M(e),{control:n,formState:a}=(0,oo.xW)(),{isSubmitting:s,isValidating:o}=a,[i]=W(),r=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:e.name,control:n,shouldUnregister:!0,defaultValue:e.defaultValue,render:({field:{value:n,onChange:a},fieldState:{error:r}})=>{const l=r?.message?e.validate&&o?i.validating:r?.message:void 0;let c=e.isDisabled;return!c&&e.isReadOnly&&(c=(0,po.t)("Readonly")),s&&(c=(0,po.t)("Submitting")),(0,z.jsx)(Vo,{fieldId:t,label:e.label,labelHelpTitle:e.labelHelpTitle??e.label,labelHelp:e.labelHelp,helperText:e.helperText,helperTextInvalid:l,isRequired:e.isRequired,additionalControls:e.additionalControls,children:(0,z.jsx)(oa,{id:t,"data-cy":t??name,placeholder:e.placeholder,options:e.options,"aria-describedby":t?`${t}-form-group`:void 0,value:n,onSelect:a,isDisabled:c,footer:e.footer,isRequired:e.isRequired,disableSortOptions:e.disableSortOptions})})},rules:{required:r,validate:e.validate}})}function wc(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),[n,a]=(0,l.useContext)(ve),s=(0,l.useCallback)((e=>(a(e),t(".."),Promise.resolve())),[t,a]),o=(0,l.useCallback)((()=>t("..")),[t]),i=xc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("User preferences"),titleHelp:e("Per user preferences.")}),(0,z.jsx)(uo,{defaultValue:{...i.reduce(((e,t)=>({...e,[t.name]:t.defaultValue})),{}),...n},submitText:e("Save user preferences"),onCancel:o,onSubmit:s,children:i.map((t=>(0,z.jsx)(vc,{id:t.name.toLowerCase(),name:t.name,label:t.label,placeholder:e("Select {{label}}",{label:t.label}),options:t.options,labelHelp:t.helpText,isRequired:!0,defaultValue:t.defaultValue},t.name)))})]})}function kc(e){const{t}=(0,I.Bd)(),n=gr();return(0,l.useMemo)((()=>[{header:t("Name"),cell:t=>(0,z.jsx)(Fe,{to:e?.disableLinks?void 0:n(fc.RoleDetails,{params:{id:t.id}}),text:t.name}),sort:e?.disableSort?void 0:"name",card:"name",list:"name"},{header:t("Description"),type:"description",value:e=>e.description,sort:e?.disableSort?void 0:"description",card:"description",list:"description"},{header:t("Created"),cell:e=>(0,z.jsx)(Ie,{value:e.created}),sort:e?.disableSort?void 0:"created",defaultSortDirection:"desc",modal:Ut.hidden},{header:t("Editable"),type:"text",value:e=>e.managed?t("Built-in"):t("Editable"),sort:e?.disableSort?void 0:"managed",defaultSortDirection:"asc",card:"subtitle",list:"subtitle",modal:Ut.hidden}]),[t,e?.disableSort,e?.disableLinks,n])}function Sc(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({content_types:{"awx.credential":{displayName:e("Credential"),permissions:{"awx.use_credential":e("Use credential"),"awx.change_credential":e("Change credential"),"awx.delete_credential":e("Delete credential"),"awx.view_credential":e("View credential")}},"awx.executionenvironment":{displayName:e("Execution environment"),permissions:{"awx.change_executionenvironment":e("Change execution environment"),"awx.delete_executionenvironment":e("Delete execution environment"),"awx.view_executionenvironment":e("View execution environment")}},"awx.instancegroup":{displayName:e("Instance group"),permissions:{"awx.use_instancegroup":e("Use instance group"),"awx.change_instancegroup":e("Change instance group"),"awx.delete_instancegroup":e("Delete instance group"),"awx.view_instancegroup":e("View instance group")}},"awx.inventory":{displayName:e("Inventory"),permissions:{"awx.use_inventory":e("Use inventory"),"awx.adhoc_inventory":e("Ad hoc inventory"),"awx.update_inventory":e("Update inventory"),"awx.change_inventory":e("Change inventory"),"awx.delete_inventory":e("Delete inventory"),"awx.view_inventory":e("View inventory")}},"awx.jobtemplate":{displayName:e("Job template"),permissions:{"awx.execute_jobtemplate":e("Execute job template"),"awx.change_jobtemplate":e("Change job template"),"awx.delete_jobtemplate":e("Delete job template"),"awx.view_jobtemplate":e("View job template")}},"awx.notificationtemplate":{displayName:e("Notification template"),permissions:{"awx.change_notificationtemplate":e("Change notification template"),"awx.delete_notificationtemplate":e("Delete notification template"),"awx.view_notificationtemplate":e("View notification template")}},"shared.organization":{displayName:e("Organization"),permissions:{"shared.member_organization":e("Member organization"),"shared.audit_organization":e("Audit organization"),"shared.change_organization":e("Change organization"),"shared.delete_organization":e("Delete organization"),"shared.view_organization":e("View organization"),"awx.update_project":e("Update project"),"awx.use_project":e("Use project"),"awx.add_project":e("Add project"),"awx.change_project":e("Change project"),"awx.delete_project":e("Delete project"),"awx.view_project":e("View project"),"shared.member_team":e("Member team"),"shared.add_team":e("Add team"),"shared.change_team":e("Change team"),"shared.delete_team":e("Delete team"),"shared.view_team":e("View team"),"awx.execute_workflowjobtemplate":e("Execute workflow job template"),"awx.approve_workflowjobtemplate":e("Approve workflow job template"),"awx.add_workflowjobtemplate":e("Add workflow job template"),"awx.change_workflowjobtemplate":e("Change workflow job template"),"awx.delete_workflowjobtemplate":e("Delete workflow job template"),"awx.view_workflowjobtemplate":e("Delete workflow job template"),"awx.execute_jobtemplate":e("Execute job template"),"awx.change_jobtemplate":e("Change job template"),"awx.delete_jobtemplate":e("Delete job template"),"awx.view_jobtemplate":e("View job template"),"awx.use_inventory":e("Use inventory"),"awx.adhoc_inventory":e("Ad hoc inventory"),"awx.update_inventory":e("Update inventory"),"awx.add_inventory":e("Add inventory"),"awx.change_inventory":e("Change inventory"),"awx.delete_inventory":e("Delete inventory"),"awx.view_inventory":e("View inventory"),"awx.use_credential":e("Use credential"),"awx.add_credential":e("Add credential"),"awx.change_credential":e("Change credential"),"awx.delete_credential":e("Delete credential"),"awx.view_credential":e("View credential"),"awx.add_notificationtemplate":e("Add notification template"),"awx.change_notificationtemplate":e("Change notification template"),"awx.delete_notificationtemplate":e("Delete notification template"),"awx.view_notificationtemplate":e("View notification template"),"awx.add_executionenvironment":e("Add execution environment"),"awx.change_executionenvironment":e("Change execution environment"),"awx.delete_executionenvironment":e("Delete execution environment"),"awx.view_executionenvironment":e("View execution environment")}},"awx.project":{displayName:e("Project"),permissions:{"awx.update_project":e("Update project"),"awx.use_project":e("Use project"),"awx.change_project":e("Change project"),"awx.delete_project":e("Delete project"),"awx.view_project":e("View project")}},"shared.team":{displayName:e("Team"),permissions:{"shared.member_team":e("Member team"),"shared.change_team":e("Change team"),"shared.delete_team":e("Delete team"),"shared.view_team":e("View team")}},"awx.workflowjobtemplate":{displayName:e("Workflow job template"),permissions:{"awx.execute_workflowjobtemplate":e("Execute workflow job template"),"awx.approve_workflowjobtemplate":e("Approve workflow job template"),"awx.change_workflowjobtemplate":e("Change workflow job template"),"awx.delete_workflowjobtemplate":e("Delete workflow job template"),"awx.view_workflowjobtemplate":e("View workflow job template")}}}})),[e])}function Cc(e){const{role:t}=e,n=Sc();return(0,z.jsx)($t.B,{isHorizontal:!0,horizontalTermWidthModifier:{default:"12ch",sm:"15ch",md:"20ch",lg:"28ch",xl:"30ch","2xl":"35ch"},"data-cy":"permissions-description-list",children:(0,z.jsx)(At.W,{children:t.content_type&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Dt.X,{"data-cy":t.content_type,style:{fontWeight:"normal"},children:n.content_types[t.content_type]?.displayName||t.content_type},t.content_type),(0,z.jsx)(Et.d,{children:!!t?.permissions.length&&(0,z.jsx)(De.o,{numLabels:3,children:t?.permissions.map((e=>(0,z.jsx)(Ee.J,{"data-cy":e,children:n.content_types[t.content_type]?.permissions[e]||e},e)))})})]})},t?.content_type)})}var Tc=n(57930);function Ic(e){const{error:t,handleRefresh:n}=e,{t:a}=(0,I.Bd)();return(0,z.jsxs)(rn.p,{isFullHeight:!0,children:[(0,z.jsx)(ln.o,{titleText:(0,z.jsx)(z.Fragment,{children:t?.message}),icon:(0,z.jsx)(cn.q,{icon:an.$Q}),headingLevel:"h4"}),(0,z.jsxs)(un.s,{children:[t instanceof Xr&&t.details&&(0,z.jsx)(dn.h,{children:t.details}),n&&(0,z.jsx)(g.$n,{variant:"primary",onClick:n,icon:(0,z.jsx)(Tc.Fj,{}),children:a("Refresh")})]})]})}function Ac(){const{t:e}=(0,I.Bd)(),t=kc({disableLinks:!0}),n=(0,Re.g)(),{data:a,error:s,refresh:o}=tc(xl`/role_definitions/`,n.id);return s?(0,z.jsx)(Ic,{error:s,handleRefresh:o}):a?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Mt,{disableScroll:!0,children:(0,z.jsx)(Kt,{item:a,columns:t})}),(0,z.jsx)(Mt,{disableScroll:!0,numberOfColumns:"single",children:(0,z.jsx)(Ft,{label:e("Permissions"),children:(0,z.jsx)(Cc,{role:a})})})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}var Dc=n(9228),Ec=n(34549),Pc=n(39931),Rc=n(13474);const Bc="persistent-filter";function Fc(e){const[t,n]=(0,l.useState)(window.location.search);(0,l.useEffect)((()=>{window.location.search!==t&&n(window.location.search)})),(0,l.useEffect)((()=>{const t={pageKey:e,qs:window.location.search};sessionStorage.setItem(Bc,JSON.stringify(t))}),[t,e])}function Nc(e){const t=yr(),n=(0,Re.Zp)(),s=gr(),o=(0,Re.zy)(),{setTabBreadcrumb:i}=Mi(),r=e.tabs.find((t=>t&&(s(t.page,{params:e.params})===o.pathname||o.pathname.includes(s(t.page,{params:e.params})))));(0,l.useEffect)((()=>{if(r)return i({label:r.label}),()=>i(void 0);i(void 0)}),[r,i]);const[c]=(0,a.ok)(),d={};if(e.sharedQueryKeys)for(const t of e.sharedQueryKeys)d[t]=c.get(t)||"";const u=function(e){const t={},n=("?"===e[0]?e.substr(1):e).split("&");for(let e=0;e<n.length;e++){const a=n[e].split("=");if(a.length<2)continue;const s=decodeURIComponent(a[0]),o=decodeURIComponent(a[1]||"");t[s]=decodeURIComponent(o)}return t}(function(e){const t=sessionStorage.getItem(Bc),n=t?JSON.parse(t):{qs:""};return n.pageKey===e?n.qs:""}(e.backTab?.persistentFilterKey)),m=e.tabs.filter((e=>!!e)).map((t=>t?(0,z.jsx)(Dc.o,{eventKey:t.page,title:t.label,href:s(t.page,{params:e.params,query:d}),"data-cy":t.dataCy},t.page):null));return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(Ec.t,{onSelect:(a,o)=>{a.preventDefault(),o===e.backTab?.page?n(s(o.toString(),{params:e.params,query:u})):t(o.toString(),{params:e.params,query:d})},inset:{default:"insetSm"},isBox:void 0===e.isBox||e.isBox,activeKey:r?r.page:void 0,style:{backgroundColor:"var(--pf-v5-c-tabs__link--BackgroundColor)",flexShrink:0},children:[e.backTab&&(0,z.jsx)(Dc.o,{eventKey:e.backTab.page,title:(0,z.jsxs)(Pc.V,{children:[(0,z.jsx)(Rc.eC,{}),(0,z.jsx)("span",{style:{marginLeft:6},children:e.backTab.label})]}),href:s(e.backTab.page,{params:e.params,query:u}),"data-cy":e.backTab.label.replace(" ","-").toLocaleLowerCase()},e.backTab.page),m]}),(0,z.jsx)("div",{style:{flexGrow:1,overflow:"hidden"},children:(0,z.jsx)(Ui,{children:(0,z.jsx)(Re.sv,{context:e.componentParams})})})]})}var $c=n(37653);const Mc=e=>{const t=[],n=[];if(Qr(e)&&"object"==typeof e.json&&null!==e.json){const a=e.json;if("detail"in a)Array.isArray(a.detail)?t.push({message:a.detail[0]}):t.push({message:a.detail});else if("__all__"in a)Array.isArray(a.__all__)?t.push({message:a.__all__[0]}):t.push({message:a.__all__});else if("inputs"in a){const e=a.inputs;Array.isArray(e)?e.forEach((e=>{"string"==typeof e&&t.push({message:e})})):"object"==typeof e&&null!==e&&Object.entries(e).forEach((([e,t])=>{"string"==typeof t?n.push({name:e,message:t}):Array.isArray(t)&&t.length>0&&n.push({name:e,message:t[0]})}))}else if("module_args"in a)t.push({message:a.module_args});else if("error"in a)Array.isArray(a.error)?t.push({message:a.error[0]}):t.push({message:a.error});else for(const e in a){let t=a[e];"string"==typeof t?n.push({name:e,message:t}):Array.isArray(t)&&(t=t[0],n.push({name:e,message:String(t)}))}}else e instanceof Error&&t.push({message:e.message});return{genericErrors:t,fieldErrors:n}},Lc=()=>Ks(Mc);function Oc(e){return e.id}function zc(e){const{t}=(0,I.Bd)(),n=kc({disableLinks:!0,disableSort:!0}),a=(0,l.useMemo)((()=>[{header:t("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name}),card:"name",list:"name"}]),[t]),{activeAwxUser:s}=_l(),o=Lc(),i=e=>e.managed?t("Built-in roles cannot be deleted."):"",r=()=>s?.is_superuser?"":t("You do not have permission to edit this role. Please contact your organization administrator if there is an issue with your access.");return s=>{const l=s.filter((e=>e.managed)),c=s.filter((e=>!e.managed)).filter(r);o({title:t("Permanently delete roles",{count:s.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} roles.",{count:s.length-l.length-c.length}),actionButtonText:t("Delete roles",{count:s.length-l.length-c.length}),items:s.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length||c.length?[...l.length?[t("{{count}} of the selected roles cannot be deleted because they are built-in.",{count:l.length})]:[],...c.length?[t("{{count}} of the selected roles cannot be deleted due to insufficient permissions.",{count:c.length})]:[]]:void 0,isItemNonActionable:e=>i(e)?i(e):r(),keyFn:Oc,isDanger:!0,confirmationColumns:n,actionColumns:a,onComplete:e,actionFn:(e,t)=>ol(xl`/role_definitions/${e.id.toString()}/`,t)})}}function Hc(e){const{t}=(0,I.Bd)(),{activeAwxUser:n}=_l(),a=zc(e),i=gr();return(0,l.useMemo)((()=>[{type:s.Link,selection:o.Single,icon:yc.oo,isPinned:!0,variant:g.Ak.primary,label:t("Edit role"),isDisabled:e=>e.managed?t("Built-in roles cannot be edited."):n?.is_superuser?void 0:t("You do not have permission to edit this role. Please contact your organization administrator if there is an issue with your access."),href:e=>i(fc.EditRole,{params:{id:e.id??""}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete role"),isDisabled:e=>e.managed?t("Built-in roles cannot be deleted."):n?.is_superuser?void 0:t("You do not have permission to delete this role. Please contact your organization administrator if there is an issue with your access."),onClick:e=>a([e]),isDanger:!0}]),[a,i,t,n?.is_superuser])}function qc(e){const t=gr(),{t:n}=(0,I.Bd)(),a=(0,Re.g)(),s=yr(),{data:o,error:i,refresh:r}=tc(xl`/role_definitions/`,a.id),l=Hc((()=>{s(fc.Roles)}));return i?(0,z.jsx)(Ic,{error:i,handleRefresh:r}):o?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name,breadcrumbs:[{label:e.breadcrumbLabelForPreviousPage||n("Roles"),to:t(fc.Roles)},{label:o?.name}],headerActions:(0,z.jsx)(oe,{actions:l,position:te.nU.right,selectedItem:o})}),(0,z.jsx)(Nc,{backTab:{label:e.backTabLabel||n("Back to Roles"),page:fc.Roles,persistentFilterKey:"awx-roles"},tabs:[{label:n("Details"),page:fc.RoleDetails}],params:{id:a.id??""}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Uc(e){let{url:t}=e;const{toolbarFilters:n,tableColumns:a,disableQueryString:s}=e;let o=e.defaultSort,i=e.defaultSortDirection;if(a&&a.length){const e=a.find((e=>e.defaultSort))??a[0];o=e?.sort,i=e?.defaultSortDirection}const r=Ur({defaultValues:{sort:o,sortDirection:i},disableQueryString:s}),c=(0,l.useRef)({itemCount:void 0}),{page:d,perPage:u,sort:m,sortDirection:p,filterState:h}=r;let b=e?.queryParams&&Object.keys(e.queryParams).length?`?${f=e.queryParams,Object.entries(f).map((([e,t=""])=>Array.isArray(t)?t.map((t=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"):`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}`:"";var f;if(h)for(const e in h){const t=n?.find((t=>t.key===e));if(t){let n=h[e];if(n&&(n=n.filter((e=>null!==e))),n&&n.length>0)if(b+=b?"&":"?","object1__in"===t.query)1===n.length&&n.some((e=>""!==e))&&(b+=`or__object1__in=${n[0].split("+").join(",")}&or__object2__in=${n[0].split("+").join(",")}`);else if("search"===t.query)b+=n.map((e=>`${t.query}=${e}`)).join("&");else if(n.length>1)t.type===Ia.DateRange?b+=`${t.query}__gte=${n[0]}&${t.query}__lte=${n[1]}`:b+=n.map((e=>`or__${t.query}=${e}`)).join("&");else if(t.type===Ia.DateRange){const e=new Date(Date.now());switch(e.setSeconds(0),e.setMilliseconds(0),n[0]){case ha.LastHour:b+=`${t.query}__gte=${new Date(e.getTime()-36e5).toISOString()}`;break;case ha.Last24Hours:b+=`${t.query}__gte=${new Date(e.getTime()-864e5).toISOString()}`;break;case ha.LastWeek:b+=`${t.query}__gte=${new Date(e.getTime()-6048e5).toISOString()}`;break;case ha.LastMonth:b+=`${t.query}__gte=${new Date(e.getTime()-2592e6).toISOString()}`}}else b+=`${t.query}=${n[0]}`}}m&&!b.includes("order_by")&&(b+=b?"&":"?",b+="desc"===p?`order_by=-${m}`:`order_by=${m}`),b+=b?"&":"?",b+=`page=${d}`,b+=b?"&":"?",b+=`page_size=${u}`,t+=b;const g=rl(),y=(0,_e.Ay)(t,g,cl),{data:x,mutate:j}=y,_=(0,l.useCallback)((async()=>{await j().finally((()=>{}))}),[j]);(0,_e.Ay)(x?.next,g,cl);let v=y.error;v instanceof Xr&&404===v.statusCode&&r.page>1&&(r.setPage(1),v=void 0);const w=os(x?.results??[],ll,e.defaultSelection);void 0!==x?.count&&(c.current.itemCount=x?.count);const k=(0,l.useCallback)((e=>{w.selectItems(e),_()}),[_,w]),S=(0,l.useCallback)((e=>{w.unselectItems(e),_()}),[_,w]),[C,T]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{T(x?.results)}),[x?.results]);const I=(0,l.useCallback)((e=>{if(!C)return;const t=C?.findIndex((t=>t.id===e.id));if(-1!==t){const n=[...C];n[t]=e,T(n)}}),[C]);return(0,l.useMemo)((()=>({refresh:_,itemCount:c.current.itemCount,pageItems:C,error:v,...r,...w,selectItemsAndRefresh:k,unselectItemsAndRefresh:S,limitFiltersToOneOrOperation:!0,updateItem:I})),[v,C,_,k,w,S,I,r])}var Wc=n(94935);function Jc(e){const{role:t}=e,{data:n}=ec(xl`/role_definitions/${t.id?.toString()??""}/`);return n?(0,z.jsx)(Wc.g,{children:(0,z.jsx)(Cc,{role:n})}):(0,z.jsx)(Wc.g,{children:(0,po.t)("Loading...")})}function Vc(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Roles"),titleHelpTitle:e("Roles"),titleHelp:e("A role represents a set of actions that a team or user may perform on a resource or set of resources."),description:e("A role represents a set of actions that a team or user may perform on a resource or set of resources.")}),(0,z.jsx)(le.F,{variant:"info",title:e("Roles can be assigned to teams and users from the teams and users pages."),isInline:!0,className:"border-bottom"}),(0,z.jsx)(Gc,{}),";"]})}function Gc(){const{t:e}=(0,I.Bd)(),t=kc(),n=(0,l.useMemo)((()=>[{key:"name",label:e("Name"),type:Ia.MultiText,query:"name__icontains",comparison:"contains"},{key:"editable",label:e("Editable"),type:Ia.SingleSelect,query:"managed",options:[{label:e("Editable"),value:"false"},{label:e("Built-in"),value:"true"}],placeholder:e("Filter by editability")}]),[e]),a=Uc({url:xl`/role_definitions/`,toolbarFilters:n,tableColumns:t}),i=function(e){const{t}=(0,I.Bd)(),{activeAwxUser:n}=_l(),a=gr(),i=zc(e);return(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,isPinned:!0,icon:Za.GY,label:t("Create role"),isDisabled:n?.is_superuser?void 0:t("You do not have permission to create a role. Please contact your system administrator if there is an issue with your access."),href:`${a(fc.CreateRole)}`,variant:g.Ak.primary},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete roles"),onClick:i,isDanger:!0}]),[i,a,t,n?.is_superuser])}(a.unselectItemsAndRefresh),r=Hc(a.unselectItemsAndRefresh);return(0,z.jsx)($s,{...a,tableColumns:t,toolbarActions:i,rowActions:r,toolbarFilters:n,expandedRow:e=>(0,z.jsx)(Jc,{role:e}),errorStateTitle:e("Error loading roles"),emptyStateTitle:e("No roles found"),defaultSubtitle:e("Role")})}function Yc(e){const t=M(e),{control:n,formState:a}=(0,oo.xW)(),{isSubmitting:s,isValidating:o}=a,[i]=W(),r=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:e.name,control:n,shouldUnregister:!0,render:({field:{value:n,onChange:a},fieldState:{error:r}})=>{const l=r?.message?e.validate&&o?i.validating:r?.message:void 0;let c=e.isDisabled;return!c&&e.isReadOnly&&(c=(0,po.t)("Readonly")),s&&(c=(0,po.t)("Submitting")),(0,z.jsx)(Vo,{fieldId:t,label:e.label,labelHelpTitle:e.labelHelpTitle??e.label,labelHelp:e.labelHelp,helperText:e.helperText,helperTextInvalid:l,isRequired:e.isRequired,additionalControls:e.additionalControls,children:(0,z.jsx)(Xn,{id:t,"data-cy":t??name,placeholder:e.placeholder,options:e.options,"aria-describedby":t?`${t}-form-group`:void 0,values:n,onSelect:e=>a(e(n)),isDisabled:c,footer:e.footer,disableSortOptions:e.disableSortOptions})})},rules:{required:r,validate:e.validate}})}function Kc(e){const t=(0,oo.FH)({name:e.watch});return e.hidden(t)?(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(z.Fragment,{children:e.children})}function Zc(){const{cache:e}=(0,_e.iX)();(0,l.useEffect)((()=>()=>e.clear?.()),[e])}function Xc(){const{cache:e}=(0,_e.iX)();return{clearAllCache:(0,l.useCallback)((()=>{for(const t of e.keys())e.delete(t)}),[e]),clearCacheByKey:(0,l.useCallback)((t=>{for(const n of e.keys())"string"==typeof n&&Qc(n)===Qc(t)&&e.delete(n)}),[e])}}function Qc(e){return e.includes("?")?e.split("?")[0]:e}function ed(){const{clearCacheByKey:e}=Xc();return async(t,n,a)=>{const s=await tl({url:t,method:"PATCH",body:n,signal:a});if(!s.ok)throw await Zr(s);return e(t),204===s.status?null:s.headers.get("content-type")?.includes("application/json")?await s.json():s.headers.get("content-type")?.includes("text/plain")?await s.text():await s.blob()}}function td(){const{clearCacheByKey:e}=Xc();return async(t,n,a)=>{const s=await tl({url:t,method:"POST",body:n,signal:a});if(!s.ok)throw await Zr(s);return e(t),204===s.status?null:s.headers.get("content-type")?.includes("application/json")?await s.json():s.headers.get("content-type")?.includes("text/plain")?await s.text():await s.blob()}}function nd(e){return(0,z.jsx)(uo,{...e,errorAdapter:Mc})}function ad(e){const{t}=(0,I.Bd)(),n=(0,Re.Zp)(),a=yr();Zc();const s=td(),o=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("Create role"),breadcrumbs:[{label:e.breadcrumbLabelForPreviousPage||t("Roles"),to:o(fc.Roles)},{label:t("Create role")}]}),(0,z.jsx)(nd,{submitText:t("Create role"),onSubmit:async e=>{const t=await s(xl`/role_definitions/`,e);a(fc.RoleDetails,{params:{id:t.id}})},cancelText:t("Cancel"),onCancel:()=>n(-1),children:(0,z.jsx)(od,{})})]})}function sd(e){const{t}=(0,I.Bd)(),n=(0,Re.Zp)(),a=yr(),s=(0,Re.g)(),o=Number(s.id),{data:i}=ec(xl`/role_definitions/${o.toString()}/`);Zc();const r=ed(),l=gr();if(Number.isInteger(o))return i?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:i?.name?t("Edit {{roleName}}",{roleName:i?.name}):t("Roles"),breadcrumbs:[{label:t("Roles"),to:l(fc.Roles)},{label:i?.name?t("Edit {{roleName}}",{roleName:i?.name}):t("Roles")}]}),(0,z.jsx)(nd,{submitText:t("Save role"),onSubmit:async e=>{await r(xl`/role_definitions/${o.toString()}/`,e),a(fc.RoleDetails,{params:{id:o}})},cancelText:t("Cancel"),onCancel:()=>n(-1),defaultValue:i,children:(0,z.jsx)(od,{disableContentType:!0})})]}):(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{breadcrumbs:[{label:e.breadcrumbLabelForPreviousPage||t("Roles"),to:l(fc.Roles)},{label:t("Edit Role")}]})})}function od(e){const{t}=(0,I.Bd)(),{disableContentType:n}=e,a=Sc(),s=(0,oo.FH)({name:"content_type"});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:t("Name"),isRequired:!0}),(0,z.jsx)(li,{name:"description",label:t("Description")}),(0,z.jsx)(ti,{name:"content_type",label:t("Content type"),placeholderText:t("Select a content type"),options:Object.entries(a.content_types).filter((([e])=>"shared.team"!==e)).map((([e,t])=>({label:t?.displayName,value:e}))),isDisabled:n,isRequired:!0}),(0,z.jsx)(Kc,{watch:"content_type",hidden:e=>!e,children:(0,z.jsx)(Yc,{name:"permissions",label:t("Permissions"),options:Object.entries(a.content_types[s]?.permissions||{}).map((([e,t])=>({label:t,value:e}))),placeholder:t("Select permissions"),isRequired:!0})})]})}var id=n(83579),rd=n(58168),ld=n(66883);const cd=({type:e})=>{const t=gr(),n=(0,Re.Zp)();return(0,z.jsx)(g.$n,{variant:"link",style:{padding:0,marginTop:1,marginLeft:8,verticalAlign:"top"},onClick:()=>n(t(fc.ActivityStream,{query:{type:e}})),children:(0,z.jsx)(ld.os,{})})};function dd(e,t){const n=function(){const e=(0,l.useRef)({});return(0,l.useEffect)((()=>{const t=e;return()=>t.current.abortController?.abort()}),[]),(0,l.useCallback)((async(e,t)=>{const n=await tl({url:e,method:"OPTIONS",signal:t});if(!n.ok)throw await Zr(n);return 204===n.status?null:n.headers.get("content-type")?.includes("application/json")?await n.json():n.headers.get("content-type")?.includes("text/plain")?await n.text():await n.blob()}),[])}();e+=dl(t);const[a,s]=(0,l.useState)(void 0),[o,i]=(0,l.useState)(void 0),[r,c]=(0,l.useState)(!0);return(0,l.useEffect)((()=>{e&&n(e).then((e=>s(e))).catch((e=>i(e instanceof Error?e:new Error("Unknown error")))).finally((()=>c(!1)))}),[n,e]),(0,l.useMemo)((()=>({data:a,error:o,isLoading:r})),[a,o,r])}const ud=["UI_NEXT","MAX_UI_JOB_EVENTS","UI_LIVE_UPDATES_ENABLED","BULK_JOB_MAX_LAUNCH","BULK_HOST_MAX_CREATE","BULK_HOST_MAX_DELETE","CUSTOM_LOGIN_INFO","CUSTOM_LOGO"];function md(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{id:"system",name:e("System Settings"),description:e("System settings plus analytics."),defaultSlugs:["system"],categories:[]},{id:"jobs",name:e("Job Settings"),description:e("Job settings and limits."),defaultSlugs:["jobs"],categories:[]},{id:"logging",name:e("Logging Settings"),description:e("Controller logging settings."),defaultSlugs:["logging"],categories:[]},{id:"debug",name:e("Troubleshooting Settings"),description:e("Debugging and troubleshooting settings."),defaultSlugs:["debug"],categories:[]},{id:"authentication",name:e("Authentication Providers"),defaultSlugs:["authentication","azuread-oauth2","github","github-org","github-team","google-oauth2","github-enterprise","github-enterprise-org","github-enterprise-team","ldap","oidc","radius","saml","tacacsplus"],categories:[]},{id:"other",name:e("Other"),categories:[]}]),[e])}function pd(){const e=md(),t=dd(xl`/settings/all/`),n=(0,l.useMemo)((()=>{if(!t.data?.actions.PUT)return;if(!t.data?.actions.GET)return;const{actions:e}=t.data,n=Object.keys(e.GET),a=Object.keys(e.PUT),s=n.filter((t=>!a.includes(t)&&e.GET[t].defined_in_file));return[...a,...s].reduce(((t,n)=>{if(ud.includes(n))return t;const a=s.includes(n)?e.GET[n]:e.PUT[n];return t[n]=a,t}),{})}),[t.data]),a=(0,l.useMemo)((()=>{let a=JSON.parse(JSON.stringify(e));if(t.isLoading)return e;if(t.error)return e;if(!n)return e;for(const e of Object.values(n)){const t=e.category,n=e.category_slug;let s=a.find((e=>e.defaultSlugs?.includes(n)));s||(s=a.find((e=>"Other"===e.name)),s||(s={id:"other",name:"Other",categories:[]},a.push(s)));let o=s.categories.find((e=>e.name===t));o||(o={id:t.toLowerCase().replace(/ /g,"-"),name:t,slugs:[]},s.categories.push(o)),o.slugs.push(n)}return a=a.filter((e=>e.categories.length>0)),a.forEach((e=>e.categories.sort(((t,n)=>(e.defaultSlugs?.indexOf(t.slugs[0])??-1)-(e.defaultSlugs?.indexOf(n.slugs[0])??-1))))),a}),[e,n,t.error,t.isLoading]);return(0,l.useMemo)((()=>({isLoading:t.isLoading,error:t.error,groups:a,options:n})),[a,t.error,t.isLoading,n])}function hd(){const{t:e}=(0,I.Bd)(),{isLoading:t,error:n,groups:a}=pd();if(n)return(0,z.jsx)(Ic,{error:n});if(t||!a)return(0,z.jsx)(zr,{});const s=a.find((e=>"authentication"===e.id));return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Authentication Methods"),headerActions:(0,z.jsx)(cd,{type:"setting"})}),(0,z.jsx)(ze,{children:(0,z.jsx)(Oe.d8,{isWidthLimited:!0,children:(0,z.jsx)(ee.B,{children:(0,z.jsx)(bd,{groups:[s]})})})})]})}function bd(e){const t=gr();return(0,z.jsx)(z.Fragment,{children:e.groups.map((e=>(0,z.jsxs)(We.Z,{isRounded:!0,isFlat:!0,children:[e.name&&(0,z.jsxs)(Je.a,{children:[(0,z.jsx)(bs.Z,{children:1===e.categories.length?(0,z.jsx)(Ge.h,{headingLevel:"h3",children:(0,z.jsx)(a.N_,{to:t(fc.SettingsCategory,{params:{category:e.categories[0].id}}),children:e.name})}):(0,z.jsx)(Ge.h,{headingLevel:"h3",children:e.name})}),e.description&&(0,z.jsx)("p",{style:{opacity:.7,fontSize:"smaller",marginTop:2},children:e.description})]}),1!==e.categories.length&&(0,z.jsx)(fs.b,{children:(0,z.jsx)(id.B8,{isPlain:!0,children:e.categories.map((e=>(0,z.jsx)(rd.c,{children:(0,z.jsx)(a.N_,{to:t(fc.SettingsCategory,{params:{category:e.id}}),children:e.name})},e.name)))})})]},e.id)))})}function fd(e){const{isLoading:t,error:n,groups:a,options:i}=pd(),{categoryId:r}=e,c=a.find((e=>e.categories.some((e=>e.id===r)))),d=c?.categories.find((e=>e.id===r)),u=ec(xl`/settings/all/`),{t:m}=(0,I.Bd)(),p=(0,Re.Zp)(),h=(0,l.useMemo)((()=>{const e={};if(d&&i)for(const[t,n]of Object.entries(i))d?.slugs.includes(n.category_slug)&&(e[t]=n);return e}),[d,i]),b=md(),f=(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,icon:yc.oo,label:m("Edit"),onClick:()=>p("./edit",{replace:!0}),isPinned:!0}]),[p,m]);if(n)return(0,z.jsx)(Ic,{error:n});if(t||!c||!d)return(0,z.jsx)(zr,{});if(u.error)return(0,z.jsx)(Ic,{error:u.error});if(u.isLoading||!u.data)return(0,z.jsx)(zr,{});const y=b.find((e=>e.id===r))?.name;return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:y??d.name,headerActions:(0,z.jsx)(oe,{actions:f,position:te.nU.right})}),(0,z.jsx)(gd,{options:h,data:u.data})]})}function gd(e){return(0,z.jsx)(Mt,{children:Object.entries(e.options).map((([t,n])=>(0,z.jsx)(yd,{option:n,data:e.data,name:t},t)))})}function yd(e){const t=e.option;switch(t.type){case"string":case"field":case"integer":return(0,z.jsx)(Ft,{label:t.label,children:e.data[e.name]});case"boolean":return(0,z.jsx)(Ft,{label:t.label,children:e.data[e.name]?(0,po.t)("Enabled"):(0,po.t)("Disabled")});case"list":return 0===e.data[e.name].length?null:(0,z.jsx)(Ft,{label:t.label,children:e.data[e.name].map(((e,t)=>(0,z.jsx)("div",{children:e},t)))});case"nested object":return 0===Object.keys(e.data[e.name]).length?null:(0,z.jsx)(Ft,{label:t.label,fullWidth:!0,children:(0,z.jsx)("pre",{children:So.Ay.dump(e.data[e.name])})});case"certificate":return(0,z.jsx)("div",{style:{color:"red"},children:(0,z.jsx)(Ft,{label:t.label,children:t.type})});case"choice":{const n=t.choices.find((t=>t[0]===e.data[e.name]||!e.data[e.name]&&""===t[0]));return(0,z.jsx)(Ft,{label:t.label,children:n?.[1]})}case"datetime":return e.data[e.name]?(0,z.jsxs)(Ft,{label:t.label,children:[new Date(e.data[e.name]).toLocaleDateString(),"  ",new Date(e.data[e.name]).toLocaleTimeString()]}):null;default:return(0,z.jsx)("pre",{style:{color:"red"},children:JSON.stringify(t,null,2)})}}var xd=n(23215),jd=n(79752);function _d(e){const[t,n]=(0,l.useState)(e.defaultCollapsed),a=(0,l.useMemo)((()=>e.isHorizontal?["pf-m-12-col","pf-v5-c-form","pf-m-horizontal"]:["pf-m-12-col","pf-v5-c-form"]),[e.isHorizontal]),s=(0,l.useMemo)((()=>e.isHorizontal?["pf-v5-c-form","pf-m-horizontal"]:["pf-v5-c-form"]),[e.isHorizontal]);return e.title?(0,z.jsx)(jd.y,{title:(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.canCollapse&&(0,z.jsx)(zo,{isExpanded:!t,setExpanded:()=>n(!t),size:"lg"}),e.title]}),style:{marginTop:16},className:a.join(" "),children:(0,z.jsx)(mo,{singleColumn:e.singleColumn,className:t?"pf-v5-u-display-none":void 0,children:e.children})}):(0,z.jsx)(xd.E,{span:12,className:s.join(" "),children:(0,z.jsx)(mo,{singleColumn:e.singleColumn,children:e.children})})}var vd=n(2670);function wd(e){const{label:t,labelHelpTitle:n,labelHelp:a,additionalControls:s,helperText:o,isRequired:i,validate:r,onInputChange:c}=e,{t:d}=(0,I.Bd)(),{control:u,formState:{isSubmitting:m,isValidating:p}}=(0,oo.xW)(),[h,b]=(0,l.useState)(""),[f,g]=(0,l.useState)(!1),[y,x]=(0,l.useState)(void 0),j=(0,l.useCallback)(((e,t)=>{b(t.name),c&&c(t).catch((e=>{x(e)}))}),[c]),_=e=>{g(!0)},v=M(e),w=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:e.name,control:u,shouldUnregister:!0,render:({field:{onChange:l,value:c},fieldState:{error:u}})=>{const x=u?.message?r&&p?d("Validating..."):u?.message:y?.message?y.message:void 0,w=t=>{b(""),l(void 0),e.onClearClick&&e.onClearClick(t)},k=e=>{g(!1),l(e)},S=t=>{"text"===e.type&&l(t)};return(0,z.jsx)(Vo,{fieldId:v,label:t,labelHelpTitle:n??t,labelHelp:a,additionalControls:s,helperText:o,helperTextInvalid:x,isRequired:i,children:e.icon&&void 0!==e.icon?(0,z.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10fr 1fr"},children:[(0,z.jsx)(vd.e,{dropzoneProps:e.dropzoneProps,id:v,"data-cy":v,type:e.type||"dataURL",value:c,hideDefaultPreview:e.hideDefaultPreview,filename:f?d("loading..."):h,filenamePlaceholder:e.placeholder,onFileInputChange:j,onDataChange:(e,t)=>S(t),onTextChange:(e,t)=>S(t),onReadStarted:(e,t)=>_(),onReadFinished:(e,t)=>k(t),onClearClick:w,allowEditingUploadedText:e.allowEditingUploadedText||!1,isReadOnly:e.isReadOnly||m,validated:u||y?"error":void 0,isDisabled:e.isDisabled,isClearButtonDisabled:e.isClearButtonDisabled}),e.icon,e.additionalHelperText?e.additionalHelperText:null]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(vd.e,{dropzoneProps:e.dropzoneProps,id:v,"data-cy":v,type:e.type||"dataURL",value:c,hideDefaultPreview:e.hideDefaultPreview,filename:f?d("loading..."):h,filenamePlaceholder:e.placeholder,onFileInputChange:j,onDataChange:(e,t)=>S(t),onTextChange:(e,t)=>S(t),onReadStarted:(e,t)=>_(),onReadFinished:(e,t)=>k(t),onClearClick:w,allowEditingUploadedText:e.allowEditingUploadedText||!1,isReadOnly:e.isReadOnly||m,validated:u?"error":void 0}),e.additionalHelperText?e.additionalHelperText:null]})})},rules:{required:w,validate:e.validate}})}function kd(){const{clearCacheByKey:e}=Xc(),t=(0,l.useRef)({});return(0,l.useEffect)((()=>{const e=t;return()=>e.current.abortController?.abort()}),[]),async(t,n)=>{const a=await tl({url:t,method:"DELETE",signal:n});if(!a.ok)throw await Zr(a);return e(t),204===a.status?null:a.headers.get("content-type")?.includes("application/json")?await a.json():a.headers.get("content-type")?.includes("text/plain")?await a.text():await a.blob()}}function Sd(e){const{categorySlugs:t,onComplete:n,popDialog:a}=e,{t:s}=(0,I.Bd)(),o=ue(),i=kd(),r=(0,l.useCallback)((async()=>{try{await Promise.all(t.map((async e=>{await i(xl`/settings/${e}/`)}))).then((()=>{n()}))}catch(e){const{genericErrors:t,fieldErrors:n}=Mc(e);o.addAlert({variant:"danger",title:s("Failed to revert settings"),children:(0,z.jsxs)(z.Fragment,{children:[t?.map((e=>e.message)),n?.map((e=>e.message))]})})}finally{a()}}),[s,o,t,i,n,a]);return(0,z.jsx)(Zt.a,{title:s("Revert settings"),titleIconVariant:"warning","data-cy":"revert-settings-modal","aria-label":s("Revert settings confirmation dialog"),variant:Zt.d.small,isOpen:!0,onClose:()=>a(),actions:[(0,z.jsx)(g.$n,{"data-cy":"delete-group-modal-delete-button",ouiaId:"delete-group-modal-delete-button",variant:"danger",onClick:()=>{r()},"aria-label":s`Confirm revert all`,children:s("Revert all")},"delete"),(0,z.jsx)(g.$n,{variant:"link",onClick:()=>a(),children:s("Cancel")},"cancel")],children:s("This will revert all configuration values on this page to their factory defaults. Are you sure you want to proceed?")})}function Cd(e){const t=(0,Re.Zp)(),n=ed(),a=function(){const{pushDialog:e,popDialog:t}=as(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{n?e((0,z.jsx)(Sd,{...n,popDialog:t})):t()}),[n,e,t]),a}(),s=(0,l.useCallback)((async a=>{const s={};for(const[t,n]of Object.entries(a))Object.keys(e.options).includes(t)&&(s[t]=n);await n(xl`/settings/all/`,s),t("..")}),[t,n,e.options]),{options:o,groups:i}=(0,l.useMemo)((()=>{const t={},n=[];for(const[a,s]of Object.entries(e.options))if(a.startsWith("AUTH_LDAP_1")||a.startsWith("AUTH_LDAP_2")||a.startsWith("AUTH_LDAP_3")||a.startsWith("AUTH_LDAP_4")||a.startsWith("AUTH_LDAP_5")){const e=a.substring(5,11).replace(/_/g," ");let t=n.find((t=>t.groupName===e));t||(t={groupName:e,options:{}},n.push(t)),t.options[a]=s}else if(a.startsWith("AUTH_LDAP")){const e=a.substring(5,9).replace(/_/g," ");let t=n.find((t=>t.groupName===e));t||(t={groupName:e,options:{}},n.push(t)),t.options[a]=s}else t[a]=s;return{options:t,groups:n}}),[e.options]),r=Object.entries(o).filter((([,e])=>"boolean"===e.type)).reduce(((e,[t,n])=>(e[t]=n,e)),{}),c=Object.entries(o).filter((([,e])=>"boolean"!==e.type)).reduce(((e,[t,n])=>(e[t]=n,e)),{});function d(e){const t=new Set;return Object.values(e).forEach((e=>{const n=e?.category_slug;n&&t.add(n)})),Array.from(t)}return(0,z.jsxs)(nd,{defaultValue:e.data,submitText:(0,po.t)("Save"),onCancel:()=>t(".."),onSubmit:s,additionalActions:(0,z.jsx)(g.$n,{variant:"secondary",onClick:e=>{e.preventDefault(),a({categorySlugs:d(o),onComplete:()=>t("..")})},children:(0,po.t)("Revert all to default")}),children:[Object.entries(c).map((([e,t])=>(0,z.jsx)(Td,{name:e,option:t},e))),Object.keys(r).length>0&&(0,z.jsx)(qo.g,{label:(0,po.t)("Options"),isStack:!0,role:"group",children:Object.entries(r).map((([e,t])=>(0,z.jsx)(Td,{name:e,option:t},e)))}),i.map((e=>(0,z.jsx)(_d,{title:e.groupName,canCollapse:!0,defaultCollapsed:"LDAP"!==e.groupName,children:Object.entries(e.options).map((([e,t])=>(0,z.jsx)(Td,{name:e,option:t},e)))},e.groupName)))]})}function Td(e){const t=e.option,n=e.option.defined_in_file;if(e.name.endsWith("SECRET")||e.name.endsWith("PASSWORD"))return(0,z.jsx)(li,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,isRequired:t.required,type:"password"});if(e.name.includes("SOCIAL_AUTH_SAML_SP_PUBLIC_CERT")||e.name.includes("SOCIAL_AUTH_SAML_SP_PRIVATE_KEY"))return(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(wd,{label:t.label,name:e.name,type:"text",labelHelpTitle:t.label,labelHelp:t.help_text,isRequired:t.required,allowEditingUploadedText:!0,isReadOnly:!1})});switch(t.type){case"string":case"field":return(0,z.jsx)(li,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,isRequired:t.required,defaultValue:t.default,enableUndo:!0,enableReset:!0});case"integer":return(0,z.jsx)(li,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,type:"number",isRequired:t.required,min:t.min_value,max:t.max_value,defaultValue:t.default,enableUndo:!0,enableReset:!0});case"boolean":return(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(go,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,defaultValue:t.default,enableReset:!0})});case"list":return(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,format:"object",isRequired:t.required,isArray:!0,defaultValue:t.default,enableUndo:!n,enableReset:!n,isReadOnly:n})});case"nested object":case"certificate":return(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,format:"object",isRequired:t.required,defaultValue:t.default,enableUndo:!0,enableReset:!0})});case"choice":return(0,z.jsx)(ti,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,options:t.choices.map((e=>({value:e[0],label:e[1]}))),isRequired:t.required,defaultValue:t.default,enableUndo:!0,enableReset:!0});case"datetime":return(0,z.jsx)(li,{label:t.label,name:e.name,labelHelpTitle:t.label,labelHelp:t.help_text,type:"datetime-local",isRequired:t.required,defaultValue:t.default,enableUndo:!0,enableReset:!0});default:return(0,z.jsx)("pre",{style:{color:"red"},children:JSON.stringify(t,null,2)})}}function Id(){const{category:e}=(0,Re.g)();return(0,z.jsx)(Ad,{categoryId:e??""})}function Ad(e){const{isLoading:t,error:n,groups:a,options:s}=pd(),{categoryId:o}=e,i=a.find((e=>e.categories.some((e=>e.id===o)))),r=i?.categories.find((e=>e.id===o)),c=ec(xl`/settings/all/`),d=(0,l.useMemo)((()=>{const e={};if(r&&s)for(const[t,n]of Object.entries(s))ud.includes(t)||r?.slugs.includes(n.category_slug)&&(e[t]=n);return e}),[r,s]),u=md();if(n)return(0,z.jsx)(Ic,{error:n});if(t||!i||!r)return(0,z.jsx)(zr,{});if(c.error)return(0,z.jsx)(Ic,{error:c.error});if(c.isLoading||!c.data)return(0,z.jsx)(zr,{});const m=u.find((e=>e.id===o))?.name;return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:m??r.name}),(0,z.jsx)(Cd,{options:d,data:c.data})]})}var Dd=n(50996),Ed=n(49609),Pd=n(88301),Rd=n(12793),Bd=n(30144),Fd=n(26309),Nd=n(23158),$d=n(15809),Md=n(26374),Ld=n(47652),Od=n(83236),zd=n(80308);function Hd(e){switch(e){case"hybrid":return Md.kf;case"execution":return Ld.XR;case"control":default:return Od.bN;case"hop":return zd.KD}}const qd=({element:e,onSelect:t,selected:n})=>{const a=e.getData(),s=a&&Hd(a.nodeType),o=(0,l.useMemo)((()=>{const n=a&&function(e){switch(e){case"ready":return(0,z.jsx)(nn.C1,{style:{fill:P}});case"installed":return(0,z.jsx)($d.O4,{style:{fill:F}});case"provisioning":return(0,z.jsx)(Za.GY,{style:{fill:N}});case"deprovisioning":return(0,z.jsx)(Nd.Kf,{style:{fill:N}});case"unavailable":case"deprovision-fail":case"provision-fail":return(0,z.jsx)(an.$Q,{style:{fill:R}});default:return(0,z.jsx)(Hl.GA,{style:{fill:N}})}}(a.nodeStatus);if(!n)return null;const{x:s,y:o}=(0,Dd.jqe)(Dd.CK5.upperLeft,e);return(0,z.jsx)(Dd.KjA,{x:s,y:o,radius:Dd.bQA,showBackground:!0,onClick:t,icon:(0,z.jsx)("g",{children:n}),ariaLabel:a?.nodeStatus})}),[a,e,t]);return(0,z.jsxs)(Dd.Icc,{element:e,onSelect:t,selected:n,onStatusDecoratorClick:t,truncateLength:20,children:[(0,z.jsx)("g",{transform:"translate(13, 13)",children:s&&(0,z.jsx)(s,{style:{color:"#393F44"},width:25,height:25})}),o]})},Ud=(0,A.Ay)(Pd.Z).withConfig({componentId:"ans__sc-v3otjg-0"})(["position:absolute;background:--pf-v5-global--BackgroundColor--100;width:240px;min-height:300px;position:absolute;left:255px;bottom:60px;border-radius:var(--pf-v5-global--BorderRadius--sm);box-shadow:var(--pf-v5-global--BoxShadow--sm);"]),Wd=()=>{const{t:e}=(0,I.Bd)(),t=Hd("control"),n=Hd("execution"),a=Hd("hybrid"),s=Hd("hop"),o=e=>{const{label:t,icon:n}=e;return(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{style:{marginRight:"10px"},children:n}),(0,z.jsx)("span",{children:t})]})};return(0,z.jsx)(Ud,{"data-cy":"mesh-viz-legend",children:(0,z.jsx)(Rd.s,{tabIndex:0,children:(0,z.jsx)(Bd.y,{children:(0,z.jsxs)($t.B,{children:[(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:e("Node types")}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Control"),icon:(0,z.jsx)(t,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Execution"),icon:(0,z.jsx)(n,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Hybrid"),icon:(0,z.jsx)(a,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Hop"),icon:(0,z.jsx)(s,{})})})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:e("Node status")}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Ready"),icon:(0,z.jsx)(nn.C1,{color:P})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Provisioning"),icon:(0,z.jsx)(Fd.uI,{color:N})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Deprovisioning"),icon:(0,z.jsx)(Nd.Kf,{color:N})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Installed"),icon:(0,z.jsx)($d.O4,{color:F})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Error"),icon:(0,z.jsx)(an.$Q,{color:R})})})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:e("Link status")}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Established"),icon:(0,z.jsx)("svg",{width:"20",height:"15",xmlns:"http://www.w3.org/2000/svg",children:(0,z.jsx)("line",{x1:"0",y1:"9",x2:"20",y2:"9",stroke:N,strokeWidth:"4"})})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Adding"),icon:(0,z.jsx)("svg",{width:"20",height:"15",xmlns:"http://www.w3.org/2000/svg",children:(0,z.jsx)("line",{x1:"0",y1:"9",x2:"20",y2:"9",stroke:P,strokeWidth:"4",strokeDasharray:"6"})})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(o,{label:e("Removing"),icon:(0,z.jsx)("svg",{width:"20",height:"15",xmlns:"http://www.w3.org/2000/svg",children:(0,z.jsx)("line",{x1:"0",y1:"9",x2:"20",y2:"9",stroke:R,strokeWidth:"4",strokeDasharray:"6"})})})})]})]})})})})};var Jd=n(1084);const Vd=(0,A.Ay)(rn.p).withConfig({componentId:"ans__sc-149ao3f-0"})(["--pf-c-empty-state--m-lg--MaxWidth:none;min-height:250px;"]),Gd=(0,A.Ay)(Jd.nt).withConfig({componentId:"ans__sc-149ao3f-1"})(["font-size:3em;fill:#6a6e73;"]),Yd=({className:e,progress:t})=>{const{t:n}=(0,I.Bd)();return(0,z.jsxs)(Vd,{variant:"full",className:e,"data-cy":e,children:[(0,z.jsx)(Gd,{}),(0,z.jsx)(Qt.k,{value:t,measureLocation:en.Ri.inside,"aria-label":n`content-loading-in-progress`,style:{margin:"20px"}}),(0,z.jsx)(Gl.n,{style:{margin:"20px"},children:(0,z.jsx)(Ve.E,{component:Ve.Y.small,style:{fontWeight:"bold",color:"black"},children:n`Please wait until the topology view is populated...`})})]})},Kd=A.Ay.span.withConfig({componentId:"ans__sc-1blf47v-0"})(["text-decoration:underline dotted;"]);function Zd(e){return(0,z.jsx)(Kd,{children:e.children})}function Xd(e){return(0,z.jsx)(Ft,{label:(0,po.t)("Last modified"),children:(0,z.jsx)(Ie,{value:e.value,author:e?.author,onClick:e?.onClick})})}var Qd=n(29962),eu=n(83340),tu=n(42706),nu=n(46762);function au(e){const{t}=(0,I.Bd)(),n=e.status,a=ou(n,t),s=iu(n),o=ru(n);return(0,z.jsx)(Fe,{text:e.hideLabel?"":a,color:s,icon:o?(0,z.jsx)(o,{}):null,to:e.to,disableLinks:e.disableLinks})}function su(e){const{t}=(0,I.Bd)(),n=e.status||"default",a=e.dataCy||"",s=ou(n,t),o=iu(n),i=ru(n);return(0,z.jsx)(Ee.J,{"data-cy":a,variant:"outline",color:o,icon:i?(0,z.jsx)(i,{}):null,children:s})}function ou(e,t){return void 0===e?t("Unknown"):{approved:t("Approved"),completed:t("Completed"),canceled:t("Canceled"),changed:t("Changed"),deleting:t("Deleting"),denied:t("Denied"),"deprovision-fail":t("Deprovisioning fail"),deprovisioning:t("Deprovisioning"),disabled:t("Disabled"),error:t("Error"),failed:t("Failed"),healthy:t("Healthy"),installed:t("Installed"),new:t("New"),"never-updated":t("Never updated"),ok:t("OK"),"provion-fail":t("Provisioning fail"),pending:t("Pending"),provisioning:t("Provisioning"),ready:t("Ready"),running:t("Running"),skipped:t("Skipped"),starting:t("Starting"),stopping:t("Stopping"),stopped:t("Stopped"),success:t("Success"),successful:t("Success"),timedOut:t("Timed out"),unavailable:t("Unavailable"),unresponsive:t("Unresponsive"),unknown:t("Unknown"),unreachable:t("Unreachable"),waiting:t("Waiting"),"workers offline":t("Workers offline")}[e]||e}function iu(e){switch(e){case"approved":case"completed":case"healthy":case"ok":case"ready":case"successful":case"success":return"green";case"deleting":case"denied":case"deprovision-fail":case"error":case"failed":case"provision-fail":case"timedOut":case"unavailable":case"unreachable":return"red";case"installed":case"new":case"never-updated":case"pending":case"running":case"skipped":return"blue";case"canceled":case"changed":case"unknown":return"orange";case"stopped":return;default:return"grey"}}function ru(e){switch(e){case"approved":case"completed":case"healthy":case"ok":case"ready":case"successful":case"success":return nn.C1;case"denied":case"new":case"never-updated":return Qd.ee;case"deleting":case"deprovision-fail":case"error":case"failed":case"provision-fail":case"timedOut":case"unavailable":case"unreachable":case"unresponsive":case"workers offline":return an.$Q;case"installed":case"pending":case"waiting":return $d.O4;case"running":return qr;case"canceled":case"changed":case"unknown":return Ws.Pi;case"disabled":return eu.tP;case"deprovisioning":case"provisioning":case"skipped":return Nd.Kf;case"starting":case"stopping":return tu.mX;case"stopped":return nu.Ad;default:return null}}var lu=n(63532);const cu=e=>e?e.toLowerCase().split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "):"",du=e=>/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e);function uu(e){const{t}=(0,I.Bd)(),{credential:n,...s}=e,o=gr();let i;if(!n)return null;i=n.cloud?t`Cloud`:"gpg_public_key"===n.kind?t`GPG Public Key`:"aws"===n.kind||"ssh"===n.kind?n.kind.toUpperCase():cu(n.kind||"");const r="vault"===n.kind&&n.inputs&&n.inputs?.vault_id?n.inputs?.vault_id:void 0;return(0,z.jsx)(Ee.J,{color:"blue",...s,children:(0,z.jsxs)(a.N_,{to:o(fc.CredentialDetails,{params:{id:n.id}}),children:[(0,z.jsxs)("strong",{children:[i,": "]}),"vault"===n.kind&&r?`${n.name} | ${r.toString()}`:n.name]})})}function mu(e=!0){const{t}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:t("ID"),cell:e=>e.id,minWidth:0,table:e?zt.hidden:void 0,card:e?"hidden":void 0,list:e?"hidden":void 0,modal:e?Ut.hidden:void 0})),[e,t])}function pu(e){const{url:t,onClick:n,disableSort:a,disableLinks:s}=e??{},{t:o}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:"name",header:e?.header??o("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name||e.hostname||("summary_fields"in e?e.summary_fields?.user?.username:void 0),iconSize:"sm",to:s?void 0:t?.replace(":id",e.id.toString()),onClick:!s&&n?()=>n?.(e):void 0}),sort:a?void 0:e?.sort??"name",card:"name",list:"name",defaultSort:void 0===e?.defaultSort||e?.defaultSort})),[e?.header,e?.sort,e?.defaultSort,o,a,s,t,n])}function hu(e){const{t}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:"description",header:t("Description"),type:"description",value:e=>e.description,table:e&&"tableViewOption"in e?e.tableViewOption:zt.description,list:"description",card:"description",modal:Ut.hidden,dashboard:Wt.hidden})),[t,e])}function bu(e){const{t}=(0,I.Bd)(),n=yr();return(0,l.useMemo)((()=>({id:"created",header:t("Created"),cell:t=>t.created||t.created_on||t.date_joined||t.pulp_created?(0,z.jsx)(Ie,{value:t.created??t.created_on??t.date_joined??t.pulp_created,author:"summary_fields"in t?t.summary_fields?.created_by?.username:void 0,onClick:e?.disableLinks||!("summary_fields"in t)||"_system"===t.summary_fields?.created_by?.username?void 0:()=>{n(e?.userDetailsPageId||fc.UserDetails,{params:{id:t.summary_fields?.created_by?.id}})}}):(0,z.jsx)(z.Fragment,{}),sort:e?.disableSort?void 0:e?.sort??"created",defaultSortDirection:"desc",table:"hidden",card:"hidden",list:"secondary",modal:"hidden",dashboard:"hidden",priority:Jt.last})),[t,e?.disableSort,e?.sort,e?.disableLinks,e?.userDetailsPageId,n])}function fu(e){const{t}=(0,I.Bd)(),n=yr();return(0,l.useMemo)((()=>({id:"modified",header:t("Last modified"),cell:t=>t.modified||t.modified_on?(0,z.jsx)(Ie,{value:t.modified?t.modified:t.modified_on,author:"summary_fields"in t?t.summary_fields?.modified_by?.username:void 0,onClick:e?.disableLinks||!("summary_fields"in t)||"_system"===t.summary_fields?.modified_by?.username?void 0:()=>n(e?.userDetailsPageId||fc.UserDetails,{params:{id:t.summary_fields?.modified_by?.id}})}):(0,z.jsx)(z.Fragment,{}),sort:e?.disableSort?void 0:e?.sort??"modified",defaultSortDirection:"desc",table:"hidden",card:"hidden",list:"secondary",modal:"hidden",dashboard:"hidden",priority:Jt.last})),[t,e?.disableSort,e?.sort,e?.disableLinks,e?.userDetailsPageId,n])}function gu(e,t,n){const{t:a}=(0,I.Bd)(),s=gr();return(0,l.useMemo)((()=>({header:a("Organization"),cell:a=>(0,z.jsx)(Fe,{text:a.summary_fields?.organization?.name??n??"",to:s(e,{params:{id:a.summary_fields?.organization?.id}}),disableLinks:!(!n||a.summary_fields?.organization?.name)||t?.disableLinks}),value:e=>e.summary_fields?.organization?.name,sort:t?.disableSort?void 0:"organization",dashboard:"hidden"})),[n,s,t?.disableLinks,t?.disableSort,e,a])}function yu(e,t){const{t:n}=(0,I.Bd)(),a=gr();return(0,l.useMemo)((()=>({header:n("Inventory"),cell:n=>(0,z.jsx)(Fe,{text:n.summary_fields?.inventory?.name,to:a(e,{params:{id:n.summary_fields?.inventory?.id,inventory_type:_u[n.summary_fields?.inventory?.kind??""]}}),disableLinks:t?.disableLinks}),value:e=>e.summary_fields?.inventory?.name,sort:t?.disableSort?void 0:"inventory",table:t&&"tableViewOption"in t?t.tableViewOption:zt.expanded,card:"hidden",list:"hidden",modal:Ut.hidden})),[a,t,e,n])}function xu(e,t){const{t:n}=(0,I.Bd)(),a=gr();return(0,l.useMemo)((()=>({header:n("Project"),cell:n=>(0,z.jsx)(Fe,{text:n.summary_fields?.project?.name,to:a(e,{params:{id:n.summary_fields?.project?.id}}),disableLinks:t?.disableLinks}),value:e=>e.summary_fields?.project?.name,sort:t?.disableSort?void 0:"project",table:zt.expanded,card:"hidden",list:"hidden",modal:Ut.hidden,dashboard:t?.dashboardOption??void 0})),[a,t?.dashboardOption,t?.disableLinks,t?.disableSort,e,n])}function ju(e){const{makeReadable:t}=e??{},{t:n}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:n("Type"),value:e=>t(e),type:"text",card:"subtitle",list:"subtitle",sort:e?.disableSort?void 0:e?.sort})),[n,t,e.disableSort,e.sort])}const _u={"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"};function vu(){const{t:e}=(0,I.Bd)();return{hybrid:e("Hybrid is the default node type for control plane nodes, responsible for runtime functions like project updates, management jobs and ansible-runner task operations. Hybrid nodes are also used for automation execution."),control:e("Control nodes run project and inventory updates and system jobs, but not regular jobs. Execution capabilities are disabled on these nodes."),execution:e("Execution nodes run jobs under ansible-runner with podman isolation. This node type is similar to isolated nodes. This is the default node type for execution plane nodes."),hop:e("Similar to a jump host, hop nodes will route traffic to other execution nodes. Hop nodes cannot execute automation.")}}var wu=n(63838);function ku(e){const{instance:t}=e,{instanceForks:n,handleInstanceForksSlider:a}=Ru(String(t.id)),s=0!==t.cpu_capacity&&0!==t.mem_capacity,{activeAwxUser:o}=_l();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{"data-cy":"number-forks",children:(0,po.t)(`${n} forks`)}),(0,z.jsx)(wu.A,{areCustomStepsContinuous:!0,max:t.mem_capacity,min:t.cpu_capacity,value:n,onChange:(e,t)=>{a(t)},isDisabled:!((o?.is_superuser||o?.is_system_auditor)&&t.enabled&&s)})]})}function Su(e){return(0,z.jsx)("span",{style:{color:E("red")},children:e.children})}function Cu(e,t){const{t:n}=(0,I.Bd)(),a=yr(),s=vu(),o=(0,l.useCallback)((e=>a(fc.InstanceDetails,{params:{id:e.id}})),[a]),i=(0,l.useCallback)((e=>(0,z.jsx)(x.m,{content:s[e.node_type],children:(0,z.jsx)(Zd,{children:`${ho(e.node_type)}`})})),[s]),r=pu({...e,onClick:t??o,header:n("Name"),sort:"hostname"}),c=bu(e),d=fu(e);return(0,l.useMemo)((()=>[r,{header:n("Status"),cell:e=>(0,z.jsx)(au,{status:e.health_check_pending?"running":e.node_state}),sort:"errors",modal:"hidden"},{cell:i,sort:"node_type",header:n("Node type"),card:"subtitle",list:"subtitle"},{header:n("Capacity adjustment"),cell:e=>Ou(e.mem_capacity,e.cpu_capacity,parseFloat(e.capacity_adjustment))>0?(0,z.jsx)(ku,{instance:e}):"hop"===e.node_type?(0,z.jsx)(x.m,{isContentLeftAligned:!0,content:n("Cannot adjust capacity for hop nodes."),children:(0,z.jsx)(Zd,{children:n("Unavailable")})}):(0,z.jsx)(x.m,{isContentLeftAligned:!0,content:n("0 forks. Cannot adjust capacity."),children:(0,z.jsx)(Zd,{children:n("Unavailable")})}),modal:Ut.hidden},{header:n("Used capacity"),cell:e=>"hop"===e.node_type?void 0:e.enabled?(0,z.jsx)(Qt.k,{value:Math.round(100-e.percent_capacity_remaining)}):(0,z.jsx)(Su,{children:n("Unavailable")}),list:"secondary",modal:"hidden"},{header:n("Running jobs"),cell:e=>e.jobs_running,table:zt.expanded},{header:n("Total jobs"),cell:e=>e.jobs_total,table:zt.expanded},{header:n("Memory"),cell:e=>e.memory&&(0,z.jsx)(he,{bytes:e.memory}),sort:"memory",list:"secondary",table:zt.expanded},{header:n("Policy type"),cell:e=>e.managed_by_policy?n("Auto"):n("Manual"),table:zt.expanded},c,d]),[n,c,r,i,d])}function Tu(e){const t=Cu({disableLinks:!0}),n=(0,l.useMemo)((()=>t.filter((e=>["Name","Node type"].includes(e.header)))),[t]),{t:a}=(0,I.Bd)(),s=pu({disableLinks:!0,disableSort:!0}),o=(0,l.useMemo)((()=>[s]),[s]),i=Lc();return t=>{i({title:a("Permanently remove instances",{count:t.length}),confirmText:1===t.length?a("Yes, I confirm that I want to delete this instance."):a("Yes, I confirm that I want to delete these {{count}} instances.",{count:t.length}),actionButtonText:a("Remove instance",{count:t.length}),items:t.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:o,onComplete:e,actionFn:e=>sl(xl`/instances/${e.id.toString()}/`,{node_state:"deprovisioning"})})}}var Iu=n(44647);function Au(e){const t=Du(e),n=Eu(e,!1),a=Pu();return(0,l.useMemo)((()=>[t,n,a]),[t,n,a])}function Du(e){const{t}=(0,I.Bd)(),{activeAwxUser:n}=_l(),a=(0,l.useCallback)((async(t,n)=>{await sl(xl`/instances/${t.id.toString()}/`,{enabled:n}),e([t])}),[e]),i=n?.is_superuser||n?.is_system_auditor;return(0,l.useMemo)((()=>({type:s.Switch,ariaLabel:e=>t(e?"Click to disable instance":"Click to enable instance"),selection:o.Single,isPinned:!0,onToggle:(e,t)=>a(e,t),isSwitchOn:e=>e.enabled,label:t("Instance enabled"),labelOff:t("Instance disabled"),showPinnedLabel:!1,isHidden:e=>"hop"===e.node_type,isDisabled:e=>i?void 0:t("You do not have permission to edit instances. Please contact your organization administrator if there is an issue with your access.")})),[t,a,i])}function Eu(e,t){const{t:n}=(0,I.Bd)(),a=ue(),{activeAwxUser:i}=_l();return(0,l.useMemo)((()=>({type:s.Button,selection:o.Single,variant:g.Ak.secondary,isPinned:!0,isDisabled:e=>$u(e,n)||Lu(i,n)||Mu(e,n)||Nu(e,n),isHidden:()=>t,icon:Iu.og,label:n("Run health check"),onClick:t=>{const s={variant:"success",title:n(`Running health check on ${t.hostname}.`),timeout:4e3};al(xl`/instances/${t.id.toString()}/health_check/`,{}).then((()=>{a.addAlert(s),e([t])})).catch((e=>{a.addAlert({variant:"danger",title:n("Failed to perform health check"),children:e instanceof Error&&e.message})}))}})),[n,e,a,i,t])}function Pu(e){const{t}=(0,I.Bd)(),n=yr(),{activeAwxUser:a}=_l(),{data:i}=ec(xl`/settings/system/`),r=a?.is_superuser||a?.is_system_auditor,c=i?.IS_K8S;return(0,l.useMemo)((()=>({type:s.Button,selection:o.Single,icon:yc.oo,isPinned:e?.isPinned??!0,isHidden:()=>e?.isHidden??!1,label:t("Edit instance"),onClick:e=>n(fc.EditInstance,{params:{id:e.id}}),isDisabled:e=>r&&c?void 0:t("You do not have permission to edit instances. Please contact your organization administrator if there is an issue with your access.")})),[t,n,c,r,e?.isHidden,e?.isPinned])}function Ru(e){const{refresh:t,data:n}=tc(xl`/instances/`,e),[a,s]=(0,l.useState)(n),[o,i]=(0,l.useState)(),[r,c]=(0,l.useState)(0);return(0,l.useEffect)((()=>{(async()=>{const t=await nl(xl`/instances/${e}/`),n=await nl(xl`/instances/${e}/instance_groups/`);s(t),i(n),c(Ou(t.mem_capacity,t.cpu_capacity,parseFloat(t.capacity_adjustment)))})()}),[e]),{instanceGroups:o,instanceForks:r,handleToggleInstance:async e=>{await sl(xl`/instances/${a.id.toString()}/`,{enabled:e}),t()},handleInstanceForksSlider:(0,lu.A)((async e=>{const n=(1-0)*(e-(s=Math.min(a.mem_capacity,a.cpu_capacity)))/(Math.max(a.mem_capacity,a.cpu_capacity)-s)+0;var s;const o=await sl(xl`/instances/${a.id.toString()}/`,{capacity_adjustment:n.toFixed(2)});c(Ou(o.mem_capacity,o.cpu_capacity,parseFloat(o.capacity_adjustment))),t()}),200)}}function Bu(){const e=(0,Re.g)(),{data:t,refresh:n}=tc(xl`/instances`,e.id),{data:a}=ec(xl`/settings/system/`),{activeAwxUser:i}=_l(),r=a?.IS_K8S,c=t?.managed??!1,d=!1===r||!i?.is_superuser&&!i?.is_system_auditor||c,u=Pu({isHidden:d,isPinned:!1}),m=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Tu((e=>n(fc.Instances))),{data:i}=ec(xl`/settings/system/`),r=i?.IS_K8S,{activeAwxUser:c}=_l();return(0,l.useMemo)((()=>({type:s.Button,isHidden:()=>e,isPinned:!1,selection:o.Single,icon:Nd.Kf,label:t("Remove instance"),onClick:e=>a([e]),isDisabled:e=>Fu([e],t,c,r??!1),isDanger:!0})),[t,a,r,c,e])}(d),p=Eu(n,"execution"!==t?.node_type);return(0,l.useMemo)((()=>[u,m,p]),[u,m,p])}function Fu(e,t,n,a){const s=n?.is_superuser||n?.is_system_auditor;return 0===e.length?t("Select at least one item from the list."):a?s?e.find((e=>!function(e){return"execution"===e.node_type||"hop"===e.node_type}(e)))?t("Cannot delete due to one or many instances being of type other than execution or hop."):"":t("Cannot delete instances due to insufficient permissions"):t("Cannot delete instances due to system environment")}function Nu(e,t){return e.health_check_pending?t("Instance has pending health checks. Wait for those to complete before attempting another health check."):""}function $u(e,t){return"execution"!==e.node_type?t("Health checks can only be run on execution instances."):""}function Mu(e,t){return e?.managed?t("Health checks cannot be run on a managed instance."):""}function Lu(e,t){return e?.is_superuser||e?.is_system_auditor?"":t("Health checks cannot be run on instance do not have correct permissions.")}function Ou(e,t,n){const a=Math.min(e,t),s=Math.max(e,t);return Math.floor(a+(s-a)*n)}var zu=n(69863),Hu=n(88161),qu=n(54709),Uu=n(65956);function Wu(e){const{value:t,label:n,helpText:a,fullWidth:s=!0,showCopyToClipboard:o=!0,toggleLanguage:i=!0,isArray:r=!1}=e,{id:c}=(0,Re.g)(),{t:d}=(0,I.Bd)(),[u,m]=(0,l.useState)(!1),p=we().dataEditorFormat??"yaml",[h,b]=(0,l.useState)(p),[f,g]=(0,l.useState)(t),{copySuccess:y,writeToClipboard:x}=ge();(0,l.useLayoutEffect)((()=>{if(i){const e=Xo(Zo(t,r),h);g(e)}}),[h,i,t,r]);const j=o||i?(0,z.jsxs)(l.Fragment,{children:[o&&(0,z.jsx)(zu.j,{children:(0,z.jsx)(Hu.M,{id:"basic-copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:e=>(x(t),void m(y)),exitDelay:u?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:()=>m(!1),children:d(u?"Successfully copied to clipboard!":"Copy to clipboard")})}),i&&(0,z.jsx)(zu.j,{children:(0,z.jsxs)(Oa.O,{isCompact:!0,children:[(0,z.jsx)(za.d,{id:"toggle-yaml","data-cy":"toggle-yaml","aria-label":d("Toggle to YAML"),isSelected:"yaml"===h,text:"YAML",type:"button",onChange:()=>b("yaml")}),(0,z.jsx)(za.d,{id:"toggle-json","data-cy":"toggle-json","aria-label":d("Toggle to JSON"),isSelected:"json"===h,text:"JSON",type:"button",onChange:()=>b("json")})]})})]}):null;return(0,z.jsx)(Ft,{label:n??d("Variables"),helpText:a,isEmpty:e?.isEmpty,fullWidth:s,children:(0,z.jsx)(qu.N,{id:c,actions:j,children:(0,z.jsx)(Uu.s,{"data-cy":"code-block-value",children:f})})})}function Ju(e){const{t}=(0,I.Bd)(),{instance:n}=e,{handleToggleInstance:a}=Ru(String(e.instance.id)),{activeAwxUser:i}=_l(),r={type:s.Switch,onToggle:()=>{a(!n?.enabled)},isSwitchOn:()=>n?.enabled,isDisabled:e=>i?.is_superuser?void 0:t("You do not have permissions to toggle this instance"),ariaLabel:e=>t(e?"Enabled":"Disabled"),selection:o.Single,label:""};return(0,z.jsx)(G,{action:r,selectedItem:n})}function Vu(){const e=(0,Re.g)(),{id:t,instance_id:n}=e,{error:a,data:s,refresh:o}=tc(xl`/instances`,n??t),{instanceGroups:i,instanceForks:r}=Ru(n??t);return a?(0,z.jsx)(Ic,{error:a,handleRefresh:o}):s?(0,z.jsx)(Ui,{children:s?(0,z.jsx)(Gu,{instance:s,instanceGroups:i,instanceForks:r}):(0,z.jsx)(Oe.d8,{variant:"light",children:(0,z.jsx)(kn.E,{})})}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Gu(e){const{t}=(0,I.Bd)(),n=yr(),s=gr(),{instance:o,instanceGroups:i,instanceForks:r}=e,l=vu();return(0,z.jsxs)(Mt,{numberOfColumns:e.numberOfColumns,disableScroll:!0,children:[(0,z.jsx)(Ft,{label:t("Name"),"data-cy":"name",children:(0,z.jsx)(g.$n,{variant:"link",isInline:!0,onClick:()=>n(fc.InstanceDetails,{params:{id:o.id}}),children:o.hostname})}),(0,z.jsx)(Ft,{label:t("Node type"),"data-cy":"node-type",children:(0,z.jsx)(x.m,{content:l[o.node_type],children:(0,z.jsx)(Zd,{children:`${ho(o.node_type)}`})})}),(0,z.jsx)(Ft,{label:t("Status"),"data-cy":"node-status",children:(0,z.jsx)(au,{status:o.health_check_pending?"running":o.node_state})}),i&&i.results.length>0&&(0,z.jsx)(Ft,{label:t("Instance groups"),"data-cy":"instance-groups",children:i.results.map((e=>(0,z.jsx)(Ee.J,{color:"blue",style:{marginRight:"10px"},children:(0,z.jsx)(a.N_,{to:s(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))}),!o.managed&&o.related?.install_bundle&&(0,z.jsx)(Ft,{label:t`Download bundle`,"data-cy":"download-bundle",children:(0,z.jsx)(g.$n,{size:"sm","aria-label":t`Download Bundle`,component:"a",download:`${o.related?.install_bundle}`,href:`${o.related?.install_bundle}`,target:"_blank",variant:"secondary",rel:"noopener noreferrer",children:(0,z.jsx)(jo.s3,{})})}),o.listener_port&&(0,z.jsx)(Ft,{label:t`Listener port`,"data-cy":"listener-port",children:o.listener_port}),(0,z.jsx)(Ft,{label:t("Used capacity"),"data-cy":"used-capacity",children:o.enabled?(0,z.jsx)(Qt.k,{value:Math.round(100-o.percent_capacity_remaining)}):(0,z.jsx)(Su,{children:t("Unavailable")})}),(0,z.jsx)(Ft,{label:t("Running jobs"),"data-cy":"running-jobs",children:o.jobs_running.toString()}),(0,z.jsx)(Ft,{label:t("Total jobs"),"data-cy":"total-jobs",children:o.jobs_total.toString()}),(0,z.jsx)(Ft,{label:t("Policy type"),"data-cy":"policy-type",children:o.managed_by_policy?t("Auto"):t("Manual")}),(0,z.jsx)(Ft,{label:t("Memory"),"data-cy":"memory",children:(0,z.jsx)(he,{bytes:o.memory})}),(0,z.jsx)(Ft,{label:t("Last health check"),"data-cy":"last-health-check",children:Se(o.last_health_check)}),(0,z.jsx)(Ft,{label:t("Created"),"data-cy":"created",children:Se(o.created)}),(0,z.jsx)(Xd,{value:o.modified,"data-cy":"modified"}),(0,z.jsx)(Ft,{label:t("Forks"),"data-cy":"forks",isEmpty:"hop"===o.node_type||r<=0,children:(0,z.jsx)(ku,{instance:o})}),(0,z.jsx)(Ft,{label:t("Enabled"),"data-cy":"enabled",children:(0,z.jsx)(Ju,{instance:o})}),(0,z.jsx)(Wu,{value:o.errors,label:t("Errors"),isEmpty:""===o.errors,fullWidth:!0})]})}var Yu=n(40961);function Ku(){const e=(0,Dd.sjt)(),{setSidebarMode:t}=Pm();return(0,l.useCallback)((()=>{e.setState({...e.getState(),selectedIds:[],sourceNode:void 0}),t(void 0)}),[e,t])}let Zu=function(e){return e[e.danger=Dd.zIx.danger]="danger",e[e.success=Dd.zIx.success]="success",e[e.info=Dd.zIx.info]="info",e}({});function Xu(){const{t:e}=(0,I.Bd)();return(0,l.useCallback)(((t,n,a)=>{const s={[Zu.success]:e("Run on success"),[Zu.danger]:e("Run on fail"),[Zu.info]:e("Run always")}[a];return{id:`${t}-${n}`,type:"edge",source:t,target:n,visible:!0,data:{originalStatus:{[Zu.success]:"success",[Zu.danger]:"failure",[Zu.info]:"info"}[a],source:t,tag:s,tagStatus:a,target:n,endTerminalType:Dd.oTR.directional,endTerminalStatus:a,endTerminalSize:14}}}),[e])}function Qu(e){const{t}=(0,I.Bd)(),n={job:t("Job template"),workflow_job:t("Workflow job template"),project_update:t("Project"),inventory_update:t("Inventory source"),workflow_approval:t("Workflow approval"),system_job:t("Management job")};return e?n[e]:null}const em="workflow-visualizer-graph",tm=50,nm="startNode",am={job:"job",workflow_job:"workflow_job",project_update:"project_update",workflow_approval:"workflow_approval",inventory_update:"inventory_update",system_job:"system_job"};function sm(){const{t:e}=(0,I.Bd)(),t=function(){const e=Xu();return(0,l.useCallback)((t=>{const n=[];t.setVisible(!1);const a=t.getTargetEdges(),s=t.getSourceEdges();a.forEach((e=>{e.setVisible(!1)})),s.forEach((s=>{s.setVisible(!1),a.forEach((a=>{a.getSource().setState({modified:!0});const o=a.getSource().getId(),i=s.getTarget().getId(),r=`${o}-${i}`;let{tagStatus:l}=s.getData();if(o===nm&&(l=Zu.info),t.getController().getEdgeById(r))t.getController().getEdgeById(r)?.setVisible(!0);else{const t=e(o,i,l);n.push(t)}}))}));const o=t.getController().toModel();o.edges||(o.edges=[]),o.edges=[...o.edges,...n],t.getController().fromModel(o)}),[e])}(),n=(0,Dd.sjt)(),a=Xu(),s=(0,Dd.XId)((e=>{e.forEach((e=>{t(e)})),n.setState({...n.getState(),modified:!0}),n.getGraph().layout()})),o=(0,l.useMemo)((()=>({header:e("Name"),cell:t=>{const n=t.getData(),a=n?.resource,s=a?.summary_fields?.unified_job_template?.name;return(0,z.jsx)(Fe,{text:s||e("DELETED"),iconSize:"sm"})}})),[e]),i=(0,l.useMemo)((()=>({header:e("Identifier"),cell:e=>{const t=e.getData()?.resource.identifier;return(0,z.jsx)(Fe,{text:t,iconSize:"sm"})}})),[e]),r=(0,l.useMemo)((()=>[o,i]),[o,i]),c=(0,l.useMemo)((()=>[o]),[o]),d=Ks(),u=(0,l.useCallback)((t=>{const n=t.length>1;d({keyFn:e=>e.getId(),title:e(n?"Remove all steps":"Remove step"),items:t,confirmText:n?e("Yes, I confirm that I want to remove these {{count}} nodes.",{count:t.length}):e("Yes, I confirm that I want to remove this node."),actionButtonText:n?e("Remove all steps",{count:t.length}):e("Remove step"),isDanger:!0,confirmationColumns:r,actionColumns:c,actionFn:()=>(s(t),Promise.resolve())})}),[c,d,r,e,s]),m=(0,l.useMemo)((()=>({header:e("Source Node"),cell:t=>{const n=t.getSource();return(0,z.jsx)(Fe,{text:n.getLabel()||e("DELETED"),iconSize:"sm"})}})),[e]),p=(0,l.useMemo)((()=>({header:e("Target Node"),cell:e=>{const t=e.getTarget();return(0,z.jsx)(Fe,{text:t.getLabel(),iconSize:"sm"})}})),[e]),h=(0,l.useMemo)((()=>({header:e("Status"),cell:e=>{const t=e.getData();return t?(0,z.jsx)(Ee.J,{color:function(e){switch(e){case"success":return"green";case"danger":return"red";case"info":return"blue"}}(t.tagStatus),children:t.tag}):null}})),[e]),b=(0,l.useMemo)((()=>[m,p,h]),[m,p,h]),f=(0,l.useMemo)((()=>[m,p]),[m,p]),g=Ks(),y=(0,Dd.XId)((e=>{e.setVisible(!1),e.getSource().setState({modified:!0}),e.getTarget().setState({modified:!0}),e.getSource().setNodeStatus(Dd.zIx.default),e.getTarget().setNodeStatus(Dd.zIx.default);const t=e.getController(),n=t.toModel();t.setState({...t.getState(),modified:!0}),!e.getTarget().getTargetEdges().filter((e=>e.isVisible())).length&&n.edges?.push(a(nm,e.getTarget().getId(),Zu.info)),t.fromModel(n,!0),t.getGraph().layout()}));return{removeNodes:u,removeLink:(0,l.useCallback)((t=>{g({keyFn:e=>e.getId(),title:e("Remove link"),items:[t],confirmText:e("Yes, I confirm that I want to remove this link."),actionButtonText:e("Remove link"),isDanger:!0,confirmationColumns:b,actionColumns:f,actionFn:()=>(y(t),Promise.resolve())})}),[f,g,b,e,y])}}function om(e){if(""===e.trim())return"";const t=JSON.parse(e);return 0===Object.entries(t).length?"":So.Ay.dump(t)}function im(e){const t=So.Ay.load(e);if(!t)return"{}";if("object"!=typeof t)throw new Error("yaml is not in object format");return JSON.stringify(t,null,2)}function rm(e){return"---"===e||"{}"===e?{}:(function(e){if("string"!=typeof e)return!1;let t;try{t=JSON.parse(e)}catch(e){return!1}return"object"==typeof t&&null!==t}(e)||(e=im(e)),JSON.parse(e))}var lm=n(23041);function cm(e,t){const n=nc(),a=(0,l.useCallback)(((n,a)=>a&&!a.next?null:`${e}${dl({...t,page:n+1,page_size:200})}`),[e,t]),{data:s,error:o,isLoading:i,mutate:r}=(0,lm.Ay)(a,n,{initialSize:200});return{results:(0,l.useMemo)((()=>s?.reduce(((e,t)=>Array.isArray(t.results)?[...e,...t.results]:e),[])),[s]),error:o,isLoading:i,refresh:(0,l.useCallback)((()=>{r()}),[r])}}function dm(e,t){t=t||[];const n=[],a=[];return(e=e||[]).forEach((e=>{t.find((t=>t.id===e.id))||a.push(e)})),t.forEach((t=>{e.find((e=>e.id===t.id))||n.push(t)})),{added:n,removed:a}}function um(e){const t=(0,Dd.sjt)(),n=Hs(),a=kd(),s=ed(),o=ed(),i=td(),r=td(),c=td(),d=td(),u=bm(),m=hm(),p=pm(),{refresh:h}=cm(xl`/workflow_job_templates/${e??""}/workflow_nodes/`);return(0,l.useCallback)((async()=>{const e=t.getGraph().getNodes().filter((e=>e.getId()!==nm)),l=t.getState(),b=[],f=[],g=[],y=[],x=[],j=[],_=[],v=[],w=[],k=[],S=[];function C(e,t){const n=e.getData();(0,Dd.XId)((()=>{e.setId(t.toString()),e.setData({...n,resource:{...n.resource,always_nodes:[],failure_nodes:[],success_nodes:[]}})}))()}e.forEach((e=>{const t=e.getId(),n=e.getState(),a=!e.isVisible(),s=t.includes("unsavedNode"),o=Boolean(n?.modified)&&!a&&!s;a&&!s&&function(e){b.push(e.getId())}(e),s&&!a&&function(e){const t=e.getData();t.resource.summary_fields?.unified_job_template?.unified_job_type===am.workflow_approval?v.push(e):k.push(e)}(e),o&&!a&&function(e){const t=e.getData();t.resource.summary_fields?.unified_job_template?.unified_job_type===am.workflow_approval?w.push(e):S.push(e)}(e)})),await async function(e){const t=e.map((async e=>{const t=e.getData(),a=e.getData()?.resource?.summary_fields?.unified_job_template,s=mm("identifier",t.resource.identifier);if(!a)return;const o=await c(xl`/workflow_job_templates/${l.workflowTemplate.id.toString()}/workflow_nodes/`,{all_parents_must_converge:t.resource.all_parents_must_converge,...s},n.signal);o&&o.id&&(await d(xl`/workflow_job_template_nodes/${o.id.toString()}/create_approval_template/`,{name:a.name,description:a.description||"",timeout:a.timeout||0},n.signal),C(e,o.id.toString()))}));await Promise.all(t)}(v),await async function(e){const t=e.map((async e=>{const t={},a=(e,n,a=!1)=>{if(a){const t=o?.original?.launch_config;if(!{diff_mode:t?.ask_diff_mode_on_launch,extra_data:t?.ask_variables_on_launch,execution_environment:t?.ask_execution_environment_on_launch,forks:t?.ask_forks_on_launch,inventory:t?.ask_inventory_on_launch,job_slice_count:t?.ask_job_slice_count_on_launch,job_type:t?.ask_job_type_on_launch,limit:t?.ask_limit_on_launch,scm_branch:t?.ask_scm_branch_on_launch,skip_tags:t?.ask_skip_tags_on_launch,job_tags:t?.ask_tags_on_launch,timeout:t?.ask_timeout_on_launch,verbosity:t?.ask_verbosity_on_launch}[e])return}null!=n&&""!==n&&(t[e]=n)},s=e.getData(),{launch_data:o,resource:i,survey_data:r}=s,{unified_job_template:d}=i.summary_fields;if(!d)return;a("all_parents_must_converge",i.all_parents_must_converge),a("identifier",i?.identifier),a("unified_job_template",d.id),a("diff_mode",o?.diff_mode,!0),a("execution_environment",o?.execution_environment,!0),a("forks",o?.forks,!0),a("inventory",o?.inventory?.id,!0),a("job_slice_count",o?.job_slice_count,!0),a("job_tags",o?.job_tags?.map((e=>e.name)).join(","),!0),a("job_type",o?.job_type,!0),a("limit",o?.limit,!0),a("scm_branch",o?.scm_branch,!0),a("skip_tags",o?.job_tags?.map((e=>e.name)).join(","),!0),a("timeout",o?.timeout,!0),a("verbosity",o?.verbosity,!0),d.unified_job_type===am.system_job&&i.extra_data?.days?a("extra_data",{days:i.extra_data.days}):o?.extra_vars&&a("extra_data",rm(o?.extra_vars),!0),r&&a("extra_data",{...rm(o?.extra_vars??"---"),...r});const h=await c(xl`/workflow_job_templates/${l.workflowTemplate.id.toString()}/workflow_nodes/`,t,n.signal);if(!h.id)return;const b=h.id.toString();await p(b,o),await m(b,o),await u(b,o),C(e,b.toString())}));await Promise.all(t)}(k),await async function(e){const t=e.map((async e=>{const t=e.getData(),a=e.getData()?.resource?.summary_fields?.unified_job_template,i=mm("identifier",t.resource.identifier);if(!a)return;const r=await s(xl`/workflow_job_template_nodes/${e.getId()}/`,{all_parents_must_converge:t.resource.all_parents_must_converge,...i},n.signal);r&&r.id&&(-1===a.id?(await d(xl`/workflow_job_template_nodes/${r.id.toString()}/create_approval_template/`,{name:a.name,description:a.description||"",timeout:a.timeout||0},n.signal),C(e,r.id.toString())):await o(xl`/workflow_approval_templates/${a.id.toString()}/`,{name:a.name,description:a.description||"",timeout:a.timeout||0},n.signal))}));await Promise.all(t)}(w),await async function(e){await Promise.allSettled(e.map((async e=>{const t={},a=e.getData(),o=e.getId(),{launch_data:i,survey_data:r,resource:l}=a,{unified_job_template:c}=l.summary_fields;if(!c)return;const d=(e,n,a=!1)=>{if(a){const t=i?.original?.launch_config;if(!{diff_mode:t?.ask_diff_mode_on_launch,execution_environment:t?.ask_execution_environment_on_launch,forks:t?.ask_forks_on_launch,inventory:t?.ask_inventory_on_launch,job_slice_count:t?.ask_job_slice_count_on_launch,job_type:t?.ask_job_type_on_launch,limit:t?.ask_limit_on_launch,scm_branch:t?.ask_scm_branch_on_launch,skip_tags:t?.ask_skip_tags_on_launch,job_tags:t?.ask_tags_on_launch,timeout:t?.ask_timeout_on_launch,verbosity:t?.ask_verbosity_on_launch}[e])return}null!=n&&""!==n&&(t[e]=n)};d("all_parents_must_converge",l.all_parents_must_converge),d("identifier",l.identifier),d("unified_job_template",c.id),d("diff_mode",i?.diff_mode,!0),d("execution_environment",i?.execution_environment,!0),d("forks",i?.forks,!0),d("inventory",i?.inventory?.id,!0),d("job_slice_count",i?.job_slice_count,!0),d("job_tags",i?.job_tags?.map((e=>e)).join(","),!0),d("job_type",i?.job_type,!0),d("limit",i?.limit,!0),d("scm_branch",i?.scm_branch,!0),d("skip_tags",i?.job_tags?.map((e=>e)).join(","),!0),d("timeout",i?.timeout,!0),d("verbosity",i?.verbosity,!0),c.unified_job_type===am.system_job&&l.extra_data?.days?d("extra_data",{days:l.extra_data.days}):i?.extra_vars&&d("extra_data",rm(i?.extra_vars),!0),r&&d("extra_data",{...rm(i?.extra_vars??"---"),...r}),await p(o,i),await m(o,i),await u(o,i),await s(xl`/workflow_job_template_nodes/${o}/`,t,n.signal)})))}(S),e.forEach((e=>{const t=e.getState(),n=!e.isVisible();Boolean(t?.modified)&&!n&&function(e){const t=e.getData(),n=e.getSourceEdges(),{resource:{always_nodes:a=[],failure_nodes:s=[],success_nodes:o=[]}}=t;o.length>0&&o.forEach((t=>{n.forEach((n=>{const{tagStatus:a}=n.getData();t.toString()===n.getTarget().getId()&&(a===Zu.success&&n.isVisible()||x.push({sourceId:e.getId(),targetId:t.toString()}))}))})),s.length>0&&s.forEach((t=>{n.forEach((n=>{const{tagStatus:a}=n.getData();t.toString()===n.getTarget().getId()&&(a===Zu.danger&&n.isVisible()||j.push({sourceId:e.getId(),targetId:t.toString()}))}))})),a.length>0&&a.forEach((t=>{n.forEach((n=>{const{tagStatus:a}=n.getData();t.toString()===n.getTarget().getId()&&(a===Zu.info&&n.isVisible()||_.push({sourceId:e.getId(),targetId:t.toString()}))}))})),n.forEach((t=>{if(!t.isVisible())return;const n=t.getTarget().getId(),{tagStatus:i}=t.getData();switch(i){case Zu.success:o?.includes(parseInt(n,10))||f.push({sourceId:e.getId(),targetId:n});break;case Zu.danger:s?.includes(parseInt(n,10))||g.push({sourceId:e.getId(),targetId:n});break;case Zu.info:a?.includes(parseInt(n,10))||y.push({sourceId:e.getId(),targetId:n})}}))}(e)})),await Promise.all(x.map((e=>r(xl`/workflow_job_template_nodes/${e.sourceId}/success_nodes/`,{id:Number(e.targetId),disassociate:!0},n.signal)))),await Promise.all(j.map((e=>r(xl`/workflow_job_template_nodes/${e.sourceId}/failure_nodes/`,{id:Number(e.targetId),disassociate:!0},n.signal)))),await Promise.all(_.map((e=>r(xl`/workflow_job_template_nodes/${e.sourceId}/always_nodes/`,{id:Number(e.targetId),disassociate:!0},n.signal)))),await Promise.all(f.map((e=>i(xl`/workflow_job_template_nodes/${e.sourceId}/success_nodes/`,{id:Number(e.targetId)},n.signal)))),await Promise.all(g.map((e=>i(xl`/workflow_job_template_nodes/${e.sourceId}/failure_nodes/`,{id:Number(e.targetId)},n.signal)))),await Promise.all(y.map((e=>i(xl`/workflow_job_template_nodes/${e.sourceId}/always_nodes/`,{id:Number(e.targetId)},n.signal)))),await Promise.all(b.map((e=>a(xl`/workflow_job_template_nodes/${e}/`,n.signal)))),(0,Dd.XId)((()=>{h(),t.setState({...l,modified:!1}),t.getElements().forEach((e=>e.setState({...e.getState(),modified:!1})))}))()}),[t,n,a,s,o,i,r,c,d,u,m,p,h])}function mm(e,t){return"string"==typeof t&&""!==t||"number"==typeof t?{[e]:t}:{}}const pm=()=>{const e=Hs(),t=td(),n=td();return(0,l.useCallback)((async(a,s)=>{const o=s?.original?.launch_config?.ask_labels_on_launch||s?.labels?.length>0,i=s?.original?.labels;if(o){const o=s.organization??await async function(){return(await nl(xl`/organizations/`)).results[0].id||1}(),{added:i,removed:r}=dm(s?.original?.labels||[],s?.labels||[]),l=r.map((n=>t(xl`/workflow_job_template_nodes/${a}/labels/`,{id:n.id,disassociate:!0},e.signal))),c=i.map((t=>n(xl`/workflow_job_template_nodes/${a}/labels/`,{name:t.name,organization:t?.organization??o},e.signal)));await Promise.all([...l,...c])}else if(i){const n=i.map((n=>t(xl`/workflow_job_template_nodes/${a}/labels/`,{id:n.id,disassociate:!0},e.signal)));await Promise.all(n)}}),[t,n,e])},hm=()=>{const e=Hs(),t=td(),n=td();return(0,l.useCallback)((async(a,s)=>{const o=s?.original?.launch_config?.ask_instance_groups_on_launch||s?.instance_groups?.length>0,i=s?.original?.instance_groups;if(o){const{added:o,removed:i}=dm(s?.original?.instance_groups||[],s?.instance_groups?s.instance_groups:[]),r=i.map((n=>t(xl`/workflow_job_template_nodes/${a}/instance_groups/`,{id:n.id,disassociate:!0},e.signal))),l=o.map((t=>n(xl`/workflow_job_template_nodes/${a}/instance_groups/`,{id:t.id},e.signal)));await Promise.all([...r,...l])}else if(i){const n=i.map((n=>t(xl`/workflow_job_template_nodes/${a}/instance_groups/`,{id:n.id,disassociate:!0},e.signal)));await Promise.all(n)}}),[t,n,e])},bm=()=>{const e=Hs(),t=td(),n=td();return(0,l.useCallback)((async(a,s)=>{const o=s?.credentials||[],i=s?.original?.launch_config?.defaults?.credentials||[],r=s?.original?.credentials||[];if(s?.credentials){const{added:s,removed:l}=fm(r,o,i),c=l.map((n=>t(xl`/workflow_job_template_nodes/${a}/credentials/`,{id:n.id,disassociate:!0},e.signal))),d=s.map((t=>n(xl`/workflow_job_template_nodes/${a}/credentials/`,{id:t.id},e.signal)));await Promise.all([...c,...d])}}),[t,n,e])},fm=(e,t,n)=>{const a=[...e,...n];return{added:t.filter((e=>!a.find((t=>t.id===e.id)))),removed:e.filter((e=>!t.find((t=>t.id===e.id))))}};function gm(e){const{t}=(0,I.Bd)(),n=e||0,a=Math.floor(n/60),s=Math.floor(n%60);return t("{{minutes}} min {{seconds}} sec ",{minutes:a.toString(),seconds:s.toString()})}function ym(e,t,n){if(t)return{id:t.id||void 0,allow_simultaneous:t.allow_simultaneous||!1,ask_credential_on_launch:t.ask_credential_on_launch||!1,ask_diff_mode_on_launch:t.ask_diff_mode_on_launch||!1,ask_execution_environment_on_launch:t.ask_execution_environment_on_launch||!1,ask_forks_on_launch:t.ask_forks_on_launch||!1,ask_instance_groups_on_launch:t.ask_instance_groups_on_launch||!1,ask_inventory_on_launch:t.ask_inventory_on_launch||!1,ask_job_slice_count_on_launch:t.ask_job_slice_count_on_launch||!1,ask_job_type_on_launch:t.ask_job_type_on_launch||!1,ask_labels_on_launch:t.ask_labels_on_launch||!1,ask_limit_on_launch:t.ask_limit_on_launch||!1,ask_scm_branch_on_launch:t.ask_scm_branch_on_launch||!1,ask_skip_tags_on_launch:t.ask_skip_tags_on_launch||!1,ask_tags_on_launch:t.ask_tags_on_launch||!1,ask_timeout_on_launch:t.ask_timeout_on_launch||!1,ask_variables_on_launch:t.ask_variables_on_launch||!1,ask_verbosity_on_launch:t.ask_verbosity_on_launch||!1,become_enabled:t.become_enabled||!1,credentials:t.summary_fields?.credentials||[],description:t.description||"",diff_mode:t.diff_mode||!1,execution_environment:t.summary_fields?.execution_environment||null,extra_vars:t.extra_vars||"---\n",forks:t.forks||0,host_config_key:t.host_config_key||"",instance_groups:n||[],inventory:t.summary_fields?.inventory||null,job_slice_count:t.job_slice_count||1,job_tags:xm(t.job_tags||"")||[],job_type:t.job_type||"run",labels:t.summary_fields?.labels?.results||[],limit:t.limit||"",name:t.name||"",organization:t.organization||void 0,playbook:t.playbook||"",prevent_instance_group_fallback:t.prevent_instance_group_fallback||!1,project:t.summary_fields?.project,scm_branch:t.scm_branch,skip_tags:xm(t.skip_tags||"")||[],timeout:t.timeout||0,use_fact_cache:t.use_fact_cache||!1,verbosity:t.verbosity??0,webhook_service:t.webhook_service||void 0,webhook_url:t.related?.webhook_receiver?`${document.location.origin}${t.related.webhook_receiver}`:e("a new webhook url will be generated on save.").toUpperCase(),webhook_key:e("a new webhook key will be generated on save.").toUpperCase(),webhook_credential:t.webhook_credential,isProvisioningCallbackEnabled:Boolean(t.related?.callback),isWebhookEnabled:Boolean(t.related?.webhook_receiver),related:{webhook_receiver:t.related?.webhook_receiver||"",callback:t.related?.callback?`${document.location.origin}${t.related.callback}`:"",webhook_key:t.related?.webhook_key||""}}}function xm(e){const t=e||"";return 0===t.trim().length?[]:t?.split(",")?.map((e=>({name:e,label:e,value:e})))}function jm(e){return e.filter((e=>{if(""!==e.name)return e.name})).map((e=>e.name)).join(",")}function _m(e){return!!(e&&"job_type"in e&&e.job_type)&&["cleanup_jobs","cleanup_activitystream"].includes(e.job_type)}function vm(e,t,n){return e===am.workflow_approval?n:t}function wm(e,t){return du(t)||""===t?e:t}function km(e){return 0===Object.keys(e).length||!(e.ask_credential_on_launch||e.ask_diff_mode_on_launch||e.ask_execution_environment_on_launch||e.ask_forks_on_launch||e.ask_instance_groups_on_launch||e.ask_inventory_on_launch||e.ask_job_slice_count_on_launch||e.ask_job_type_on_launch||e.ask_labels_on_launch||e.ask_limit_on_launch||e.ask_scm_branch_on_launch||e.ask_skip_tags_on_launch||e.ask_tags_on_launch||e.ask_timeout_on_launch||e.ask_variables_on_launch||e.ask_verbosity_on_launch)}function Sm(){return(0,l.useCallback)((e=>{if(!e)return Cm;const t=e?.getData(),{resource:n}=t||{},a=n?.summary_fields?.unified_job_template,s=a?.unified_job_type,o=du(n?.identifier||"")?"":n?.identifier,i=(r=n?.all_parents_must_converge,null==r?"any":r?"all":"any");var r;const l=n?.extra_data?.days,c=a?.timeout,d=s?vm(s,"",a?.name??""):"";return{approval_description:(s?vm(s,"",a?.description??""):"")??Cm.approval_description,approval_name:d??Cm.approval_name,approval_timeout:c??Cm.approval_timeout,node_alias:o??Cm.node_alias,node_convergence:i??Cm.node_convergence,node_days_to_keep:l??Cm.node_days_to_keep,resource:a??Cm.resource,node_type:s||Cm.node_type}}),[])}const Cm={approval_description:"",approval_name:"",approval_timeout:0,node_alias:"",node_convergence:"any",node_days_to_keep:30,resource:null,node_type:am.job,node_status_type:Zu.info};async function Tm(e){const t=await nl(e);return t.results.length>=1?t.results:[]}const Im=A.Ay.div.withConfig({componentId:"ans__sc-1usqo1i-0"})(["position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:white;z-index:1000;"]),Am=A.Ay.div.withConfig({componentId:"ans__sc-1usqo1i-1"})(["width:100%;height:100%;.pf-topology-container{min-height:0;}.pf-v5-c-toolbar__group{flex:1;width:100%;display:flex;}"]),Dm=(0,l.createContext)({toggleFullScreen:()=>{},isFullScreen:!1,isLegendOpen:!1,toggleLegend:()=>{},isEmpty:!1,isLoading:!0,sidebarMode:void 0,setSidebarMode:()=>null,removeNodes:()=>null,removeLink:()=>null,selectedIds:[]}),Em=(0,Dd.PAp)((e=>{const{children:t}=e,n=(0,Dd.sjt)(),{selectedIds:a}=n.getState(),s=n.getGraph().getNodes().find((e=>e.isVisible()&&e.getId()!==nm)),o=n.toModel().graph?.visible,i=!!a?.length&&a[0]===em,{removeNodes:r,removeLink:c}=sm(),[d,u]=(0,l.useState)(!1),[m,p]=(0,l.useState)(!1),[h,b]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!o),[y,x]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{g(!o)}),[o]),(0,l.useEffect)((()=>{f||u(void 0===s)}),[s,f]),(0,l.useEffect)((()=>{i&&x(void 0)}),[i]);const j={isFullScreen:m,toggleFullScreen:()=>{p(!m)},isLegendOpen:h,toggleLegend:()=>{b(!h)},isLoading:f,isEmpty:d,sidebarMode:y,selectedIds:a,setSidebarMode:x,removeNodes:r,removeLink:c};return(0,z.jsx)(Dm.Provider,{value:j,children:m?(0,z.jsx)(Rm,{children:(0,z.jsx)(Am,{children:(0,z.jsx)(Im,{"data-cy":"full-page-visualizer",children:t})})}):(0,z.jsx)(Am,{children:t})})})),Pm=()=>{const e=(0,l.useContext)(Dm);if(!e)throw new Error("useViewOptions must be used within a ViewOptions");return e};function Rm(e){const{children:t}=e,[n]=(0,l.useState)(document.createElement("div"));return(0,l.useEffect)((()=>(document.body.appendChild(n),()=>{document.body.removeChild(n)})),[n]),Yu.createPortal(t,n)}function Bm(e){const{setSidebarMode:t}=Pm(),{t:n}=(0,I.Bd)();return(0,z.jsx)(g.$n,{"data-cy":"add-node-button",icon:(0,z.jsx)(Za.GY,{}),variant:e.variant||"secondary",label:n("Add step"),onClick:()=>{t("add")},children:n("Add step")})}const Fm=e=>{const t=E(e)||N;return{fill:t,stroke:t}},Nm=({children:e,xPoint:t,yPoint:n,status:a,onContextMenu:s,hoverRef:o,isSourceRootNode:i})=>{const[r,l]=(0,Dd.XXc)([e]),{width:c,height:d}=((e,t,n)=>({width:e?e.width+20:0,height:e?e.height+8:0}))(r),u=t-c/2,m=n-d/2,[p,h]=(0,Dd.XXc)([C.bz,10]),b=r?.height?""+r.height/2:"0";return(0,z.jsxs)("g",{transform:`translate(${u}, ${m})`,ref:o,children:[r&&(0,z.jsx)("rect",{style:Fm(a),x:0,y:0,width:i||!s?r.width+20:r.width+50,height:d,rx:15,ry:15}),(0,z.jsx)("text",{ref:l,style:{fill:"white"},x:10,y:d/2,dy:"0.35em",children:e}),!i&&s&&(0,z.jsxs)("g",{ref:h,className:"pf-topology__node__action-icon",children:[(0,z.jsx)("line",{className:"pf-topology__node__separator",x1:c,x2:c,y1:0,y2:`${d}`}),p&&(0,z.jsx)("path",{"data-cy":"edge-context-menu_kebab",onClick:s,d:`M${c+2},1 h12q${b},0 ${b},${b} v2 q0,${b} -${b},${b} h-${b} z`,style:Fm(a)}),(0,z.jsx)("g",{"data-cy":"node-context-menu_kebab",transform:`translate(${c+5}, ${d/4})`,children:(0,z.jsx)(C.bz,{style:{fill:"white"}})})]})]})};var $m=function(e){return e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom",e}($m||{});const Mm={[$m.Left]:{x:-1,y:0},[$m.Right]:{x:1,y:0},[$m.Top]:{x:0,y:-1},[$m.Bottom]:{x:0,y:1}};const Lm=({source:e,sourcePosition:t=$m.Bottom,target:n})=>t===$m.Left||t===$m.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Om=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),zm=e=>{const{target:t,style:n}=e;return(0,z.jsx)("g",{transform:`translate(${t.x-14}, ${t.y+25})`,children:(0,z.jsx)("polygon",{transform:"translate(0.5,0.5) ",points:" 0,7 0,-7 14,0",className:`pf-topology-connector-arrow pf-topology__edge pf-topology__edge ${n}`})})},Hm=(0,Dd.PAp)((e=>{const{element:t,contextMenuOpen:n,dragging:a,selected:s,onSelect:o,onContextMenu:i,targetDragRef:r,sourceDragRef:l,...c}=e,[d,u]=(0,Dd.Mks)(0),[m,p]=(0,Dd.Mks)(0),{path:h,centerPoint:b}=function(e){const t=e.getSource().getPosition(),n=e.getTarget().getPosition(),{path:a,labelCoordinates:s}=function({source:e,target:t,borderRadius:n=5,offset:a=20}){const[s,o,i]=function({source:e,sourcePosition:t=$m.Bottom,target:n,targetPosition:a=$m.Top,offset:s}){const o=Mm[t],i=Mm[a],r={x:e.x+o.x*s,y:e.y+o.y*s},l={x:n.x+i.x*s,y:n.y+i.y*s},c=Lm({source:r,sourcePosition:t,target:l}),d=0!==c.x?"x":"y",u=c[d];let m,p,h=[];const b={x:0,y:0},f={x:0,y:0},[g,y]=function({source:e,target:t}){const n=Math.abs(t.x-e.x)/2,a=t.x<e.x?t.x+n:t.x-n,s=Math.abs(t.y-e.y)/2;return[a,t.y<e.y?t.y+s:t.y-s]}({source:e,target:n});if(o[d]*i[d]==-1){m=g,p=y;const e=[{x:m,y:r.y},{x:m,y:l.y}],t=[{x:r.x,y:p},{x:l.x,y:p}];h=o[d]===u?"x"===d?e:t:"x"===d?t:e}else{const c=[{x:r.x,y:l.y}],g=[{x:l.x,y:r.y}];if(h="x"===d?o.x===u?g:c:o.y===u?c:g,t===a){const t=Math.abs(e[d]-n[d]);if(t<=s){const a=Math.min(s-1,s-t);o[d]===u?b[d]=(r[d]>e[d]?-1:1)*a:f[d]=(l[d]>n[d]?-1:1)*a}}if(t!==a){const e="x"===d?"y":"x",t=o[d]===i[e],n=r[e]>l[e],a=r[e]<l[e];(1===o[d]&&(!t&&n||t&&a)||1!==o[d]&&(!t&&a||t&&n))&&(h="x"===d?c:g)}const y={x:r.x+b.x,y:r.y+b.y},x={x:l.x+f.x,y:l.y+f.y};Math.max(Math.abs(y.x-h[0].x),Math.abs(x.x-h[0].x))>=Math.max(Math.abs(y.y-h[0].y),Math.abs(x.y-h[0].y))?(m=(y.x+x.x)/2,p=h[0].y):(m=h[0].x,p=(y.y+x.y)/2)}return[[e,{x:r.x+b.x,y:r.y+b.y},...h,{x:l.x+f.x,y:l.y+f.y},n],m,p]}({source:{x:e.x,y:e.y+25},sourcePosition:$m.Right,target:{x:t.x,y:t.y+25},targetPosition:$m.Left,offset:a});return{path:s.reduce(((e,t,a)=>{let o="";return o=a>0&&a<s.length-1?function(e,t,n,a){const s=Math.min(Om(e,t)/2,Om(t,n)/2,a),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i)return`L ${o+s*(e.x<n.x?-1:1)},${i}Q ${o},${i} ${o},${i+s*(e.y<n.y?1:-1)}`;const r=e.x<n.x?1:-1;return`L ${o},${i+s*(e.y<n.y?-1:1)}Q ${o},${i} ${o+s*r},${i}`}(s[a-1],t,s[a+1],n):`${0===a?"M":"L"}${t.x} ${t.y}`,e+o}),""),labelCoordinates:{x:o,y:i}}}({source:t,sourcePosition:$m.Right,target:n,targetPosition:$m.Right,borderRadius:15,offset:25});return{path:a,centerPoint:s}}(t),f=t.getSource().getId()===nm,g=t.getData();if(!g)return null;const{tag:y,tagStatus:x}=g,j=(0,Pr.A)(`pf-topology__edge ${Dd.UMg[x]}`,(d||m)&&"pf-m-hover");return(0,z.jsxs)(Dd.Wdr,{id:a?Dd.Wzh:void 0,...c,children:[(0,z.jsxs)("g",{"data-test-id":"workflow-visualizer-edge",className:j,fillOpacity:0,ref:u,onClick:o,children:[(0,z.jsx)("path",{className:"pf-topology__edge__background",d:h}),(0,z.jsx)("path",{strokeMiterlimit:25,strokeLinecap:"round",d:h,transform:"translate(0.5,0.5)",shapeRendering:"geometricPrecision",className:"pf-topology__edge__link"})]}),b?(0,z.jsx)(Nm,{hoverRef:p,xPoint:b.x,yPoint:b.y,status:x,isSourceRootNode:f,...e,children:y}):null,(0,z.jsx)(zm,{target:t.getTarget().getPosition(),style:`pf-topology-connector-arrow pf-topology__edge pf-topology__edge ${j}`})]})})),qm=({element:e,...t})=>{if(!(0,Dd.UPE)(e))throw new Error("CustomEdge must be used only on Edge elements");return(0,z.jsx)(Hm,{element:e,...t})};var Um=n(6458),Wm=n(21502),Jm=n(93690),Vm=n(80212),Gm=n(16614);const Ym={inventory_update:Um.KY,job:Wm.OD,project_update:$n.Ci,system_job:Jm.DP,workflow_approval:$d.O4,workflow_job:Vm.KZ,deleted_resource:$c.uc},Km=(0,Dd.PAp)((({element:e,onSelect:t,...n})=>{const{setSidebarMode:a}=Pm(),s=e.getData()?.resource?.summary_fields?.unified_job_template?.unified_job_type,o=e.getId(),i=e.getData();if(!i&&(0,Dd.Lln)(e))return null;const r=Ym[s??"deleted_resource"];return o!==nm?(0,z.jsx)(Dd.Icc,{showLabel:!0,element:e,labelClassName:`${o}-node-label`,onSelect:e=>{s&&(a("view"),t&&t(e))},truncateLength:20,...n,badge:i?.badge,badgeColor:i?.badgeColor,badgeTextColor:i?.badgeTextColor,badgeBorderColor:i?.badgeBorderColor,children:(0,z.jsx)("g",{transform:"translate(13, 13)",children:(0,z.jsx)(r,{style:{color:"#393F44"},width:25,height:25})})}):(0,z.jsx)(Dd.Icc,{...n,element:e,labelClassName:`${o}-node-label`,dragging:!1,truncateLength:20,badge:i?.badge,badgeColor:i?.badgeColor,badgeTextColor:i?.badgeTextColor,badgeBorderColor:i?.badgeBorderColor,children:(0,z.jsx)("g",{transform:"translate(13, 13)",children:(0,z.jsx)(Gm.fA,{style:{color:"#393F44"},width:25,height:25})})})}));function Zm(e){const{element:t}=e,n=t.getData(),a=function(e){const{t}=(0,I.Bd)(),{removeLink:n}=Pm(),a=(0,Dd.sjt)(),s=(0,Dd.XId)((t=>{t?(e.setState({modified:!0}),e.getSource().setState({modified:!0}),a.setState({...a.getState(),modified:!0})):(e.setState({modified:!1}),e.getSource().setState({modified:!1}))}));return[{key:"success",status:Zu.success,icon:(0,z.jsx)(y.I,{status:"success",children:(0,z.jsx)(nn.C1,{})}),label:t("Run on success"),onClick:n=>{(0,Dd.XId)((()=>{e.setData({...n,tag:t("Run on success"),tagStatus:Zu.success,endTerminalStatus:"success"}),s("success"!==n.originalStatus)}))()}},{key:"always",status:Zu.info,icon:(0,z.jsx)(y.I,{status:"info",children:(0,z.jsx)(T.GQ,{})}),label:t("Run always"),onClick:n=>{(0,Dd.XId)((()=>{e.setData({...n,tag:t("Run always"),tagStatus:Zu.info,endTerminalStatus:"info"}),s("info"!==n.originalStatus)}))()}},{key:"fail",status:Zu.danger,icon:(0,z.jsx)(y.I,{status:"danger",children:(0,z.jsx)(an.$Q,{})}),label:t("Run on fail"),onClick:n=>{(0,Dd.XId)((()=>{e.setData({...n,tag:t("Run on fail"),tagStatus:Zu.danger,endTerminalStatus:"fail"}),s("danger"!==n.originalStatus)}))()}},{key:"separator",label:"-"},{key:"remove-link",icon:(0,z.jsx)(y.I,{status:"danger",children:(0,z.jsx)($c.uc,{})}),isDanger:!0,label:t("Remove link"),onClick:()=>{n(e)}}]}(t);return a.map((e=>"-"===e.label?(0,z.jsx)(Dd.K5t,{component:"li"},`separator:${e.key}`):(0,z.jsx)(Dd.ktA,{"data-cy":e.key,icon:e.icon,isDanger:e.isDanger,onClick:()=>{e?.onClick&&n&&e.onClick(n)},children:e.label},e.key)))}const Xm=(0,A.Ay)(Pd.Z).withConfig({componentId:"ans__sc-19ll8tu-0"})(["position:absolute;background:--pf-v5-global--BackgroundColor--100;width:240px;min-height:300px;position:absolute;left:255px;bottom:60px;border-radius:var(--pf-v5-global--BorderRadius--sm);box-shadow:var(--pf-v5-global--BoxShadow--sm);z-index:1;"]),Qm=()=>{const{t:e}=(0,I.Bd)(),t=e=>{const{label:t,icon:n}=e;return(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{style:{marginRight:"10px"},children:n}),(0,z.jsx)("span",{children:t})]})};return(0,z.jsx)(Xm,{"data-cy":"workflow-visualizer-legend",children:(0,z.jsx)(Rd.s,{children:(0,z.jsx)(Bd.y,{children:(0,z.jsxs)($t.B,{children:[(0,z.jsxs)(At.W,{"data-cy":"legend-node-types",children:[(0,z.jsx)(Dt.X,{children:e("Node types")}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Job Template"),icon:(0,z.jsx)(Wm.OD,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Workflow Template"),icon:(0,z.jsx)(Vm.KZ,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Project Sync"),icon:(0,z.jsx)($n.Ci,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Approval Node"),icon:(0,z.jsx)($d.O4,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Inventory Update"),icon:(0,z.jsx)(Um.KY,{})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("System Job"),icon:(0,z.jsx)(Jm.DP,{})})})]}),(0,z.jsxs)(At.W,{"data-cy":"legend-node-status-types",children:[(0,z.jsx)(Dt.X,{children:e("Node status types")}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Failed"),icon:(0,z.jsx)(y.I,{status:"danger",children:(0,z.jsx)(an.$Q,{})})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Warning"),icon:(0,z.jsx)(y.I,{status:"warning",children:(0,z.jsx)(Ws.Pi,{})})})})]}),(0,z.jsxs)(At.W,{"data-cy":"legend-run-status-types",children:[(0,z.jsx)(Dt.X,{children:e("Run status types")}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Run on success"),icon:(0,z.jsxs)(y.I,{status:"success",children:[(0,z.jsx)(nn.C1,{})," "]})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Run on fail"),icon:(0,z.jsx)(y.I,{status:"danger",children:(0,z.jsx)(an.$Q,{})})})}),(0,z.jsx)(Et.d,{children:(0,z.jsx)(t,{label:e("Run always"),icon:(0,z.jsx)(y.I,{status:"info",children:(0,z.jsx)(T.GQ,{})})})})]})]})})})})};function ep(e){const{element:t}=e,n=function(e){const{t}=(0,I.Bd)(),{selectedIds:n}=(0,Dd.sjt)().getState(),{setSidebarMode:a}=Pm(),[s,o]=(0,Dd.Rwe)("selectedIds",n),{removeNodes:i}=Pm(),[r,l]=(0,Dd.Rwe)("sourceNode"),c=e.getId();return c===nm?[{key:"add-node",icon:(0,z.jsx)(Za.GY,{}),label:t("Add step"),onClick:()=>{a("add")}}]:[{key:"edit-node",icon:(0,z.jsx)(yc.oo,{}),label:t("Edit step"),onClick:()=>{(0,Dd.XId)((()=>{a("edit"),o([c])}))()}},{key:"add-node-and-link",icon:(0,z.jsx)(Za.GY,{}),label:t("Add step and link"),onClick:()=>{a("add"),l(e)}},{key:"separator",label:"-"},{key:"remove-node",icon:(0,z.jsx)(Nd.Kf,{}),isDanger:!0,label:t("Remove step"),onClick:()=>{i([e])}}]}(t);return n.map((e=>"-"===e.label?(0,z.jsx)(Dd.K5t,{component:"li"},`separator:${e.key}`):(0,z.jsx)(Dd.ktA,{"data-cy":e.key,icon:e.icon,isDanger:e.isDanger,onClick:()=>{e?.onClick&&e.onClick()},children:e.label},e.key)))}function tp(e){const{t}=(0,I.Bd)();switch(e){case 0:return t("0 (Normal)");case 1:return t("1 (Verbose)");case 2:return t("2 (More Verbose)");case 3:return t("3 (Debug)");case 4:return t("4 (Connection Debug)");case 5:return t("5 (WinRM Debug)");default:return""}}function np({source:e}){const{t}=(0,I.Bd)(),n=gr(),a=function(){const{data:e}=dd(xl`/inventory_sources/`),t=e?.actions?.GET?.source?.choices?.reduce(((e,[t,n])=>(e[t]=n,e)),{});return t??{}}(),s=tp(e.verbosity);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ft,{label:t("Organization"),isEmpty:!e.summary_fields.organization,children:(0,z.jsx)(Fe,{text:e.summary_fields.organization?.name,to:n(fc.OrganizationDetails,{params:{id:e.summary_fields.organization?.id}})})}),(0,z.jsx)(Ft,{label:t("Inventory"),isEmpty:!e.summary_fields.inventory,children:(0,z.jsx)(Fe,{text:e.summary_fields.inventory?.name,to:n(fc.InventoryDetails,{params:{id:e.summary_fields.inventory?.id}})})}),(0,z.jsx)(Ft,{label:t("Project"),isEmpty:!e.summary_fields.source_project,children:(0,z.jsx)(Fe,{text:e.summary_fields.source_project?.name,to:n(fc.ProjectDetails,{params:{id:e.summary_fields.source_project?.id}})})}),(0,z.jsx)(Ft,{label:t`Source`,children:a[e.source]}),(0,z.jsx)(Ft,{label:t`Inventory file`,children:""===e.source_path?t`/ (project root)`:e.source_path}),(0,z.jsx)(Ft,{label:t`Verbosity`,children:s}),(0,z.jsx)(Ft,{label:t`Source control branch`,children:e.scm_branch}),(0,z.jsx)(Ft,{label:t("Cache Timeout"),children:`${e?.update_cache_timeout} seconds`})]})}function ap(e){const{t}=(0,I.Bd)(),{label:n,children:a,isOverridden:s=!1,overriddenValue:o="",isEmpty:i=!1}=e;if(null==a||""===a)return(0,z.jsx)(z.Fragment,{});if(i)return(0,z.jsx)(z.Fragment,{});let r=null;if(s){const e=t("This prompt value has been overridden. The default value was: "),n=(0,z.jsxs)(z.Fragment,{children:[e," ",o]});r=(0,z.jsx)(x.m,{position:"right",content:n,children:(0,z.jsx)(y.I,{isInline:!0,size:"lg",iconSize:"sm",children:(0,z.jsx)(g.$n,{"aria-label":"Clipboard",variant:"plain",id:"tt-ref",children:(0,z.jsx)(Wm.OD,{})})})})}return(0,z.jsxs)(At.W,{children:[n&&(0,z.jsxs)(Dt.X,{children:[n,r]}),(0,z.jsx)(Et.d,{children:a})]})}function sp({label:e,nodeExtraVars:t,templateExtraVars:n}){const{id:a}=(0,Re.g)(),{t:s}=(0,I.Bd)(),o=t??n,i=o.trim()===n.trim();return(0,z.jsx)(ap,{label:e??s("Variables"),isEmpty:!o,isOverridden:!i,overriddenValue:n,children:(0,z.jsx)(qu.N,{id:a,children:(0,z.jsx)(Uu.s,{"data-cy":"code-block-value",children:o})})})}function op({label:e,nodeTags:t=[],templateTags:n=[]}){const a=t.length>0?t:n,s=function(e,t){if(e.length!==t.length)return!1;const n=new Set(e.map((e=>e.name))),a=new Set(t.map((e=>e.name)));if(n.size!==a.size)return!1;for(const e of n)if(!a.has(e))return!1;return!0}(a,n);return(0,z.jsx)(ap,{label:e,isEmpty:0===a?.length,isOverridden:!s,overriddenValue:n.map((e=>e.name)).join(", "),children:(0,z.jsx)(De.o,{children:a.map((e=>(0,z.jsx)(Ee.J,{children:e.name},e.name)))})})}function ip(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{label:e`GitHub`,value:"github"},{label:e`GitLab`,value:"gitlab"},{label:e`Bitbucket Data Center`,value:"bitbucket_dc"}]),[e])}function rp(e){const{service:t}=e,n=ip(),a=n.find((e=>e.value===t))?.label;if(a)return a}function lp({node:e,template:t}){const{t:n}=(0,I.Bd)(),a=gr(),{credentials:s,diffMode:o,executionEnvironment:i,forks:r,instanceGroups:l,inventory:c,jobSliceCount:d,jobTags:u,jobType:m,labels:p,limit:h,scmBranch:b,skipTags:f,templateCredentials:g,templateInstanceGroups:y,templateTimeoutString:x,templateVerbosityString:j,timeout:_,timeoutString:v,variables:w,verbosity:k,verbosityString:S,webhookKey:C}=function({template:e,node:t}){const{launch_data:n,survey_data:a,resource:s}=t,{data:o}=ec(s?.related?.labels),{data:i}=ec(e?.related?.webhook_key),{data:r}=ec(s?.related?.instance_groups),{data:l}=ec(e?.related?.instance_groups),{data:c}=ec(s?.related?.credentials),{data:d}=ec(e?.related?.credentials),{data:u}=tc(xl`/execution_environments/`,String(n?.execution_environment)),m=n?.credentials??c?.results??d?.results,p=n?.diff_mode??s?.diff_mode??e.diff_mode;let h;h=n?.execution_environment&&u?u:s?.summary_fields?.execution_environment??e.summary_fields.execution_environment;const b=Number(n?.forks??s?.forks??e.forks),f=n?.instance_groups??r?.results??l?.results,g=n?.inventory??s.summary_fields.inventory??e.summary_fields.inventory,y=n?.job_slice_count??s?.job_slice_count??e.job_slice_count,x=n?.job_tags??xm(s?.job_tags||e.job_tags),j=n?.job_type??s?.job_type??e.job_type,_=n?.labels??o?.results??e.summary_fields.labels?.results,v=n?.limit??s?.limit??e.limit,w=n?.scm_branch??s?.scm_branch??e.scm_branch,k=n?.skip_tags??xm(s?.skip_tags||e.skip_tags),S=Number(n?.timeout??s?.timeout??e.timeout),C=gm(S),T=gm(e.timeout),I=n?.verbosity??s?.verbosity??e.verbosity,A=tp(I),D=tp(e.verbosity);let E=n?.extra_vars??(s?.extra_data?om(JSON.stringify(s.extra_data)):void 0)??e.extra_vars;if(a){const e={};E&&E.split("\n").forEach((t=>{const[n,a]=t.split(":").map((e=>e.trim()));e[n]=a}));const t={...e,...a};E=om(JSON.stringify(t))}return{credentials:m,diffMode:p,executionEnvironment:h,forks:b,instanceGroups:f,inventory:g,jobSliceCount:y,jobTags:x,jobType:j,labels:_,limit:v,scmBranch:w,skipTags:k,templateCredentials:d,templateInstanceGroups:l,templateTimeoutString:T,templateVerbosityString:D,timeout:S,timeoutString:C,variables:E,verbosity:I,verbosityString:A,webhookKey:i}}({template:t,node:e});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ap,{label:n("Job type"),isEmpty:!m,isOverridden:m!==t.job_type,overriddenValue:t.job_type,children:m}),(0,z.jsx)(Ft,{label:n("Organization"),isEmpty:!t.summary_fields.organization,children:(0,z.jsx)(Fe,{text:t.summary_fields.organization?.name,to:a(fc.OrganizationDetails,{params:{id:t.summary_fields.organization?.id}})})}),(0,z.jsx)(ap,{label:n("Inventory"),isOverridden:c?.id!==t.summary_fields.inventory?.id,overriddenValue:t.summary_fields.inventory?.name,isEmpty:!c,children:(0,z.jsx)(Fe,{text:c?.name,to:a(fc.InventoryDetails,{params:{id:c?.id}})})}),(0,z.jsx)(Ft,{label:n("Project"),isEmpty:!t.summary_fields.project,children:(0,z.jsx)(Fe,{text:t.summary_fields.project?.name,to:a(fc.ProjectDetails,{params:{id:t.summary_fields.project?.id}})})}),(0,z.jsx)(ap,{isEmpty:!i,label:n("Execution environment"),overriddenValue:t.summary_fields?.execution_environment?.name,isOverridden:i?.id!==t.summary_fields?.execution_environment?.id,children:(0,z.jsx)(Fe,{text:i?.name,to:a(fc.ExecutionEnvironmentDetails,{params:{id:i?.id}})})}),(0,z.jsx)(cp,{credentials:s,templateCredentials:g?.results??[]}),(0,z.jsx)(dp,{instanceGroups:l,templateInstanceGroups:y?.results??[]}),(0,z.jsx)(Ft,{label:n("Playbook"),children:t.playbook}),(0,z.jsx)(ap,{label:n("Source control branch"),isEmpty:!b,isOverridden:b!==t.scm_branch,overriddenValue:t.scm_branch,children:b}),(0,z.jsx)(ap,{label:n("Forks"),isEmpty:!r,isOverridden:r!==t.forks,overriddenValue:t.forks,children:r}),(0,z.jsx)(ap,{label:n("Limit"),isEmpty:!h,isOverridden:h!==t.limit,overriddenValue:t.limit,children:h}),(0,z.jsx)(ap,{label:n("Verbosity"),isEmpty:!k,isOverridden:k!==t.verbosity,overriddenValue:j,children:S}),(0,z.jsx)(ap,{label:n("Show changes"),isEmpty:!o,isOverridden:o!==t.diff_mode,overriddenValue:t.diff_mode?n`On`:n`Off`,children:o?n`On`:n`Off`}),(0,z.jsx)(ap,{label:n("Job slicing"),isEmpty:!d,isOverridden:d!==t.job_slice_count,overriddenValue:t.job_slice_count,children:d}),(0,z.jsx)(ap,{label:n("Timeout"),isEmpty:!_,isOverridden:_!==t.timeout,overriddenValue:x,children:v}),(0,z.jsx)(Ft,{label:n("Webhook service"),isEmpty:!t.webhook_service,children:(0,z.jsx)(rp,{service:t.webhook_service})}),(0,z.jsx)(Ft,{label:n("Webhook key"),isEmpty:!C?.webhook_key,children:C?.webhook_key}),(0,z.jsx)(Ft,{label:n("Webhook url"),isEmpty:!C?.webhook_key,children:`${window.location.origin}${t.related.webhook_receiver}`}),(0,z.jsx)(Ft,{label:n("Enabled options"),isEmpty:!(t.allow_simultaneous||t.webhook_service),children:(0,z.jsxs)(Yl.K,{component:Yl.C.ul,children:[t.allow_simultaneous&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:n`Concurrent jobs`}),t.webhook_service&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:n`Webhooks`})]})}),(0,z.jsx)(op,{label:n("Labels"),nodeTags:p,templateTags:t.summary_fields.labels?.results}),(0,z.jsx)(op,{label:n("Job tags"),nodeTags:u,templateTags:xm(t.job_tags||"")}),(0,z.jsx)(op,{label:n("Skip tags"),nodeTags:f,templateTags:xm(t.skip_tags||"")}),(0,z.jsx)(sp,{label:n("Variables"),nodeExtraVars:w,templateExtraVars:t.extra_vars})]})}function cp({credentials:e=[],templateCredentials:t=[]}){const{t:n}=(0,I.Bd)(),a=up(e.map((({id:e})=>({id:e}))),t);return(0,z.jsx)(ap,{label:n`Credentials`,isEmpty:0===e?.length,isOverridden:!a,overriddenValue:t.map((e=>e.name)).join(", "),children:(0,z.jsx)(De.o,{children:e?.map((e=>(0,z.jsx)(uu,{credential:e},e.id)))})})}function dp({instanceGroups:e=[],templateInstanceGroups:t=[]}){const{t:n}=(0,I.Bd)(),s=up(e.map((({id:e})=>({id:e}))),t),o=gr();return(0,z.jsx)(ap,{label:n`Instance groups`,isEmpty:0===e?.length,isOverridden:!s,overriddenValue:t.map((e=>e.name)).join(", "),children:(0,z.jsx)(De.o,{children:e?.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:o(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))})})}function up(e,t){if(e.length!==t.length)return!1;const n=new Set(e.map((e=>e.id))),a=new Set(t.map((e=>e.id)));if(n.size!==a.size)return!1;for(const e of n)if(!a.has(e))return!1;return!0}const mp={inventory_update:fc.InventorySourceDetail,job:fc.JobTemplateDetails,project_update:fc.ProjectDetails,system_job:fc.ManagementJobSchedules,workflow_approval:fc.WorkflowApprovalDetails,workflow_job:fc.WorkflowJobTemplateDetails};function pp({nodeData:e}){const{t}=(0,I.Bd)(),n=gr(),{id:s,name:o,unified_job_type:i}=e.summary_fields?.unified_job_template||{};let r;if(i===am.inventory_update)r=(0,z.jsx)(hp,{id:s?.toString()||"",children:o});else if(i){const e=n(mp[i],{params:{id:s}});r=(0,z.jsx)(a.N_,{to:e,children:o})}return(0,z.jsx)(Ft,{label:t("Name"),children:i===am.workflow_approval||i===am.system_job?o:r})}function hp({id:e,children:t}){const n=gr(),{data:s}=ec(xl`/inventory_sources/${e}/`),o=s?.summary_fields?.inventory.kind||"inventory",i=s?.inventory,r=n(fc.InventorySourceDetail,{params:{source_id:s?.id,id:i,inventory_type:o}});return(0,z.jsx)(a.N_,{to:r,children:t})}function bp(e){const t=function(e){switch(e){case"git":return{text:"Git"};case"svn":return{text:"Svn"};case"":return{text:"Manual"};case"insights":return{text:"Insights"};case"archive":return{text:"Remote archive"};default:return{text:"Unknown"}}}(e.scmType);return(0,z.jsx)(Fe,{icon:t.icon,iconSize:"md",text:t.text})}function fp({project:e}){const{t}=(0,I.Bd)(),n=sc(),a=gr();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ft,{label:t("Organization"),isEmpty:!e.summary_fields.organization,children:(0,z.jsx)(Fe,{text:e.summary_fields.organization?.name,to:a(fc.OrganizationDetails,{params:{id:e.summary_fields.organization?.id}})})}),(0,z.jsx)(Ft,{label:t("Source control type"),children:(0,z.jsx)(bp,{scmType:e.scm_type})}),e.scm_revision&&(0,z.jsx)(Ft,{label:t("Source control revision"),children:(0,z.jsx)(ye,{text:e.scm_revision})}),(0,z.jsx)(Ft,{label:t("Source control URL"),children:e.scm_url}),(0,z.jsx)(Ft,{label:t("Source control branch"),children:e.scm_branch}),(0,z.jsx)(Ft,{label:t("Source control refspec"),children:e.scm_refspec}),(0,z.jsx)(Ft,{label:t("Cache timeout"),children:`${e.scm_update_cache_timeout} seconds`}),(0,z.jsx)(Ft,{label:t("Project Base Path"),children:n?.project_base_dir}),(0,z.jsx)(Ft,{label:t("Playbook directory"),children:e.local_path})]})}const gp=A.Ay.div.withConfig({componentId:"ans__sc-b4mvpe-0"})(["display:flex;justify-content:space-between;"]);function yp({onClose:e,title:t}){return(0,z.jsxs)(gp,{children:[(0,z.jsx)(Ge.h,{headingLevel:"h2",style:{padding:"16px 24px"},children:t}),(0,z.jsx)(g.$n,{variant:"plain",onClick:e,"aria-label":"Close",children:(0,z.jsx)(Kn.AX,{})})]})}function xp({node:e,template:t}){const{t:n}=(0,I.Bd)(),a=gr(),{data:s}=ec(t?.related?.webhook_key),{data:o}=ec(e?.resource?.related?.labels),{data:i}=ec(t?.related?.launch),r=t.allow_simultaneous||t.webhook_service,{launch_data:l,resource:c,survey_data:d}=e,u=l?.scm_branch??c?.scm_branch??t?.scm_branch,m=l?.limit??c?.limit??t?.limit,p=l?.inventory??c.summary_fields.inventory??t.summary_fields.inventory;let h=l?.extra_vars??(c?.extra_data?om(JSON.stringify(c.extra_data)):void 0)??t.extra_vars;if(d){const e={};h&&h.split("\n").forEach((t=>{const[n,a]=t.split(":").map((e=>e.trim()));e[n]=a}));const t={...e,...d};h=om(JSON.stringify(t))}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ft,{label:n("Organization"),isEmpty:!t.summary_fields.organization,children:(0,z.jsx)(Fe,{text:t.summary_fields.organization?.name,to:a(fc.OrganizationDetails,{params:{id:t.summary_fields.organization?.id}})})}),(0,z.jsx)(ap,{label:n("Inventory"),isOverridden:p?.id!==t.summary_fields.inventory?.id,overriddenValue:t.summary_fields.inventory?.name,isEmpty:!p,children:(0,z.jsx)(Fe,{text:p?.name,to:a(fc.InventoryDetails,{params:{id:p?.id}})})}),(0,z.jsx)(ap,{label:n("Source control branch"),isEmpty:!u,isOverridden:u!==t.scm_branch,overriddenValue:t.scm_branch,children:u}),(0,z.jsx)(ap,{label:n("Limit"),isEmpty:!m,isOverridden:m!==t.limit,overriddenValue:t.limit,children:m}),(0,z.jsx)(Ft,{label:n("Webhook service"),isEmpty:!t.webhook_service,children:(0,z.jsx)(rp,{service:t.webhook_service})}),(0,z.jsx)(Ft,{label:n("Webhook key"),isEmpty:!s?.webhook_key,children:s?.webhook_key}),(0,z.jsx)(Ft,{label:n("Webhook url"),isEmpty:!s?.webhook_key,children:`${window.location.origin}${t.related.webhook_receiver}`}),(0,z.jsx)(Ft,{label:n("Enabled options"),isEmpty:!r,children:(0,z.jsxs)(Yl.K,{component:Yl.C.ul,children:[t.allow_simultaneous&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:n`Concurrent jobs`}),t.webhook_service&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:n`Webhooks`})]})}),(0,z.jsx)(op,{label:n("Labels"),nodeTags:i?.ask_labels_on_launch?l?.labels??o?.results:t.summary_fields.labels?.results,templateTags:t.summary_fields.labels?.results}),(0,z.jsx)(op,{label:n("Job tags"),nodeTags:i?.ask_tags_on_launch?l?.job_tags??xm(c?.job_tags||""):xm(t.job_tags||""),templateTags:xm(t.job_tags||"")}),(0,z.jsx)(op,{label:n("Skip tags"),nodeTags:i?.ask_skip_tags_on_launch?l?.skip_tags??xm(c?.skip_tags||""):xm(t.skip_tags||""),templateTags:xm(t.skip_tags||"")}),(0,z.jsx)(sp,{label:n("Variables"),nodeExtraVars:h,templateExtraVars:t.extra_vars})]})}function jp({node:e}){const{t}=(0,I.Bd)(),n=e.getData(),a=n?.resource?.summary_fields?.unified_job_template,{data:s}=ec(function(e){if(!e)return"";switch(e?.unified_job_type){case"inventory_update":return xl`/inventory_sources/${e?.id.toString()}/`;case"job":return xl`/job_templates/${e?.id.toString()}/`;case"project_update":return xl`/projects/${e?.id.toString()}/`;case"workflow_job":return xl`/workflow_job_templates/${e?.id.toString()}/`;case"system_job":return xl`/system_job_templates/${e?.id.toString()}/`;case"workflow_approval":return xl`/workflow_approval_templates/${e?.id.toString()}/`;default:return""}}(n?.resource?.summary_fields.unified_job_template)),o=gm(a?.timeout||0),i=Qu(a?.unified_job_type),r=(0,Dd.sjt)(),{RBAC:l}=r.getState();if(!n)return null;let c;switch(s?.type){case"inventory_source":c=(0,z.jsx)(np,{source:s});break;case"job_template":c=(0,z.jsx)(lp,{node:n,template:s});break;case"project":c=(0,z.jsx)(fp,{project:s});break;case"workflow_job_template":c=(0,z.jsx)(xp,{node:n,template:s});break;case"system_job_template":c=(0,z.jsx)(Wu,{label:t("Variables"),value:om(JSON.stringify(n?.resource?.extra_data||{}))})}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(_p,{node:e}),(0,z.jsx)(ze,{borderTop:!0,children:(0,z.jsxs)(Mt,{numberOfColumns:"single",children:[(0,z.jsx)(pp,{nodeData:n?.resource}),(0,z.jsx)(Ft,{label:t("Type"),children:i}),(0,z.jsx)(Ft,{isEmpty:!a?.description,label:t("Description"),children:a?.description}),(0,z.jsx)(Ft,{label:t("Convergence"),children:t(n?.resource?.all_parents_must_converge?"All":"Any")}),(0,z.jsx)(Ft,{label:t("Timeout"),isEmpty:void 0===a?.timeout,children:o}),c,(0,z.jsx)(Ft,{label:t("Created"),isEmpty:!n?.resource?.created,children:(0,z.jsx)(Ie,{value:n?.resource?.created})}),(0,z.jsx)(Xd,{value:n?.resource?.modified})]})}),l?.edit&&(0,z.jsx)(vp,{node:e})]})}function _p({node:e}){const t=Ku(),n={inventory_update:Um.KY,job:Wm.OD,project_update:$n.Ci,system_job:Jm.DP,workflow_approval:$d.O4,workflow_job:Vm.KZ},a=e.getData(),s=a?.resource?.summary_fields.unified_job_template?.unified_job_type,o=s?n[s]:null;return(0,z.jsx)(yp,{title:(0,z.jsxs)(z.Fragment,{children:[o&&(0,z.jsx)(o,{style:{marginRight:"8px"}}),e.getLabel()]}),onClose:t})}function vp({node:e}){const{t}=(0,I.Bd)(),{setSidebarMode:n}=Pm(),{removeNodes:a}=Pm(),s=Ku();return(0,z.jsx)(Oe.d8,{variant:"light",isFilled:!1,className:"bg-lighten border-top",children:(0,z.jsxs)(Fn.l,{"data-cy":"workflow-topology-sidebar-actions",children:[(0,z.jsx)(g.$n,{"data-cy":"edit-node",variant:"primary",onClick:()=>n("edit"),children:t("Edit")}),(0,z.jsx)(g.$n,{"data-cy":"remove-node",variant:"danger",onClick:()=>{a([e]),s()},children:t("Remove")})]})})}var wp=n(23060);function kp(e){const{additionalControls:t,helperText:n,helperTextInvalid:a,isReadOnly:s,isRequired:o,isSubmitting:i,label:r,labelHelp:c,labelHelpTitle:d,onHandleClear:u,onHandleSelection:m,options:p,placeholderText:h,value:b}=e,[f,g]=(0,l.useState)(!1),y=M(e);return(0,z.jsx)(Vo,{fieldId:y,label:r,labelHelp:c,labelHelpTitle:d??r,helperTextInvalid:a,isRequired:o,additionalControls:t,helperText:n,children:(0,z.jsx)(Qo.l,{chipGroupComponent:(()=>{if(!b)return;const e=b.filter((e=>e.name&&""!==e.name.trim()));return(0,z.jsx)(Ln.I,{children:e.map((e=>(0,z.jsx)(Mn.v,{onClick:()=>{u(e.name)},children:e.name},e.name)))})})(),variant:wp.ez.typeaheadMulti,isCreatable:!0,placeholderText:!b?.length&&h?h:void 0,isOpen:f,isCreateOptionOnTop:!0,onClear:()=>u(),id:y,ouiaId:"menu-select",selections:b?.length?b:void 0,onToggle:()=>{g(!f)},onSelect:(e,t)=>{g(!f),m("string"==typeof t?{name:t}:t)},isDisabled:s||i,children:p.map((e=>{const t=L(e);return(0,z.jsx)(ei.O,{value:e.value,"data-cy":t,children:e.label},`${e.label}`)}))})})}function Sp(e){const{additionalControls:t,id:n,isReadOnly:a,isRequired:s,label:o,labelHelp:i,labelHelpTitle:r,name:l,options:c,placeholderText:d,validate:u}=e,{control:m,formState:{isSubmitting:p},getValues:h}=(0,oo.xW)(),b=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:e.name,control:m,shouldUnregister:!0,render:({field:{onChange:u,value:m},fieldState:{error:b}})=>(0,z.jsx)(kp,{additionalControls:t,helperTextInvalid:b?.message,id:n??l,isReadOnly:a,isSubmitting:p,isRequired:s,label:o,labelHelp:i,labelHelpTitle:r??o,options:c,placeholderText:d,value:m,onHandleClear:t=>{const n=h(e.name);u(t?n.filter((e=>e.name!==t)):[])},onHandleSelection:t=>{let n;const a=t,s=h(e.name);return n=s?.find((e=>e.name===a.name))?s.filter((e=>e!==a)):s?.length?[...s,a]:[a],u(n)}}),rules:{required:b,validate:u}})}function Cp(e){const{title:t,view:n,tableColumns:a,toolbarFilters:s,confirmText:o,cancelText:i,onSelect:r}=e,[c,d]=ss();let u=(0,l.useCallback)((()=>d(void 0)),[d]);e.onClose&&(u=e.onClose);const[m]=W(),p=Gt(a);return(0,z.jsx)(Zt.a,{title:t,"aria-label":t,ouiaId:t,isOpen:!0,onClose:u,variant:Zt.d.medium,tabIndex:0,actions:[(0,z.jsx)(g.$n,{variant:"primary",id:"submit",onClick:()=>{u(),n.selectedItems.length>0&&r(n.selectedItems[0])},isAriaDisabled:0===n.selectedItems.length,children:o??m.confirmText},"submit"),(0,z.jsx)(g.$n,{id:"cancel",variant:"link",onClick:u,children:i??m.cancelText},"cancel")],hasNoBodyWrapper:!0,children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",maxHeight:500,overflow:"hidden"},children:(0,z.jsx)($s,{tableColumns:p,toolbarFilters:s,...n,emptyStateTitle:e.emptyStateTitle??m.noItemsFound,errorStateTitle:e.errorStateTitle??m.errorText,disableCardView:!0,disableListView:!0,compact:!0,disableBodyPadding:!0,onSelect:()=>{},autoHidePagination:!0})})})}function Tp(e){const t=M(e),{control:n,formState:a}=(0,oo.xW)(),{isSubmitting:s,isValidating:o}=a,[i]=W(),r=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:e.name,control:n,shouldUnregister:!0,render:({field:{value:n,onChange:a},fieldState:{error:r}})=>{const l=r?.message?e.validate&&o?i.validating:r?.message:void 0;let c=e.isDisabled;return!c&&e.isReadOnly&&(c=(0,po.t)("Readonly")),s&&(c=(0,po.t)("Submitting")),(0,z.jsx)(Vo,{fieldId:t,label:e.label,labelHelpTitle:e.labelHelpTitle??e.label,labelHelp:e.labelHelp,helperText:e.helperText,helperTextInvalid:l,isRequired:e.isRequired,additionalControls:e.additionalControls,children:(0,z.jsx)(ca,{id:t,"data-cy":t??name,placeholder:e.placeholder,queryOptions:e.queryOptions,queryPlaceholder:e.queryPlaceholder,queryErrorText:e.queryErrorText,"aria-describedby":t?`${t}-form-group`:void 0,value:n,onSelect:a,isDisabled:c,footer:e.footer,onBrowse:e.onBrowse,queryLabel:e.queryLabel,disableAutoSelect:!0,isRequired:e.isRequired,writeInOption:e.writeInOption})})},rules:{required:r,validate:e.validate}})}function Ip(e){const{data:t,isLoading:n,error:a}=tc(e.url,e.id,{refreshInterval:0});if(void 0===e.id)return null;if(n)return(0,z.jsx)(Wn.y,{size:"md"});if(a)return"RequestError"===a.name&&404===a.statusCode?e.id.toString():a.message;if(!t)return e.id.toString();const s=t[e.field??"name"];switch(typeof s){case"string":return s;case"number":return s.toString();default:return e.id.toString()}}function Ap(e){const t=M(e),n=(0,l.useCallback)((async t=>{try{const n=e.url.split("?")[0],a=e.url.split("?")[1],s=new URLSearchParams(a);if(s.delete("page_size"),s.set("page_size","10"),s.delete("order_by"),s.set("order_by","name"),e.queryParams)for(const[t,n]of Object.entries(e.queryParams))if(Array.isArray(n))for(const e of n)s.set(t,e);else s.set(t,n);t.next&&s.set("name__gt",t.next.toString()),t.search&&s.set("name__icontains",t.search);const o=await nl(n+"?"+decodeURIComponent(s.toString()),t.signal);return{remaining:o.count-o.results.length,options:o.results?.map((e=>({label:e.name,value:e.id,description:e.description})))??[],next:o.results[o.results.length-1]?.name}}catch(e){return{remaining:0,options:[],next:0}}}),[e.url,e.queryParams]),[a,s]=ss(),{setValue:o}=(0,oo.xW)(),i=(0,oo.FH)({name:e.name}),r=(0,l.useCallback)((t=>{s((0,z.jsx)(Dp,{title:e.label,url:e.url,onSelect:t,toolbarFilters:e.toolbarFilters,tableColumns:e.tableColumns,defaultSelection:i?[{id:i}]:[],queryParams:e.queryParams}))}),[e.label,e.tableColumns,e.toolbarFilters,e.url,s,i,e.queryParams]),c=(0,l.useCallback)((t=>(0,z.jsx)(Ip,{url:e.url.split("?")[0],id:t})),[e.url]);return(0,z.jsx)(Tp,{id:t,name:e.name,label:e.label,queryOptions:n,placeholder:e.placeholder,queryPlaceholder:e.queryPlaceholder,queryErrorText:e.queryErrorText,isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,labelHelp:e.labelHelp,onBrowse:()=>r((t=>o(e.name,t.id))),queryLabel:c,additionalControls:e.additionalControls})}function Dp(e){const t=(0,l.useMemo)((()=>new URLSearchParams(e.url.split("?")[1])),[e.url]),n=(0,l.useMemo)((()=>{const e={};return t.forEach(((t,n)=>e[n]=t)),e}),[t]),a=Uc({url:e.url.split("?")[0],toolbarFilters:e.toolbarFilters,tableColumns:e.tableColumns,disableQueryString:!0,defaultSelection:e.defaultSelection,queryParams:e.queryParams??n});return(0,z.jsx)(Cp,{title:e.title,onSelect:e.onSelect,toolbarFilters:e.toolbarFilters??[],tableColumns:e.tableColumns,view:a})}function Ep(e){const{t}=(0,I.Bd)(),n=yr(),a=(0,l.useCallback)((e=>n(fc.CredentialDetails,{params:{id:e.id}})),[n]),s=mu(),o=pu({...e,onClick:a}),i=hu(),r=bu(e),c=fu(e),{results:d}=cm(xl`/credential_types/`),u=(0,l.useMemo)((()=>{const e={};if(d){for(const t of d){const{id:n,name:a}=t;n&&a&&(e[n]=a)}return e}return{}}),[d]);return(0,l.useMemo)((()=>[s,o,i,{id:"credential_type",header:t("Credential type"),cell:e=>u&&u[e.credential_type]?u[e.credential_type]:t("Unknown"),card:"subtitle",list:"subtitle"},r,c]),[s,o,i,t,r,c,u])}function Pp(e){const{optionsPath:t,preSortedKeys:n,preFilledValueKeys:a,additionalFilters:s,removeFilters:o}=(0,l.useRef)(e).current,{t:i}=(0,I.Bd)(),r=xl`/${t}/`,c=decodeURIComponent(r),{data:d}=dd(c),u=(m=d?.actions?.GET,(0,l.useMemo)((()=>m?Object.entries(m).reduce(((e,[t,n])=>(n.filterable&&e.push({key:t,type:n.type,label:n.label,query:t,options:n.choices?n.choices.map((([e,t])=>({value:e,label:t}))):[]}),e)),[]):[]),[m]));var m;const p=(0,l.useCallback)((async(e,t)=>{const n=Rp[t]||a?.[t],s=n.labelKey||t,o=n.valueKey||t,i=await nl(function(e,t,n,a,s){let o=xl`/${t}/?page_size=20&order_by=${a}`;return e.next&&(o+=`&${a}__gt=${e.next}`),e.search&&(o+=`&${n}__icontains=${e.search}`),s&&Object.entries(s).forEach((([e,t])=>{if(Array.isArray(t))for(const n of t)o+=`&${e}=${n}`;else o+=`&${e}=${t}`})),decodeURIComponent(o)}(e,n.apiPath,s,o,n.queryParams),e.signal);let r="";if(i.results.length>0){const e=i.results[i.results.length-1][o];r=e?.toString()??""}return{remaining:i.count-i.results.length,options:i.results.map((e=>({label:e[s]?.toString()||"",value:e[o]?.toString()||""}))),next:r}}),[a]),h=(0,l.useCallback)(((e,t)=>{const n=Rp[t]||a?.[t];return n?(0,z.jsx)(Ip,{url:xl`/${n.apiPath}/`,id:e,field:n.labelKey}):e}),[a]),b=(0,l.useMemo)((()=>((e,t,n,a,s)=>{const o=[];return e.forEach((e=>{let t=!(!n||!n[e.key]);Rp[e.key]&&(t=!0),"choice"===e.type?o.push({key:e.key,label:i(e.label),type:Ia.MultiSelect,placeholder:i("Select {{field}}",{field:e.label.toLowerCase()}),query:e.query,options:e.options?e.options:[],disableSortOptions:!0}):"boolean"===e.type?o.push({key:e.key,label:i(e.label),type:Ia.SingleSelect,placeholder:i("Filter by {{field}}",{field:e.label.toLowerCase()}),query:e.query,options:[{label:i("True"),value:"true"},{label:i("False"),value:"false"}],disableSortOptions:!0}):"datetime"===e.type?o.push({key:e.key,label:i(e.label),type:Ia.DateRange,placeholder:i("Filter by {{field}}",{field:e.label.toLowerCase()}),query:e.query,options:[{label:i("Last hour"),value:ha.LastHour},{label:i("Last 24 hours"),value:ha.Last24Hours},{label:i("Last 7 days"),value:ha.LastWeek},{label:i("Last 30 days"),value:ha.LastMonth}]}):t?o.push({key:e.key,query:e.query,label:i(e.label),type:Ia.AsyncMultiSelect,queryOptions:t=>p(t,e.key),placeholder:i("Select {{field}}",{field:e.label.toLowerCase()}),queryPlaceholder:i("Loading..."),queryErrorText:i("Failed to load options."),queryLabel:t=>h(t,e.key)}):o.push({key:e.key,label:i(e.label),type:Ia.MultiText,query:`${e.key}__icontains`,comparison:"contains",placeholder:i("Filter by {{field}} ({{fieldType}})",{field:e.label.toLowerCase(),fieldType:e.type.toLowerCase()})})})),a&&o.length>0&&(Array.isArray(a)?o.push(...a):o.push(a)),t&&t.length>0&&o.sort(((e,n)=>{const a=t.indexOf(e.key),s=t.indexOf(n.key);return-1===a&&-1===s?0:-1===a?1:-1===s?-1:a-s})),s&&o.length>0?o.filter((e=>!s.includes(e.key))):o})(u,n,a,s,o)),[u,n,a,s,o,i,p,h]);return b}const Rp={credential_type:{apiPath:"credential_types",labelKey:"name",valueKey:"id"},credential:{apiPath:"credentials",labelKey:"name",valueKey:"id"},default_environment:{apiPath:"execution_environments",labelKey:"name",valueKey:"id"},organization:{apiPath:"organizations",labelKey:"name",valueKey:"id"},project:{apiPath:"projects",labelKey:"name",valueKey:"id"},execution_environment:{apiPath:"execution_environments",labelKey:"name",valueKey:"id"},unified_job_template:{apiPath:"unified_job_templates",labelKey:"name",valueKey:"id"},execution_node:{labelKey:"hostname",apiPath:"instances",valueKey:"id",queryParams:{node_type:"execution"}},controller_node:{labelKey:"hostname",valueKey:"id",apiPath:"instances",queryParams:{node_type:"control"}},inventory:{apiPath:"inventories",labelKey:"name",valueKey:"id"},last_job:{apiPath:"unified_jobs",labelKey:"id",valueKey:"id"}};function Bp(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"name",label:e("Name"),type:Ia.MultiText,query:"name__icontains",comparison:"contains"})),[e])}function Fp(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"description",label:e("Description"),type:Ia.MultiText,query:"description__icontains",comparison:"contains"})),[e])}function Np(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"created-by",label:e("Created by"),type:Ia.MultiText,query:"created_by__username__icontains",comparison:"contains"})),[e])}function $p(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"modified-by",label:e("Modified by"),type:Ia.MultiText,query:"modified_by__username__icontains",comparison:"contains"})),[e])}function Mp(){return Pp({optionsPath:"credentials",preSortedKeys:["name","credential_type","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:"credentials"},id:{apiPath:"credentials"}},additionalFilters:[Np(),$p()]})}function Lp(e){const t=M(e),{control:n,formState:a}=(0,oo.xW)(),{isSubmitting:s,isValidating:o}=a,[i]=W(),r=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:e.name,control:n,shouldUnregister:!0,render:({field:{value:n,onChange:a},fieldState:{error:r}})=>{const l=r?.message?e.validate&&o?i.validating:r?.message:void 0;let c=e.isDisabled;return!c&&e.isReadOnly&&(c=(0,po.t)("Readonly")),s&&(c=(0,po.t)("Submitting")),(0,z.jsx)(Vo,{fieldId:t,label:e.label,labelHelpTitle:e.labelHelpTitle??e.label,labelHelp:e.labelHelp,helperText:e.helperText,helperTextInvalid:l,isRequired:e.isRequired,additionalControls:e.additionalControls,children:(0,z.jsx)(ta,{id:t,"data-cy":t??name,placeholder:e.placeholder,queryOptions:e.queryOptions,queryPlaceholder:e.queryPlaceholder,queryErrorText:e.queryErrorText,"aria-describedby":t?`${t}-form-group`:void 0,values:n,onSelect:e=>a(e(n)),isDisabled:c,footer:e.footer,disableClearChips:e.disableClearChips,disableClearSelection:e.disableClearSelection,onBrowse:e.onBrowse,queryLabel:e.queryLabel,compareOptionValues:e.compareOptionValues})})},rules:{required:r,validate:e.validate}})}function Op(e){const{formatLabel:t}=e,n=M(e),a=(0,l.useCallback)((async n=>{try{const a=e.url.split("?")[0],s=e.url.split("?")[1],o=new URLSearchParams(s);if(o.delete("page_size"),o.set("page_size","10"),o.delete("order_by"),o.set("order_by","name"),e.queryParams)for(const[t,n]of Object.entries(e.queryParams))if(Array.isArray(n))for(const e of n)o.set(t,e);else o.set(t,n);n.next&&o.set("name__gt",n.next.toString()),n.search&&o.set("name__icontains",n.search);const i=await nl(a+"?"+decodeURIComponent(o.toString()),n.signal);return{remaining:i.count-i.results.length,options:i.results?.map((e=>({value:e,description:e.description,label:t?t(e):e.name})))??[],next:i.results[i.results.length-1]?.name}}catch(e){return{remaining:0,options:[],next:0}}}),[e.url,e.queryParams,t]),[s,o]=ss(),{setValue:i}=(0,oo.xW)(),r=(0,oo.FH)({name:e.name}),c=(0,l.useCallback)((t=>{o((0,z.jsx)(zp,{title:e.label,url:e.url,onSelect:t,toolbarFilters:e.toolbarFilters,tableColumns:e.tableColumns,queryParams:e.queryParams,defaultSelection:r&&Array.isArray(r)?r.map((e=>({id:e.id}))):[]}))}),[e.label,e.tableColumns,e.toolbarFilters,e.url,o,r,e.queryParams]),d=(0,l.useCallback)((t=>(0,z.jsx)(Ip,{url:e.url.split("?")[0],id:t.id})),[e.url]);return(0,z.jsx)(Lp,{id:n,name:e.name,label:e.label,queryOptions:a,placeholder:e.placeholder,queryPlaceholder:e.queryPlaceholder,queryErrorText:e.queryErrorText,isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,labelHelp:e.labelHelp,onBrowse:()=>c((t=>{t&&i(e.name,t.map((e=>e)))})),queryLabel:d,additionalControls:e.additionalControls,compareOptionValues:e.compareOptionValues,validate:e.validate})}function zp(e){const t=(0,l.useMemo)((()=>new URLSearchParams(e.url.split("?")[1])),[e.url]),n=(0,l.useMemo)((()=>{let n={};return t.forEach(((e,t)=>n[t]=e)),n={...n,...e.queryParams},n}),[t,e.queryParams]),a=Uc({url:e.url.split("?")[0],toolbarFilters:e.toolbarFilters,tableColumns:e.tableColumns,disableQueryString:!0,defaultSelection:e.defaultSelection,queryParams:n});return(0,z.jsx)(Xs,{title:e.title,onSelect:e.onSelect,toolbarFilters:e.toolbarFilters??[],tableColumns:e.tableColumns,view:a})}function Hp(e){const{t}=(0,I.Bd)(),n=Ep({disableLinks:!0}),a=Mp(),s=function(e=!1){const{t}=(0,I.Bd)();return(0,l.useCallback)((async n=>{const a=[],s=[];n?.forEach((e=>"summary_fields"in e?s.push(e):a.push(e.id)));const o=[...await Promise.all(a.map((e=>nl(xl`/credentials/${e.toString()}/`))))||[],...s],i=o.filter((e=>"vault"===e.kind&&e.inputs.vault_id)).map((e=>e.inputs.vault_id.toString())),r=o.filter((e=>"vault"!==e.kind)).map((e=>e.summary_fields.credential_type.name)),l=i.filter(((e,t,n)=>n.indexOf(e)!==n.lastIndexOf(e))).length>0,c=[...new Set(r.filter(((e,t,n)=>n.indexOf(e)!==n.lastIndexOf(e))))];return c.length>0&&!e?t(`Cannot assign multiple credentials of the same type. Duplicated credential types are: ${c.join(", ")}`):l?t("Cannot assign multiple vault credentials of the same vault id."):void 0}),[t,e])}(!!e?.allowDuplicateCredentialTypes);return e.isMultiple?(0,z.jsx)(Op,{name:e.name,id:e.id?e.id:"credential",label:e.label?e.label:t("Credential"),placeholder:e.placeholder?e.placeholder:t("Select credentials"),queryPlaceholder:t("Loading credentials..."),queryErrorText:t("Error loading credentials"),isRequired:e.isRequired,isDisabled:e.isDisabled,labelHelp:e.labelHelp,url:xl`/credentials/`,tableColumns:n,toolbarFilters:a,queryParams:e.queryParams,additionalControls:e.additionalControls,compareOptionValues:(e,t)=>e.id===t.id,validate:s,formatLabel:e=>`${e.name} | ${e.summary_fields.credential_type.name}`}):(0,z.jsx)(Ap,{name:e.name,id:e.id?e.id:"credential",label:e.label?e.label:t("Credential"),placeholder:e.placeholder?e.placeholder:t("Select credential"),queryPlaceholder:t("Loading credentials..."),queryErrorText:t("Error loading credentials"),isRequired:e.isRequired,isDisabled:e.isDisabled,labelHelp:e.labelHelp,url:xl`/credentials/`,tableColumns:n,toolbarFilters:a,queryParams:e.queryParams,additionalControls:e.additionalControls})}function qp(e){const{t}=(0,I.Bd)(),n=yr(),a=(0,l.useCallback)((e=>n(fc.ExecutionEnvironmentDetails,{params:{id:e.id}})),[n]),s=pu({...e,onClick:a}),o=mu(),i=hu(),r=gu(fc.OrganizationDetails,e,t("Globally available")),c=bu(e),d=fu(e);return(0,l.useMemo)((()=>[o,s,i,{header:t("Image"),cell:e=>e.image,sort:"image"},r,c,d]),[o,s,i,t,r,c,d])}function Up({url:e}={}){const t=(e?e.replace(yl,""):"")||"execution_environments";return Pp({optionsPath:t,preSortedKeys:["name","id","image","created-by","modified-by"],preFilledValueKeys:{id:{apiPath:t},name:{apiPath:t}},additionalFilters:[Np(),$p()]})}function Wp(e){const{t}=(0,I.Bd)(),n=qp({disableLinks:!0}),a=Up();return(0,z.jsx)(Ap,{name:e.name,id:"executionEnvironment",label:e.label??t("Execution environment"),placeholder:t("Select execution environment"),queryPlaceholder:t("Loading execution environments..."),queryErrorText:t("Error loading execution environments"),isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,url:xl`/execution_environments/`,queryParams:e.organizationId?{or__organization__id:e.organizationId.toString(),or__organization__isnull:"True"}:void 0,tableColumns:n,toolbarFilters:a,additionalControls:e.additionalControls})}function Jp(e){const{t}=(0,I.Bd)(),n=e&&e.disableLinks,a=gr(),s=bu(e),o=fu(e);return(0,l.useMemo)((()=>[{header:t("Name"),cell:e=>(0,z.jsx)(Fe,{to:n?void 0:a(fc.InstanceGroupDetails,{params:{id:e.id}}),text:e.name}),sort:"name",card:"name",list:"name"},{header:t("Type"),cell:e=>(0,z.jsx)(Fe,{text:e.is_container_group?t("Container group"):t("Instance group")}),card:"subtitle",list:"subtitle"},{header:t("Running jobs"),cell:e=>e.jobs_running},{header:t("Total jobs"),cell:e=>e.jobs_total},{header:t("Instances"),cell:e=>e.instances},{header:t("Used capacity"),cell:e=>e.is_container_group?null:e.capacity?(0,z.jsx)(Qt.k,{value:Math.round(100-e.percent_capacity_remaining)}):(0,z.jsx)(Fe,{text:t("Unavailable"),color:"red"}),list:"secondary"},s,o]),[t,s,o,n,a])}function Vp(e){const{t}=(0,I.Bd)(),n=Jp({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=e=>e?.summary_fields?.user_capabilities?.delete?void 0:t("The instance group cannot be deleted due to insufficient permission."),r=(0,l.useCallback)((async(e,n)=>{let a=[];if(e.length>1&&(a=[t("Deleting instance groups could impact other resources that rely on them.",{count:e.length-n.length})]),n.length>0&&a.push(t("{{count}} of the selected instance groups cannot be deleted due to insufficient permission.",{count:n.length})),1===e.length&&!n.length){const n=await async function(e){const t=await nl(xl`/organizations/?instance_groups=${e.id.toString()}`),n=await nl(xl`/inventories/?instance_groups=${e.id.toString()}`),a=await nl(xl`/unified_job_templates/?instance_groups=${e.id.toString()}`);return{totalResourceCount:t?.count+a?.count+n?.count,relatedOrganizationsCount:t?.count??0,relatedInventoriesCount:n?.count??0,relatedTemplatesCount:a?.count??0}}(e[0]);if(n?.totalResourceCount>0){let e=t("This instance group is currently being used by other resources: ");n.relatedTemplatesCount>0&&(n.totalResourceCount-n.relatedTemplatesCount>0?e+=t("{{count}} templates, ",{count:n.relatedTemplatesCount}):e+=t("{{count}} templates",{count:n.relatedTemplatesCount})),n.relatedOrganizationsCount>0&&(n.relatedInventoriesCount>0?e+=t("{{count}} organizations, ",{count:n.relatedOrganizationsCount}):e+=t("{{count}} organizations",{count:n.relatedOrganizationsCount})),n.relatedInventoriesCount>0&&(e+=t("{{count}} inventories",{count:n.relatedInventoriesCount})),a=[e]}}return a}),[t]);return async a=>{const l=a.filter(i),c=await r(a,l),d=a.every((e=>e.is_container_group));o({title:t(d?"Permanently delete container groups":"Permanently delete instance groups",{count:a.length}),confirmText:t(d?"Yes, I confirm that I want to delete these {{count}} container groups.":"Yes, I confirm that I want to delete these {{count}} instance groups.",{count:a.length-l.length}),actionButtonText:d?t("Delete container group"):t("Delete instance group",{count:a.length-l.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/instance_groups/${e.id.toString()}/`,t),alertPrompts:c,isItemNonActionable:i})}}function Gp(){const{data:e}=dd(xl`/instance_groups/`),{t}=(0,I.Bd)();return(0,l.useMemo)((()=>e&&e.actions&&e.actions.POST?void 0:t("You do not have permission to create an instance group. Please contact your organization administrator if there is an issue with your access.")),[e,t])}function Yp(e){const{t}=(0,I.Bd)(),n=yr(),a=Vp(e),i=(0,Re.g)();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:yc.oo,isPinned:!0,variant:i.id?g.Ak.primary:g.Ak.plain,label:t("Edit instance group"),isDisabled:e=>e.summary_fields?.user_capabilities?.edit?void 0:t("You do not have permission to edit this instance group. Please contact your organization administrator if there is an issue with your access."),isHidden:e=>e.is_container_group,onClick:e=>n(fc.EditInstanceGroup,{params:{id:e.id}})},{type:s.Button,selection:o.Single,icon:yc.oo,variant:i.id?g.Ak.primary:g.Ak.plain,isPinned:!0,label:t("Edit container group"),isDisabled:e=>e.summary_fields?.user_capabilities?.edit?void 0:t("You do not have permission to edit this container group. Please contact your organization administrator if there is an issue with your access."),isHidden:e=>!e.is_container_group,onClick:e=>n(fc.EditContainerGroup,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete instance group"),isDisabled:e=>e.summary_fields?.user_capabilities?.delete?void 0:t("You do not have permission to delete this instance group. Please contact your organization administrator if there is an issue with your access."),isHidden:e=>e.is_container_group,onClick:e=>a([e]),isDanger:!0},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete container group"),isDisabled:e=>e.summary_fields?.user_capabilities?.delete?void 0:t("You do not have permission to delete this container group. Please contact your organization administrator if there is an issue with your access."),isHidden:e=>!e.is_container_group,onClick:e=>a([e]),isDanger:!0}]),[a,n,t,i.id])}function Kp(){const{t:e}=(0,I.Bd)(),t=Zp(),n=Jp(),a=Uc({url:xl`/instance_groups/`,toolbarFilters:t,tableColumns:n}),i=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Vp(e),i=Gp();return(0,l.useMemo)((()=>[{type:s.Dropdown,icon:Za.GY,variant:g.Ak.primary,isPinned:!0,selection:o.None,label:t("Create group"),isDisabled:i,actions:[{type:s.Button,selection:o.None,label:t("Create container group"),onClick:()=>n(fc.CreateContainerGroup)},{type:s.Button,selection:o.None,label:t("Create instance group"),onClick:()=>n(fc.CreateInstanceGroup)}]},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete instance groups"),onClick:a,isDanger:!0}]),[a,i,n,t])}(a.unselectItemsAndRefresh),r=Yp(a.unselectItemsAndRefresh),c=Gp();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Instance Groups"),titleHelpTitle:e("Instance Groups"),titleHelp:e("An instance group provides the ability to group instances in a clustered environment. It defines grouped instances or grouped containers."),description:e("An instance group provides the ability to group instances in a clustered environment."),headerActions:(0,z.jsx)(cd,{type:"instance_group"})}),(0,z.jsx)($s,{id:"awx-instance-groups-table",toolbarFilters:t,toolbarActions:i,tableColumns:n,rowActions:r,errorStateTitle:e("Error loading instance groups"),emptyStateTitle:e(c?"You do not have permission to create an instance group.":"No instance groups yet"),emptyStateDescription:e(c?"Please contact your organization administrator if there is an issue with your access.":"Please create an instance group by using the button below."),emptyStateIcon:c?Xa.IN:void 0,emptyStateActions:c?void 0:i.slice(0,1),...a,defaultSubtitle:e("Instance Group")})]})}function Zp(){return Pp({optionsPath:"instance_groups",preSortedKeys:["name","id"],preFilledValueKeys:{name:{apiPath:"instance_groups"},id:{apiPath:"instance_groups"}}})}function Xp(e){const{t}=(0,I.Bd)(),n=Jp(),a=Zp();return(0,z.jsx)(Op,{...e,name:e.name,tableColumns:n,toolbarFilters:a,queryPlaceholder:t("Loading instance groups..."),queryErrorText:t("Error loading instance groups"),url:xl`/instance_groups/`,id:"instance-group-select",placeholder:t("Select instance groups"),labelHelp:e.labelHelp,label:t("Instance groups"),isRequired:e.isRequired,compareOptionValues:(e,t)=>e.id===t.id})}function Qp(e){const{labelHelpTitle:t,labelHelp:n,name:a,placeholderText:s,additionalControls:o}=e,{t:i}=(0,I.Bd)(),{results:r,isLoading:l}=cm(xl`/labels/`,{order_by:"name"}),c=l?[{name:""}]:r;return(0,z.jsx)(Sp,{labelHelpTitle:t,labelHelp:n,name:a,placeholderText:s??i("Select or create labels"),label:i("Labels"),additionalControls:o??void 0,options:c?.map((e=>({value:e,label:e.name})))??[{label:"",value:""}]})}function eh(e){const{isRequired:t,label:n,loadingErrorText:a,loadingPlaceholder:s,name:o,openSelectDialog:i,placeholder:r,query:c,valueToString:d,valueToDescription:u,labelHelp:m,labelHelpTitle:p,additionalControls:h}=e,b=M(e),{control:f,setValue:g,formState:{isSubmitting:y}}=(0,oo.xW)(),[x,j]=(0,l.useState)(),[_]=W(),v=(0,l.useCallback)((e=>(g(o,void 0),j(void 0),c(e).then((e=>(1===e.total&&1===e.values.length&&g(o,e.values[0]),e))).catch((e=>(e instanceof Error?j(e):j(new Error(_.unknownError)),{total:0,values:[]}))))),[_.unknownError,o,c,g]),w=bo(e.label,e.isRequired);return(0,z.jsx)(oo.xI,{name:o,control:f,shouldUnregister:!0,render:({field:{onChange:l,value:c},fieldState:{error:f}})=>(0,z.jsx)(Vo,{fieldId:b,label:n,labelHelp:m,labelHelpTitle:p??n,helperTextInvalid:x?a:f?.message,isRequired:t,additionalControls:h,children:(0,z.jsx)(th,{id:b,variant:e.variant,query:v,valueToString:d,valueToDescription:u,placeholder:r,loadingPlaceholder:s,value:c,onSelect:l,isReadOnly:e.isReadOnly||y,validated:x?.message||f?.message?"error":void 0,isRequired:t,limit:e.limit,openSelectDialog:i,loadingError:!!x,labeledBy:`${o}-form-group`})}),rules:{required:w}})}function th(e){const{id:t,isReadOnly:n,labeledBy:a,loadingError:s,loadingPlaceholder:o,onSelect:i,placeholder:r,query:c,validated:d,variant:u}=e,[m,p]=(0,l.useState)(!1),[h]=(0,l.useState)((()=>e.valueToString)),[b]=(0,l.useState)((()=>e.valueToDescription)),f=(0,l.useMemo)((()=>{if(e.value)return new nh(e.value,h)}),[e.value,h]),[y,x]=(0,l.useState)(null),[j,_]=(0,l.useState)(!1),[v]=W(),[w,k]=(0,l.useState)(!1),S=(0,l.useCallback)((()=>{k((t=>t||(x([]),c(e.limit).then((t=>{1===t.total&&1===t.values.length&&i(t.values[0]),t.total>e.limit?(_(!0),x([])):(_(!1),x(t.values.map((e=>new nh(e,h)))))})).catch((()=>null)).finally((()=>k(!1))),!0)))}),[i,e.limit,c,h]);(0,l.useEffect)(S,[S]);const C=(0,l.useCallback)(((e,t)=>(y??[]).filter((e=>!t||!!e&&-1!==e.toString().toLowerCase().indexOf(t.toLowerCase()))).map((e=>{const t=L(e.toString());return(0,z.jsx)(ei.O,{value:e,description:"option"in e&&e.option?b?.(e.option):void 0,"data-cy":t,children:e.toString()},e.toString())}))),[y,b]);return(0,z.jsxs)(ga.M,{children:[(0,z.jsx)(ya.b,{isFill:!0,children:(0,z.jsx)(Qo.l,{toggleId:t,ouiaId:"menu-select","aria-labelledby":a,variant:u?wp.ez[`${u}`]:wp.ez.single,hasPlaceholderStyle:!0,placeholderText:s?v.clickToRefresh:o&&w?o:r,typeAheadAriaLabel:r,"data-cy":"dropdown-menu",selections:f,onSelect:(e,t)=>{"object"==typeof t&&"option"in t&&t.option&&(i(t.option),p(!1))},onClear:f&&!e.isRequired?()=>i(null):void 0,isOpen:m,onToggle:(t,n)=>{s?S():n?j&&e.openSelectDialog?e.openSelectDialog(i,e.value):p(!0):p(!1)},toggleIndicator:w?(0,z.jsx)(Wn.y,{size:"md",style:{margin:-1,marginBottom:-3},"data-cy":"loading-spinner"}):s?(0,z.jsx)($n.Ci,{}):j?(0,z.jsx)(pn.WI,{"data-cy":"lookup-button"}):void 0,validated:d,isDisabled:null===y||w||n,onFilter:C,hasInlineFilter:null!==y&&y.length>10,menuAppendTo:"parent",maxHeight:"45vh",footer:e.openSelectDialog?(0,z.jsx)(g.$n,{"data-cy":"browse-button",variant:"link",onClick:()=>{p(!1),e.openSelectDialog?.(i,e.value)},children:"Browse"}):void 0,children:(y??[]).map((e=>(0,z.jsx)(ei.O,{value:e,description:"option"in e&&e.option?b?.(e.option):void 0,children:e.toString()},e.toString())))})}),e.showRefreshButton&&!1===w?(0,z.jsx)(g.$n,{variant:"control",onClick:S,children:(0,z.jsx)($n.Ci,{})}):(0,z.jsx)(z.Fragment,{}),e.showRefreshButton&&!0===w?(0,z.jsx)(g.$n,{variant:"control",isDisabled:!0,children:(0,z.jsx)(Wn.y,{size:"md",style:{margin:-1,marginBottom:-3}})}):(0,z.jsx)(z.Fragment,{})]})}class nh{constructor(e,t){this.option=e,this.asString=t}toString(){return this.asString(this.option)}compareTo(e){return this.toString()===e.toString()}}function ah(e){const t=yr(),{t:n}=(0,I.Bd)(),a=(0,l.useCallback)((e=>t(fc.InventoryDetails,{params:{inventory_type:{"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"}[e.kind],id:e.id}})),[t]),s=pu({...e,onClick:a}),o=bu(e),i=hu(),r=fu(e),c=gu(fc.OrganizationDetails,e),d=(0,l.useMemo)((()=>({header:n("Type"),type:"text",value:e=>{switch(e.kind){case"smart":return n("Smart inventory");case"constructed":return n("Constructed inventory");default:return n("Inventory")}},card:"subtitle",list:"subtitle",dashboard:"hidden"})),[n]),u=(0,l.useMemo)((()=>({header:n("Status"),cell:e=>{if(""!==e.kind)return null;let t="disabled";e.has_inventory_sources&&(t=e.inventory_sources_with_failures?"error":"successful","status"in e&&(t=e.status));let a="";return a=e.has_inventory_sources?n`No inventory sync failures`:n`Not configured for inventory sync.`,a?(0,z.jsx)(x.m,{content:a,position:"top",children:(0,z.jsx)(au,{status:t})}):(0,z.jsx)(au,{status:t})}})),[n]);return(0,l.useMemo)((()=>[s,i,u,d,c,o,r]),[s,i,u,d,c,o,r])}function sh(){const e=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"inventory-type",label:e("Inventory type"),type:Ia.MultiSelect,query:"kind",options:[{label:e("Inventory"),value:""},{label:e("Smart inventory"),value:"smart"},{label:e("Constructed inventory"),value:"constructed"}],placeholder:e("Select types"),disableSortOptions:!0})),[e])}();return Pp({optionsPath:"inventories",preSortedKeys:["name","id","created-by","modified-by","inventory-type"],preFilledValueKeys:{name:{apiPath:"inventories"},id:{apiPath:"inventories"}},additionalFilters:[Np(),$p(),e],removeFilters:["kind"]})}function oh(e){const t=sh(),n=ah({disableLinks:!0}),a=Uc({url:xl`/inventories/`,toolbarFilters:t,tableColumns:n,disableQueryString:!0});return(0,z.jsx)(Cp,{...e,toolbarFilters:t,tableColumns:n,view:a})}function ih(e){const{t}=(0,I.Bd)(),n=function(){const[e,t]=ss(),{t:n}=(0,I.Bd)();return(0,l.useCallback)((e=>{t((0,z.jsx)(oh,{title:n("Select inventory"),onSelect:e}))}),[t,n])}(),a=(0,l.useCallback)((async()=>{const e=await nl(xl`/inventories/`.concat("?page_size=200"));return Promise.resolve({total:e.count,values:e.results})}),[]);return(0,z.jsx)(eh,{name:e.name,id:"inventory",variant:"typeahead",additionalControls:e.additionalControls,label:t("Inventory"),query:a,valueToString:e=>e?.name??"",placeholder:t("Select inventory"),labelHelpTitle:t("Inventory"),labelHelp:e.labelHelp??t("Select the inventory containing the playbook you want this job to execute."),loadingPlaceholder:t("Loading inventories..."),loadingErrorText:t("Error loading inventories"),isRequired:e.isRequired,limit:200,openSelectDialog:n})}function rh(e){const{t}=(0,I.Bd)(),n=ah({disableLinks:!0}),a=sh();return(0,z.jsx)(Ap,{name:e.name,id:"inventory",label:t("Inventory"),placeholder:t("Select inventory"),queryPlaceholder:t("Loading inventories..."),queryErrorText:t("Error loading inventories"),isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,labelHelp:e.labelHelp,url:xl`/inventories/`,tableColumns:n,toolbarFilters:a})}function lh({isHidden:e=!1,children:t}){return e?null:(0,z.jsx)(z.Fragment,{children:t})}function ch(){const{t:e}=(0,I.Bd)(),{wizardData:t,setStepData:n}=vr(),{reset:a}=(0,oo.xW)(),s=(0,oo.FH)({name:"prompt"}),{launch_config:o,resource:i,prompt:r}=t,c=i,d=c?.organization??null;return(0,l.useEffect)((()=>{n((e=>({...e,nodePromptsStep:{prompt:s}})))}),[s,n]),(0,l.useEffect)((()=>{if(!o||!o?.defaults)return;const{defaults:e}=o,t=e?.labels?.map((e=>({...e,isReadOnly:!0}))),s={credentials:r?.credentials??e.credentials,diff_mode:r?.diff_mode??e.diff_mode,execution_environment:r?.execution_environment??e.execution_environment?.id,extra_vars:r?.extra_vars??e.extra_vars,forks:r?.forks??e.forks,instance_groups:r?.instance_groups??e.instance_groups,inventory:r?.inventory??(e.inventory.id?e.inventory:null),job_slice_count:r?.job_slice_count??e.job_slice_count,job_tags:r?.job_tags??xm(e.job_tags),job_type:r?.job_type??e.job_type,labels:r?.labels??t,limit:r?.limit??e.limit,organization:r?.organization??d,scm_branch:r?.scm_branch??e.scm_branch,skip_tags:r?.skip_tags??xm(e.skip_tags),timeout:r?.timeout??e.timeout,verbosity:r?.verbosity??e.verbosity,defaults:e};n((e=>({...e,nodePromptsStep:{prompt:s}}))),a({prompt:s})}),[a,d,n,o,r]),o&&c?(0,z.jsxs)(mo,{isVertical:!0,singleColumn:!0,children:[(0,z.jsx)(lh,{isHidden:!o.ask_inventory_on_launch,children:(0,z.jsx)(ih,{name:"prompt.inventory",isRequired:!0})}),(0,z.jsx)(lh,{isHidden:!o.ask_credential_on_launch,children:(0,z.jsx)(Hp,{name:"prompt.credentials",label:e("Credentials"),placeholder:e("Select credentials"),labelHelp:e('Select credentials for accessing the nodes this job will be ran against. You can only select one credential of each type. For machine credentials (SSH), checking "Prompt on launch" without selecting credentials will require you to select a machine credential at run time. If you select credentials and check "Prompt on launch", the selected credential(s) become the defaults that can be updated at run time.'),isMultiple:!0})}),(0,z.jsx)(lh,{isHidden:!o.ask_execution_environment_on_launch,children:(0,z.jsx)(Wp,{name:"prompt.execution_environment",organizationId:d})}),(0,z.jsx)(lh,{isHidden:!o.ask_instance_groups_on_launch,children:(0,z.jsx)(Xp,{name:"prompt.instance_groups",labelHelp:e("Select the instance groups for this template to run on.")})}),(0,z.jsx)(lh,{isHidden:!o.ask_job_type_on_launch,children:(0,z.jsx)(ti,{isRequired:!0,id:"job_type",label:e("Job type"),labelHelpTitle:e("Job type"),labelHelp:e("Select a job type for this job template."),name:"prompt.job_type",options:[{label:e("Check"),value:"check"},{label:e("Run"),value:"run"}],placeholderText:e("Select job type")})}),(0,z.jsx)(lh,{isHidden:!o.ask_scm_branch_on_launch,children:(0,z.jsx)(li,{name:"prompt.scm_branch",placeholder:e("Add a source control branch"),labelHelpTitle:e("Source control branch"),labelHelp:e("Branch to use in job run. Project default used if blank. Only allowed if project allow_override field is set to true."),label:e("Source control branch")})}),(0,z.jsx)(lh,{isHidden:!o.ask_labels_on_launch,children:(0,z.jsx)(Qp,{labelHelpTitle:e("Labels"),labelHelp:e("Optional labels that describe this job template, such as 'dev' or 'test'. Labels can be used to group and filter job templates and completed jobs."),name:"prompt.labels"})}),(0,z.jsx)(lh,{isHidden:!o.ask_forks_on_launch,children:(0,z.jsx)(li,{id:"forks",label:e("Forks"),labelHelpTitle:e("Forks"),labelHelp:e("The number of parallel or simultaneous processes to use while executing the playbook. An empty value, or a value less than 1 will use the Ansible default which is usually 5. The default number of forks can be overwritten with a change to ansible.cfg. Refer to the Ansible documentation for details about the configuration file."),name:"prompt.forks",type:"number",placeholder:e("Add number of forks"),min:0})}),(0,z.jsx)(lh,{isHidden:!o.ask_limit_on_launch,children:(0,z.jsx)(li,{id:"limit",label:e("Limit"),labelHelpTitle:e("Limit"),labelHelp:e("Provide a host pattern to further constrain the list of hosts that will be managed or affected by the playbook. Multiple patterns are allowed. Refer to Ansible documentation for more information and examples on patterns."),name:"prompt.limit",placeholder:e("Add a limit to reduce number of hosts.")})}),(0,z.jsx)(lh,{isHidden:!o.ask_verbosity_on_launch,children:(0,z.jsx)(ti,{name:"prompt.verbosity",label:e("Verbosity"),labelHelpTitle:e("Verbosity"),labelHelp:e("Control the level of output Ansible will produce as the playbook executes."),options:[{label:e`0 (Normal)`,value:0},{label:e`1 (Verbose)`,value:1},{label:e`2 (More Verbose)`,value:2},{label:e`3 (Debug)`,value:3},{label:e`4 (Connection Debug)`,value:4},{label:e`5 (WinRM Debug)`,value:5}],placeholderText:e("Select a verbosity value")})}),(0,z.jsx)(lh,{isHidden:!o.ask_job_slice_count_on_launch,children:(0,z.jsx)(li,{id:"job_slice_count",label:e("Job slicing"),labelHelpTitle:e("Job slicing"),labelHelp:e("Divide the work done by this job template into the specified number of job slices, each running the same tasks against a portion of the inventory."),name:"prompt.job_slice_count",type:"number",placeholder:e("Add number of slices")})}),(0,z.jsx)(lh,{isHidden:!o.ask_timeout_on_launch,children:(0,z.jsx)(li,{id:"timeout",label:e("Timeout"),labelHelpTitle:e("Timeout"),labelHelp:e("The amount of time (in seconds) to run before the task is canceled and considered failed. A value of 0 means no timeout."),name:"prompt.timeout",type:"number",placeholder:e("Add timeout")})}),(0,z.jsx)(lh,{isHidden:!o.ask_diff_mode_on_launch,children:(0,z.jsx)(ni,{id:"diff_mode",label:e("Show changes"),labelHelpTitle:e("Show changes"),labelHelp:e("If enabled, show the changes made by Ansible tasks, where supported. This is equivalent to Ansible's --diff mode."),name:"prompt.diff_mode"})}),(0,z.jsx)(lh,{isHidden:!o.ask_tags_on_launch,children:(0,z.jsx)(Sp,{labelHelpTitle:e("Job tags"),labelHelp:e("Tags are useful when you have a large playbook, and you want to run a specific part of a play or task. Use commas to separate multiple tags. Refer to the documentation for details on the usage of tags."),name:"prompt.job_tags",placeholderText:e("Select or create job tags"),label:e("Job tags"),options:xm(c?.job_tags)||[]})}),(0,z.jsx)(lh,{isHidden:!o.ask_skip_tags_on_launch,children:(0,z.jsx)(Sp,{labelHelpTitle:e("Job tags"),labelHelp:e("Skip tags are useful when you have a large playbook, and you want to skip specific parts of a play or task. Use commas to separate multiple tags. Refer to the documentation for details on the usage of tags."),name:"prompt.skip_tags",placeholderText:e("Select or create skip tags"),label:e("Skip tags"),options:xm(c?.skip_tags)||[]})}),(0,z.jsx)(lh,{isHidden:!o.ask_variables_on_launch,children:(0,z.jsx)(Go,{labelHelpTitle:e("Variables"),labelHelp:e("Optional extra variables to be applied to job template"),label:e("Variables"),name:"prompt.extra_vars",format:"yaml"})})]}):null}function dh(){const{t:e}=(0,I.Bd)(),t=gr(),{wizardData:{prompt:n,resource:s,survey:o}}=vr(),{inventory:i,credentials:r,instance_groups:l,execution_environment:c,diff_mode:d,scm_branch:u,extra_vars:m,forks:p,job_slice_count:h,job_tags:b,job_type:f,labels:g,limit:y,skip_tags:x,timeout:j,verbosity:_}=n||{},{data:v}=ec(function(e){if(!e)return"";switch(e?.type){case"job_template":return xl`/job_templates/${e?.id.toString()}/survey_spec/`;case"workflow_job_template":return xl`/workflow_job_templates/${e?.id.toString()}/survey_spec/`;default:return""}}(s)),{data:w}=tc(xl`/execution_environments/`,String(c)),k="string"==typeof b?xm(b):b,S="string"==typeof x?xm(x):x,C=tp(Number(_));let T=m||"{}";if(o&&(T=function(e,t,n){const a=e?JSON.parse(im(e)):{},s={...t};if(n?.spec){const e=function(e,t){const n={...e};return t.forEach((e=>{void 0!==n[e]&&(n[e]="$encrypted$")})),n}(t,n.spec.filter((e=>"password"===e.type)).map((e=>e.variable)));Object.keys(e).forEach((t=>{s[t]=e[t]}))}const o={...a,...s};return om(JSON.stringify(o))}(m,o,v??null)),!s)return null;const A=s.summary_fields?.organization;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ft,{label:e("Job type"),children:f}),(0,z.jsx)(Ft,{label:e("Organization"),isEmpty:!A,children:(0,z.jsx)(a.N_,{to:t(fc.OrganizationDetails,{params:{id:A?.id}}),children:A?.name})}),(0,z.jsx)(Ft,{label:e`Inventory`,isEmpty:!i?.id,children:(0,z.jsx)(a.N_,{to:t(fc.InventoryDetails,{params:{id:i?.id?.toString(),inventory_type:{"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"}[i?.kind??""]}}),children:i?.name})}),"job_template"===s.type&&(0,z.jsx)(Ft,{label:e`Project`,isEmpty:!s.summary_fields.project,children:(0,z.jsx)(a.N_,{to:t(fc.ProjectDetails,{params:{id:s.summary_fields?.project?.id}}),children:s.summary_fields.project?.name})}),(0,z.jsx)(Ft,{label:e`Execution environment`,isEmpty:mh(c),children:(0,z.jsx)(a.N_,{to:t(fc.ExecutionEnvironmentDetails,{params:{id:c?c.toString():""}}),children:w?.name})}),(0,z.jsx)(Ft,{label:e("Source control branch"),children:u}),"job_template"===s.type&&(0,z.jsx)(Ft,{label:e("Playbook"),children:s?.playbook}),(0,z.jsx)(Ft,{label:e("Credentials"),isEmpty:mh(r),children:(0,z.jsx)(De.o,{children:Array.isArray(r)&&r.length>0?r?.map((e=>(0,z.jsx)(uh,{credentialID:e.id},e.id))):null})}),(0,z.jsx)(Ft,{label:e`Instance groups`,helpText:e`The instance groups for this job template to run on.`,isEmpty:mh(l),children:(0,z.jsx)(De.o,{children:l?.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:t(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))})}),(0,z.jsx)(Ft,{label:e("Forks"),children:p||0}),(0,z.jsx)(Ft,{label:e("Limit"),children:y}),(0,z.jsx)(Ft,{label:e("Verbosity"),children:C}),(0,z.jsx)(Ft,{label:e("Timeout"),children:j||0}),(0,z.jsx)(Ft,{label:e("Show changes"),children:d?e`On`:e`Off`}),(0,z.jsx)(Ft,{label:e("Job slicing"),children:h}),(0,z.jsx)(Ft,{label:e("Labels"),isEmpty:mh(g),children:(0,z.jsx)(De.o,{children:g?.map((e=>(0,z.jsx)(Ee.J,{children:e.name},e.id)))})}),(0,z.jsx)(Ft,{label:e("Job tags"),isEmpty:mh(k),children:(0,z.jsx)(De.o,{children:k?.map((({name:e})=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{label:e("Skip tags"),isEmpty:mh(S),children:(0,z.jsx)(De.o,{children:S?.map((({name:e})=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Wu,{label:e("Extra vars"),value:T})]})}function uh({credentialID:e}){const{data:t}=ec(xl`/credentials/${e?.toString()}/`);return t?(0,z.jsx)(uu,{credential:t},e):null}function mh(e){return null==e||(Array.isArray(e)?0===e.length:"object"==typeof e&&(0===Object.keys(e).length||Object.values(e).every(mh)))}const ph={inventory_update:fc.InventorySourceDetail,job:fc.JobTemplateDetails,project_update:fc.ProjectDetails,system_job:fc.ManagementJobSchedules,workflow_approval:fc.WorkflowApprovalDetails,workflow_job:fc.WorkflowJobTemplateDetails};function hh(){const{t:e}=(0,I.Bd)(),t=gr(),{wizardData:n,visibleSteps:s}=vr(),{approval_name:o,approval_description:i,node_type:r,resource:l,approval_timeout:c,node_alias:d,node_convergence:u,node_days_to_keep:m,survey:p}=n,{data:h}=ec(function(e){if(!e)return"";switch(e?.type??e?.unified_job_type){case"job_template":case"job":return xl`/job_templates/${e?.id.toString()}/survey_spec/`;case"workflow_job_template":case"workflow_job":return xl`/workflow_job_templates/${e?.id.toString()}/survey_spec/`;default:return""}}(l??null)),b=Boolean(s.find((e=>"nodePromptsStep"===e.id))),f=Qu(r),g=vm(r,l?.name||"",o),y=vm(r,l?.description||"",i),x=e("all"===u?"All":"Any"),j=vm(r,"",gm(c)),_=r===am.system_job&&_m(l),v=_?om(JSON.stringify({days:m})):"";let w=t(ph[r],{params:{id:l?.id}}),k="{}";return p&&h&&(k=function(e,t){const n={...e};if(t?.spec){const a=function(e,t){const n={...e};return t.forEach((e=>{void 0!==n[e]&&(n[e]="$encrypted$")})),n}(e,t.spec.filter((e=>"password"===e.type)).map((e=>e.variable)));Object.keys(a).forEach((e=>{n[e]=a[e]}))}return om(JSON.stringify(n))}(p,h??null)),l&&"type"in l&&"inventory_source"===l.type&&(w=t(fc.InventorySourceDetail,{params:{source_id:l?.id,id:l?.inventory,inventory_type:""===l?.summary_fields?.inventory.kind?"inventory":l?.summary_fields?.inventory.kind}})),(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Mt,{numberOfColumns:"single",children:[(0,z.jsx)(Ft,{label:e("Type"),children:f}),(0,z.jsx)(Ft,{label:e("Name"),children:(0,z.jsx)(a.N_,{to:w,children:g})}),(0,z.jsx)(Ft,{label:e("Description"),children:y}),(0,z.jsx)(Ft,{label:e("Timeout"),children:j}),(0,z.jsx)(Ft,{label:e("Convergence"),children:x}),(0,z.jsx)(Ft,{label:e("Alias"),children:d}),_?(0,z.jsx)(Wu,{label:e("Extra vars"),value:v}):null,b?(0,z.jsx)(dh,{}):null,!b&&p?(0,z.jsx)(Wu,{label:e("Extra vars"),value:k}):null]})})}var bh=n(43018);function fh(e){const t=(0,oo.FH)({name:e.watch}),{setError:n}=(0,oo.xW)();return(0,z.jsx)(z.Fragment,{children:e.children(t,n)})}function gh(){const{t:e}=(0,I.Bd)(),t=gr();return(0,l.useMemo)((()=>[{id:"name",header:e("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name,to:t(fc.ManagementJobSchedules,{params:{id:e.id}})}),sort:"name",card:"name",list:"name"},{header:e("Description"),cell:e=>(0,z.jsx)(Fe,{text:e.description})}]),[e,t])}function yh(){return Pp({optionsPath:"system_job_templates",preFilledValueKeys:{name:{apiPath:"system_job_templates"},id:{apiPath:"system_job_templates"}},preSortedKeys:["name","id","created-by","modified-by"],additionalFilters:[Np(),$p()]})}function xh(e){const t=yh(),n=gh(),a=Uc({url:xl`/system_job_templates/`,toolbarFilters:t,tableColumns:n,disableQueryString:!0});return(0,z.jsx)(Cp,{...e,toolbarFilters:t,tableColumns:n,view:a})}function jh(e){const{t}=(0,I.Bd)(),n=function(){const[e,t]=ss(),{t:n}=(0,I.Bd)();return(0,l.useCallback)((e=>{t((0,z.jsx)(xh,{title:n("Select a system job"),onSelect:e}))}),[t,n])}(),a=(0,l.useCallback)((async()=>{const e=await nl(xl`/system_job_templates/`);return Promise.resolve({total:e.count,values:e.results})}),[]);return(0,z.jsx)(eh,{name:e.name,id:"management-job-template-select",label:t("Management job template"),query:a,valueToString:e=>e&&"string"==typeof e?e:e?.name??"",placeholder:t("Select a management job template"),loadingPlaceholder:t("Loading management job templates..."),loadingErrorText:t("Error loading management job templates"),isRequired:e.isRequired,limit:200,openSelectDialog:n})}function _h(e){const{t}=(0,I.Bd)(),{data:n,error:a,isLoading:s}=dd(xl`/inventory_sources/`),o=yr(),i=(0,l.useCallback)((e=>o(fc.InventorySourceDetail,{params:{inventory_type:"inventory",id:e.inventory.toString(),source_id:e.id}})),[o]),r=n?.actions?.GET?.source?.choices,c=pu({...e,onClick:i}),d=hu(),u=(0,l.useMemo)((()=>({header:t("Type"),type:"text",value:e=>{if(a||s)return;let t="";return r?.find((([n,a])=>e.source===n?t=a:null)),t},card:"subtitle",list:"subtitle"})),[t,a,s,r]),m=(0,l.useMemo)((()=>({header:t("Status"),cell:e=>(0,z.jsx)(au,{status:e.status})})),[t]);return(0,l.useMemo)((()=>[c,d,m,u]),[c,d,m,u])}function vh(e){return Pp({optionsPath:e||"inventory_sources",preFilledValueKeys:{name:{apiPath:e||"inventory_sources"},id:{apiPath:e||"inventory_sources"}},preSortedKeys:["name","id","description"]})}function wh(e){const{title:t,inventoryId:n,onSelect:a}=e,s=_h({disableLinks:!0}),o=n?xl`/inventories/${n.toString()}/inventory_sources/`:xl`/inventory_sources/`,i=vh(o),r=Uc({url:o,toolbarFilters:i,tableColumns:s,disableQueryString:!0});return(0,z.jsx)(Cp,{title:t,onSelect:a,toolbarFilters:i,tableColumns:s,view:r})}function kh(e){const{name:t,inventoryId:n,isRequired:a=!1}=e,{t:s}=(0,I.Bd)(),o=function(e){const[t,n]=ss(),{t:a}=(0,I.Bd)();return(0,l.useCallback)((t=>{n((0,z.jsx)(wh,{title:a("Select inventory source"),inventoryId:e,onSelect:t}))}),[n,e,a])}(n),i=(0,l.useCallback)((async()=>{const e=await nl(null==n?xl`/inventory_sources/?page_size=200`:xl`/inventories/${n.toString()}/inventory_sources/?page_size=200`);return Promise.resolve({total:e.count,values:e.results})}),[n]);return(0,z.jsx)(eh,{name:t,id:"inventory-source-select",label:s("Inventory source"),query:i,valueToString:e=>e?.name??"",placeholder:s("Select inventory source"),loadingPlaceholder:s("Loading inventory sources..."),loadingErrorText:s("Error loading inventory sources"),isRequired:a,limit:200,openSelectDialog:o})}function Sh(e){const{t}=(0,I.Bd)(),n=function(e){const{t}=(0,I.Bd)(),{disableLinks:n}=e??{},s=gr();return(0,l.useMemo)((()=>({header:t("Name"),cell:e=>e.custom_virtualenv&&!e.default_environment?(0,z.jsxs)(ee.B,{children:[(0,z.jsx)(xe.o,{style:{marginRight:"8px"},children:(0,z.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:n?e.name:(0,z.jsx)(a.N_,{to:s(fc.ProjectDetails,{params:{id:e.id}}),children:e.name})})}),(0,z.jsx)(xe.o,{children:(0,z.jsx)(x.m,{content:t("Custom virtual environment {{venvName}} must be replaced by an execution environment.",{venvName:e.custom_virtualenv}),position:"right",children:(0,z.jsx)(Be,{size:"sm",color:"warning",children:(0,z.jsx)(Ws.Pi,{})})})})]}):(0,z.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:n?e.name:(0,z.jsx)(a.N_,{to:s(fc.ProjectDetails,{params:{id:e.id}}),children:e.name})}),sort:"name",card:"name",list:"name",defaultSort:!0})),[t,n,s])}({disableLinks:e?.disableLinks}),s=hu(),o=gu(fc.OrganizationDetails,e),i=bu(e),r=fu(e),c=function(e){const{t}=(0,I.Bd)(),n=gr();return(0,l.useMemo)((()=>({header:t("Status"),cell:t=>t.summary_fields?.current_job||t.summary_fields?.last_job?(0,z.jsx)(x.m,{content:e?.tooltip??"",position:"top",children:(0,z.jsx)(au,{status:t.status,to:n(fc.JobOutput,{params:{job_type:t.type,id:t.summary_fields?.current_job?.id??t.summary_fields?.last_job?.id}}),disableLinks:e?.disableLinks})}):(0,z.jsx)(x.m,{content:e?.tooltipAlt??"",position:"top",children:(0,z.jsx)(au,{status:t.status})}),sort:e?.disableSort?void 0:"status"})),[t,e?.disableSort,e?.tooltip,e?.disableLinks,e?.tooltipAlt,n])}({...e,tooltip:t`Click to view latest project sync job`,tooltipAlt:t`Unable to load latest project sync job`}),d=function(){const{t:e}=(0,I.Bd)(),t=yr();return(0,l.useMemo)((()=>({header:e("Last used"),value:e=>e.last_job_run?e.last_job_run:void 0,cell:e=>e.last_job_run?(0,z.jsx)(Ie,{value:e.last_job_run,author:"summary_fields"in e?e.summary_fields?.modified_by?.username:void 0,onClick:"summary_fields"in e?()=>t(fc.UserDetails,{params:{id:e.summary_fields?.modified_by?.id}}):void 0}):(0,z.jsx)(z.Fragment,{}),table:zt.expanded,card:"hidden",list:"secondary",modal:Ut.hidden,dashboard:Ut.hidden})),[t,e])}(),u=function(){const{t:e}=(0,I.Bd)(),t=gr();return(0,l.useMemo)((()=>({header:e("Default environment"),value:e=>e.summary_fields?.default_environment?.name,cell:e=>(0,z.jsx)(Fe,{text:e.summary_fields?.default_environment?.name,to:t(fc.ExecutionEnvironmentDetails,{params:{id:e.summary_fields?.default_environment?.id}})}),table:zt.expanded,card:"hidden",list:"secondary",modal:Ut.hidden,dashboard:Ut.hidden})),[t,e])}();return(0,l.useMemo)((()=>[n,s,c,{header:t("Type"),cell:e=>(0,z.jsx)(bp,{scmType:e.scm_type}),modal:Ut.hidden,dashboard:Ut.hidden},{header:t("Revision"),cell:e=>e.scm_revision?(0,z.jsx)(ye,{text:e.scm_revision}):t("Sync for revision"),modal:Ut.hidden,dashboard:Ut.hidden},o,i,r,d,u]),[i,u,s,d,r,n,o,c,t])}function Ch(){return Pp({optionsPath:"projects",preFilledValueKeys:{name:{apiPath:"projects"},id:{apiPath:"projects"}},preSortedKeys:["name","id","status","scm_type","created-by","modified-by"],additionalFilters:[Np(),$p()]})}function Th(e){const t=Ch(),n=Sh({disableLinks:!0}),a=Uc({url:xl`/projects/`,toolbarFilters:t,tableColumns:n,disableQueryString:!0});return(0,z.jsx)(Cp,{...e,toolbarFilters:t,tableColumns:n,view:a})}function Ih(e){const{t}=(0,I.Bd)(),n=function(){const[e,t]=ss(),{t:n}=(0,I.Bd)();return(0,l.useCallback)((e=>{t((0,z.jsx)(Th,{title:n("Select project"),onSelect:e}))}),[t,n])}(),a=(0,l.useCallback)((async()=>{const e=await nl(xl`/projects/`.concat("?page_size=200"));return Promise.resolve({total:e.count,values:e.results})}),[]);return(0,z.jsx)(eh,{name:e.name,id:"project",label:t("Project"),query:a,valueToString:e=>e&&"string"==typeof e?e:e?.name??"",placeholder:t("Select project"),loadingPlaceholder:t("Loading projects..."),loadingErrorText:t("Error loading projects"),isRequired:e.isRequired,limit:200,openSelectDialog:n})}function Ah(){const e=gr();return(0,l.useCallback)((t=>e(fc.JobOutput,{params:{job_type:Dh[t.type],id:t.id}})),[e])}const Dh={project_update:"project",inventory_update:"inventory",job:"playbook",ad_hoc_command:"command",system_job:"management",workflow_job:"workflow"},Eh=A.Ay.div.withConfig({componentId:"ans__sc-1ds7m2k-0"})(["display:inline-flex;flex-wrap:wrap;"]),Ph=({jobs:e})=>{const t={job:"playbook",project_update:"project",system_job:"management",inventory_update:"inventory",ad_hoc_command:"command",workflow_job:"workflow"},{t:n}=(0,I.Bd)(),s=Ah(),o=e=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{children:[n`JOB ID:`," ",e.id]}),(0,z.jsxs)("div",{children:[n`STATUS:`," ",e.status?.toUpperCase()]}),e.finished&&(0,z.jsxs)("div",{children:[n`FINISHED:`," ",Se(e.finished)]})]}),i=e?.map((e=>{const i=s(e);return(0,z.jsx)(x.m,{position:"top",content:o(e),children:(0,z.jsx)(a.N_,{"aria-label":n(`View job ${e.id}`),to:i||`/jobs/${t[e.type]}/${e.id}/output`,children:(0,z.jsx)(au,{status:e.status,hideLabel:!0})})},e.id)}));return(0,z.jsx)(Eh,{children:i})},Rh=e=>"job_template"===e.type&&(!e?.summary_fields.project||!e?.summary_fields.inventory&&!e?.ask_inventory_on_launch);function Bh(e){const{t}=(0,I.Bd)(),n=gr(),a=bu(e),s=hu(),o=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Activity"),cell:e=>(0,z.jsx)(Ph,{jobs:e.summary_fields?.recent_jobs}),value:e=>e.summary_fields?.recent_jobs?.length?e.summary_fields?.recent_jobs.length:void 0,table:zt.expanded,card:"hidden",list:"hidden",modal:Ut.hidden})),[e])}(),i=fu(e),r=gu(fc.OrganizationDetails,e),c=yu(fc.InventoryDetails,e),d=xu(fc.ProjectDetails,e),u=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Credentials"),cell:e=>(0,z.jsx)(De.o,{children:e.summary_fields?.credentials?.map((e=>(0,z.jsx)(uu,{credential:e},e.id)))}),value:e=>!!e.summary_fields?.credentials?.length||void 0,table:zt.expanded,card:"hidden",list:"hidden",modal:Ut.hidden})),[e])}(),m=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Labels"),cell:e=>e.summary_fields?.labels?.results?(0,z.jsx)(De.o,{children:e.summary_fields.labels?.results.map((e=>(0,z.jsx)(Ee.J,{children:e.name},e.id)))}):(0,z.jsx)(z.Fragment,{}),table:zt.expanded,value:e=>!!e.summary_fields?.labels?.results.length||void 0,card:"hidden",list:"hidden",modal:Ut.hidden})),[e])}(),p=function(e,t){const{t:n}=(0,I.Bd)(),a=gr();return(0,l.useMemo)((()=>({header:n("Execution Environment"),cell:n=>"job_template"!==n.type?(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(Fe,{text:n.summary_fields?.execution_environment?.name,to:a(e,{params:{id:n.summary_fields?.execution_environment?.id}}),disableLinks:t?.disableLinks}),value:e=>"job_template"===e.type?e.summary_fields?.execution_environment?.name:void 0,sort:t?.disableSort?void 0:"execution_environment",table:zt.expanded,card:"hidden",list:"hidden",modal:Ut.hidden})),[n,t?.disableSort,t?.disableLinks,a,e])}(fc.ExecutionEnvironments,e),h=function(e){const{t}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:t("Last ran"),cell:e=>e.last_job_run?(0,z.jsx)(Ie,{value:e.last_job_run}):(0,z.jsx)(z.Fragment,{}),sort:e?.disableSort?void 0:e?.sortKey??"last_job_run",defaultSortDirection:"desc"})),[e?.disableSort,e?.sortKey,t])}(e),b=ju({...e,makeReadable:e=>"workflow_job_template"===e.type?t("Workflow job template"):t("Job template")});return(0,l.useMemo)((()=>[{header:t("Name"),cell:e=>(0,z.jsxs)(ee.B,{hasGutter:!0,children:[(0,z.jsx)(Fe,{text:e.name,to:n("job_template"===e.type?fc.JobTemplateDetails:fc.WorkflowJobTemplateDetails,{params:{id:e.id}})}),Rh(e)&&(0,z.jsx)(x.m,{content:t`Resources are missing from this template.`,position:"right",children:(0,z.jsx)(y.I,{status:"danger",style:{paddingTop:"6px"},children:(0,z.jsx)(Ws.Pi,{})})})]}),card:"name",list:"name",sort:"name"},o,s,b,a,i,r,c,p,d,u,m,h]),[n,t,o,s,b,a,i,r,c,p,d,u,m,h])}function Fh(e){const t=Bp(),n=Fp(),a=Np(),s=$p(),o=(0,l.useMemo)((()=>[t,n,a,s]),[t,n,a,s]),i=Bh({disableLinks:!0}),r=Uc({url:xl`/job_templates/`,toolbarFilters:o,tableColumns:i,disableQueryString:!0});return(0,z.jsx)(Cp,{...e,toolbarFilters:o,tableColumns:i,view:r})}function Nh(e){const{t}=(0,I.Bd)(),{templateType:n="job_templates"}=e,a=function(){const[e,t]=ss(),{t:n}=(0,I.Bd)();return(0,l.useCallback)((e=>{t((0,z.jsx)(Fh,{title:n("Select job template"),onSelect:e}))}),[t,n])}(),s=(0,l.useCallback)((async()=>{const e=await nl(xl`/${n}/`.concat("?page_size=200"));return Promise.resolve({total:e.count,values:e.results})}),[n]);return(0,z.jsx)(eh,{name:e.name,id:"job-template-select",label:"workflow_job_templates"===e.templateType?t("Workflow job template"):t("Job template"),query:s,valueToString:e=>e&&"string"==typeof e?e:e?.name??"",placeholder:"workflow_job_templates"===e.templateType?t("Select a workflow job template"):t("Select job template"),loadingPlaceholder:"workflow_job_templates"===e.templateType?t("Loading workflow job templates..."):t("Loading job templates..."),loadingErrorText:"workflow_job_templates"===e.templateType?t("Error loading workflow job templates"):t("Error loading job templates"),isRequired:e.isRequired,limit:200,openSelectDialog:a})}function $h(e){const{reset:t,getValues:n,setValue:a,formState:s,getFieldState:o,register:i,control:r}=(0,oo.xW)(),{defaultValues:c}=s,{setWizardData:d,setStepData:u,stepData:m,steps:p}=vr();i("node_type"),i("resource"),i("prompt");const h=(0,oo.FH)({name:"node_type",control:r,defaultValue:c?.node_type}),b=(0,oo.FH)({name:"resource"});return(0,l.useEffect)((()=>{const{isDirty:e,isTouched:s}=o("node_type"),i=n(),r=h===am.workflow_approval;a("node_type",h,{shouldTouch:!0}),s&&!e&&r&&(t(void 0,{keepDefaultValues:!0}),d({...i,launch_config:null}),u({nodeTypeStep:i}))}),[h,o,a,t,p,d,u,n]),(0,l.useEffect)((()=>{a("resource",null)}),[h,a]),(0,l.useEffect)((()=>{h!==am.job&&h!==am.workflow_job||(async()=>{let e,t={},s=n("resource");if(!s&&b&&(s=b),!s)return;"type"in s?e=s.type:"unified_job_type"in s&&(e=s.unified_job_type);let i={};e===am.job||"job_template"===e?i=await nl(xl`/job_templates/${s.id.toString()}/launch/`):e!==am.workflow_job&&"workflow_job_template"!==e||(i=await nl(xl`/workflow_job_templates/${s.id.toString()}/launch/`));const{job_tags:r,skip_tags:l,inventory:u,...p}=i?.defaults||{};t={...p,execution_environment:p.execution_environment?.id,inventory:u?.id?u:null,job_tags:xm(r||""),skip_tags:xm(l||"")};const h=!km(i),f=i.survey_enabled;if(h||f){if(d((e=>({...e,launch_config:i}))),m.nodePromptsStep&&b){const{isDirty:n}=o("node_type");n||b.id!==c?.resource?.id?(a("prompt",t),"type"in b&&b.type!==e&&a("resource",s)):a("prompt",{...m.nodePromptsStep?.prompt})}}else d((e=>({...e,launch_config:null})))})()}),[p,c,o,n,b,h,a,d,m]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Lh,{}),(0,z.jsx)(Oh,{}),e.hasSourceNode&&(0,z.jsx)(Mh,{}),(0,z.jsx)(qh,{}),(0,z.jsx)(Uh,{})]})}function Mh(){const{t:e}=(0,I.Bd)();return(0,z.jsx)(ti,{label:e("Status"),"data-cy":"node-status-type",name:"node_status_type",isRequired:!0,options:[{label:e("Always run"),value:"info",description:e("Execute regardless of the parent node final state.")},{label:e("Run on success"),value:"success",description:e("Execute when the parent node results in a successful state.")},{label:e("Run on fail"),value:"danger",description:e("Execute when the parent node results in a failure state.")}]})}function Lh(){const{t:e}=(0,I.Bd)();return(0,z.jsx)(ti,{isRequired:!0,label:e("Node type"),name:"node_type","data-cy":"node-type",options:[{label:e("Job Template"),value:am.job},{label:e("Workflow Job Template"),value:am.workflow_job},{label:e("Approval"),value:am.workflow_approval},{label:e("Project Sync"),value:am.project_update},{label:e("Inventory Source Sync"),value:am.inventory_update},{label:e("Management Job"),value:am.system_job}]})}function Oh(){const{t:e}=(0,I.Bd)();return(0,z.jsx)(fh,{watch:"node_type",children:t=>{switch(t){case am.job:return(0,z.jsx)(Nh,{templateType:"job_templates",name:"resource",isRequired:!0});case am.workflow_job:return(0,z.jsx)(Nh,{templateType:"workflow_job_templates",name:"resource",isRequired:!0});case am.workflow_approval:return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{label:e("Name"),name:"approval_name",id:"approval_name",isRequired:!0}),(0,z.jsx)(li,{label:e("Description"),name:"approval_description",id:"approval_description"}),(0,z.jsx)(Hh,{})]});case am.project_update:return(0,z.jsx)(Ih,{name:"resource",isRequired:!0});case am.inventory_update:return(0,z.jsx)(kh,{name:"resource",isRequired:!0});case am.system_job:return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(jh,{name:"resource",isRequired:!0}),(0,z.jsx)(zh,{})]});default:return}}})}function zh(){const{t:e}=(0,I.Bd)(),{data:t}=ec(xl`/system_job_templates/`);return(0,z.jsx)(fh,{watch:"resource",children:n=>(e=>{const n=e?.job_type||t?.results.find((t=>e?.id===t?.id))?.job_type;return["cleanup_jobs","cleanup_activitystream"].includes(n||"")})(n)?(0,z.jsx)(li,{name:"node_days_to_keep",label:e("Days of data to be retained"),placeholder:e("Enter number of days"),type:"number",isRequired:!0,min:0}):null})}function Hh(){const{t:e}=(0,I.Bd)(),{control:t}=(0,oo.xW)();return(0,z.jsx)(oo.xI,{name:"approval_timeout",control:t,shouldUnregister:!0,render:({field:t})=>{const{onChange:n,value:a}=t;function s({input:e,unit:t}){const s=60*("minutes"===t?e:Math.floor(Number(a)/60))+("seconds"===t?e:Math.floor(Number(a)%60));n(s)}return(0,z.jsx)(Vo,{fieldId:"approval_timeout",label:e("Timeout"),children:(0,z.jsx)(ga.M,{children:(0,z.jsxs)(so.x,{hasGutter:!0,sm:6,children:[(0,z.jsx)(xd.E,{children:(0,z.jsxs)(ya.b,{isFill:!0,children:[(0,z.jsx)(ri.ks,{placeholder:e("Timeout in minutes"),onChange:(e,t)=>s({input:Number(t),unit:"minutes"}),value:Math.floor(Number(a)/60),"aria-describedby":"approval_timeout_minutes-form-group",type:"number","data-cy":"approval_timeout_minutes",min:0}),(0,z.jsx)(bh.z,{children:e("minutes")})]})}),(0,z.jsx)(xd.E,{children:(0,z.jsxs)(ya.b,{isFill:!0,children:[(0,z.jsx)(ri.ks,{placeholder:e("Timeout in seconds"),onChange:(e,t)=>s({input:Number(t),unit:"seconds"}),value:Math.floor(Number(a)%60),"aria-describedby":"approval_timeout_seconds-form-group",type:"number","data-cy":"approval_timeout_seconds",min:0}),(0,z.jsx)(bh.z,{children:e("seconds")})]})})]})})})}})}function qh(){const{t:e}=(0,I.Bd)(),t=sc();return(0,z.jsx)(ti,{isRequired:!0,label:e("Convergence"),name:"node_convergence","data-cy":"node-convergence",labelHelpTitle:e("Convergence"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[e("Preconditions for running this node when there are multiple parents")," ",(0,z.jsx)("a",{href:pc(t,"workflowVisBuild"),children:e("documentation.")})]}),options:[{label:e("Any"),value:"any",description:e("Ensures that at least one parent node met the expected outcome in order to run the child node.")},{label:e("All"),value:"all",description:e("Ensures that every parent node met the expected outcome in order to run the child node.")}]})}function Uh(){const{t:e}=(0,I.Bd)(),{formState:{defaultValues:t}}=(0,oo.xW)(),n=""!==t?.node_alias;return(0,z.jsx)(li,{label:e("Node alias"),name:"node_alias","data-cy":"node-alias",labelHelpTitle:e("Node alias"),labelHelp:e("If specified, this field will be shown on the node instead of the resource name when viewing the workflow"),isRequired:n})}function Wh({templateId:e,jobType:t,singleColumn:n}){const{t:a}=(0,I.Bd)(),{wizardData:s,stepData:o}=vr(),{reset:i}=(0,oo.xW)(),{resource:r}=s,c=r?r?.id?.toString():e||"";t=t??function(e){if(e){if("type"in e){if("job_template"===e?.type)return"job_templates";if("workflow_job_template"===e?.type)return"workflow_job_templates"}if("unified_job_type"in e){if("job"===e?.unified_job_type)return"job_templates";if("workflow_job"===e?.unified_job_type)return"workflow_job_templates"}}}(r);const{data:d}=ec(xl`/${t??"job_templates"}/${c}/survey_spec/`);(0,l.useEffect)((()=>{const e={},t=o.survey;d?.spec?.forEach((n=>{const a=t?.survey?.[n?.variable];if(a)e[n.variable]=a;else if(""!==n.default)if("multiselect"!==n.type)e[n.variable]=n.default;else{const t=n.default;e[n.variable]=t.split("\n")}})),i({survey:e})}),[d,i,o]);const u=e=>{const t=[];return d?.spec.forEach((n=>{"multiplechoice"!==n.type&&"multiselect"!==n.type||!Array.isArray(n.choices)||n.question_name===e&&n.choices?.forEach((e=>{t.push({value:e,label:a(e)})}))})),t};return(0,z.jsx)(_d,{singleColumn:n,children:d?.spec.map(((e,t)=>"text"===e.type?(0,z.jsx)(li,{name:`survey.${e.variable}`,label:a(e.question_name),labelHelp:e.question_description,labelHelpTitle:"",isRequired:e.required,type:"text",maxLength:e.max,minLength:e.min},t):"integer"===e.type||"float"===e.type?(0,z.jsx)(li,{name:`survey.${e.variable}`,label:a(e.question_name),labelHelp:e.question_description,labelHelpTitle:"",isRequired:e.required,type:"number",max:e.max,min:e.min},t):"password"===e.type?(0,z.jsx)(li,{name:`survey.${e.variable}`,label:a(e.question_name),labelHelp:e.question_description,labelHelpTitle:"",isRequired:e.required,type:"password",maxLength:e.max,minLength:e.min},t):"textarea"===e.type?(0,z.jsx)(ii,{name:`survey.${e.variable}`,label:a(e.question_name),labelHelp:e.question_description,labelHelpTitle:"",isRequired:e.required,maxLength:e.max,minLength:e.min},t):"multiplechoice"===e.type?(0,z.jsx)(ti,{name:`survey.${e.variable}`,placeholderText:a("Select option"),label:a(e.question_name),labelHelp:e.question_description,labelHelpTitle:"",options:u(e.question_name),isRequired:e.required},t):"multiselect"===e.type?(0,z.jsx)(Yc,{name:`survey.${e.variable}`,placeholder:a("Select option(s)"),label:a(e.question_name),labelHelp:e.question_description,labelHelpTitle:"",options:u(e.question_name),isRequired:e.required},t):void 0))})}function Jh(e,t){return null!==t?je.c9.fromISO(e,{zone:t}).toLocaleString(je.c9.DATETIME_SHORT_WITH_SECONDS):je.c9.fromISO(e).toLocaleString(je.c9.DATETIME_SHORT_WITH_SECONDS)}function Vh(e,t){let n;return n=t?je.c9.fromISO(e,{zone:t}):je.c9.fromISO(e),[n.toFormat("yyyy-LL-dd"),n.toFormat("h:mm a")]}function Gh(e){return je.dw.fromObject({seconds:e}).toFormat("hh:mm:ss")}const Yh=(0,A.Ay)(Dd.tgn).withConfig({componentId:"ans__sc-yho04c-0"})([".pf-v5-c-divider{display:none;}"]),Kh=(0,Dd.PAp)((e=>{const t=(0,Dd.sjt)(),{t:n}=(0,I.Bd)(),a=t.toModel().nodes,s=function(e,t){const[n,a]=(0,l.useState)(),s=(0,l.useCallback)((n=>{n&&(a(n),"jobs"===n?.group_name&&n?.unified_job_id?.toString()===t?.id.toString()&&n?.status&&e())}),[t?.id,e]);return dc({control:["limit_reached_1"],group:["workflow_jobs"],jobs:["status_changed"]},s),n}(e.reloadJob,e.job),o=s?.workflow_node_id?.toString(),{data:i}=ec(o?xl`/workflow_job_nodes/${o}/`:"",void 0,{refreshInterval:1e3}),r=t.getNodeById(s?.workflow_node_id?.toString()||""),{refreshNodeStatus:c}=e;return(0,l.useEffect)((()=>{if(s?.workflow_node_id&&s?.status&&a?.length){if(s?.unified_job_id&&s.unified_job_id!==e.job?.id&&r){const{resource:e}=r.getData();(0,Dd.XId)((()=>{r.setData({...r.getData(),resource:{...e,summary_fields:{...e.summary_fields,job:{...e.summary_fields.job,id:s.unified_job_id,type:s.type}}}})}))()}s.finished&&(t=>{e.job&&t&&r?.setData({...r?.getData(),secondaryLabel:i?n(`Elapsed time ${Gh(i?.summary_fields?.job?.elapsed||0)}`):""})})(s.workflow_node_id),(0,Dd.XId)((()=>{r?.setNodeStatus(s.status)}))()}}),[r,s,e.job,n,a,i]),(0,l.useEffect)((()=>{c()}),[r,c]),(0,z.jsx)(Em,{children:(0,z.jsx)(Dm.Consumer,{children:({isLegendOpen:e,toggleLegend:n})=>(0,z.jsxs)(Yh,{"data-cy":"workflow-visualizer-output-graph",controlBar:(0,z.jsx)(Dd.Ug7,{controlButtons:(0,Dd.ks9)({...Dd.q7Z,zoomInCallback:(0,Dd.XId)((()=>{t.getGraph().scaleBy(4/3)})),zoomOutCallback:(0,Dd.XId)((()=>{t.getGraph().scaleBy(.75)})),fitToScreenCallback:(0,Dd.XId)((()=>{t.getGraph().fit(80)})),resetViewCallback:(0,Dd.XId)((()=>{t.getGraph().reset(),t.getGraph().layout()})),legend:!0,legendCallback:n})}),sideBarOpen:!1,children:[e&&(0,z.jsx)(Qm,{}),(0,z.jsx)(Dd.AUs,{})]})})})}));var Zh=n(91858);const Xh=(0,A.i7)(["from{transform:rotate(0);}to{transform:rotate(1turn);}"]),Qh=A.Ay.g.withConfig({componentId:"ans__sc-1wyt3dz-0"})(["animation:"," 1.75s linear infinite;transform-origin:",";"],Xh,(({centerPoint:e})=>`${Number(e.x)+1}px ${Number(e.y)+1}px`)),eb=(0,A.Ay)(Dd.Icc).withConfig({componentId:"ans__sc-1848i81-0"})(["&.pf-m-hover{cursor:pointer;}&.unexecuted-job{&:hover{cursor:default;}.pf-topology__node__background{fill:var(--pf-v5-chart-color-black-300);stroke:var(--pf-v5-global--Color--200);}}"]),tb={project_update:"project",inventory_update:"inventory",job:"playbook",ad_hoc_command:"command",system_job:"management",workflow_job:"workflow"},nb={inventory_update:Um.KY,job:Wm.OD,project_update:$n.Ci,system_job:Jm.DP,workflow_approval:$d.O4,workflow_job:Vm.KZ,deleted_resource:$c.uc},ab=(0,Dd.PAp)((({element:e,selected:t})=>{const[n,a]=(0,Dd.Mks)(),s=yr(),o=(0,l.useCallback)((e=>{if(!(0,Dd.Lln)(e))return null;const t=e.getNodeStatus(),{x:n,y:a}=(0,Dd.jqe)(Dd.CK5.upperLeft,e),s=t&&function(e,t){switch(e){case"success":case"successful":return(0,z.jsx)(nn.C1,{"data-cy":"successful-icon",style:{fill:P}});case"running":return(0,z.jsx)(Qh,{"data-cy":"running-icon",centerPoint:t,children:(0,z.jsx)($n.Ci,{style:{fill:F}})});case"fail":case"failed":case"error":return(0,z.jsx)(an.$Q,{"data-cy":"failed-icon",style:{fill:R}});case"pending":case"waiting":return(0,z.jsx)($d.O4,{"sdata-cy":"pending-icon",style:{fill:F}});case"canceled":return(0,z.jsx)(Zh.YE,{"data-cy":"canceled-icon",style:{fill:B}});default:return null}}(t,{x:n,y:a});return null===s?null:(0,z.jsx)(Dd.KjA,{x:n,"data-cy":`node-decorator-${t}`,y:a,radius:Dd.bQA,showBackground:!0,icon:s,className:`node-decorator-${t}-${e.getId()}`,ariaLabel:t})}),[]),i=e.getController().getNodeById(e.getId())?.getNodeStatus(),r=e.getData(),{job:c,unified_job_template:d}=r?.resource?.summary_fields||{},{unified_job_type:u}=d||{},m=nb[u??"deleted_resource"];return(0,z.jsx)(Dd.Wdr,{id:n?Dd.Wzh:void 0,children:(0,z.jsx)("g",{ref:a,children:(0,z.jsxs)(eb,{showLabel:!0,element:e,labelClassName:`${e.getId()}-node-label`,onSelect:function(){if(!c)return;const e="workflow_approval"===c.type?{params:{id:c.id}}:{params:{job_type:tb[c.type],id:c.id}};s("workflow_approval"===c.type?fc.WorkflowApprovalDetails:fc.JobOutput,e)},secondaryLabel:r?.secondaryLabel,selected:!!c?.type&&t,truncateLength:20,badge:r?.badge,badgeColor:r?.badgeColor,badgeTextColor:r?.badgeTextColor,badgeBorderColor:r?.badgeBorderColor,className:i!==Dd.zIx.default||c?"":"unexecuted-job",children:[(0,z.jsx)("g",{transform:"translate(13, 13)",children:(0,z.jsx)(m,{style:{color:"#393F44"},width:25,height:25})}),o(e)]})})})})),sb={nodes:[],edges:[],graph:{id:em,type:"graph",layout:"Dagre",visible:!1}},ob={badge:"ALL",badgeColor:"var(--pf-v5-global--BackgroundColor--200)",badgeBorderColor:"var(--pf-v5-global--palette--black-400)"},ib=e=>{const{t}=(0,I.Bd)(),n=Xu(),{results:a}=cm(xl`/workflow_jobs/${e.job.id.toString()||""}/workflow_nodes/`),s=(0,l.useCallback)(((e,t)=>{switch(t){case"group":return Dd.b7q;case nm:return Km;default:switch(e){case Dd.g9r.graph:return(0,Dd.LY3)()(Dd.uJG);case Dd.g9r.node:return(0,Dd.VMe)()(ab);case Dd.g9r.edge:return qm;default:return}}}),[]),o=(0,l.useCallback)((()=>{const e=new Dd.Dib;return e.setFitToScreenOnLayout(!0),e.registerComponentFactory(s),e.registerLayoutFactory(((e,t)=>new Dd.mCS(t,{edgesep:100,marginx:20,marginy:20,rankdir:"LR",ranker:"network-simplex",ranksep:200}))),e.fromModel(sb,!1),e}),[s]),i=(0,l.useRef)(o()).current;return(0,l.useEffect)((()=>{if(!a?.length)return;const e=[],s={id:nm,type:nm,label:t("Start"),width:tm,height:tm,data:{resource:{always_nodes:[]}}},o=a.map((a=>{const s=a.id.toString(),o=wm(a.summary_fields?.unified_job_template?.name||"",a.identifier)||t("Deleted");a.success_nodes.forEach((t=>{e.push(n(s,t.toString(),Zu.success))})),a.failure_nodes.forEach((t=>{e.push(n(s,t.toString(),Zu.danger))})),a.always_nodes.forEach((t=>{e.push(n(s,t.toString(),Zu.info))}));let i="";a?.summary_fields?.job?.elapsed&&(i=Gh(a?.summary_fields?.job?.elapsed));const r=a.summary_fields.job?.status||void 0,l={id:s,type:r?`${r}-node`:"node",label:o,width:tm,height:tm,shape:Dd.AG_.circle,status:r||Dd.zIx.default,labelPosition:Dd.G5S.bottom,data:{secondaryLabel:i?t(`Elapsed time ${i}`):void 0,resource:a}};return a.all_parents_must_converge?{...l,data:{...l.data,...ob}}:l})),r=e.map((e=>e.target)),l=o?.filter((e=>!r.includes(e.id)&&e.id!==nm));l.forEach((t=>{e.push(n(nm,t.id,Zu.info))}));const c={edges:e,nodes:[s,...o],graph:{id:em,type:"graph",layout:"Dagre",visible:!0}};i.fromModel(c,!0),i.getGraph().reset()}),[t,i,n,a]),(0,z.jsx)(Dd.Uk6,{controller:i,children:(0,z.jsx)(Kh,{job:e.job,reloadJob:e.reloadJob,refreshNodeStatus:e.refreshNodeStatus})})};function rb(){const{t:e}=(0,I.Bd)(),t=Ku(),n=Xu(),a=(0,Dd.sjt)(),s=a.getState(),o={nodeTypeStep:Sm()()},i=[{id:"nodeTypeStep",label:e("Node details"),inputs:(0,z.jsx)($h,{hasSourceNode:Boolean(s.sourceNode)}),validate:t=>{const{resource:n}=t;if("job_template"===n?.type&&"project"in n&&"inventory"in n&&"ask_inventory_on_launch"in n&&(!n?.project||null===n?.project||(!n?.inventory||null===n?.inventory)&&!n?.ask_inventory_on_launch)){const t={__all__:[e("Job Templates with a missing inventory or project cannot be selected when creating or editing nodes. Select another template or fix the missing fields to proceed.")]};throw new Xr("","",400,"",t)}}},{id:"nodePromptsStep",label:e("Prompts"),inputs:(0,z.jsx)(ch,{}),hidden:e=>{const{launch_config:t,resource:n,node_type:a}=e;return 0===Object.keys(e).length||a!==am.workflow_job&&a!==am.job||!n||!t||km(t)}},{id:"survey",label:e("Survey"),inputs:(0,z.jsx)(Wh,{singleColumn:!0}),hidden:e=>{const{launch_config:t,node_type:n}=e;return 0===Object.keys(e).length||!(!n||[am.workflow_job,am.job].includes(n))||!t?.survey_enabled}},{id:"review",label:e("Review"),element:(0,z.jsx)(hh,{})}];return(0,z.jsx)(Lr,{isVertical:!0,singleColumn:!0,steps:i,onCancel:t,onSubmit:async e=>{const o=a.toModel(),i=a.getGraph().getNodes().filter((e=>e.getId()!==nm)),{approval_name:r,approval_description:l,launch_config:c,node_type:d,resource:u,approval_timeout:m,node_alias:p,node_convergence:h,node_days_to_keep:b,node_status_type:f,prompt:g,survey:y}=e,x=g;x&&(u&&"organization"in u&&(x.organization=u.organization??null),c&&(x.original={launch_config:c}));const j=vm(d,u?.name||"",r),_=""===p?j:p;let v={id:`${i.length+1}-unsavedNode`,type:"node",label:_,width:tm,height:tm,shape:Dd.AG_.circle,data:{resource:{always_nodes:[],success_nodes:[],failure_nodes:[],identifier:p,all_parents_must_converge:"all"===h,extra_data:{days:b},summary_fields:{unified_job_template:{id:Number(u?.id||0),name:j,description:vm(d,u?.description||"",l),unified_job_type:d,timeout:m}}},launch_data:x,survey_data:y}};if("all"===h&&(v={...v,data:{...v.data,...ob}}),!s.sourceNode){const e=n(nm,v.id,Zu.info);o.edges?.push(e)}if(s.sourceNode){const e=f===Zu.info?Zu.info:f===Zu.success?Zu.success:Zu.danger,t=n(s.sourceNode.getId(),v.id,e);s.sourceNode.setState({modified:!0}),o.edges?.push(t)}d!==am.workflow_approval&&delete v.data.resource.summary_fields.unified_job_template.timeout,u&&!_m(u)&&delete v.data.resource.extra_data,""===p&&delete v.data.resource.identifier,o.nodes?.push(v),a.fromModel(o,!0),a.getNodeById(v.id)?.setState({modified:!0}),a.setState({...s,modified:!0}),t(),a.getGraph().layout(),await Promise.resolve()},defaultValue:o,errorAdapter:Mc,title:e("Add step")})}function lb({node:e}){const{t}=(0,I.Bd)(),n=(0,Dd.sjt)(),a=Ku(),s=function(){const e=Sm();return(0,l.useCallback)((async t=>{const n=e(t),a=t.getData(),s=t.getId(),o=s.includes("unsavedNode"),i=await async function(e){const t=e?.getData()?.resource?.summary_fields?.unified_job_template;if(!t)return;const{unified_job_type:n,id:a}=t;return n===am.workflow_job?await nl(xl`/workflow_job_templates/${a.toString()}/launch/`):n===am.job?await nl(xl`/job_templates/${a.toString()}/launch/`):void 0}(t),r=!i||km(i),l=!1===i?.survey_enabled,c=i?.ask_credential_on_launch&&!o?await async function(e){return Tm(xl`/workflow_job_template_nodes/${e}/credentials/`)}(s):[],d=i?.ask_labels_on_launch&&!o?await async function(e){return Tm(xl`/workflow_job_template_nodes/${e}/labels/`)}(s):[],u=i?.ask_instance_groups_on_launch&&!o?await async function(e){return Tm(xl`/workflow_job_template_nodes/${e}/instance_groups/`)}(s):[],m=a?.launch_data,p=a?.resource,h={credentials:c,instance_groups:u,labels:d};let b;const f=p?.summary_fields?.unified_job_template;if(f?.id&&f?.unified_job_type===am.job){const e=await async function(e){return Tm(xl`/job_templates/${e}/credentials/`)}(f.id.toString());b=function(e=[],t=[],n=[]){const a={};return n.forEach((e=>{a[e.credential_type]=e})),e.forEach((e=>{const t=e.credential_type;a[t]?.id!==e.id&&(a[t]=e)})),t.forEach((e=>{const t=e.credential_type;a[t]?.id!==e.id&&(a[t]=e)})),Object.values(a)}(c,m?.credentials,e)}let g={...p?.extra_data||{}},y=a?.resource?.extra_data;if(i?.ask_variables_on_launch&&i.survey_enabled){const e=await async function(e){if(e)return e.unified_job_type===am.job?await nl(xl`/job_templates/${e.id.toString()}/survey_spec/`):e.unified_job_type===am.workflow_job?await nl(xl`/workflow_job_templates/${e.id.toString()}/survey_spec/`):void 0}(a?.resource?.summary_fields?.unified_job_template);if(e?.spec){const{extraVars:t,surveyData:n}=function(e,t){const n={...e},a={};return t.spec.forEach((t=>{const{variable:s}=t;s in e&&(a[s]=e[s],delete n[s])})),{extraVars:n,surveyData:a}}(g,e);g=t,y=n}}const x={credentials:b??(c||[]),diff_mode:m?.diff_mode??(p?.diff_mode||!1),execution_environment:m?.execution_environment??(p?.execution_environment||null),extra_vars:m?.extra_vars??om(JSON.stringify(g)),forks:m?.forks??(p?.forks||0),instance_groups:m?.instance_groups??(u||[]),inventory:m?.inventory??(a?.resource?.summary_fields?.inventory||null),job_slice_count:m?.job_slice_count??(p?.job_slice_count||0),job_tags:m?.job_tags??xm(p?.job_tags||""),job_type:m?.job_type??(p?.job_type||"run"),labels:m?.labels??(d||[]),limit:m?.limit??(p?.limit||""),scm_branch:m?.scm_branch??(p?.scm_branch||""),skip_tags:m?.skip_tags??xm(p?.skip_tags||""),timeout:m?.timeout??(p?.timeout||0),verbosity:m?.verbosity??(p?.verbosity||0),launch_config:i,original:h};return{nodeTypeStep:n,...r?{}:{nodePromptsStep:{prompt:x}},...l?{}:{survey:{survey:a?.survey_data??y}}}}),[e])}(),[o,i]=(0,l.useState)(null),r=ue();if((0,l.useEffect)((()=>{!async function(){if(e)try{const t=await s(e);i(t)}catch(e){const{genericErrors:n,fieldErrors:a}=Mc(e);r.addAlert({variant:"danger",title:t("Failed to get default node values."),children:(0,z.jsxs)(z.Fragment,{children:[n?.map((e=>e.message)),a?.map((e=>e.message))]})})}}()}),[e,s,r,t]),!o||"nodeTypeStep"in o==0)return null;const c=[{id:"nodeTypeStep",label:t("Node details"),inputs:(0,z.jsx)($h,{}),validate:e=>{const{resource:n}=e;if("job_template"===n?.type&&"project"in n&&"inventory"in n&&"ask_inventory_on_launch"in n&&(!n?.project||null===n?.project||(!n?.inventory||null===n?.inventory)&&!n?.ask_inventory_on_launch)){const e={__all__:[t("Job Templates with a missing inventory or project cannot be selected when creating or editing nodes. Select another template or fix the missing fields to proceed.")]};throw new Xr("","",400,"",e)}}},{id:"nodePromptsStep",label:t("Prompts"),inputs:(0,z.jsx)(ch,{}),hidden:e=>{const{launch_config:t,resource:n,node_type:a}=e;return!t||(a!==am.workflow_job&&a!==am.job||!n?!("nodePromptsStep"in o):km(t))}},{id:"survey",label:t("Survey"),inputs:(0,z.jsx)(Wh,{singleColumn:!0}),hidden:e=>{const{launch_config:t,node_type:n}=e;return 0===Object.keys(e).length||!(!n||[am.workflow_job,am.job].includes(n))||!t?.survey_enabled}},{id:"review",label:t("Review"),element:(0,z.jsx)(hh,{})}];return(0,z.jsx)(Lr,{isVertical:!0,singleColumn:!0,steps:c,onCancel:a,onSubmit:async t=>{const s=e.getData(),i=o?.nodePromptsStep?.prompt?.original,{approval_name:r,approval_description:l,node_type:c,resource:d,approval_timeout:u,node_alias:m,node_convergence:p,node_days_to_keep:h,launch_config:b,prompt:f,survey:g}=t,y=f;y&&(d&&"organization"in d&&(y.organization=d.organization??null),b&&(y.original={launch_config:b}),i&&(y.original={...y.original,...i}));const x=vm(c,d?.name||"",r),j=(_=s.resource.identifier,v=m,du(_)&&"string"==typeof v&&""!==v?v:du(_)||_===v?_:v);var _,v;const w={...s,resource:{...s.resource,all_parents_must_converge:"all"===p,identifier:j,extra_data:{days:h},summary_fields:{...s.resource.summary_fields,unified_job_template:{id:Number(d?.id||-1),name:x,description:vm(c,d?.description||"",l),unified_job_type:c,timeout:u}}},launch_data:y,survey_data:g};c!==am.workflow_approval&&delete w.resource.summary_fields?.unified_job_template?.timeout,_m(d)||(w.resource.extra_data={}),e.setLabel(wm(x,m)),e.setData(w),e.setState({modified:!0}),n.setState({...n.getState(),modified:!0}),a(),n.getGraph().layout(),await Promise.resolve()},defaultValue:o,errorAdapter:Mc,title:t("Edit step")})}const cb=(0,A.Ay)(Dd.M3g).withConfig({componentId:"ans__sc-16qdpc5-0"})(["display:flex;flex-direction:column;"]);function db(){const{t:e}=(0,I.Bd)(),t=function(){const e=(0,Dd.sjt)(),{selectedIds:t}=e.getState();return(0,l.useMemo)((()=>{const n=t&&t[0];if(n)return e.getNodeById(n)}),[e,t])}(),{sidebarMode:n}=Pm();if(!n)return null;const a={add:(0,z.jsx)(rb,{}),edit:t&&(0,z.jsx)(lb,{node:t}),view:t&&(0,z.jsx)(jp,{node:t})};return(0,z.jsx)(cb,{"aria-label":e("Topology sidebar"),"data-cy":"workflow-topology-sidebar",resizable:!0,show:!0,children:a[n]})}var ub=n(52871),mb=n(85091),pb=n(8169),hb=n(28781),bb=n(55665);function fb(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=td(),a=ue(),s=yr(),o=Ah();return async i=>{const r=function(e){return"job_template"===e.type?xl`/job_templates/${e.id.toString()}/launch/`:"workflow_job_template"===e.type?xl`/workflow_job_templates/${e.id.toString()}/launch/`:void 0}(i);if(!r)return Promise.reject(new Error("Unable to retrieve launch configuration"));try{if((l=await nl(r)).ask_credential_on_launch||l.ask_diff_mode_on_launch||l.ask_execution_environment_on_launch||l.ask_forks_on_launch||l.ask_instance_groups_on_launch||l.ask_inventory_on_launch||l.ask_job_slice_count_on_launch||l.ask_job_type_on_launch||l.ask_labels_on_launch||l.ask_limit_on_launch||l.ask_scm_branch_on_launch||l.ask_skip_tags_on_launch||l.ask_tags_on_launch||l.ask_timeout_on_launch||l.ask_variables_on_launch||l.ask_verbosity_on_launch||!l.can_start_without_user_input||l.survey_enabled||l.passwords_needed_to_start&&0!==l.passwords_needed_to_start.length||l.variables_needed_to_start&&0!==l.variables_needed_to_start.length){const e="workflow_job_template"===i.type?fc.WorkflowJobTemplateLaunchWizard:fc.TemplateLaunchWizard;s(e,{params:{id:i.id}})}else{const e=await n(r,{});t(o(e))}}catch(t){a.addAlert({variant:"danger",title:e("Failed to launch template"),children:t instanceof Error&&t.message,timeout:5e3})}var l}}const gb=(0,Dd.PAp)((()=>{const{t:e}=(0,I.Bd)(),t=yr(),n=ue(),{id:a}=(0,Re.g)(),s=(0,Dd.sjt)(),{workflowTemplate:o}=s.getState(),[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),{isFullScreen:p}=Pm(),h=um(a||""),b=s.getElements().some((e=>e.getState().modified)),f=(0,l.useCallback)((()=>{b?m(!0):t(fc.WorkflowJobTemplateDetails,{params:{id:a}})}),[t,a,b]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(wn.T,{align:{default:"alignLeft"},children:(0,z.jsx)(Ge.h,{headingLevel:"h1",children:(0,z.jsxs)(i.s,{children:[(0,z.jsx)(r.Z,{"data-cy":"wf-vzr-title",children:e("Workflow Visualizer")}),(0,z.jsx)(k.c,{orientation:{default:"vertical"}}),(0,z.jsx)(r.Z,{"data-cy":"wf-vzr-name",children:o?.name})]})})}),(0,z.jsx)(wn.T,{align:{default:"alignRight"},visibility:{default:p?"hidden":"visible"},children:(0,z.jsx)(g.$n,{"data-cy":"workflow-visualizer-toolbar-close",variant:"plain",icon:(0,z.jsx)(ub.US,{}),"aria-label":e("Close"),onClick:f})}),(0,z.jsx)(Zt.a,{title:e("Warning: Unsaved changes"),"data-cy":"visualizer-unsaved-changes-modal",titleIconVariant:"warning",isOpen:u,variant:"small",onClose:()=>m(!1),actions:[(0,z.jsx)(g.$n,{"data-cy":"save-and-exit",variant:"primary",isLoading:c,onClick:()=>{!async function(){d(!0);try{await h(),n.addAlert({variant:"success",title:e("Successfully saved workflow visualizer"),timeout:5e3})}catch(t){const{genericErrors:a,fieldErrors:s}=Mc(t);n.addAlert({variant:"danger",title:e("Failed to save workflow job template"),children:(0,z.jsxs)(z.Fragment,{children:[a?.map((e=>e.message)),s?.map((e=>e.message))]})})}d(!1),m(!1)}()},children:e("Save and exit")},"save-and-exit"),(0,z.jsx)(g.$n,{"data-cy":"exit-without-saving",variant:"danger",onClick:()=>{t(fc.WorkflowJobTemplateDetails,{params:{id:a}})},children:e("Exit without saving")},"exit-without-saving")],children:e("You have unsaved changes. Are you sure you want to leave this page?")})]})})),yb=(0,Dd.PAp)((()=>{const{t:e}=(0,I.Bd)(),t=sc(),n=ue(),{id:a}=(0,Re.g)(),s=(0,Dd.sjt)(),{workflowTemplate:o,RBAC:i,modified:r}=s.getState(),[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),{isFullScreen:p,toggleFullScreen:h}=Pm(),{removeNodes:b}=sm(),f=um(a||""),x=fb(),S=s.getGraph().getNodes().filter((e=>e.isVisible()&&e.getId()!==nm)),T=(0,l.useCallback)((async()=>{await x(o)}),[x,o]);return(0,z.jsxs)(z.Fragment,{children:[p&&(0,z.jsx)(gb,{}),i?.edit&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(wn.T,{children:(0,z.jsx)(g.$n,{"data-cy":"workflow-visualizer-toolbar-save",icon:(0,z.jsx)(nn.C1,{}),label:e("Save"),isDisabled:!r,isLoading:u,onClick:()=>{!async function(){m(!0);try{await f(),n.addAlert({variant:"success",title:e("Successfully saved workflow visualizer"),timeout:5e3})}catch(t){const{genericErrors:a,fieldErrors:s}=Mc(t);n.addAlert({variant:"danger",title:e("Failed to save workflow job template"),children:(0,z.jsxs)(z.Fragment,{children:[a?.map((e=>e.message)),s?.map((e=>e.message))]})})}m(!1)}()},children:e("Save")})}),(0,z.jsx)(wn.T,{children:(0,z.jsx)(Bm,{})})]}),(0,z.jsx)(wn.T,{"data-cy":"workflow-visualizer-toolbar-kebab",children:(0,z.jsx)(j.m,{onOpenChange:e=>d(e),onSelect:()=>d(!c),isOpen:c,toggle:e=>(0,z.jsx)(_.S,{ref:e,className:"toggle-kebab",onClick:()=>d(!c),variant:"plain",children:(0,z.jsx)(C.bz,{})}),children:(0,z.jsxs)(v.Q,{children:[(0,z.jsx)(w.t,{icon:(0,z.jsx)(et._,{}),"data-cy":"workflow-documentation",to:pc(t,"workflowVisualizer"),target:"_blank",children:e("Documentation")}),i?.start&&(0,z.jsx)(w.t,{tooltipProps:r||0===S.length?{content:e(r?"Save the workflow before launching":"Add a step to the workflow before launching")}:void 0,isAriaDisabled:0===S.length||r,"data-cy":"workflow-visualizer-toolbar-launch",onClick:()=>{T()},icon:(0,z.jsx)(mb.Ab,{}),children:e("Launch workflow")}),i?.edit&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(k.c,{}),(0,z.jsx)(w.t,{isAriaDisabled:0===S.length,tooltipProps:0===S.length?{content:e("Add a step to the workflow before removing")}:void 0,"data-cy":"workflow-visualizer-toolbar-remove-all",onClick:()=>b(S),isDanger:!0,icon:(0,z.jsx)(Nd.Kf,{}),children:e("Remove all steps")})]})]})})}),(0,z.jsx)(wn.T,{style:{alignSelf:"center"},children:(0,z.jsxs)("div",{"data-cy":"workflow-visualizer-toolbar-total-nodes",children:[e("Total nodes")," ",(0,z.jsx)(bb.E,{isRead:!0,children:S.length||0})]})}),(0,z.jsx)(wn.T,{align:{default:"alignRight"},children:(0,z.jsx)(g.$n,{"data-cy":"workflow-visualizer-toolbar-expand-collapse",variant:"plain","aria-label":e(p?"Collapse":"Expand"),onClick:h,icon:(0,z.jsx)(y.I,{size:"lg",children:p?(0,z.jsx)(pb.dY,{"data-cy":"workflow-visualizer-toolbar-collapse","aria-label":e("Collapse")}):(0,z.jsx)(hb.hs,{"data-cy":"workflow-visualizer-toolbar-expand","aria-label":e("Expand")})})})})]})}));function xb(e){const{instance:t,instanceGroups:n,instanceForks:a}=e;return(0,z.jsx)(Gu,{numberOfColumns:"single",instance:t,instanceGroups:n,instanceForks:a})}function jb(e){const{selectedId:t}=e,{data:n}=tc(xl`/instances/`,t),{instanceGroups:a,instanceForks:s}=Ru(t);return n?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(yp,{onClose:e.onClose,title:n.hostname}),(0,z.jsx)(xb,{instance:n,instanceGroups:a||void 0,instanceForks:s})]}):null}const _b=({element:e})=>{const t=e.getData();return(0,z.jsx)(Dd.FjY,{element:e,...t})},vb=(0,A.Ay)(Yd).withConfig({componentId:"ans__sc-1410ylk-0"})(["height:100%;position:absolute;width:100%;background:white;"]),wb=(0,A.Ay)(Dd.tgn).withConfig({componentId:"ans__sc-1410ylk-1"})(["overflow:auto;& > div.pf-topology-container{max-height:100%;}"]),kb=(e,t)=>{if("group"===t)return Dd.b7q;switch(e){case Dd.g9r.graph:return(0,Dd.LY3)()(Dd.uJG);case Dd.g9r.node:return(0,Dd.VMe)()(qd);case Dd.g9r.edge:return _b;default:return}};function Sb(e){switch(e){case"established":default:return Dd.lC1.default;case"adding":case"removing":return Dd.lC1.dashed}}function Cb(e){switch(e){case"established":default:return Dd.zIx.default;case"adding":return Dd.zIx.success;case"removing":return Dd.zIx.danger}}const Tb=e=>{const{mesh:t}=e,[a,s]=(0,l.useState)([]),[o,i]=(0,l.useState)({type:"",nodes:[],links:[],progress:0}),[r,c]=(0,l.useState)(0),[d,u]=(0,l.useState)(!0),[m,p]=(0,l.useState)(!1),h=(0,l.useRef)(),b=h.current,f=(0,l.useMemo)((()=>new Worker(new URL(n.p+n.u(326),n.b))),[]);(0,l.useEffect)((()=>{const e=function(e){const t=Ed.select("#mesh-topology").node();return t?t.getBoundingClientRect().width:1200}(),n=function(e){const t=Ed.select("#mesh-topology").node();return t?t.getBoundingClientRect().height:800}();window.Worker&&f.postMessage({nodes:t.nodes,links:t.links,width:e,height:n})}),[]),(0,l.useEffect)((()=>{window.Worker&&(f.onmessage=function(e){switch(e.data.type){case"tick":return function(e){const t=Math.round(100*e);c(t),setTimeout((()=>u(100!==t)),100)}(e.data.progress);case"end":return t=e.data,i((()=>({...t}))),void f.terminate();default:return!1}var t})}),[f]),(0,l.useEffect)((()=>{const e=new Dd.Dib;e.registerComponentFactory(kb),e.addEventListener(Dd.oqJ,s),e.fromModel({nodes:[],edges:[],graph:{id:"g1",type:"graph"}},!1),h.current=e}),[]),(0,l.useEffect)((()=>{const e={nodes:o.nodes.map((e=>({id:e.id,x:e.x,y:e.y,type:e.node_type,label:e.hostname,width:50,height:50,shape:Dd.AG_.rect,data:{nodeType:e.node_type,nodeStatus:e.node_state}}))),edges:o.links.map((e=>({id:`edge-${e.source.hostname}-${e.target.hostname}`,type:"edge",source:e.source.id,target:e.target.id,edgeStyle:Sb(e.link_state),data:{endTerminalStatus:Cb(e.link_state),tagStatus:Cb(e.link_state)}})))};b&&(b.fromModel(e,!0),(0,Dd.XId)((()=>b.getGraph().fit(80)))())}),[o,b]);const{t:g}=(0,I.Bd)();return b?(0,z.jsx)(Dd.Uk6,{controller:b,children:(0,z.jsxs)(wb,{id:"mesh-topology",sideBarResizable:!0,sideBarOpen:a.length>0,sideBar:a.length>0&&(0,z.jsx)(Dd.M3g,{"data-cy":"mesh-viz-sidebar","aria-label":g("Mesh Topology sidebar"),show:!0,resizable:!0,children:(0,z.jsx)(jb,{onClose:()=>s([]),selectedId:a[0]})}),controlBar:!d&&(0,z.jsx)(Dd.Ug7,{controlButtons:(0,Dd.ks9)({...Dd.q7Z,zoomInCallback:(0,Dd.XId)((()=>{b.getGraph().scaleBy(4/3)})),zoomOutCallback:(0,Dd.XId)((()=>{b.getGraph().scaleBy(.75)})),fitToScreenCallback:(0,Dd.XId)((()=>{b.getGraph().fit(80)})),resetViewCallback:(0,Dd.XId)((()=>{b.getGraph().reset(),b.getGraph().layout()})),legend:!0,legendCallback:function(){p(!m)}})}),children:[(0,z.jsx)(Dd.AUs,{state:{selectedIds:a}}),d&&(0,z.jsx)(vb,{className:"mesh-content-loader",progress:r}),m&&(0,z.jsx)(Wd,{})]})}):null};var Ib=n(77334);function Ab(e){const{adminMessage:t,loginLink:n,title:a}=e;return(0,z.jsx)(Qa,{icon:Ib.XA,title:a||"You do not have access",description:(0,z.jsxs)(z.Fragment,{children:[t||"Contact your organization administrator for more information.",(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),n]})})}function Db(){const{t:e}=(0,I.Bd)(),t=sc(),{data:n,error:a}=ec(xl`/mesh_visualizer/`,void 0,{errorRetryCount:0}),s=403===a?.statusCode;return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Topology View"),description:e("View node type, node health, and specific details about each node in your mesh topology."),titleHelpTitle:e("Topology View"),titleHelp:e("View node type, node health, and specific details about each node in your mesh topology."),titleDocLink:pc(t,"topology")}),s?(0,z.jsx)(Ab,{title:e("You do not have permission to perform this action.")}):a?(0,z.jsx)(Ka,{}):n&&(0,z.jsx)(Tb,{mesh:n})]})}function Eb(e){const{button:t,clearAllFilters:n,description:a,title:s}=e;return(0,z.jsx)(Qa,{title:s||"No results found",description:a||"No results match the filter criteria. Try changing your filter settings.",icon:pn.WI,button:n?(0,z.jsx)(g.$n,{onClick:n,variant:"link",children:t||"Clear all filters"}):void 0})}var Pb=n(81496),Rb=n(33829);let Bb=function(e){return e.nonGrouped="nonGrouped",e.grouped="grouped",e}({});const Fb=({x:e,y:t,disableInlineStyles:n,...a})=>void 0!==e&&void 0!==t?(0,z.jsx)(an.$Q,{x:e-8,y:t-8,...a,...a.events}):null,Nb=e=>({...Pb.Cn,axisFormat:{...Pb.Cn.axisFormat,formatAsYear:e=>Intl.DateTimeFormat("en",{year:"numeric"}).format(new Date(e)),formatAsMonth:e=>Intl.DateTimeFormat("en",{month:"long"}).format(new Date(e)),...e?.axisFormat},labelFormat:{...Pb.Cn.labelFormat,...e?.labelFormat},onClick:{...Pb.Cn.onClick,...e?.onClick},dataComponent:{scatterPlot:Fb}}),$b=({schema:e,data:t,specificFunctions:n})=>{const a=[],[s,o]=(0,l.useState)({series:[],legend:[]});return(0,l.useEffect)((()=>{o(((e,t=[])=>({...e,series:e.series.map((e=>({...e,hidden:!(!e.serie[0].id&&!e.serie[0].host_id||!t.includes(Object.prototype.hasOwnProperty.call(e.serie[0],"host_id").toString()||Object.prototype.hasOwnProperty.call(e.serie[0],"id").toString()))})))}))((e=>{const t={series:[],legend:[]};switch(e.type="dates"in e?Bb.grouped:Bb.nonGrouped,e.type){case Bb.grouped:t.series=(e=>{const{dates:t}=e,n=[];return t.forEach((e=>{e?.items?.forEach(((t,a)=>{n[a]||(n[a]={serie:[],hidden:!1,name:(0,Rb.A)()}),n[a].serie.push({created_date:e.date,...t})}))})),n})(e);break;case Bb.nonGrouped:t.series=[{serie:e.items||e.meta?.legend||[],hidden:!1,name:(0,Rb.A)()}]}return e.meta?.legend&&(t.legend=e.meta.legend.map((e=>{const n=t.series.find((({serie:t})=>t.find((({id:t})=>t===e.id))));return{...e,childName:n&&n.name?n.name:""}}))),t})(t),a))}),[t]),(0,z.jsx)(Pb.Ay,{schema:e,functions:{...Nb(n)},dataState:[s,e=>{o(e)}]})},Mb=e=>t=>{if(!t)return e;let n=JSON.stringify(e);return Object.entries(t).forEach((e=>{const t=new RegExp(`VAR_${e[0]}`,"g");n=n.replace(t,`${e[1]}`)})),JSON.parse(n)},Lb=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),Ob=()=>{const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{children:(0,z.jsx)("strong",{children:e("Savings per template")})}),(0,z.jsx)("p",{children:(0,z.jsx)(I.x6,{children:"Savings per template is the difference between the manual cost and automation cost of successfully running templates across hosts. Manual cost is calculated by multiplying the number of hours spent manually running templates across hosts by the average hourly wages per engineer. Automation cost is the total amount of time, in seconds, spent running templates automatically multiplied by the average monthly cost for automated processes."})}),(0,z.jsx)("br",{}),(0,z.jsx)("p",{children:e("The formula used to calculate manual cost:")}),(0,z.jsx)(qu.N,{children:(0,z.jsx)(Uu.s,{children:e("manual time  = configurable time (in minutes) to manually complete the task on one host * number of host runs manual cost = manual time * configurable manual cost of automation (e.g. average salary of mid-level Software Engineer)")})}),(0,z.jsx)("br",{}),(0,z.jsx)("p",{children:e("The formula used to calculate automation cost:")}),(0,z.jsx)(qu.N,{children:(0,z.jsx)(Uu.s,{children:e("automation time = successful elapsed total / 3600 automation cost = automation time * configurable automated process cost")})}),(0,z.jsx)("br",{}),(0,z.jsx)("p",{children:e("The formula used to calculate automation cost:")}),(0,z.jsx)(qu.N,{children:(0,z.jsx)(Uu.s,{children:e("savings per template = manual cost - automation cost")})}),(0,z.jsx)("br",{})]})},zb=()=>{const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{children:(0,z.jsx)("strong",{children:e("Failed hosts cost per template")})}),(0,z.jsx)("p",{children:(0,z.jsx)(I.x6,{children:"Failed hosts cost per template is the total amount of time spent on failed automated job runs multiplied by the configured automated process cost."})}),(0,z.jsx)("br",{}),(0,z.jsx)("p",{children:e("The formula used to calculate failed host cost per template:")}),(0,z.jsx)(qu.N,{children:(0,z.jsx)(Uu.s,{children:e("failed cost per template = (failed elapsed total / 3600) * configurable automated process cost")})}),(0,z.jsx)("br",{})]})},Hb=()=>{const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{children:(0,z.jsx)("strong",{children:e("Monetary gain per template")})}),(0,z.jsx)("p",{children:(0,z.jsx)(I.x6,{children:"Monetary gain per template is the difference between total savings per template and failed hosts cost per template."})}),(0,z.jsx)("br",{}),(0,z.jsx)("p",{children:e("The formula for monetary gain per template:")}),(0,z.jsx)(qu.N,{children:(0,z.jsx)(Uu.s,{children:e("monetary gain per template = savings per template - failed host cost per template")})}),(0,z.jsx)("br",{})]})},qb=()=>{const[e,t]=(0,l.useState)(!1),{t:n}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(g.$n,{variant:g.Ak.link,onClick:()=>t(!0),icon:(0,z.jsx)(Qd.ee,{}),"data-cy":"automation_formula_button",children:n("Automation formula")}),(0,z.jsxs)(Zt.a,{title:n("Automation formula"),"data-cy":"automation_formula_modal",isOpen:e,onClose:()=>t(!1),variant:Zt.d.medium,actions:[(0,z.jsx)(g.$n,{variant:g.Ak.primary,onClick:()=>t(!1),"data-cy":"automation_formula_cancel_button",children:n("Close")},"cancel")],children:[(0,z.jsx)("p",{children:(0,z.jsx)(I.x6,{children:"We use manual effort versus time spent on automation as factors to create formulas for cost and savings related to automation. While we aim to provide as accurate an account of the cost and savings as possible, actual values may differ in practice. The following information breaks down where we get the data, the factors we use, the assumptions we make, and the formula used to compute the values as displayed in the chart."})}),(0,z.jsx)("br",{}),(0,z.jsx)(Ob,{}),(0,z.jsx)("br",{}),(0,z.jsx)(zb,{}),(0,z.jsx)("br",{}),(0,z.jsx)(Hb,{})]})]})};var Ub=n(85715);const Wb=(0,A.Ay)(ga.M).withConfig({componentId:"ans__sc-5rsxl4-0"})(["width:170px;"]),Jb=e=>+e&&+e<0?NaN:e,Vb=({costManual:e=0,setFromCalculation:t=()=>({}),costAutomation:n=0,readOnly:a=!0})=>{const{t:s}=(0,I.Bd)();return(0,z.jsx)(We.Z,{isPlain:!0,isCompact:!0,children:(0,z.jsxs)(fs.b,{children:[(0,z.jsxs)("p",{children:[s("Manual cost of automation"),(0,z.jsx)("span",{style:{fontSize:"0.8em",display:"block"},children:s("(e.g. average salary of mid-level Software Engineer)")})]}),(0,z.jsxs)(Wb,{children:[(0,z.jsx)(bh.z,{children:(0,z.jsx)(Ub.zI,{})}),(0,z.jsx)(ri.ks,{id:"manual-cost",type:"number","aria-label":"manual-cost",value:isNaN(e)?"":e.toString(),onChange:e=>t("manual_cost",Jb(+e)),isDisabled:a},"manual-cost")]}),(0,z.jsx)("p",{style:{paddingTop:"10px"},children:s("Automated process cost")}),(0,z.jsxs)(Wb,{children:[(0,z.jsx)(bh.z,{children:(0,z.jsx)(Ub.zI,{})}),(0,z.jsx)(ri.ks,{id:"automation-cost",type:"number","aria-label":"automation-cost",value:isNaN(n)?"":n.toString(),onChange:e=>t("automation_cost",Jb(+e)),isDisabled:a},"automation-cost")]})]})})};var Gb=n(18298),Yb=n(39529);function Kb(e){const{t}=(0,I.Bd)(),{activeAwxUser:n}=_l(),{error:a}=e,s={"analytics-upload-not-enabled":{title:t("Missing Gather data for Automation Analytics."),description:t("Please contact your organization's administrator to enable Gather data for Automation Analytics.")},"missing-user":{title:t("Missing User for Automation Analytics."),description:t("Please contact your organization's administrator to add User for Automation Analytics.")},"missing-password":{title:t("Missing Password for Automation Analytics."),description:t("Please contact your organization's administrator to add Password for Automation Analytics.")},"missing-url":{title:t("Missing URL for Automation Analytics."),description:t("Please contact your organization's administrator to add URL for Automation Analytics.")},unauthorized:{title:t("Missing Authentication for Automation Analytics."),description:t("Please contact your organization's administrator to add credentials.")},"no-data-or-entitlement":{title:t("You have no entitlement available. Or there's no data."),description:t("Please contact your organization's administrator to add entitlements.")},"not-found":{title:t("Not Found"),description:t("Not Found")},unknown:{title:t("There was an error on the server."),description:t("Please contact your organization's administrator.")}};function o(e){const{error:t}=e;return t&&s[t]?(0,z.jsx)(Qa,{title:s[t]?.title,description:s[t]?.description,icon:Gb.RY,button:s[t]?.button}):(0,z.jsx)(Ka,{})}function i(){return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Qa,{title:t("Automation Analytics is currently not enabled to send data."),description:t(n?.is_superuser?"Please click the button below to visit the settings page to set your credentials.":"Please contact your organization's administrator to add credentials."),icon:Yb.wI,button:n?.is_superuser?(0,z.jsx)(g.$n,{onClick:()=>null,children:t("Go to settings")}):void 0,footNote:t("Gain insights into your deployments through visual dashboards and organization statistics, calculate your return on investment, explore automation processes details.")})})}return(n?.is_superuser||n?.is_system_auditor)&&a?(0,z.jsx)(o,{error:a}):(0,z.jsx)(i,{})}var Zb=n(73683),Xb=n(27974),Qb=n(68591);const ef=e=>new Intl.NumberFormat("en-US",{maximumSignificantDigits:2}).format(e),tf=({template:e})=>{const{t}=(0,I.Bd)();return(0,z.jsx)(xn.Td,{colSpan:5,children:(0,z.jsx)(Wc.g,{children:(0,z.jsxs)($t.B,{columnModifier:{default:"3Col"},children:[(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Elapsed")}),(0,z.jsx)(Et.d,{children:t(`${e.elapsed} seconds`)})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Host count")}),(0,z.jsx)(Et.d,{children:e.host_count})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Total count")}),(0,z.jsx)(Et.d,{children:e.total_count})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Total org count")}),(0,z.jsx)(Et.d,{children:e.total_org_count})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Total cluster count")}),(0,z.jsx)(Et.d,{children:e.total_cluster_count})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Total inventory count")}),(0,z.jsx)(Et.d,{children:e.total_inventory_count})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Template success rate")}),(0,z.jsx)(Et.d,{children:parseInt(e.template_success_rate.toString()).toFixed(2)})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Savings from successful hosts")}),(0,z.jsx)(Et.d,{children:Lb(parseInt(e.successful_hosts_savings.toString()))})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Costs from failed hosts")}),(0,z.jsx)(Et.d,{children:Lb(parseInt(e.failed_hosts_costs.toString()))})]}),(0,z.jsxs)(At.W,{children:[(0,z.jsx)(Dt.X,{children:t("Monetary gain")}),(0,z.jsx)(Et.d,{children:e?.monetary_gain?Lb(parseInt(e.monetary_gain.toString())):""})]})]})})})},nf=({template:e,readOnly:t=!0,variableRow:n})=>{const[a,s]=(0,l.useState)("true"===window.localStorage.getItem(e.id.toString())||!1),{t:o}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(gn.Tr,{children:[(0,z.jsx)(xn.Td,{expand:{rowIndex:parseInt(e.id.toString()),isExpanded:a,onToggle:()=>{return t=!a,n=parseInt(e.id.toString()),window.localStorage.setItem(n.toString(),t?"true":"false"),void s(t);var t,n}}}),(0,z.jsx)(xn.Td,{children:e.name}),n&&(0,z.jsx)(xn.Td,{children:((e,t)=>{let n;switch(e){case"elapsed":n=ef(t)+" seconds";break;case"template_automation_percentage":n=ef(t)+"%";break;case"successful_hosts_savings":case"failed_hosts_costs":case"monetary_gain":n=Lb(t);break;default:n=(+t).toFixed(2)}return n})(n.key,+e[n.key])}),(0,z.jsx)(xn.Td,{children:(0,z.jsxs)(ga.M,{children:[(0,z.jsx)(ya.b,{isFill:!0,children:(0,z.jsx)(ri.ks,{autoFocus:window.localStorage.getItem("focused")==="manual-time-"+e.id.toString(),id:"manual-time-"+e.id.toString(),"data-cy":"manual-time",style:{maxWidth:"150px"},type:"number","aria-label":"time run manually",value:e.manual_effort_minutes||60,onBlur:()=>window.localStorage.setItem("focused",""),isDisabled:t})}),(0,z.jsx)(bh.z,{children:o("min")}),(0,z.jsx)(bh.z,{children:o(`x ${e.successful_hosts_total} host runs`)})]})}),(0,z.jsx)(xn.Td,{"data-cy":"savings",style:{color:e.enabled?Xb.V.value:Qb.g.value},children:Lb(parseInt(e.monetary_gain.toString())||0)}),(0,z.jsx)(xn.Td,{children:(0,z.jsx)(O.d,{label:o("Show"),labelOff:o("Hide"),isChecked:!!e.enabled,isDisabled:t})})]}),(0,z.jsx)(gn.Tr,{isExpanded:a,children:(0,z.jsx)(tf,{template:e})})]})},af=({data:e=[],readOnly:t=!0,variableRow:n,getSortParams:a})=>{const{t:s}=(0,I.Bd)();return(0,z.jsxs)(hn.X,{"data-cy":"table","aria-label":"ROI Table",variant:Zb.a.compact,children:[(0,z.jsx)(fn.d,{children:(0,z.jsxs)(gn.Tr,{children:[(0,z.jsx)(yn.Th,{}),(0,z.jsx)(yn.Th,{children:s("Name")}),n&&(0,z.jsx)(yn.Th,{...a,children:n.value}),(0,z.jsx)(yn.Th,{children:s("Manual time")}),(0,z.jsx)(yn.Th,{children:s("Savings")})]})}),(0,z.jsx)(bn.N,{children:e.map((e=>(0,z.jsx)(nf,{template:e,readOnly:t,variableRow:n},e.id)))})]})},sf=A.Ay.div.withConfig({componentId:"ans__sc-12bow-0"})(["height:46.8px;padding-left:100px;"]),of=({totalSavings:e=0,currentPageSavings:t=0,isLoading:n=!1})=>{const{t:a}=(0,I.Bd)();return(0,z.jsx)(z.Fragment,{children:[a("Total savings"),a("Current page savings")].map(((a,s)=>(0,z.jsxs)(We.Z,{"data-cy":a.toLowerCase().replace(" ","_").replace(" ","_"),isPlain:!0,isCompact:!0,children:[(0,z.jsx)(bs.Z,{children:a}),(0,z.jsx)(fs.b,{children:(0,z.jsx)(Ge.h,{headingLevel:"h3",size:0===s?"4xl":"xl",style:{color:"var(--pf-v5-global--success-color--100)"},children:n?(0,z.jsx)(sf,{children:(0,z.jsx)(Wn.y,{"data-cy":"spinner",size:"lg"})}):Lb(0===s?e:t)})})]},a)))})};function rf(e){const{t}=(0,I.Bd)(),[n]=jr(),{schema:a}=e,{data:s,isLoading:o,error:i}=(0,_e.Ay)(xl`/analytics/roi_templates_options/`,(e=>al(e,void 0))),r=(0,l.useCallback)((()=>""),[]),[c,d]=(0,l.useState)((()=>{const e={},t=[{key:"cluster_id",searchParam:"clusters"},{key:"org_id",searchParam:"orgs"},{key:"template_id",searchParam:"templates"},{key:"inventory_id",searchParam:"inventories"},{key:"quick_date_range",searchParam:"dates"}];for(const a of t){const t=n.get(a.searchParam);t&&(e[a.key]=t.split(","))}return e})),u=(0,l.useMemo)((()=>{const e=[];return s&&(s.cluster_id&&s.cluster_id.length>0&&e.push({key:"cluster_id",query:"cluster_id",type:Ia.MultiSelect,label:t("Cluster"),placeholder:t("Filter by Cluster"),options:s.cluster_id.map((e=>({label:e.value.toString(),value:e.key.toString()})))}),s.org_id&&s.org_id.length>0&&e.push({key:"org_id",query:"org_id",type:Ia.MultiSelect,label:t("Organization"),placeholder:t("Filter by Organization"),options:s.org_id.map((e=>({label:e.value.toString(),value:e.key.toString()})))}),s.template_id&&s.template_id.length>0&&e.push({key:"template_id",query:"template_id",type:Ia.MultiSelect,label:t("Template"),placeholder:t("Filter by Template"),options:s.template_id.map((e=>({label:e.value.toString(),value:e.key.toString()})))}),s.inventory_id&&s.inventory_id.length>0&&e.push({key:"inventory_id",query:"inventory_id",type:Ia.MultiSelect,label:t("Inventory"),placeholder:t("Filter by Inventory"),options:s.inventory_id.map((e=>({label:e.value.toString(),value:e.key.toString()})))}),s.quick_date_range&&s.quick_date_range.length>0&&e.push({key:"quick_date_range",query:"quick_date_range",type:Ia.DateRange,label:t("Dates"),options:s.quick_date_range.map((e=>({label:e.value.toString(),value:e.key.toString(),isCustom:"roi_custom"===e.key}))),isRequired:!0,isPinned:!0})),e}),[s,t]),[m,p]=(0,l.useState)((()=>{let e=n.get("sort");return e?(e?.startsWith("-")&&(e=e.substring(1)),e):"host_count"})),[h,b]=(0,l.useState)((()=>{const e=n.get("sort");return e&&e?.startsWith("-")?"asc":"desc"})),f=(0,l.useMemo)((()=>s?s.sort_options.map((e=>({label:e.value.toString(),value:e.key.toString(),type:"number",defaultDirection:"desc"}))):[]),[s]),g=(0,l.useMemo)((()=>f.find((e=>e.value===m))),[m,f]);return o?(0,z.jsx)(Or,{}):i?(0,z.jsx)(Kb,{error:i.message}):g?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ya,{keyFn:r,itemCount:0,toolbarFilters:u,filterState:c,setFilterState:d,sortOptions:f,sort:m,setSort:p,sortDirection:h,setSortDirection:b,disablePagination:!0}),(0,z.jsx)(lf,{schema:a,filterState:c,setFilterState:d,sortOption:g,sortDirection:h,setSortDirection:b})]}):(0,z.jsx)(Or,{})}function lf(e){const{t}=(0,I.Bd)(),{schema:n,filterState:a,setFilterState:s,sortOption:o,sortDirection:i,setSortDirection:r}=e,[c,d]=jr(),[u,m]=(0,l.useState)((()=>c.get("page")?parseInt(c.get("page")):1)),[p,h]=(0,l.useState)((()=>c.get("per_page")?parseInt(c.get("per_page")):10));(0,l.useEffect)((()=>{const e=new URLSearchParams;o&&("desc"===i?e.set("sort",o.value):e.set("sort","-"+o.value)),e.set("page",u.toString()),e.set("per_page",p.toString()),a&&(a.org_id&&e.set("orgs",a.org_id.join(",")),a.cluster_id&&e.set("clusters",a.cluster_id.join(",")),a.template_id&&e.set("templates",a.template_id.join(",")),a.inventory_id&&e.set("inventories",a.inventory_id.join(",")),a.quick_date_range&&e.set("dates",a.quick_date_range.join(","))),d(e)}),[a,u,p,d,o,i]);const b=(0,l.useMemo)((()=>{const e=a.quick_date_range;let t,n;return e&&(e.length>=2&&(t=e[1]),e.length>=3&&(n=e[2])),{status:[],org_id:a.org_id??[],cluster_id:a.cluster_id??[],template_id:a.template_id??[],inventory_id:a.inventory_id??[],quick_date_range:a.quick_date_range&&a.quick_date_range.length?a.quick_date_range[0]:"roi_last_year",job_type:[],sort_options:o.value,sort_order:i,start_date:t,end_date:n,limit:p.toString(),offset:((u-1)*p).toString(),only_root_workflows_and_standalone_jobs:!0,template_weigh_in:void 0,attributes:["elapsed","host_count","total_count","total_org_count","total_cluster_count","successful_hosts_total","successful_elapsed_total"],group_by:"template",group_by_time:!1}}),[a,u,p,o.value,i]),[f,g]=(0,l.useState)(),[y,x]=(0,l.useState)(),[j,_]=(0,l.useState)(!0);(0,l.useEffect)((()=>{const e=new AbortController;return _(!0),al(xl`/analytics/roi_templates/?limit=${p.toString()}&offset=${((u-1)*p).toString()}&sort_by=${o?.value}:${encodeURIComponent(i)}`,b,e.signal).then((t=>{e.signal.aborted||(g(t),_(!1),x(void 0))})).catch((t=>{e.signal.aborted||(x(t),_(!1),g(void 0))})),()=>e.abort()}),[u,p,o?.value,i,b]);return(0,l.useEffect)((()=>{const e=f?.meta.count??0,t=Math.min(1,Math.ceil(e/p));(u>t||u<1)&&m(1)}),[f?.meta.count,u,p]),j?(0,z.jsx)(ze,{borderTop:!0,borderBottom:!0,children:(0,z.jsx)(Oe.d8,{children:(0,z.jsx)(We.Z,{style:{height:"100%"},isFlat:!0,isRounded:!0,children:(0,z.jsx)(Or,{})})})}):y?(0,z.jsx)(Kb,{error:y.message}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ze,{borderTop:!0,borderBottom:!0,children:(0,z.jsx)(Oe.d8,{children:(0,z.jsxs)(We.Z,{isFlat:!0,isRounded:!0,children:[(0,z.jsx)(fs.b,{children:(0,z.jsxs)(so.x,{hasGutter:!0,children:[(0,z.jsx)(xd.E,{span:9,children:!j&&(0,z.jsxs)(We.Z,{isPlain:!0,children:[(0,z.jsx)(Je.a,{children:(0,z.jsx)(bs.Z,{children:t("Automation savings")})}),f&&0!==f?.meta?.legend.length?(0,z.jsx)($b,{schema:Mb(n)({y:o.value,tooltip:"Savings for",field:o.value,label:o.label}),data:{items:f?.meta?.legend},specificFunctions:{labelFormat:{customTooltipFormatting:({datum:e})=>`${o.label} for ${e.name||""}: ${((e,t)=>{let n;switch(e){case"elapsed":n=t.toFixed(2)+" seconds";break;case"template_automation_percentage":n=t.toFixed(2)+"%";break;case"successful_hosts_savings":case"failed_hosts_costs":case"monetary_gain":n=Lb(t);break;default:n=t.toFixed(2)}return n})(o.value,e.y)||""}`}}}):(0,z.jsx)(Eb,{clearAllFilters:()=>s((()=>({quick_date_range:["roi_last_year"]})))})]})}),(0,z.jsx)(xd.E,{span:3,children:!j&&(0,z.jsxs)(Xe.B,{children:[(0,z.jsx)(Qe.a,{children:(0,z.jsx)(of,{totalSavings:(f?.monetary_gain_other_pages||0)+(f?.monetary_gain_current_page||0),currentPageSavings:f?.monetary_gain_current_page||0,isLoading:j})}),(0,z.jsx)(Qe.a,{children:(0,z.jsx)(Vb,{costManual:f?.cost.hourly_manual_labor_cost||0,setFromCalculation:()=>null,costAutomation:f?.cost.hourly_automation_cost||0,readOnly:!0})}),(0,z.jsx)(Qe.a,{children:(0,z.jsx)(qb,{})})]})})]})}),(0,z.jsx)(af,{data:f?.meta.legend||[],variableRow:{key:o.value,value:o.label},readOnly:!0,getSortParams:{sort:{sortBy:{index:1,direction:i},onSort:(e,t,n)=>r(n),columnIndex:1}}})]})})}),(0,z.jsx)(Cn.d,{itemCount:f?.meta.count,page:u,perPage:p,perPageOptions:cf,onPerPageSelect:(e,t)=>h(t),onSetPage:(e,t)=>m(t),variant:Cn.A.bottom})]})}const cf=[4,6,8,10,15,20,25].map((e=>({title:e.toString(),value:e})));let df=function(e){return e.operations="Operations",e.executive="Executive",e.subscription="Subscription",e.migration="Migration",e.controller="Controller",e.catalog="Catalog",e.automationHub="Automation Hub",e.modules="Modules",e.hosts="Hosts",e.tasks="Tasks",e.organization="Organization",e.jobTemplate="Job template",e.jobRuns="Job runs",e.timeSeries="Time series",e.performanceAnomalyDetection="Performance anomaly detection",e.savings="Savings",e}({});const uf=[{key:df.operations,name:"Operations",description:"This report is useful to the engineers who manage day-to-day Ansible operations.  In other words, team members who write playbooks, do administration tasks within Controller, etc."},{key:df.executive,name:"Executive",description:"This report is useful to executives who want to monitor and learn about the Ansible operations happening across the company."},{key:df.subscription,name:"Subscription",description:"This report provides useful information around subscription data, helping you make decisions around compliance."},{key:df.migration,name:"Migration",description:"This report provides useful information around migrations, such as helping to identify what could be necessary to move to newer versions of the Ansible Automation Platform."},{key:df.controller,name:"Controller",description:"This report provides information gathered from Controller."},{key:df.catalog,name:"Catalog",description:"This report provides information gathered from Automation Services Catalog."},{key:df.automationHub,name:"Automation Hub",description:"This report provides information gathered from Automation Hub."},{key:df.modules,name:"Modules",description:"This report groups information by Ansible modules, the specific executable code ran in individual playbook or job template tasks."},{key:df.hosts,name:"Hosts",description:"This report groups information by the hosts within the Ansible inventories that are executed by playbooks or job templates."},{key:df.tasks,name:"Tasks",description:"This report groups information by the individual tasks that make up a playbook or job template."},{key:df.organization,name:"Organization",description:"This report groups information by the organizations set up within the company’s Ansible Controller instances."},{key:df.jobTemplate,name:"Job template",description:"This report groups information by the job templates set up within the company’s Ansible Controller instances."},{key:df.jobRuns,name:"Job runs",description:"This report groups information by the individual runs of playbooks or job templates."},{key:df.timeSeries,name:"Time series",description:"This report groups information for a specified time range and granularity, such as weekly (e.g., from the past 12 weeks) or monthly (e.g., between August and November)."},{key:df.performanceAnomalyDetection,name:"Performance anomaly detection",description:"This report provides the ability to detect anomalies in Ansible performance, such as identifying slow tasks or hosts, or tasks with high error rates."},{key:df.savings,name:"Savings",description:"This report is useful for showing potential or actual savings based on Ansible usage."}];function mf(){const{activeAwxUser:e}=_l(),{data:t,error:n}=(0,_e.Ay)(xl`/analytics/report/automation_calculator/`,nl),[a,s]=(0,l.useState)("");function o(){return n||a?a?(0,z.jsx)(Kb,{error:a}):(0,z.jsx)(z.Fragment,{}):t?(0,z.jsx)(rf,{...t.report?.layoutProps}):(0,z.jsx)(z.Fragment,{})}(0,l.useEffect)((()=>{s(n?n?.body?.error?.keyword||"unknown":"")}),[n]);const i=(0,z.jsx)(pf,{numLabels:6,children:!!t&&t.report.layoutProps.tags.map(((e,t)=>{const n=uf.find((t=>t.key===e));if(n)return(0,z.jsx)(x.m,{position:x.Z.bottom,content:n.description,children:(0,z.jsx)(Ee.J,{"data-cy":n.name,children:n.name},t)},`tooltip_${t}`)}))});return(0,z.jsx)(or.Y,{children:(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t?.report?.name||"",description:t?.report?.description||"",controls:t?i:void 0}),e&&!e?.is_superuser?(0,z.jsx)(Kb,{}):(0,z.jsx)(o,{})]})})}const pf=(0,A.Ay)(De.o).withConfig({componentId:"ans__sc-1ym1hl2-0"})(["flex-wrap:nowrap;"]);function hf(){const{activeTheme:e}=we();let t="var(--pf-v5-chart-color-green-300)",n="var(--pf-v5-chart-color-red-100)",a="var(--pf-v5-chart-color-orange-300)",s="var(--pf-v5-chart-color-gold-400)",o="var(--pf-v5-chart-color-black-400)",i="var(--pf-v5-chart-color-blue-300)",r="var(--pf-v5-chart-color-cyan-300)",l="var(--pf-v5-chart-color-red-100)",c="var(--pf-v5-chart-color-green-300)",d="var(--pf-v5-chart-color-gold-400)",u="var(--pf-v5-chart-color-purple-300)",m="var(--pf-v5-chart-color-orange-300)",p="var(--pf-v5-chart-color-black-400)";return"dark"===e&&(t="var(--pf-v5-chart-color-green-400)",n="var(--pf-v5-chart-color-red-400)",a="var(--pf-v5-chart-color-orange-300)",s="var(--pf-v5-chart-color-gold-300)",o="var(--pf-v5-chart-color-black-400)",i="var(--pf-v5-chart-color-blue-400)",r="var(--pf-v5-chart-color-cyan-400)",l="var(--pf-v5-chart-color-red-400)",c="var(--pf-v5-chart-color-green-400)",d="var(--pf-v5-chart-color-gold-300)",u="var(--pf-v5-chart-color-purple-400)",m="var(--pf-v5-chart-color-orange-300)",p="var(--pf-v5-chart-color-black-300)"),{successfulColor:t,failedColor:n,errorColor:a,warningColor:s,canceledColor:o,blueColor:i,yellowColor:d,purpleColor:u,orangeColor:m,redColor:l,cyanColor:r,greenColor:c,greyColor:p,chartColors:[i,d,u,m,r,l,c,p]}}function bf(e){const{data:t,isLoading:n}=(0,_e.Ay)(xl`/host_metric_summary_monthly/?date__gte=${(()=>{const t=new Date;let n="";switch(e.period.dateRange?.[0]){case"year":default:n=t.getMonth()<9?`${t.getFullYear()-1}-0${t.getMonth()+1}-01`:`${t.getFullYear()-1}-${t.getMonth()+1}-01`;break;case"two_years":n=t.getMonth()<9?`${t.getFullYear()-2}-0${t.getMonth()+1}-01`:`${t.getFullYear()-2}-${t.getMonth()+1}-01`;break;case"three_years":n=t.getMonth()<9?`${t.getFullYear()-3}-0${t.getMonth()+1}-01`:`${t.getFullYear()-3}-${t.getMonth()+1}-01`}return n})()}&order_by=date&page_size=100`,(e=>fetch(e).then((e=>e.json())))),a=e=>{const t=e,n=t?.split("-")??[];return n[1]+"/"+n[0]},s=void 0!==t?t.results.map((({date:e,license_consumed:t})=>({label:a(e),value:t}))):[],o=void 0!==t?t.results.map((({date:e,license_capacity:t})=>({label:a(e),value:t}))):[],{blueColor:i,redColor:r}=hf();return n?(0,z.jsx)(Un.a,{children:(0,z.jsx)(Wn.y,{})}):(0,z.jsx)(Ct,{groups:[{label:"Subscriptions consumed ",color:i,values:s},{label:"Subscription capacity",color:r,values:o}],xLabel:"Month",yLabel:"Unique hosts",variant:"lineChart",allowZero:!0,onlyIntegerTicks:!0,padding:{right:15},showLegendCount:!1})}function ff(){const{t:e}=(0,I.Bd)(),t=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{key:"dateRange",label:e("Period"),type:Ia.SingleSelect,query:"dateRange",options:[{label:e("Past year"),value:"year"},{label:e("Past two years"),value:"two_years"},{label:e("Past three years"),value:"three_years"}],placeholder:e("Select period"),isPinned:!0,isRequired:!0,defaultValue:"year"}]),[e])}(),[n,a]=(0,l.useState)({dateRange:["year"]}),s=ec(xl`/settings/system/`),{data:o}=ec(xl`/host_metric_summary_monthly/`);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Subscription Usage"),titleHelpTitle:e("Subscription Usage"),titleHelp:e("A chart showing historical usage of your subscription. Subscription capacity and licenses consumed per month are displayed, with the ability to filter by the last year, two years, or three years."),description:e("A chart showing historical usage of your subscription. Subscription capacity and licenses consumed per month are displayed, with the ability to filter by the last year, two years, or three years.")}),(0,z.jsx)(Ya,{keyFn:ll,itemCount:o?.count,toolbarFilters:t,setFilterState:a,filterState:n,disableCardView:!0,disableListView:!0,disableTableView:!0,disablePagination:!0}),(0,z.jsx)(Ue,{children:(0,z.jsx)(it,{title:e("Subscription Compliance"),width:"xxl",height:"xl",headerControls:(0,z.jsx)(i.s,{spaceItems:{default:"spaceItemsNone"},style:{gap:8},children:(0,z.jsx)(r.Z,{children:(0,z.jsxs)(Ve.E,{component:"small",children:["Last recalculation date:"," ",void 0!==s.data&&s.data.HOST_METRIC_SUMMARY_TASK_LAST_TS?s.data.HOST_METRIC_SUMMARY_TASK_LAST_TS.slice(0,10):e("None")]})})}),children:(0,z.jsx)(fs.b,{children:(0,z.jsx)(bf,{period:n})})})})]})}var gf=n(97510);function yf(e){return(0,z.jsx)(it,{width:"xxl",isCompact:!0,children:(0,z.jsx)(fs.b,{children:(0,z.jsx)("div",{"data-cy":"resource-count-bar",style:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",paddingLeft:8,paddingRight:8,gap:16},children:e.counts.map(((e,t)=>{const n=e.title.toLowerCase().replace(/ /g,"-"),s=e.total??e.counts?.reduce(((e,t)=>e+(t.count??0)),0)??0;return(0,z.jsxs)("div",{"data-cy":n,id:n,style:{display:"flex",gap:12,alignItems:"center"},children:[(0,z.jsx)(a.N_,{to:e.to,style:{color:"var(--pf-v5-global--text--Color)"},children:(0,z.jsxs)(Ge.h,{headingLevel:"h3",size:"xl",style:{whiteSpace:"nowrap",textDecoration:"none"},children:[s," ",e.title]})}),s&&"counts"in e&&e.counts?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{id:`${n}-chart`,style:{maxHeight:64,marginTop:-4,marginBottom:-4},children:(0,z.jsx)(gf.P,{padding:{top:0,left:0,right:0,bottom:0},width:64,height:64,data:e.counts.map((e=>({x:" ",y:e.count}))),colorScale:e.counts.map((e=>e.color)),cornerRadius:1,allowTooltip:!1})}),(0,z.jsx)(bt,{id:`${n}-legend`,legend:e.counts})]}):(0,z.jsx)("span",{id:`${n}-chart`,style:{fontSize:"xx-large",lineHeight:1},children:s})]},t)}))})})})}function xf(e){const{t}=(0,I.Bd)(),{data:n}=e,{successfulColor:a,failedColor:s}=hf(),o=gr();return(0,z.jsx)(yf,{counts:[{title:t("Hosts"),to:o(fc.Hosts),counts:n?.hosts?.total?[{label:t("Ready"),count:n.hosts.total-n.hosts.failed,color:a},{label:t("Failed"),count:n.hosts.failed,color:s}]:void 0},{title:t("Projects"),to:o(fc.Projects),counts:n?.projects?.total?[{label:t("Ready"),count:n.projects.total-n.projects.failed,color:a,link:o(fc.Projects)+"?status=successful"},{label:t("Failed"),count:n.projects.failed,color:s,link:o(fc.Projects)+"?status=failed,error,canceled,missing"}]:void 0},{title:t("Inventories"),to:o(fc.Inventories),counts:n?.inventories?.total?[{label:t("Synced"),count:n.inventories.total-n.inventories.inventory_failed,color:a},{label:t("Synced failures"),count:n.inventories.inventory_failed,color:s}]:void 0}]})}function jf(e){const t=gr(),{t:n}=(0,I.Bd)(),{period:a,jobType:s}=e,{data:o,isLoading:i}=(0,_e.Ay)(xl`/dashboard/graphs/jobs/?job_type=${s??"all"}&period=${a??"month"}`,(e=>fetch(e).then((e=>e.json())))),r=e=>{const t=new Date(1e3*e[0]);let n;return n="day"===a?`${t.toLocaleTimeString()}`:`${t.getMonth()+1}/${t.getDate()}`,{label:n,value:e[1]}},l=o?.jobs?.failed.map(r)??[],c=o?.jobs?.successful.map(r)??[],d=o?.jobs?.canceled?.map(r)??[],u=o?.jobs?.error?.map(r)??[],{successfulColor:m,failedColor:p,errorColor:h,canceledColor:b}=hf();return i?(0,z.jsx)(Un.a,{children:(0,z.jsx)(Wn.y,{})}):(0,z.jsx)(Ct,{yLabel:n("Job count"),variant:"stackedAreaChart",groups:[{label:n("Success"),color:m,values:c,link:t(fc.Jobs)+"?status=successful"},{label:n("Error"),color:h,values:u,link:t(fc.Jobs)+"?status=error"},{label:n("Failed"),color:p,values:l,link:t(fc.Jobs)+"?status=failed"},{label:n("Canceled"),color:b,values:d,link:t(fc.Jobs)+"?status=canceled"}],height:e.height})}function _f(){const{t:e}=(0,I.Bd)(),[t,n]=(0,l.useState)("month"),[a,s]=(0,l.useState)("all"),o=gr();return(0,z.jsx)(it,{title:e("Job Activity"),linkText:e("View all Jobs"),to:o(fc.Jobs),width:"xxl",height:"sm",headerControls:(0,z.jsxs)(i.s,{spaceItems:{default:"spaceItemsNone"},style:{gap:8},children:[(0,z.jsx)(r.Z,{children:(0,z.jsx)(oa,{placeholder:e("Select period"),value:t,onSelect:n,options:[{label:e("Past month"),value:"month"},{label:e("Past two weeks"),value:"two_weeks"},{label:e("Past week"),value:"week"}],isRequired:!0})}),(0,z.jsx)(r.Z,{children:(0,z.jsx)(oa,{placeholder:e("Select job types"),value:a,onSelect:s,options:[{label:e("All job types"),value:"all"},{label:e("Inventory sync"),value:"inv_sync"},{label:e("Scm update"),value:"scm_update"},{label:e("Playbook run"),value:"playbook_run"}],isRequired:!0})})]}),children:(0,z.jsx)(fs.b,{children:(0,z.jsx)(jf,{period:t,jobType:a})})})}function vf(){const{t:e}=(0,I.Bd)(),t=yr(),n=gr(),{data:a}=dd(xl`/inventories/`),s=Boolean(a&&a.actions&&a.actions.POST),o=Uc({url:xl`/inventories/`,disableQueryString:!0,defaultSort:"modified",defaultSortDirection:"desc"});let i=ah();return i=Yt(i),(0,z.jsx)(it,{title:e("Inventories"),subtitle:e("Recently updated inventories"),width:"md",height:"md",linkText:e("View all Inventories"),to:n(fc.Inventories),children:(0,z.jsx)($s,{disableBodyPadding:!0,tableColumns:i,autoHidePagination:!0,errorStateTitle:e("Error loading inventories"),emptyStateIcon:Za.GY,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateVariant:"light",emptyStateTitle:e("There are currently no inventories"),emptyStateDescription:e(s?"Create a inventory by clicking the button below..":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonText:s?e("Create inventory"):void 0,emptyStateButtonClick:s?()=>t(fc.CreateInventory):void 0,...o,compact:!0,itemCount:void 0!==o.itemCount?Math.min(o.itemCount,7):void 0,pageItems:o.pageItems?o.pageItems.slice(0,7):[],disableLastRowBorder:!0})})}function wf(e){switch(e){case"ad_hoc_command":return xl`/ad_hoc_commands/`;case"inventory_update":return xl`/inventory_updates/`;case"project_update":return xl`/project_updates/`;case"system_job":return xl`/system_jobs/`;case"workflow_job":return xl`/workflow_jobs/`;default:return xl`/jobs/`}}function kf(e){return["new","pending","waiting","running"].includes(e??"waiting")}function Sf(e){switch(e.type){case"ad_hoc_command":return xl`/ad_hoc_commands/${e.id.toString()}/relaunch/`;case"workflow_job":return xl`/workflow_jobs/${e.id.toString()}/relaunch/`;case"job":return xl`/jobs/${e.id.toString()}/relaunch/`;case"inventory_update":return e.inventory_source?xl`/inventory_sources/${e.inventory_source}/update/`:"";case"project_update":return e.project?xl`/projects/${e.project}/update/`:"";default:return""}}function Cf(){const e=gr();return(0,l.useMemo)((()=>t=>{const n=t.summary_fields?.unified_job_template?.id,a=t.summary_fields?.schedule?.id,s=t.summary_fields?.inventory?t.summary_fields.inventory.id:null;let o="";if(n&&a)switch(t.type){case"inventory_update":o=s?e(fc.InventorySourceScheduleDetails,{params:{id:s,source_id:n,schedule_id:a}}):"";break;case"job":o=e(fc.JobTemplateScheduleDetails,{params:{id:n,schedule_id:a}});break;case"project_update":o=e(fc.ProjectScheduleDetails,{params:{id:n,schedule_id:a}});break;case"system_job":o=e(fc.ManagementJobScheduleDetails,{params:{id:n,schedule_id:a}});break;case"workflow_job":o=e(fc.WorkflowJobTemplateScheduleDetails,{params:{id:n,schedule_id:a}})}return o}),[e])}function Tf(){const e=gr(),t=Cf();return(0,l.useMemo)((()=>n=>{const a=n.summary_fields?.created_by,s=n.summary_fields?.job_template,o=n.summary_fields?.workflow_job_template,i=n.summary_fields?.schedule;if(!a&&!i)return{};let r,l;switch(n.launch_type){case"webhook":l="Webhook",r=s?e(fc.JobTemplateDetails,{params:{id:s.id}}):o?e(fc.WorkflowJobTemplateDetails,{params:{id:o.id}}):"";break;case"scheduled":l=i?.name||"",r=t(n);break;default:r=a?.id?e(fc.UserDetails,{params:{id:a.id}}):"",l=a?a.username:""}return{link:r,value:l}}),[e,t])}function If(e){const{t}=(0,I.Bd)(),n=gr(),s=Cf(),{data:o}=dd(xl`/inventory_sources/`),i=(0,l.useMemo)((()=>o&&o.actions&&o.actions.GET&&o.actions.GET.source&&Array.isArray(o.actions.GET.source.choices)?o.actions.GET.source.choices:[]),[o]),r=Ah(),c=Tf();return(0,l.useMemo)((()=>[{header:t("ID"),cell:e=>e.id,sort:"id",card:"hidden",list:"hidden",dashboard:"hidden",minWidth:0},{header:t("Name"),cell:t=>(0,z.jsx)(Fe,{text:t.name,to:r(t),disableLinks:e?.disableLinks}),sort:"name",card:"name",list:"name"},{header:t("Status"),cell:e=>(0,z.jsx)(au,{status:e.status}),sort:"status"},{header:t("Type"),cell:e=>{const n={project_update:t`Source control update`,inventory_update:t`Inventory sync`,job:"check"===e.job_type?t`Playbook check`:t`Playbook run`,ad_hoc_command:t`Command`,system_job:t`Management job`,workflow_job:t`Workflow job`};return(0,z.jsx)(Fe,{text:n[e.type]})},sort:"type",card:"subtitle",list:"subtitle",dashboard:"hidden"},{header:t("Duration"),cell:e=>e.started&&(0,z.jsx)(Ae,{start:e.started,finish:e.finished}),modal:Ut.hidden,dashboard:"hidden"},{header:t("Started"),cell:e=>e.started&&(0,z.jsx)(Ie,{value:e.started}),sort:"started",list:"secondary",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Finished"),cell:e=>e.finished?(0,z.jsx)(Ie,{value:e.finished}):"--",sort:"finished",card:"hidden",list:"secondary",defaultSortDirection:"desc",defaultSort:!0,modal:Ut.hidden,dashboard:"hidden"},{header:t("Source"),cell:e=>i?.map((([t,n])=>t===e.source?n:null)),value:e=>e.source?e.source:void 0,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Launched by"),cell:e=>{const{value:t,link:n}=c(e)??{};return n?(0,z.jsx)(a.N_,{to:`${n}`,children:t}):t},table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Schedule"),cell:e=>(0,z.jsx)(a.N_,{to:e.summary_fields?.schedule?s(e)??"":"",children:e.summary_fields?.schedule?.name}),value:e=>e.summary_fields?.schedule?.name,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Job template"),cell:e=>(0,z.jsx)(a.N_,{to:n(fc.JobTemplateDetails,{params:{id:e.summary_fields?.job_template?.id}}),children:e.summary_fields?.job_template?.name}),value:e=>e.summary_fields?.job_template?.name,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Workflow job template"),cell:e=>(0,z.jsx)(a.N_,{to:n(fc.WorkflowJobTemplateDetails,{params:{id:e.summary_fields?.workflow_job_template?.id}}),children:e.summary_fields?.workflow_job_template?.name}),value:e=>e.summary_fields?.workflow_job_template?.name,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Source workflow job"),cell:e=>(0,z.jsx)(a.N_,{to:n(fc.JobDetails,{params:{job_type:"workflow",id:e.summary_fields.source_workflow_job?.id}}),children:e.summary_fields.source_workflow_job?.name}),value:e=>e.summary_fields?.source_workflow_job?.name,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Inventory"),cell:e=>(0,z.jsx)(a.N_,{to:n(fc.InventoryDetails,{params:{inventory_type:Af[e.summary_fields?.inventory?.kind??""],id:e.summary_fields?.inventory?.id}}),children:e.summary_fields?.inventory?.name}),helpText:t("Inventory used on this job."),value:e=>e.summary_fields?.inventory?.name,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Project"),helpText:t("The project containing the playbook this job will execute."),cell:e=>(0,z.jsx)(a.N_,{to:n(fc.ProjectDetails,{params:{id:e.summary_fields?.project?.id}}),children:e.summary_fields?.project?.name}),value:e=>e.summary_fields?.project?.name,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Execution environment"),helpText:t("The execution environment used to run the job."),cell:e=>(0,z.jsx)(a.N_,{to:n(fc.ExecutionEnvironmentDetails,{params:{id:e.summary_fields.execution_environment?.id}}),children:e.summary_fields.execution_environment?.name}),value:e=>e.summary_fields?.execution_environment?e.summary_fields?.execution_environment.name:void 0,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Credentials"),helpText:t("Credential(s) used to access the nodes this job will be ran against."),cell:e=>(0,z.jsx)(De.o,{numLabels:5,collapsedText:t("{{count}} more",{count:(e.summary_fields.credentials?.length??0)-5}),children:e.summary_fields.credentials?.map((e=>(0,z.jsx)(uu,{credential:e},e.id)))}),value:e=>e.summary_fields?.credentials?.length?e.summary_fields?.credentials?.length:void 0,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Labels"),helpText:t("Labels used to describe job."),cell:e=>(0,z.jsx)(Ln.I,{numChips:5,collapsedText:t("{{count}} more",{count:(e.summary_fields?.labels?.results.length??0)-5}),ouiaId:`job-${e.id}-label-chips`,children:e.summary_fields?.labels?.results.map((e=>(0,z.jsx)(Mn.v,{isReadOnly:!0,ouiaId:`label-${e.id}-chip`,children:e.name},e.id)))}),value:e=>e.summary_fields?.labels?.results.length?e.summary_fields?.labels?.results.length:void 0,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Explanation"),cell:e=>e.job_explanation,value:e=>e.job_explanation?e.job_explanation:void 0,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Job slice"),helpText:t("Divide the work done by this job template into the specified number of job slices, each running the same tasks against a portion of the inventory."),cell:e=>(0,z.jsx)("span",{children:`${e.job_slice_number??0}/${(e.job_slice_count??0).toString()}`}),value:e=>e.job_slice_count,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"},{header:t("Job slice parent"),cell:e=>(0,z.jsx)("span",{children:t`True`}),value:e=>"workflow_job"===e.type&&e.is_sliced_job,table:zt.expanded,card:"hidden",list:"hidden",defaultSortDirection:"desc",modal:Ut.hidden,dashboard:"hidden"}]),[r,n,i,e?.disableLinks,t,c,s])}const Af={"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"};function Df(){const e=gr(),t=Uc({url:xl`/unified_jobs/`,disableQueryString:!0,defaultSort:"finished",defaultSortDirection:"desc"}),{t:n}=(0,I.Bd)(),a=yr();let s=If();s=Yt(s);const{data:o}=dd(xl`/job_templates/`),{data:i}=dd(xl`/workflow_job_templates/`),r=Boolean(o&&o.actions&&o.actions.POST),l=Boolean(i&&i.actions&&i.actions.POST);return(0,z.jsx)(it,{title:n("Jobs"),subtitle:n("Recently finished jobs"),width:"md",height:"md",linkText:n("View all Jobs"),to:e(fc.Jobs),children:(0,z.jsx)($s,{disableBodyPadding:!0,tableColumns:s,autoHidePagination:!0,errorStateTitle:n("Error loading jobs"),emptyStateIcon:Za.GY,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateVariant:"light",emptyStateTitle:n("There are currently no jobs"),emptyStateDescription:n(r||l?"Create a job by clicking the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonText:r||l?n("Create job"):void 0,emptyStateButtonClick:r?()=>a(fc.CreateJobTemplate):void 0,...t,compact:!0,itemCount:void 0!==t.itemCount?Math.min(t.itemCount,7):void 0,pageItems:t.pageItems?t.pageItems.slice(0,7):[],disableLastRowBorder:!0})})}function Ef(){const e=Uc({url:xl`/projects/`,disableQueryString:!0,defaultSort:"modified",defaultSortDirection:"desc"}),{t}=(0,I.Bd)(),n=yr(),a=gr(),{data:s}=dd(xl`/projects/`),o=Boolean(s&&s.actions&&s.actions.POST);let i=Sh();return i=Yt(i),(0,z.jsx)(it,{title:t("Projects"),subtitle:t("Recently updated projects"),width:"md",height:"md",linkText:t("View all Projects"),to:a(fc.Projects),children:(0,z.jsx)($s,{disableBodyPadding:!0,tableColumns:i,autoHidePagination:!0,errorStateTitle:t("Error loading projects"),emptyStateIcon:Za.GY,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateVariant:"light",emptyStateTitle:t("There are currently no projects"),emptyStateDescription:t(o?"Create a project by clicking the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonText:o?t("Create project"):void 0,emptyStateButtonClick:o?()=>n(fc.CreateProject):void 0,...e,compact:!0,itemCount:void 0!==e.itemCount?Math.min(e.itemCount,7):void 0,pageItems:e.pageItems?e.pageItems.slice(0,7):[],disableLastRowBorder:!0})})}function Pf(){const{t:e}=(0,I.Bd)(),{openManageDashboard:t,managedResources:n}=function(){const{t:e}=(0,I.Bd)(),t=(0,l.useMemo)((()=>[{header:e("Dashboard resources"),cell:e=>e.name}]),[e]),n=(0,l.useMemo)((()=>[{id:"counts",name:e("Resource counts")},{id:"recent_job_activity",name:e("Recent job activity")},{id:"recent_jobs",name:e("Recent jobs")},{id:"recent_projects",name:e("Recent projects")},{id:"recent_inventories",name:e("Recent inventories")}]),[e]),{openManageItems:a,managedItems:s}=cs({id:"awx-dashboard",title:e("Manage view"),description:e("Hide or show the panels you want to see on the overview page by selecting or unselecting, respectively. The panels are ordered from top to bottom on the list. Use the draggable icon :: to re-order your view."),items:n,keyFn:e=>e.id,columns:t,hideColumnHeaders:!0});return{openManageDashboard:a,managedResources:s}}();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Welcome to {{product}}",{product:"AWX"}),description:e("Define, operate, scale, and delegate automation across your enterprise."),controls:(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Jm.DP,{}),variant:"link",onClick:t,children:e("Manage view")})}),(0,z.jsx)(Rf,{managedResources:n})]})}function Rf(e){const{managedResources:t}=e,{data:n,isLoading:a}=(0,_e.Ay)(xl`/dashboard/`,(e=>fetch(e).then((e=>e.json()))));return!n||a?(0,z.jsx)(Oe.d8,{isFilled:!0,children:(0,z.jsx)(Un.a,{children:(0,z.jsx)(Wn.y,{})})}):(0,z.jsx)(Ue,{children:t.map((e=>{switch(e.id){case"counts":return(0,z.jsx)(xf,{data:n},e.id);case"recent_job_activity":return(0,z.jsx)(_f,{},e.id);case"recent_jobs":return(0,z.jsx)(Df,{},e.id);case"recent_projects":return(0,z.jsx)(Ef,{},e.id);case"recent_inventories":return(0,z.jsx)(vf,{},e.id);default:return(0,z.jsx)(z.Fragment,{})}}))})}function Bf(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{header:e("Hostname"),cell:e=>(0,z.jsx)(Fe,{text:e.hostname}),sort:"hostname",card:"name",list:"name",defaultSortDirection:"asc",defaultSort:!0},{header:e("First automated"),cell:e=>(0,z.jsx)(Ce,{value:e.first_automation}),sort:"first_automation"},{header:e("Last automated"),cell:e=>(0,z.jsx)(Ce,{value:e.last_automation}),sort:"last_automation"},{header:e("Automation"),type:"count",value:e=>e.automated_counter,sort:"automated_counter"},{header:e("Deleted"),type:"count",value:e=>e.deleted_counter,sort:"deleted_counter"}]),[e])}function Ff(e){const{t}=(0,I.Bd)(),n=Bf(),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Soft delete hostnames",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} hostnames.",{count:a.length}),actionButtonText:t("Delete hostnames",{count:a.length}),items:a.sort(((e,t)=>Js(e.hostname,t.hostname))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/host_metrics/${e.id.toString()}/`,t)})}}function Nf(){const{t:e}=(0,I.Bd)(),t=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{key:"hostname__icontains",label:e("Hostname"),type:Ia.MultiText,query:"hostname__icontains",comparison:"contains"}]),[e])}(),n=Bf(),a=Uc({url:xl`/host_metrics/`,queryParams:{not__deleted:"true"},toolbarFilters:t,tableColumns:n}),i=function(e){const{t}=(0,I.Bd)(),n=Ff(e);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete hostnames"),onClick:n,isDanger:!0}]),[n,t])}(a.unselectItemsAndRefresh),r=function(e){const{t}=(0,I.Bd)(),n=Ff(e);return(0,l.useMemo)((()=>[{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete hostname"),onClick:e=>n([e]),isDanger:!0}]),[n,t])}(a.unselectItemsAndRefresh);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Host Metrics"),titleHelpTitle:e("Host Metrics"),titleHelp:e("All currently managed hosts, with information about when they were first automated, when they were most recently automated, how many times they were automated, and how many times each host has been deleted. Host metrics can be used to accurately count node usage and ensure subscription compliance. For example, if a host is no longer in use or otherwise should not be counted towards the subscription total, it can be soft-deleted."),description:e("All currently managed hosts, with information about when they were first automated, when they were most recently automated, how many times they were automated, and how many times each host has been deleted.")}),(0,z.jsx)($s,{id:"awx-host-metrics-table",toolbarFilters:t,tableColumns:n,toolbarActions:i,rowActions:r,errorStateTitle:e("Error loading host metrics"),emptyStateTitle:e("No host metrics found"),emptyStateDescription:e("Please launch a job to populate this list."),...a})]})}function $f(e){if(!e)return null;switch(e){case"job":case"workflow_job":return fc.JobOutput;case"job_template":return fc.JobTemplateDetails;case"workflow_job_template":return fc.WorkflowJobTemplateDetails;case"project":return fc.ProjectDetails;case"inventory":return fc.InventoryDetails;case"inventory_source":return fc.InventorySourceDetail;case"host":return fc.HostDetails;case"instance_group":return fc.InstanceGroupDetails;case"instance":return fc.InstanceDetails;case"execution_environment":return fc.ExecutionEnvironmentDetails;case"workflow_approval":return fc.WorkflowApprovalDetails;case"management_job":return fc.ManagementJobSchedules;case"organization":return fc.OrganizationDetails;case"team":return fc.TeamDetails;case"user":return fc.UserDetails;case"role":return fc.RoleDetails;case"credential":return fc.CredentialDetails;case"credential_type":return fc.CredentialTypeDetails;default:return null}}const Mf={"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"};function Lf(e,t){const n=Of(e,t);if(n){if("name"in n&&"string"==typeof n.name)return n.name;if("hostname"in n&&"string"==typeof n.hostname)return n.hostname;if("username"in n&&"string"==typeof n.username)return n.username}return""}function Of(e,t){const{summary_fields:n}=e;if(t&&t in n){const e=n[t];if(e&&e.length>0)return e[0]}return null}const zf=({activity:e})=>{const t=gr(),n=(e=>{switch(e){case"associate":return"associated";case"disassociate":return"disassociated";case"create":return"created";case"update":return"updated";case"delete":return"deleted";default:return e}})(e.operation),s=$f(String(e.object1)),o=$f(String(e.object2)),i=Lf(e,e.object1),r=Lf(e,e.object2),l=Of(e,e.object2),c=Of(e,e.object1),d=Of(e,"role"),u=function(e){const{operation:u,object1:m,object2:p}=e,h=e.changes?.name||null;switch(u){case"create":case"update":case"delete":if(s&&c){switch(m){case"job":return(0,z.jsxs)("span",{children:[`${n} ${m} `,(0,z.jsx)(a.N_,{to:t(s,{params:{id:c.id,job_type:"playbook"}}),"data-cy":"source-resource-detail",children:i})]});case"workflow_job":return(0,z.jsxs)("span",{children:[`${n} ${m} `,(0,z.jsx)(a.N_,{to:t(s,{params:{id:c.id,job_type:"workflow"}}),"data-cy":"source-resource-detail",children:i})]});case"inventory":return(0,z.jsxs)("span",{children:[" ",`${n} ${m} `,(0,z.jsx)(a.N_,{to:t(s,{params:{id:c.id,inventory_type:Mf[c.kind]}}),"data-cy":"source-resource-detail",children:i})]})}return(0,z.jsxs)("span",{children:[`${n} ${m} `,(0,z.jsx)(a.N_,{to:t(s,{params:{id:c.id}}),"data-cy":"source-resource-detail",children:i})]})}return`${n} ${m} ${i}${h&&h!==i?` ${h}`:""}`;case"disassociate":return o&&s&&c?(0,z.jsxs)("span",{children:[`${n} ${m} `,s&&(0,z.jsx)(a.N_,{to:t(s,{params:{id:c.id}}),"data-cy":"source-resource-detail",children:i}),d&&` ${d.role_field} `,!s&&(0,z.jsx)("span",{children:i}),` from ${p} `,o&&l&&(0,z.jsx)(a.N_,{to:t(o,{params:{id:l.id}}),"data-cy":"target-resource-detail",children:r}),!o&&(0,z.jsx)("span",{children:r})]}):(0,z.jsxs)("span",{children:[`${n} ${m} ${i}`,d&&`${d.role_field}`," ",`from ${p} ${r}`]});case"associate":return o&&s&&c?(0,z.jsxs)("span",{children:[`${n} ${m} `,s&&(0,z.jsx)(a.N_,{to:t(s,{params:{id:c.id}}),"data-cy":"source-resource-detail",children:i}),d&&` ${d.role_field} `,!s&&(0,z.jsx)("span",{children:i}),` to ${p} `,o&&l&&(0,z.jsx)(a.N_,{to:t(o,{params:{id:l.id}}),"data-cy":"target-resource-detail",children:r}),!o&&(0,z.jsx)("span",{children:r})]}):(0,z.jsxs)("span",{children:[`${n} ${m} ${i}`,d&&`${d.role_field}`," ",`to ${p} ${r}`]});default:return"Event summary not available"}}(e);return(0,z.jsx)("span",{children:u})},Hf=({item:e,options:t})=>{const{t:n}=(0,I.Bd)(),a=gr(),s=e.summary_fields?.actor?.id,o=e.summary_fields?.actor?.username,i=a(fc.UserDetails,{params:{id:s}});return s?(0,z.jsx)(Fe,{text:o??"",to:i,disableLinks:t?.disableLinks,"data-cy":"initiated-by"}):e.summary_fields?.actor?(0,z.jsx)("span",{children:n(`${o} (deleted)`)}):(0,z.jsx)("span",{children:n("system")})};var qf=n(5518);function Uf({activity:e}){const{t}=(0,I.Bd)(),[n,a]=ss(),s=()=>a(void 0);return(0,z.jsxs)(Zt.a,{title:t("Event details"),"data-cy":"activity-stream-event-modal","aria-label":t("Event details"),isOpen:!0,hasNoBodyWrapper:!0,onClose:s,variant:Zt.d.medium,actions:[(0,z.jsx)(g.$n,{variant:"primary",onClick:s,children:t("Close")},"cancel")],children:[(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Time"),children:Se(e.timestamp)}),(0,z.jsx)(Ft,{label:t("Initiated by"),children:(0,z.jsx)(Hf,{item:e})}),"setting"===e.object1&&e.summary_fields?.setting&&(0,z.jsx)(Ft,{label:t("Setting category"),children:e.summary_fields.setting[0].category}),"setting"===e.object1&&e.summary_fields?.setting&&(0,z.jsx)(Ft,{label:t("Setting name"),children:e.summary_fields.setting[0].name}),(0,z.jsx)(Ft,{label:t("Action"),children:(0,z.jsx)(zf,{activity:e})})]}),e.changes&&(0,z.jsx)(Mt,{numberOfColumns:"single",children:(0,z.jsx)(Wu,{label:t("Changes"),value:JSON.stringify(e.changes),showCopyToClipboard:!0})})]})}function Wf(){const{t:e}=(0,I.Bd)(),t=Pp({optionsPath:"activity_stream",preFilledValueKeys:{id:{apiPath:"activity_stream"}},additionalFilters:[function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"keyword",label:e("Keyword"),type:Ia.SingleText,query:"search",comparison:"contains"})),[e])}(),function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"initiated-by",label:e("Initiated by (username)"),type:Ia.SingleText,query:"actor__username__icontains",comparison:"contains"})),[e])}(),(0,l.useMemo)((()=>({type:Ia.SingleSelect,key:"type",query:"object1__in",label:"Type",options:[{label:"All Activity",value:""},{label:"Jobs",value:"job"},{label:"Schedules",value:"schedule"},{label:"Workflow Approvals",value:"workflow_approval",group:"Administration"},{label:"Templates",value:"job_template+workflow_job_template+workflow_job_template_node"},{label:"Credentials",value:"credential",group:"Access"},{label:"Projects",value:"project"},{label:"Inventories",value:"inventory",group:"Infrastructure"},{label:"Hosts",value:"host",group:"Infrastructure"},{label:"Organizations",value:"organization",group:"Access"},{label:"Users",value:"user",group:"Access"},{label:"Teams",value:"team",group:"Access"},{label:"Credential Types",value:"credential_type",group:"Access"},{label:"Notification Templates",value:"notification_template",group:"Administration"},{label:"Instances",value:"instance",group:"Infrastructure"},{label:"Instance Groups",value:"instance_group",group:"Infrastructure"},{label:"Applications and Tokens",value:"o_auth2_application",group:"Administration"},{label:"Execution Environments",value:"execution_environment",group:"Infrastructure"},{label:"Settings",value:"setting",group:"Administration"}],placeholder:"Filter by type",isPinned:!0})),[])],preSortedKeys:["keyword","initiated-by","id"]}),n=function(e){const{t}=(0,I.Bd)();return(0,l.useMemo)((()=>[{header:t("Time"),cell:e=>e.timestamp&&(0,z.jsx)(Ie,{value:e.timestamp}),sort:"timestamp",list:"secondary",defaultSortDirection:"desc",modal:Ut.hidden},{header:t("Initiated by"),cell:t=>(0,z.jsx)(Hf,{item:t,options:e}),sort:"actor__username",list:"secondary"},{header:t("Event"),cell:e=>(0,z.jsx)(zf,{activity:e}),sort:void 0,list:"secondary",fullWidth:!0}]),[e,t])}(),a=Uc({url:xl`/activity_stream/`,toolbarFilters:t,tableColumns:n}),i=function(){const{t:e}=(0,I.Bd)(),t=function(){const[e,t]=ss(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{if(n){const e=()=>{a(void 0),n.onClose?.()};t((0,z.jsx)(Uf,{...n,onClose:e}))}else t(void 0)}),[n,t]),a}();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,variant:g.Ak.primary,isPinned:!0,icon:qf.ch,label:e("View event details"),onClick:e=>t({activity:e})}]),[e,t])}(),r=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Activity Stream"),titleHelpTitle:e("Activity Stream"),titleHelp:e("An activity stream shows all changes for a particular object. For each change, the activity stream shows the time of the event, the user that initiated the event, and the action.",{product:"AWX"}),titleDocLink:pc(r,"activityStream"),description:e("An activity stream shows all changes for a particular object. For each change, the activity stream shows the time of the event, the user that initiated the event, and the action.",{product:"AWX"})}),(0,z.jsx)($s,{id:"awx-activity-stream",toolbarFilters:t,tableColumns:n,rowActions:i,errorStateTitle:e("Error loading activity stream"),emptyStateTitle:e("There are currently no activity streams"),emptyStateDescription:e("Past and pending activity stream will appear here when available"),...a,defaultSubtitle:e("Activity Stream")})]})}var Jf=n(14541);const Vf=()=>Us(Mc);function Gf(){const{t:e}=(0,I.Bd)(),t=Vf(),n=td();return(0,l.useCallback)(((a,s,o)=>{t({title:e("Adding users",{count:s.length}),keyFn:e=>e.id,items:a,actionColumns:[{header:"User",cell:e=>e.username}],actionFn:async(e,t)=>{for(const a of s)await n(xl`/users/${e.id.toString()}/roles/`,{id:a.summary_fields.object_roles.member_role.id},t)},processingText:e("Adding users...",{count:s.length}),onComplete:o})}),[t,e,n])}function Yf(e){const{user:t}=e,{t:n}=(0,I.Bd)();return t.is_superuser?(0,z.jsx)(Ee.J,{children:n("System administrator")}):t.is_system_auditor?(0,z.jsx)(Ee.J,{children:n("System auditor")}):(0,z.jsx)(Ve.E,{children:n("Normal user")})}function Kf(e){const{t}=(0,I.Bd)(),n=gr(),a=e?.disableLinks||!1,s=bu(e);return(0,l.useMemo)((()=>[{header:t("Username"),cell:e=>(0,z.jsx)(Fe,{text:e.username,to:a?void 0:n(fc.UserDetails,{params:{id:e.id.toString()}})}),card:"name",list:"name",sort:"username",maxWidth:200},{header:t("User type"),cell:e=>(0,z.jsx)(Yf,{user:e}),card:"subtitle",list:"subtitle"},{header:t("First name"),type:"text",value:e=>e.first_name,sort:"first_name"},{header:t("Last name"),type:"text",value:e=>e.last_name,sort:"last_name"},{header:t("Email"),type:"text",value:e=>e.email,sort:"email"},{...s,sort:void 0}]),[s,n,t,a])}function Zf(){return Pp({optionsPath:"users",preSortedKeys:["username","first_name","last_name","email","id"],preFilledValueKeys:{id:{apiPath:"users"}}})}function Xf(e){const{t}=(0,I.Bd)(),n=Zf(),a=Kf({disableLinks:!0}),s=Uc({url:e.accessUrl??xl`/users/`,toolbarFilters:n,tableColumns:a,disableQueryString:!0});return function(e){function t(e,t){const{role:n}=e;n.team_id?t.team_roles?.push(n):t.user_roles?.push(n)}if(e?.length>0)for(const n of e)n.team_roles=[],n.user_roles=[],n.summary_fields?.direct_access?.forEach((e=>t(e,n))),n.summary_fields?.indirect_access?.forEach((e=>t(e,n)))}(s.pageItems),(0,z.jsx)(Xs,{title:e.title,onSelect:e.onSelect,toolbarFilters:n,tableColumns:a,view:s,confirmText:e.confirmText||t("Add user(s)")})}function Qf(){const[e,t]=ss();return(0,l.useCallback)(((e,n,a,s)=>{t((0,z.jsx)(Xf,{accessUrl:s,title:e,onSelect:n,confirmText:a}))}),[t])}function eg(e){const{t}=(0,I.Bd)(),n=ag({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete organizations",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} organizations.",{count:a.length}),actionButtonText:t("Delete organization",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/organizations/${e.id.toString()}/`,t)})}}function tg(){const{t:e}=(0,I.Bd)(),t=yr(),n=gr();Fc("organizations");const a=sc(),i=ng(),r=ag(),c=Uc({url:xl`/organizations/`,toolbarFilters:i,tableColumns:r}),d=eg(c.unselectItemsAndRefresh),u=function(){const{t:e}=(0,I.Bd)(),t=Qf(),n=Gf();return(0,l.useCallback)((a=>{t(e("Add users to organizations",{count:a.length}),(e=>{n(e,a)}))}),[n,t,e])}(),m=function(e){const{t}=(0,I.Bd)(),n=Qf(),a=function(e){const{t}=(0,I.Bd)(),n=Vf(),a=td();return(0,l.useCallback)(((s,o)=>{n({title:t("Removing users from organizations",{count:o.length}),keyFn:e=>e.id,items:s,actionColumns:[{header:t("User"),cell:e=>e.username}],actionFn:async(e,t)=>{for(const n of o)await a(xl`/users/${e.id.toString()}/roles/`,{id:n.summary_fields.object_roles.member_role.id,disassociate:!0},t)},processingText:t("Removing users from organizations...",{count:o.length}),onComplete:e})}),[n,t,e,a])}(e);return(0,l.useCallback)((e=>{n(t("Remove users from organizations",{count:e.length}),(t=>{a(t,e)}),t("Remove user(s)"))}),[a,n,t])}(),p=(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,isPinned:!0,variant:g.Ak.primary,icon:Za.GY,label:e("Create organization"),href:n(fc.CreateOrganization)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:Za.GY,label:e("Add users to organizations"),onClick:()=>u(c.selectedItems)},{type:s.Button,selection:o.Multiple,icon:Nd.Kf,label:e("Remove users from organizations"),onClick:()=>m(c.selectedItems)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:e("Delete organizations"),onClick:d,isDanger:!0}]),[e,n,d,u,c.selectedItems,m]),h=(0,l.useMemo)((()=>[{type:s.Link,selection:o.Single,isPinned:!0,icon:yc.oo,label:e("Edit organization"),href:e=>n(fc.EditOrganization,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:Za.GY,label:e("Add users to organizations"),onClick:e=>u([e])},{type:s.Button,selection:o.Single,icon:Nd.Kf,label:e("Remove users from organizations"),onClick:e=>m([e])},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:e("Delete organization"),onClick:e=>d([e]),isDanger:!0}]),[e,n,u,m,d]);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Organizations"),titleHelpTitle:e("Organizations"),titleHelp:e("An organization is a logical collection of users, teams, projects, and inventories, and is the highest level in the {{product}} object hierarchy.",{product:"AWX"}),titleDocLink:pc(a,"organizations"),description:e("An organization is a logical collection of users, teams, projects, and inventories, and is the highest level in the {{product}} object hierarchy.",{product:"AWX"}),headerActions:(0,z.jsx)(cd,{type:"organization"})}),(0,z.jsx)($s,{id:"awx-organizations-table",toolbarFilters:i,toolbarActions:p,tableColumns:r,rowActions:h,errorStateTitle:e("Error loading organizations"),emptyStateTitle:e("No organizations yet"),emptyStateDescription:e("To get started, create an organization."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:e("Create organization"),emptyStateButtonClick:()=>t(fc.CreateOrganization),...c,defaultSubtitle:e("Organization")})]})}function ng(){return Pp({optionsPath:"organizations",preSortedKeys:["name","description","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:"organizations"},id:{apiPath:"organizations"}},additionalFilters:[Np(),$p()]})}function ag(e){const{t}=(0,I.Bd)(),n=yr(),a=gr(),s=mu(),o=(0,l.useCallback)((e=>n(fc.OrganizationDetails,{params:{id:e.id}})),[n]),i=hu(),r=pu({...e,onClick:o}),c=bu(e),d=fu(e);return(0,l.useMemo)((()=>[s,r,i,{header:t("Members"),type:"count",value:e=>e.summary_fields?.related_field_counts?.users},{header:t("Teams"),type:"count",value:e=>e.summary_fields?.related_field_counts?.teams},{header:t("Admins"),type:"count",value:e=>e.summary_fields?.related_field_counts?.admins},{header:t("Inventories"),type:"count",value:e=>e.summary_fields?.related_field_counts?.inventories},{header:t("Projects"),type:"count",value:e=>e.summary_fields?.related_field_counts?.projects},{header:t("Job templates"),type:"count",value:e=>e.summary_fields?.related_field_counts?.job_templates},{header:t("Hosts"),type:"count",value:e=>e.summary_fields?.related_field_counts?.hosts},{id:"execution-environment",header:t("Default environment"),type:"text",value:e=>e.summary_fields?.default_environment?.name,to:e=>a(fc.ExecutionEnvironmentDetails,{params:{id:e.summary_fields?.default_environment?.id}})},c,d]),[s,r,i,t,c,d,a])}function sg(e){const{t}=(0,I.Bd)(),n=ag({disableLinks:!0}),a=ng();return(0,z.jsx)(Ap,{name:e.name,id:"organization",label:t("Organization"),placeholder:t("Select organization"),queryPlaceholder:t("Loading organizations..."),queryErrorText:t("Error loading organizations"),isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,url:xl`/organizations/`,tableColumns:n,toolbarFilters:a})}function og({fieldOptions:e,isRequired:t}){const{t:n}=(0,I.Bd)(),{control:a}=(0,oo.xW)(),{field:s,fieldState:{error:o}}=(0,oo.as)({name:`${e.id}`,control:a,rules:{required:t}}),i=s.value,r=s.onChange,[c,d]=l.useState(!1),[u,m]=l.useState(["sudo","su","pbrun","pfexec","dzdo","pmrun","runas","enable","doas","ksu","machinectl","sesu"].map((e=>({value:e}))));return(0,z.jsx)(Vo,{fieldId:`${e.id}`,helperTextInvalid:o?o.message:"",label:e.label,labelHelp:e.help_text,isRequired:t,children:(0,z.jsx)(Qo.l,{typeAheadAriaLabel:e.label,maxHeight:200,variant:wp.ez.typeahead,onToggle:(e,t)=>d(t),onClear:()=>r(""),onSelect:(e,t)=>{r(t),d(!1)},isOpen:c,"data-cy":"select-become-method",id:"select-become-method",selections:i,isCreatable:!0,onCreateOption:e=>{m((t=>[...t,{value:e}])),r(e)},noResultsFoundText:n("No results found"),createText:n("Create"),clearSelectionsAriaLabel:n("Clear all"),placeholderText:n("Select a become method"),toggleAriaLabel:n("Options menu"),children:u.map((e=>(0,z.jsx)(ei.O,{"data-cy":`select-option-${e.value}`,value:e.value},e.value)))})})}function ig({field:e,requiredFields:t,kind:n,handleModalToggle:a,accumulatedPluginValues:s,setAccumulatedPluginValues:o,setPluginsToDelete:i,fieldInitialValue:r}){const{t:c}=(0,I.Bd)(),[d,u]=(0,l.useState)(e.secret),{getValues:m,setValue:p,clearErrors:h}=(0,oo.xW)(),b=m(),f=(e=>{const{data:t}=tc(xl`/credentials/`,e);return t})(s.filter((t=>t.input_field_name===e.id))[0]?.source_credential),y=(0,l.useCallback)((e=>{let t="Drag a file here or browse to upload";return s.forEach((n=>{n.input_field_name===e.id&&f&&(t=c(`Value is managed by ${f.kind}: ${f.name}`))})),t}),[s,f,c]);return(0,l.useEffect)((()=>{s.some((t=>t.input_field_name===e.id))&&p(e.id,y(e),{shouldDirty:!0})}),[p,s,y,e]),(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(wd,{onClearClick:()=>{p(e.id,"",{shouldDirty:!1}),h(e.id),s.some((t=>t.input_field_name===e.id))&&i?.((t=>[...t,e.id])),o?.(s.filter((t=>t.input_field_name!==e.id)))},type:"text",label:e.label,name:`${e.id}`,labelHelpTitle:e.label,labelHelp:e.help_text,helperText:(e=>{let t="";return s.forEach((n=>{n.input_field_name===e.id&&(t=c("This field will be retrieved from an external secret management system using the specified credential."))})),t})(e),isRequired:t.includes(e.id),isReadOnly:(e=>{let t=!1;return s.forEach((n=>{n.input_field_name===e.id&&(t=!0)})),t})(e),isDisabled:"$encrypted$"===b?.[e.id],isClearButtonDisabled:"$encrypted$"===b?.[e.id]||!b?.[e.id],allowEditingUploadedText:!0,icon:"external"!==n?e.secret&&"$encrypted$"===b?.[e.id]?(0,z.jsxs)("div",{style:{display:"grid"},children:[(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Gb.RY,{}),variant:"control",onClick:a,isDisabled:!0}),(0,z.jsx)(x.m,{content:c("Replace"),children:(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Jf.ej,{}),variant:"control",onClick:()=>{p(e.id,"",{shouldDirty:!1}),u(!d)}})})]}):e.secret&&r&&"$encrypted$"===r&&"$encrypted$"!==b?.[e.id]?(0,z.jsxs)("div",{style:{display:"grid"},children:[(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Gb.RY,{}),variant:"control",onClick:a}),(0,z.jsx)(x.m,{content:c("Revert"),children:(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Jf.ej,{}),variant:"control",onClick:()=>{p(e.id,r,{shouldDirty:!0}),u(!d),o?.(s.filter((t=>t.input_field_name!==e.id)))}})})]}):(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Gb.RY,{}),variant:"control",onClick:a}):void 0},e.id)})}function rg(){const{t:e}=(0,I.Bd)(),{setValue:t,clearErrors:n}=(0,oo.xW)(),[a,s]=(0,l.useState)({}),[o,i]=(0,l.useState)(void 0),[r,c]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{a.project_id&&(t("project",a.project_id),n("project")),a.client_email&&(t("username",a.client_email),n("username")),a.private_key&&(t("ssh_key_data",a.private_key),n("ssh_key_data"))}),[a,t,n]),(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(wd,{onClearClick:()=>{s({}),i(void 0),t("project",""),t("username",""),t("ssh_key_data","")},name:"credential-gce-file",fieldId:"credential-gce-file",label:e("Service account JSON file"),helperText:e("Select a JSON formatted service account key to autopopulate the following fields."),validated:o?"error":"default",onInputChange:async e=>{try{const t=await e.text(),n=JSON.parse(t);s(n)}catch(e){i(e)}},dropzoneProps:{accept:{"text/json":[".json"]},onDropRejected:()=>{c(!0)}},additionalHelperText:(0,z.jsx)(Uo.e,{children:(0,z.jsx)(Jo.j,{variant:r?"error":"default",children:r?e("File upload rejected. Please select a single .json file."):null})})},"credential-gce-file")})}function lg(){return Pp({optionsPath:"credential_types",preSortedKeys:["name","id","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:"credential_types"},id:{apiPath:"credential_types"}},additionalFilters:[Np(),$p()]})}function cg(){const{t:e}=(0,I.Bd)(),t=gr(),n=hu(),a=bu(),s=fu();return(0,l.useMemo)((()=>[{header:e("Name"),cell:n=>(0,z.jsxs)(ee.B,{hasGutter:!0,children:[(0,z.jsx)(Fe,{text:n.name,to:t(fc.CredentialTypeDetails,{params:{id:n.id}})}),n.managed&&(0,z.jsx)(Ee.J,{children:e("Read-only")})]}),card:"name",list:"name",sort:"name",maxWidth:200},n,{header:e("Type"),cell:t=>t.managed?(0,z.jsx)(Ee.J,{children:e("System provided")}):null,table:zt.hidden,card:"hidden",list:"hidden",sort:"managed",defaultSortDirection:"desc",defaultSort:!0,modal:Ut.hidden},a,s]),[n,t,e,a,s])}function dg(e){const{t}=(0,I.Bd)(),n=lg(),a=cg();return(0,z.jsx)(Ap,{name:e.name,id:"credential_type",label:t("Credential type"),placeholder:t("Select credential type"),queryPlaceholder:t("Loading credential types..."),queryErrorText:t("Error loading credential types"),isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,url:xl`/credential_types/`,tableColumns:a,toolbarFilters:n})}function ug(e){const{t}=(0,I.Bd)(),n=Ep({disableLinks:!0}),a=Mp();return(0,z.jsx)(Ap,{name:e.name,id:"credential",label:t("Credential"),placeholder:t("Select credential"),queryPlaceholder:t("Loading credentials..."),queryErrorText:t("Error loading credentials"),isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,url:xl`/credentials/`,queryParams:{credential_type__kind:"external"},tableColumns:n,toolbarFilters:a,defaultSelection:[]})}function mg(e){const{t}=(0,I.Bd)(),{getValues:n,formState:{isValid:a}}=(0,oo.xW)();return(0,z.jsx)(g.$n,{variant:"secondary",onClick:()=>{const t=n();e.handleTest(t)},isDisabled:!a,children:t("Test")})}function pg({onCancel:e,handleSubmit:t,handleTest:n,defaultValues:a}){const{t:s}=(0,I.Bd)(),o=()=>{const e=(e=>{const{data:t}=tc(xl`/credentials/`,e),{data:n}=tc(xl`/credential_types/`,t?.summary_fields?.credential_type?.id);return n})((0,oo.FH)({name:"source_credential"}));return e?(0,z.jsx)(_d,{title:s("Metadata"),children:e?.inputs?.metadata.map((t=>"choices"in t?(0,z.jsx)(vc,{defaultValue:t?.default,name:t.id,label:t.label,placeholder:t.label,labelHelp:t.help_text,options:t.choices?t.choices?.map((e=>({label:e,value:e}))):[],isRequired:e.inputs.required.includes(t.id)},t.id):t.multiline?t.multiline?(0,z.jsx)(ii,{name:t.id,label:t.label,labelHelp:t.help_text,isRequired:e.inputs.required.includes(t.id)},t.id):void 0:(0,z.jsx)(li,{name:t.id,label:t.label,type:"text",labelHelp:t.help_text,isRequired:e.inputs.required.includes(t.id)},t.id)))}):null};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s("Secret Management System")}),(0,z.jsxs)(nd,{submitText:s("Finish"),onSubmit:t,onCancel:e,defaultValue:a,additionalActions:(0,z.jsx)(mg,{handleTest:n}),children:[(0,z.jsx)(_d,{title:s("Select external credential"),children:(0,z.jsx)(ug,{name:"source_credential",isRequired:!0})}),(0,z.jsx)(o,{})]})]})}function hg(e){const{t}=(0,I.Bd)(),n=()=>{e.onClose?.()};return(0,z.jsx)(Zt.a,{"aria-label":t("Credential Plugins"),isOpen:!0,onClose:n,variant:Zt.d.large,children:(0,z.jsx)(pg,{onCancel:n,handleSubmit:t=>new Promise(((a,s)=>{const{source_credential:o,...i}=t;e.setCredentialPluginValues([{input_field_name:e.field.id,metadata:{...i},source_credential:o}]),n();try{a()}catch(e){s(e)}})),handleTest:n=>new Promise(((a,s)=>{const{source_credential:o,...i}=n,r={variant:"success",title:t("Test passed."),timeout:2e3},l={metadata:i};al(xl`/credentials/${String(o)}/test/`,l).then((()=>{e.alertToaster.addAlert(r)})).catch((n=>{e.alertToaster.addAlert({variant:"danger",title:t("Something went wrong with the request to test this credential."),children:n instanceof Error&&n.message})}));try{a()}catch(e){s(e)}})),defaultValues:function(){const t=e.accumulatedPluginValues?.find((t=>t.input_field_name===e.field.id));if(t){const{metadata:e,source_credential:n}=t;return{source_credential:n,...e}}}()})})}function bg(e){const{t}=(0,I.Bd)(),n=td(),a=e.alertToaster;return(0,z.jsx)(Zt.a,{"aria-label":t("Test external credential"),variant:"small",position:"default",title:t`Test external credential`,hasNoBodyWrapper:!0,isOpen:!0,onClose:()=>e.popDialog(),children:(0,z.jsx)(nd,{submitText:t("Run"),onSubmit:async s=>{const o={variant:"success",title:t("Test passed."),timeout:2e3},i=Object.fromEntries(Object.entries(s).map((([e,t])=>[e,t||""]))),r={inputs:e.credentialType.inputs.fields.reduce(((t,n,a)=>(t[n.id]=e.watchedSubFormFields[a]||e.credentialType.inputs.fields[a].default||"",t)),{}),metadata:i};e.credential?await n(xl`/credentials/${String(e.credential.id)}/test/`,r).then((()=>{a.addAlert(o)})).catch((e=>{a.addAlert({variant:"danger",title:t("Something went wrong with the request to test this credential."),children:e instanceof Error&&e.message})})):await n(xl`/credential_types/${String(e.credentialType.id)}/test/`,r).then((()=>{a.addAlert(o)})).catch((e=>{a.addAlert({variant:"danger",title:t("Something went wrong with the request to test this credential."),children:e instanceof Error&&e.message})}))},cancelText:t("Cancel"),onCancel:()=>e.popDialog(),singleColumn:!0,children:e.credentialType.inputs.metadata.map((t=>{const n=e.credentialType.inputs?.required.includes(t.id);return"string"===t.type?t.choices?(0,z.jsx)(ti,{name:t.id,label:t.label,labelHelp:t.help_text,isRequired:n,options:t.choices.map((e=>({value:e,key:e,label:e})))},t.id):t.multiline?(0,z.jsx)(ii,{name:t.id,label:t.label,labelHelp:t.help_text,isRequired:n},t.id):(0,z.jsx)(li,{name:t.id,label:t.label,labelHelp:t.help_text,type:"text",isRequired:n},t.id):null}))})})}function fg(){const{pushDialog:e,popDialog:t}=as(),[n,a]=(0,l.useState)(),s=ue();return(0,l.useEffect)((()=>{n?e((0,z.jsx)(bg,{...n,popDialog:t,alertToaster:s})):t()}),[n,e,t,s]),a}function gg(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.Zp)(),{activeAwxUser:a}=_l(),s=td(),o=gr(),[i,r]=(0,l.useState)(0),[c,d]=(0,l.useState)([]),u=fg(),[m,p]=(0,l.useState)([]),[h,b]=(0,l.useState)([]);(0,l.useEffect)((()=>{b((e=>[...e.filter((e=>!m.some((t=>t.input_field_name===e.input_field_name)))),...m]))}),[m]);const[f,y]=(0,l.useState)(!1),[x,j]=(0,l.useState)(!1),{results:_,isLoading:v}=cm(xl`/credential_types/`);if(v&&!_)return(0,z.jsx)(zr,{});const w=_?.reduce(((e,t)=>(e[t.id]=t,e)),{}),k=!!w&&"external"===w?.[i]?.kind;return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create credential"),breadcrumbs:[{label:e("Credentials"),to:o(fc.Credentials)},{label:e("Create credential")}]}),(0,z.jsx)(nd,{submitText:e("Create credential"),onSubmit:async e=>{const n=w?.[e?.credential_type]?.inputs,o={};(n?.fields||[]).forEach((t=>{if(t.id&&"string"==typeof t.id&&t.id in e&&!(e=>h.some((t=>t.input_field_name===e)))(t.id)){const n=t.id;void 0===e[n]&&""===e[n]||(o[n]=e[n],delete e[n])}})),e.organization||(e.user=a?.id),Object.keys(e).forEach((t=>{t.startsWith("ask_")&&delete e[t]}));const i=await s(xl`/credentials/`,{...e,inputs:{...o}}),r=h.map((e=>({...e,target_credential:i.id})));await Promise.all(r.map((async e=>{await s(xl`/credential_input_sources/`,e)}))),t(fc.CredentialDetails,{params:{id:i.id}})},onCancel:()=>n(-1),additionalActions:k?(0,z.jsx)(g.$n,{"aria-label":e("Test"),variant:"secondary",onClick:e=>{e.preventDefault(),u({credentialType:void 0!==w?w?.[i]:{},watchedSubFormFields:c})},isDisabled:!f||!x,children:e("Test")}):void 0,children:(0,z.jsx)(xg,{isEditMode:!1,credentialTypes:w||{},setCredentialPluginValues:p,accumulatedPluginValues:h,setAccumulatedPluginValues:b,setSelectedCredentialTypeId:r,setIsTestButtonEnabled:y,setIsTestButtonEnabledSubForm:j,setWatchedSubFormFields:d})})]})}function yg(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=(0,Re.g)(),a=Number(n.id),{activeAwxUser:s}=_l(),o=gr(),i=ed(),r=kd(),c=td(),[d,u]=(0,l.useState)([]),[m,p]=(0,l.useState)([]),[h,b]=(0,l.useState)([]),{cache:f}=(0,_e.iX)();(0,l.useEffect)((()=>{p((e=>{const t=[...e.filter((e=>!d.some((t=>t.input_field_name===e.input_field_name)))),...d];return t.forEach((t=>{e.some((e=>e.input_field_name===t.input_field_name))&&b((e=>[...e,t.input_field_name]))})),t}))}),[d]);const y=fg(),[x,j]=(0,l.useState)(!1),[_,v]=(0,l.useState)(!1),[w,k]=(0,l.useState)([]),[S,C]=(0,l.useState)([]),{data:T,isLoading:A}=ec(xl`/credentials/${a.toString()}/`),{data:D,isLoading:E}=ec(xl`/credentials/${a.toString()}/input_sources/`);(0,l.useEffect)((()=>{if(D){const e=D.results.map((e=>({input_field_name:e.input_field_name,source_credential:e.source_credential,target_credential:e.target_credential,metadata:e.metadata})));p(e)}}),[D]);const P=D?.results.filter((e=>h.includes(e.input_field_name))).map((e=>e.id?.toString()??"")),{results:R,isLoading:B}=cm(xl`/credential_types/`),F=R?.reduce(((e,t)=>(e[t.id]=t,e)),{}),N=F&&void 0!==T?"external"===F?.[T.credential_type]?.kind:null,$=(0,l.useMemo)((()=>{const e={};return T?.inputs&&Object.entries(T.inputs).forEach((([t,n])=>{e[`ask_${t}`]="string"==typeof n&&"ASK"===n})),e}),[T]),M=(0,l.useMemo)((()=>({name:T?.name??"",description:T?.description??"",credential_type:T?.credential_type??0,organization:T?.organization??null,...T?.inputs??{},...$??{}})),[T,$]);return A&&!T||B&&!R||E&&!D?(0,z.jsx)(zr,{}):T?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:T?.name?e("Edit {{credentialName}}",{credentialName:T?.name}):e("Credentials"),breadcrumbs:[{label:e("Credentials"),to:o(fc.Credentials)},{label:T?.name?e("Edit {{credentialName}}",{credentialName:T?.name}):e("Credentials")}]}),(0,z.jsx)(nd,{submitText:e("Save credential"),onSubmit:async e=>{const n=F?.[e?.credential_type]?.inputs;e.organization||(e.user=s?.id);const o={};(n?.fields||[]).forEach((t=>{if(t.id&&"string"==typeof t.id&&t.id in e&&!(e=>m.some((t=>t.input_field_name===e)))(t.id)){const n=t.id;void 0===e[n]&&""===e[n]||(o[n]=e[n],delete e[n])}})),Object.keys(e).forEach((t=>{t.startsWith("ask_")&&delete e[t]})),Object.keys(o).forEach((e=>{S?.includes(e)&&(o[e]="$encrypted$")}));const l={...e,inputs:o},d=m.map((e=>({...e,target_credential:T?.id})));P&&P.length>0?await Promise.all(P.map((async e=>{await r(xl`/credential_input_sources/${e.toString()}/`)}))).then((async()=>{await i(xl`/credentials/${a.toString()}/`,l),await Promise.all(d.map((async e=>{await c(xl`/credential_input_sources/`,e)})))})):(await i(xl`/credentials/${a.toString()}/`,l),await Promise.all(d.map((async e=>{await c(xl`/credential_input_sources/`,e)})))),f.clear?.(),t(-1)},onCancel:()=>t(-1),defaultValue:M,additionalActions:N?(0,z.jsx)(g.$n,{"aria-label":e("Test"),variant:"secondary",onClick:e=>{e.preventDefault(),y({credential:T,credentialType:void 0!==F?F?.[T?.credential_type]:{},watchedSubFormFields:w})},isDisabled:!x||!_,children:e("Test")}):void 0,children:(0,z.jsx)(xg,{isEditMode:!0,credentialTypes:F||{},selectedCredentialTypeId:T?.credential_type,setCredentialPluginValues:u,accumulatedPluginValues:m,setAccumulatedPluginValues:p,setPluginsToDelete:b,setIsTestButtonEnabled:j,setIsTestButtonEnabledSubForm:v,setWatchedSubFormFields:k,initialValues:M,setFieldEncryptedID:C})})]}):(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{breadcrumbs:[{label:e("Credentials"),to:o(fc.Credentials)},{label:e("Edit Credential")}]})})}function xg({isEditMode:e=!1,selectedCredentialTypeId:t,credentialTypes:n,setCredentialPluginValues:a,accumulatedPluginValues:s,setAccumulatedPluginValues:o,setPluginsToDelete:i,setSelectedCredentialTypeId:r,setIsTestButtonEnabled:c,setIsTestButtonEnabledSubForm:d,setWatchedSubFormFields:u,setFieldEncryptedID:m,initialValues:p}){const{t:h}=(0,I.Bd)(),b=(0,oo.FH)({name:"credential_type"});(0,l.useEffect)((()=>{r&&r(b)}),[b,r]);const f=t||b,g=!!n&&"galaxy"===n?.[f]?.kind,y=(0,oo.FH)({name:["name","credential_type"]});return(0,l.useEffect)((()=>{const e=[];Object.values(y).forEach((t=>{null!=t&&""!==t&&e.push(t)})),c(e.length>=2)}),[y,c]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:h("Name"),placeholder:h("Enter name"),isRequired:!0}),(0,z.jsx)(li,{name:"description",label:h("Description"),placeholder:h("Enter description")}),(0,z.jsx)(sg,{isRequired:g,name:"organization"}),(0,z.jsx)(dg,{name:"credential_type",isRequired:!0,isDisabled:e?h("You cannot change the credential type of a credential, as it may break the functionality of the resources using it."):void 0}),a&&f&&n&&n[f]?(0,z.jsx)(jg,{credentialType:n[f],setCredentialPluginValues:a,isEditMode:e,initialValues:p,accumulatedPluginValues:s||[],setAccumulatedPluginValues:o,setPluginsToDelete:i,setIsTestButtonEnabledSubForm:d,setWatchedSubFormFields:u,setFieldEncryptedID:m}):null]})}function jg({credentialType:e,setCredentialPluginValues:t,isEditMode:n=!1,accumulatedPluginValues:a,setAccumulatedPluginValues:s,setPluginsToDelete:o,setIsTestButtonEnabledSubForm:i,setWatchedSubFormFields:r,setFieldEncryptedID:c,initialValues:d}){const{t:u}=(0,I.Bd)(),m=function(){const{pushDialog:e,popDialog:t}=as(),[n,a]=(0,l.useState)(),s=ue();return(0,l.useEffect)((()=>{n?e((0,z.jsx)(hg,{...n,onClose:t,alertToaster:s})):t()}),[n,e,t,s]),a}(),p=e?.inputs?.required||[],h=e?.inputs?.fields?.filter((e=>p.includes(e.id))),b=e?.inputs?.fields?.map((e=>e.id)),f=(0,oo.FH)({name:p});if(r((0,oo.FH)({name:b})),(0,l.useEffect)((()=>{const e=[];Object.values(f).forEach((t=>{null!=t&&""!==t&&e.push(t)})),i(e.length>=h?.length)}),[f,i,h]),!e||!e?.inputs?.fields)return null;const g=e?.inputs?.fields?.filter((e=>"string"===e.type&&!e?.choices?.length))||[],y=e?.inputs?.fields?.filter((e=>(e?.choices?.length??0)>0))||[],x=e?.inputs?.fields?.filter((e=>"boolean"===e.type))||[];return g.length>0||y.length>0||x.length>0?(0,z.jsxs)(_d,{title:u("Type Details"),children:["gce"===e?.namespace&&(0,z.jsx)(rg,{}),g.length>0&&g.map((i=>i?.multiline?(0,z.jsx)(ig,{accumulatedPluginValues:a,setAccumulatedPluginValues:s,setPluginsToDelete:o,kind:e.kind,field:i,requiredFields:p,handleModalToggle:()=>{m({field:i,setCredentialPluginValues:t,accumulatedPluginValues:a})},fieldInitialValue:d&&d[i?.id]},i.id):"ssh"===e.kind&&"become_method"===i.id?(0,z.jsx)(og,{fieldOptions:i,isRequired:p.includes(i.id)},i.id):(0,z.jsx)(_g,{setFieldEncryptedID:c,accumulatedPluginValues:a,setAccumulatedPluginValues:s,setPluginsToDelete:o,field:i,credentialType:e,fieldInitialValue:d&&d[i?.id],isDisabled:"vault_id"===i.id&&"vault"===e.kind&&n,isRequired:p.includes(i.id),handleModalToggle:()=>m({field:i,setCredentialPluginValues:t,accumulatedPluginValues:a})},i.id))),y.length>0&&y.map((e=>(0,z.jsx)(ti,{defaultValue:e?.default,name:e?.id,label:e.label,options:e?.choices?.map((e=>({value:e,label:e})))??[],isRequired:p.includes(e.id),labelHelp:e.help_text},e.id))),x.length>0&&x.map((e=>(0,z.jsx)(go,{name:e.id,label:e.label,isRequired:p.includes(e.id),labelHelp:e.help_text},e.id)))]}):null}function _g({credentialType:e,field:t,handleModalToggle:n,isDisabled:a=!1,isRequired:s=!1,accumulatedPluginValues:o,setAccumulatedPluginValues:i,setPluginsToDelete:r,setFieldEncryptedID:c,fieldInitialValue:d}){const{t:u}=(0,I.Bd)(),{setValue:m,clearErrors:p,getValues:h}=(0,oo.xW)(),[b,f]=(0,l.useState)(!1),j="ASK",_=t.secret,v="$encrypted$"===d,[w,k]=(0,l.useState)(_&&v),[S,C]=(0,l.useState)(!1),T=(0,oo.FH)({name:`ask_${t.id}`,defaultValue:d===j}),A=(e=>{const{data:t}=tc(xl`/credentials/`,e);return t})(o.filter((e=>e.input_field_name===t.id))[0]?.source_credential),D=(0,l.useCallback)((e=>{let t="";return o.forEach((n=>{n.input_field_name===e.id&&A&&(t=u(`Value is managed by ${A.kind}: ${A.name}`))})),t}),[o,A,u]),E=(0,l.useCallback)((()=>{h(t.id)!==j&&m(t.id,"",{shouldDirty:!1}),p(t.id),i?.(o.filter((e=>e.input_field_name!==t.id))),r?.((e=>[...e,t.id]))}),[h,m,p,t.id,o,i,r]);(0,l.useEffect)((()=>{T?(o.some((e=>e.input_field_name===t.id))&&(r?.((e=>[...e,t.id])),i?.(o.filter((e=>e.input_field_name!==t.id)))),m(t.id,j,{shouldDirty:!0}),p(t.id)):T||h(t.id)!==j||m(t.id,"",{shouldDirty:!0})}),[h,T,t,m,r,o,i,p]),(0,l.useEffect)((()=>{T&&(E(),f(!0),k(!1))}),[T,E]),(0,l.useEffect)((()=>{o.some((e=>e.input_field_name===t.id))&&m(t.id,D(t),{shouldDirty:!0})}),[m,o,D,t]);const P=()=>{m(t.id,"",{shouldDirty:!1}),k(!1)},R=()=>{m(t.id,d,{shouldDirty:!0}),i?.(o.filter((e=>e.input_field_name!==t.id))),k(!0)};(0,l.useEffect)((()=>{t?.id&&w&&_&&v&&!T?(m(t.id,u("ENCRYPTED"),{shouldDirty:!1}),c&&c((e=>e.includes(t.id)?e:[...e,t.id])),C(!0)):(C(!1),c&&c((e=>e.filter((e=>e!==t.id)))))}),[c,w,_,v,T,t.id,m,u]);const B=!T&&v,F=h(t.id)===j||t.secret&&!S?"password":"text";return(0,z.jsx)(li,{name:t.id,label:t.label,placeholder:(t?.default||u("Enter value")).toString(),type:F,isRequired:!T&&s,isDisabled:a||!!T||S,isReadOnly:(e=>o.some((t=>t.input_field_name===e.id)))(t),labelHelp:t.help_text,helperText:(e=>{let t="";return o.forEach((n=>{n.input_field_name===e.id&&(t=u("This field will be retrieved from an external secret management system using the specified credential."))})),t})(t),button:"external"!==e?.kind?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(x.m,{flipBehavior:["top","bottom"],content:u("Populate field from an external secret management system"),children:(0,z.jsx)(g.$n,{isDisabled:a||!!T||S,"data-cy":"secret-management-input",variant:"control",icon:(0,z.jsx)(y.I,{children:(0,z.jsx)(Gb.RY,{})}),onClick:n})}),o.some((e=>e.input_field_name===t.id))&&(0,z.jsx)(g.$n,{"data-cy":"clear-secret-management-input",variant:"control",onClick:E,children:u("Clear")}),B?(0,z.jsx)(vg,{clearField:P,isRevert:b,revertField:R,setIsRevert:f}):null]}):B?(0,z.jsx)(vg,{clearField:P,isRevert:b,revertField:R,setIsRevert:f}):null,additionalControls:t?.ask_at_runtime&&(0,z.jsx)(go,{name:`ask_${t.id}`,label:u("Prompt on launch")})},t.id)}const vg=({clearField:e,revertField:t,isRevert:n,setIsRevert:a})=>{const{t:s}=(0,I.Bd)();return(0,z.jsx)(x.m,{content:s(n?"Revert":"Replace"),children:(0,z.jsx)(g.$n,{id:"credential-replace-button","aria-label":s(n?"Revert field to previously saved value":"Replace field with new value"),variant:g.Ak.control,icon:(0,z.jsx)(Jf.ej,{}),onClick:()=>{n?t():e(),a(!n)}})})};function wg(e){const{inputs:t,field:n,inputSources:a}=e,{t:s}=(0,I.Bd)(),{id:o,label:i,type:r,ask_at_runtime:c,help_text:d=""}=n;return o&&a&&a[o]?(0,z.jsxs)(l.Fragment,{children:[(0,z.jsx)(Ft,{helpText:d,label:i+" *",children:(0,z.jsx)(Ln.I,{numChips:1,ouiaId:`credential-${o}-chips`,children:(0,z.jsx)(uu,{credential:a[o]?.summary_fields?.source_credential})})}),a[o]&&a[o].metadata&&(0,z.jsx)(Wu,{label:s("Metadata"),value:JSON.stringify(a[o].metadata,null,2)})]},o):"boolean"===r?(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Ft,{label:i,helpText:d,children:t[o]?s("Yes"):s("No")},o)}):"$encrypted$"===t[o]?(0,z.jsx)(Ft,{label:i,helpText:d,children:s("Encrypted")},o):c&&"ASK"===t[o]?(0,z.jsxs)(Ft,{helpText:d,label:i,children:[s("Prompt on launch")," "]},o):(0,z.jsx)(Ft,{label:i,helpText:d,children:t[o]},o)}const kg=A.Ay.p.withConfig({componentId:"ans__sc-1no6r2n-0"})(["margin-top:10px;"]);function Sg(){const e=(0,Re.g)(),{data:t,isLoading:n}=tc(xl`/credentials`,e.id);return n&&!t?(0,z.jsx)(zr,{}):t?(0,z.jsx)(Cg,{credential:t}):null}function Cg(e){const{t}=(0,I.Bd)(),{credential:n}=e,a=yr(),s=gr(),{summary_fields:o,inputs:i}=n,{data:r,error:c,refresh:d}=tc(xl`/credential_types`,o.credential_type.id.toString()),{results:u,error:m,isLoading:p,refresh:h}=cm(xl`/credentials/${n.id.toString()}/input_sources/`),b=(0,l.useMemo)((()=>u?.reduce(((e,t)=>(e[t.input_field_name]=t,e)),{})),[u]);return c?(0,z.jsx)(Ic,{error:c||m,handleRefresh:c?d:h}):p?(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0}):(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Name"),children:n.name}),(0,z.jsx)(Ft,{label:t("Description"),children:n.description}),(0,z.jsx)(Ft,{label:t("Organization"),children:n.summary_fields.organization&&(0,z.jsx)(Fe,{text:n.summary_fields?.organization?.name,to:s(fc.OrganizationDetails,{params:{id:n.summary_fields?.organization?.id}})})}),(0,z.jsx)(Ft,{label:t("Credential type"),children:r?.managed?(0,z.jsx)(Fe,{text:n.summary_fields?.credential_type?.name}):(0,z.jsx)(Fe,{text:n.summary_fields?.credential_type?.name,to:s(fc.CredentialTypeDetails,{params:{id:n.summary_fields?.credential_type?.id}})})}),b&&i&&(r?.inputs.fields||[]).map(((e,t)=>(0,z.jsx)(wg,{inputs:i,field:e,inputSources:b},`${e.id}+ ${t}`))),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:n.created,author:n.summary_fields?.created_by?.username,onClick:()=>a(fc.UserDetails,{params:{id:n.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:n.modified,author:n.summary_fields?.modified_by?.username,onClick:()=>a(fc.UserDetails,{params:{id:n.summary_fields?.modified_by?.id}})}),i&&u&&Object.keys(u).length>0&&(0,z.jsx)(kg,{children:t("* This field will be retrieved from an external secret management system using the specified credential.")})]})}function Tg(e){const{t}=(0,I.Bd)(),n=yr();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:ld.os,label:t("View activity stream"),onClick:()=>n(fc.ActivityStream,{query:{type:e}})},{type:s.Seperator}]),[n,e,t])}const Ig=(e,t,n)=>e?.summary_fields?.user_capabilities?.edit||n?"":t("This cannot be edited due to insufficient permissions.");function Ag(e,t){return e.summary_fields?.user_capabilities?.delete?"":t("This cannot be deleted due to insufficient permissions.")}function Dg(e,t){return e.find((e=>Ag(e,t)))?t("Cannot delete due to insufficient permissions with one or many items."):""}const Eg=(e,t)=>e?.summary_fields?.user_capabilities?.copy?"":t("This cannot be copied due to insufficient permissions.");function Pg(e){const{t}=(0,I.Bd)(),n=Ep({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete credentials",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} credentials.",{count:a.length}),actionButtonText:t("Delete credential",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/credentials/${e.id.toString()}/`,t)})}}function Rg(e){const{t}=(0,I.Bd)(),n=yr(),a=Pg(e?.onDeleted),i=function(e){const{t}=(0,I.Bd)(),n=td(),a=ue();return s=>{const o={variant:"success",title:t(`${s.name} copied.`),timeout:2e3};n(xl`/credentials/${s.id.toString()}/copy/`,{name:`${s.name} @ ${(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")}`}).then((()=>{a.addAlert(o)})).catch((e=>{a.replaceAlert(o,{variant:"danger",title:t("Failed to copy credential"),children:e instanceof Error&&e.message})})).finally(e)}}(e?.onCredentialCopied);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:yc.oo,variant:g.Ak.primary,isPinned:!0,label:t("Edit credential"),isDisabled:e=>Ig(e,t),onClick:e=>n(fc.EditCredential,{params:{id:e.id}})},{type:s.Button,selection:o.Single,icon:yo.Td,label:t("Copy credential"),onClick:e=>i(e),isDisabled:e=>Eg(e,t),isDanger:!1,isPinned:!0},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete credential"),isDisabled:e=>Ag(e,t),onClick:e=>a([e]),isDanger:!0}]),[n,i,a,t])}function Bg(){const{t:e}=(0,I.Bd)(),t=Tg("credential"),n=(0,Re.g)(),{data:a}=tc(xl`/credentials`,n.id),s=gr(),o=yr(),i=Rg({onDeleted:()=>o(fc.Credentials)});return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.name,breadcrumbs:[{label:e("Credentials"),to:s(fc.Credentials)},{label:a?.name}],headerActions:(0,z.jsx)(oe,{actions:[...t,...i],position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Credentials"),page:fc.Credentials,persistentFilterKey:"credentials"},tabs:[{label:e("Details"),page:fc.CredentialDetails,dataCy:"credential-details"},{label:e("Job Templates"),page:fc.CredentialJobTemplates,dataCy:"job-templates"},{label:e("Team Access"),page:fc.CredentialTeamAccess,dataCy:"team-access"},{label:e("User Access"),page:fc.CredentialUserAccess,dataCy:"user-access"}],params:{id:n.id||0}})]})}function Fg(e){const{t}=(0,I.Bd)(),n=yr(),a=Ep();Fc("credentials");const i=Mp(),r=Uc({url:e.url,toolbarFilters:i,tableColumns:a}),c=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Pg(e.unselectItemsAndRefresh);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create credential"),onClick:()=>n(fc.CreateCredential)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete credentials"),onClick:a,isDanger:!0}]),[n,a,t])}(r),d=Rg({onDeleted:()=>{r.refresh()},onCredentialCopied:()=>{r.refresh()}});return(0,z.jsx)($s,{id:"awx-credentials-table",toolbarFilters:i,toolbarActions:c,tableColumns:a,rowActions:d,errorStateTitle:t("Error loading credentials"),emptyStateTitle:t("No credentials yet"),emptyStateDescription:t("To get started, create an credential."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:t("Create credential"),emptyStateButtonClick:()=>n(fc.CreateCredential),...r,defaultSubtitle:t("Credential")})}function Ng(){const{t:e}=(0,I.Bd)();Fc("credentials");const t=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Credentials"),titleHelpTitle:e("Credentials"),titleHelp:e("Credentials are utilized by {{product}} for authentication when launching jobs against machines, synchronizing with inventory sources, and importing project content from a version control system. You can grant users and teams the ability to use these credentials, without actually exposing the credential to the user. If you have a user move to a different team or leave the organization, you don’t have to re-key all of your systems just because that credential was available in {{product}}.",{product:"AWX"}),titleDocLink:pc(t,"credentials"),description:e("Credentials are utilized by {{product}} for authentication when launching jobs against machines, synchronizing with inventory sources, and importing project content from a version control system.",{product:"AWX"}),headerActions:(0,z.jsx)(cd,{type:"credential"})}),(0,z.jsx)(Fg,{url:xl`/credentials/`})]})}function $g(e){const{t}=(0,I.Bd)(),n=Bh({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{var i;o({title:1===a.length?(i=a[0].type,t("job_template"===i?"Permanently delete job template":"Permanently delete workflow job template")):t("Permanently delete templates"),confirmText:t("Yes, I confirm that I want to delete these {{count}} templates.",{count:a.length}),actionButtonText:t("Delete template",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>"job_template"===e.type?ol(xl`/job_templates/${e.id.toString()}/`,t):ol(xl`/workflow_job_templates/${e.id.toString()}/`,t)})}}var Mg=n(9352);function Lg({onTemplatesDeleted:e,onTemplateCopied:t=()=>null}){const{t:n}=(0,I.Bd)(),a=$g(e),i=fb(),r=function(e){const{t}=(0,I.Bd)(),n=td(),a=ue();return s=>{const o={variant:"success",title:t(`${s.name} copied.`),timeout:2e3};"job_template"===s.type?n(xl`/job_templates/${s.id.toString()}/copy/`,{name:`${s.name} @ ${(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")}`}).then((()=>{a.addAlert(o)})).catch((e=>{a.replaceAlert(o,{variant:"danger",title:t("Failed to copy template"),children:e instanceof Error&&e.message})})).finally(e):"workflow_job_template"===s.type&&n(xl`/workflow_job_templates/${s.id.toString()}/copy/`,{name:`${s.name} @ ${(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")}`}).then((()=>{a.addAlert(o)})).catch((e=>{a.replaceAlert(o,{variant:"danger",title:t("Failed to copy template"),children:e instanceof Error&&e.message})})).finally(e)}}(t),c=gr();return(0,l.useMemo)((()=>[{type:s.Link,isHidden:e=>"workflow_job_template"!==e?.type,selection:o.Single,isPinned:!0,icon:Mg.W$,label:n("View workflow visualizer"),variant:g.Ak.primary,ouiaId:"job-template-detail-edit-button",href:e=>c(fc.WorkflowVisualizer,{params:{id:e.id}})},{type:s.Button,selection:o.Single,icon:mb.Ab,label:n("Launch template"),onClick:e=>{i(e)},isDisabled:e=>Rh(e)?n("Resources are missing from this template."):e?.summary_fields.user_capabilities.start?void 0:n("You do not have permission to launch this template"),ouiaId:"job-template-detail-launch-button",isDanger:!1,isPinned:!0},{type:s.Link,selection:o.Single,isPinned:!0,isHidden:e=>!e?.summary_fields?.user_capabilities?.edit,icon:yc.oo,label:n("Edit template"),ouiaId:"job-template-detail-edit-button",href:e=>c("job_template"===e.type?fc.EditJobTemplate:fc.EditWorkflowJobTemplate,{params:{id:e?.id.toString()}})},{type:s.Button,selection:o.Single,icon:yo.Td,label:n("Copy template"),onClick:e=>r(e),isDisabled:e=>e?.summary_fields.user_capabilities.copy?void 0:n("You do not have permission to copy this template"),ouiaId:"job-template-detail-copy-button",isDanger:!1},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,isDisabled:e=>e?.summary_fields?.user_capabilities?.delete?void 0:n("You do not have permission to delete this template"),label:n("Delete template"),onClick:e=>{e&&a([e])},ouiaId:"job-template-detail-delete-button",isDanger:!0}]),[r,a,c,i,n])}function Og(e){const{t}=(0,I.Bd)(),n=yr(),a=gr(),i=function({url:e,projectId:t,inventoryId:n,credentialsId:a,executionEnvironmentId:s}={}){const o=e?e.split("/"):[],i=o[o.length-2]||"unified_job_templates",r=Np(),c=$p(),d=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"type-templates",label:e("Type"),type:Ia.MultiSelect,query:"type",options:[{label:e("Job template"),value:"job_template"},{label:e("Workflow job template"),value:"workflow_job_template"}],placeholder:e("Select types")})),[e])}(),u=((e,t,n,a)=>{const s={type:"job_template,workflow_job_template"};return e&&(s.project__id=e),t&&(s.inventory__id=t),n&&(s.credentials__id=n),a&&(s.execution_environment__id=a),s})(t,n,a,s);return Pp({optionsPath:i,preSortedKeys:["name","description","status","created-by","modified-by","type-templates"],preFilledValueKeys:{name:{apiPath:i,queryParams:u},id:{apiPath:i,queryParams:u}},additionalFilters:[r,c,d],removeFilters:["type"]})}({url:e.url,projectId:e.projectId,inventoryId:e.inventoryId,credentialsId:e.credentialsId,executionEnvironmentId:e.executionEnvironmentId}),r=Bh(),c=Uc({url:e.url?e.url:xl`/unified_job_templates/`,queryParams:((e,t,n,a)=>{const s={type:"job_template,workflow_job_template"};return e&&(s.project__id=e),t&&(s.inventory__id=t),n&&(s.credentials__id=n),a&&(s.execution_environment__id=a),s})(e.projectId,e.inventoryId,e.credentialsId,e.executionEnvironmentId),toolbarFilters:i,tableColumns:r}),{data:d}=dd(xl`/job_templates/`),{data:u}=dd(xl`/workflow_job_templates/`),m=Boolean(d&&d.actions&&d.actions.POST),p=Boolean(u&&u.actions&&u.actions.POST);Fc("templates");const h=$g(c.unselectItemsAndRefresh),b=(0,l.useMemo)((()=>[{type:s.Dropdown,variant:g.Ak.primary,isPinned:!0,label:t("Create template"),isDisabled:m||p?void 0:t("You do not have permission to create a template. Please contact your organization administrator if there is an issue with your access."),selection:o.None,icon:Za.GY,actions:[{type:s.Link,selection:o.None,label:t("Create job template"),isDisabled:m?void 0:"You do not have permission to create a job template. Please contact your organization administrator if there is an issue with your access.",href:a(fc.CreateJobTemplate)},{type:s.Link,selection:o.None,label:t("Create workflow job template"),isDisabled:p?void 0:"You do not have permission to create a workflow job template. Please contact your organization administrator if there is an issue with your access.",href:a(fc.CreateWorkflowJobTemplate)}]},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:"Delete templates",onClick:h,isDanger:!0}]),[m,p,h,a,t]),f=Lg({onTemplatesDeleted:c.unselectItemsAndRefresh,onTemplateCopied:c.refresh});return(0,z.jsx)($s,{id:"awx-job-templates-table",toolbarFilters:i,toolbarActions:b,tableColumns:r,rowActions:f,errorStateTitle:t("Error loading templates"),emptyStateTitle:t(m||p?"No templates yet":"You do not have permission to create a template"),emptyStateDescription:t(m||p?"Please create a template by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:m||p?t("Create template"):void 0,emptyStateButtonClick:m?()=>n(fc.CreateJobTemplate):void 0,...c,defaultSubtitle:t("Template")})}function zg(){const{id:e=""}=(0,Re.g)();return(0,z.jsx)(Og,{url:xl`/job_templates/`,credentialsId:e})}var Hg=n(80536);function qg(){const{t:e}=(0,I.Bd)();return(0,l.useCallback)(((t,n)=>{const a={edacredential:e(n?.isTitleCase?"Credential":"credential"),credential:e(n?.isTitleCase?"Credential":"credential"),project:e(n?.isTitleCase?"Project":"project"),activation:e(n?.isTitleCase?"Rulebook activation":"rulebook activation"),rulebook:e(n?.isTitleCase?"Rulebook":"rulebook"),rulebookprocess:e(n?.isTitleCase?"Rulebook Process":"rulebook process"),credentialtype:e(n?.isTitleCase?"Credential Type":"credential type"),decisionenvironment:e(n?.isTitleCase?"Decision Environment":"decision environment"),eventstream:e(n?.isTitleCase?"Event Stream":"event stream"),auditrule:e(n?.isTitleCase?"Rule Audit":"rule audit"),team:e(n?.isTitleCase?"Team":"team"),organization:e(n?.isTitleCase?"Organization":"organization"),executionenvironment:e(n?.isTitleCase?"Execution Environment":"execution environment"),jobtemplate:e(n?.isTitleCase?"Job Template":"job template"),workflowjobtemplate:e(n?.isTitleCase?"Workflow Job Template":"workflow job template"),notificationtemplate:e(n?.isTitleCase?"Notification Template":"notification template"),instancegroup:e(n?.isTitleCase?"Instance Group":"instance group"),inventory:e(n?.isTitleCase?"Inventory":"inventory"),namespace:e(n?.isTitleCase?"Namespace":"namespace"),collectionremote:e(n?.isTitleCase?"Remote":"remote"),containernamespace:e(n?.isTitleCase?"Execution Environment":"execution environment"),containerrepository:e(n?.isTitleCase?"Container Repository":"container repository"),ansiblerepository:e(n?.isTitleCase?"Repository":"repository"),system:e(n?.isTitleCase?"System":"system"),null:e(n?.isTitleCase?"System":"system")},s=t?.split(".").pop()||t;return a[s]??s}),[e])}const Ug=(0,A.Ay)(bb.E).withConfig({componentId:"ans__sc-10zjiw0-0"})(["margin-left:var(--pf-v5-global--spacer--sm);"]),Wg=(0,A.Ay)(k.c).withConfig({componentId:"ans__sc-10zjiw0-1"})(["margin:var(--pf-v5-global--spacer--md) 0 var(--pf-v5-global--spacer--md) 0;"]);function Jg(e){const{wizardData:t}=vr(),{t:n}=(0,I.Bd)(),{resourceType:a,resources:s,users:o,teams:i,edaRoles:r,awxRoles:l,hubRoles:c}=t,d=qg();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ge.h,{headingLevel:"h1",children:n("Review")}),a?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{marginTop:"var(--pf-v5-global--spacer--lg)"},children:(0,z.jsx)(Mt,{disablePadding:!0,children:(0,z.jsx)(Ft,{label:n("Resource type"),children:d(a,{isTitleCase:!0})})})}),(0,z.jsx)(Wg,{className:"pf-v5-u-mb-xl"})]}):null,e.selectedUser?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{marginTop:"var(--pf-v5-global--spacer--lg)"},children:(0,z.jsx)(Mt,{disablePadding:!0,children:(0,z.jsx)(Ft,{label:n("User"),children:e.selectedUser.username})})}),(0,z.jsx)(Wg,{className:"pf-v5-u-mb-xl"})]}):null,e.selectedTeam?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{marginTop:"var(--pf-v5-global--spacer--lg)"},children:(0,z.jsx)(Mt,{disablePadding:!0,children:(0,z.jsx)(Ft,{label:n("Team"),children:e.selectedTeam.name})})}),(0,z.jsx)(Wg,{className:"pf-v5-u-mb-xl"})]}):null,s&&s.length?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Vg,{selectedItems:s,fieldName:"resources"}),(0,z.jsx)(Wg,{})]}):null,o&&o.length?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Vg,{selectedItems:o,fieldName:"users"}),(0,z.jsx)(Wg,{})]}):null,i&&i.length?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Vg,{selectedItems:i,fieldName:"teams"}),(0,z.jsx)(Wg,{})]}):null,r&&r.length?(0,z.jsx)(Vg,{selectedItems:r,fieldName:"edaRoles",...e}):null,l&&l.length?(0,z.jsx)(Vg,{selectedItems:l,fieldName:"awxRoles",...e}):null,c&&c.length?(0,z.jsx)(Vg,{selectedItems:c,fieldName:"hubRoles",...e}):null]})}function Vg(e){const{label:t,selectedItems:n,fieldName:a,edaRolesLabel:s,awxRolesLabel:o,hubRolesLabel:i}=e,[r,c]=(0,l.useState)(!0),{t:d}=(0,I.Bd)(),u=(0,l.useMemo)((()=>{if(t)return t;switch(a){case"users":return d("Users");case"teams":return d("Teams");case"resources":return d("Resources");case"edaRoles":return s||d("Roles");case"awxRoles":return o||d("Roles");case"hubRoles":return i||d("Roles");default:return""}}),[o,s,i,a,t,d]),m=(0,l.useMemo)((()=>{switch(a){case"users":return[{header:d("Username"),cell:e=>(0,z.jsx)(Fe,{text:e.username}),card:"name",list:"name",sort:"username",maxWidth:200}];case"awxRoles":case"edaRoles":case"hubRoles":return[{header:d("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name}),card:"name",list:"name",sort:"name"},{header:d("Description"),cell:e=>e.description&&(0,z.jsx)(Fe,{text:e.description}),card:"description",list:"description"}];default:return[{header:d("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name}),card:"name",list:"name",sort:"name"}]}}),[a,d]),p=Jr({keyFn:e=>e.pulp_href?e.pulp_href:e.id,items:n,tableColumns:m});return 0===p?.itemCount?null:(0,z.jsx)(Hg.Q,{"data-cy":`expandable-section-${a}`,toggleContent:(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{children:u}),(0,z.jsx)(Ug,{isRead:!0,children:n.length})]}),onToggle:(e,t)=>{c(t)},isExpanded:r,children:(0,z.jsx)($s,{...p,tableColumns:m,errorStateTitle:"NEVER",emptyStateTitle:"NEVER",defaultSubtitle:d("Role"),disablePagination:!0,disableLastRowBorder:!0,compact:!0,borderless:!0})})}function Gg(e,t){const{setValue:n}=(0,oo.xW)(),{wizardData:a,stepData:s}=vr(),o=Uc({...e,defaultSelection:a[t]||s[t]||[]});return(0,l.useEffect)((()=>{n(t,o.selectedItems)}),[n,t,o.selectedItems]),o}const Yg=(0,A.Ay)(Ge.h).withConfig({componentId:"ans__sc-12a9n8o-0"})(["margin-bottom:1rem;"]);function Kg(e){const{t}=(0,I.Bd)(),{view:n,tableColumns:a,toolbarFilters:s,fieldNameForPreviousStep:o,descriptionForRoleSelection:i,title:r}=e,{wizardData:c}=vr(),{resourceType:d}=c,u=(0,l.useMemo)((()=>{if(c&&o)return c[o]}),[o,c]),m=(0,l.useMemo)((()=>{if(u?.length&&o)switch("resources"===o?d:o){case"users":return t("Selected users");case"teams":return t("Selected teams");case"eda.edacredential":return t("Selected credentials");case"eda.project":return t("Selected projects");case"eda.activation":return t("Selected rulebook activations");case"eda.rulebook":return t("Selected rulebooks");case"eda.rulebookprocess":return t("Selected rulebook processes");case"eda.credentialtype":return t("Selected credential types");case"eda.decisionenvironment":return t("Selected decision environments");case"eda.auditrule":return t("Selected audit rules");default:return}}),[o,d,u?.length,t]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Zg,{selectedItemsFromPreviousStep:u,labelForSelectedItemsFromPreviousStep:m,descriptionForRoleSelection:i,title:r,resourceType:d||void 0}),(0,z.jsx)(Zs,{view:n,tableColumns:a,toolbarFilters:s,labelForSelectedItems:t("Selected roles"),errorStateTitle:t("Error loading roles")})]})}function Zg(e){const{selectedItemsFromPreviousStep:t,labelForSelectedItemsFromPreviousStep:n,descriptionForRoleSelection:a,title:s,resourceType:o}=e,{t:i}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Yg,{headingLevel:"h1",children:s??i("Select roles to apply")}),"system"!==o?(0,z.jsxs)(ee.B,{hasGutter:!0,children:[(0,z.jsx)(xe.o,{style:{fontWeight:"bold",whiteSpace:"nowrap"},children:n??i("Selected")}),t&&t.length>0&&(0,z.jsx)(De.o,{children:t?.map(((e,t)=>(0,z.jsx)(Ee.J,{children:(0,z.jsx)(Fe,{text:e.name?e.name:e.username})},t)))})]}):null,a&&(0,z.jsx)("h2",{style:{marginTop:"1rem",marginBottom:"1rem"},children:a})]})}function Xg(e){const t=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{key:"name",label:e("Name"),type:Ia.MultiText,query:"name__contains",comparison:"contains"}]),[e])}(),{t:n}=(0,I.Bd)(),{wizardData:a}=vr(),{resourceType:s}=a,{fieldNameForPreviousStep:o,title:i}=e,r=(0,l.useMemo)((()=>e.contentType?e.contentType:s?.split(".").pop()??""),[e.contentType,s]),c=(0,l.useMemo)((()=>{if(e.descriptionForRoleSelection)return e.descriptionForRoleSelection;switch(s){case"awx.credential":return n("Select roles to apply to all of your selected credentials.");case"awx.instancegroup":return n("Select roles to apply to all of your selected instance groups.");case"awx.inventory":return n("Select roles to apply to all of your selected inventories.");case"awx.jobtemplate":return n("Select roles to apply to all of your selected job templates.");case"awx.notificationtemplate":return n("Select roles to apply to all of your selected notification templates.");case"awx.project":return n("Select roles to apply to all of your selected projects.");case"awx.executionenvironment":return n("Select roles to apply to all of your selected execution environments.");case"awx.workflowjobtemplate":return n("Select roles to apply to all of your selected workflow job templates.");default:return n("Select roles to apply to all of your selected resources.")}}),[e.descriptionForRoleSelection,s,n]),d=(0,l.useMemo)((()=>[{header:n("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name}),card:"name",list:"name",sort:"name"},{header:n("Description"),cell:e=>e.description&&(0,z.jsx)(Fe,{text:e.description}),card:"description",list:"description"}]),[n]),u=Gg({url:xl`/role_definitions/`,toolbarFilters:t,tableColumns:d,queryParams:(0,l.useMemo)((()=>{const e={content_type__model:r};return"organization"===r&&(e.not__name=["Organization Member","Organization Admin","Organization Organization Admin"]),e}),[r])},"awxRoles");return(0,z.jsx)(Kg,{view:u,tableColumns:d,toolbarFilters:t,fieldNameForPreviousStep:o,descriptionForRoleSelection:c,title:i})}const Qg=(0,A.Ay)(Ge.h).withConfig({componentId:"ans__sc-w1msyr-0"})(["margin-bottom:1rem;"]);function ey(e){const t=Zf(),{t:n}=(0,I.Bd)(),{descriptionForUsersSelection:a}=e,s=(0,l.useMemo)((()=>[{header:n("Username"),cell:e=>(0,z.jsx)(Fe,{text:e.username}),card:"name",list:"name",sort:"username",maxWidth:200},{header:n("First name"),type:"text",value:e=>e.first_name,sort:"first_name"},{header:n("Last name"),type:"text",value:e=>e.last_name,sort:"last_name"}]),[n]),o=Gg({url:xl`/users/`,queryParams:{is_superuser:"false"},toolbarFilters:t,tableColumns:s},"users");return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Qg,{headingLevel:"h1",children:n("Select user(s)")}),(0,z.jsx)("h2",{style:{marginTop:"1rem",marginBottom:"1rem"},children:a??n("Select the user(s) that you want to apply new roles to.")}),(0,z.jsx)(Zs,{view:o,tableColumns:s,toolbarFilters:t})]})}function ty(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/credentials/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{credentialName}}.",{credentialName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"credential",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{credentialName}}.",{credentialName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Credentials"),to:t(fc.Credentials)},{label:a?.name,to:t(fc.CredentialDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.CredentialUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"awx.credential",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.CredentialUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.CredentialUserAccess,{params:{id:a?.id}})}})]})}function ny(){return Pp({optionsPath:"teams",preSortedKeys:["name","description","id","organization","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:"teams"},id:{apiPath:"teams"}},additionalFilters:[Np(),$p()]})}const ay=(0,A.Ay)(Ge.h).withConfig({componentId:"ans__sc-6hpp1k-0"})(["margin-bottom:1rem;"]);function sy(e){const t=ny(),{descriptionForTeamsSelection:n}=e,{t:a}=(0,I.Bd)(),s=(0,l.useMemo)((()=>[{header:a("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name}),card:"name",list:"name",sort:"name",maxWidth:200}]),[a]),o=Gg({url:xl`/teams/`,toolbarFilters:t,tableColumns:s},"teams");return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ay,{headingLevel:"h1",children:a("Select team(s)")}),(0,z.jsx)("h2",{style:{marginTop:"1rem",marginBottom:"1rem"},children:n??a("Select the team(s) that you want to apply new roles to.")}),(0,z.jsx)(Zs,{view:o,tableColumns:s,toolbarFilters:t})]})}function oy(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/credentials/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{credentialName}}.",{credentialName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"credential",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{credentialName}}.",{credentialName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Credentials"),to:t(fc.Credentials)},{label:s?.name,to:t(fc.CredentialDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.CredentialTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"awx.credential",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.CredentialTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.CredentialTeamAccess,{params:{id:s?.id}})}})]})}let iy="/api/eda/v1";function ry(e,...t){return iy+hl(e,...t)}const ly=e=>{const t=[],n=[];if(Qr(e)&&e.json&&"object"==typeof e.json){const a=e.json;for(const e in a){const s=a[e];if("detail"===e)Array.isArray(s)?t.push({message:s[0]}):t.push({message:s});else if("non_field_errors"===e&&Array.isArray(s))s.forEach((e=>{"string"==typeof e&&t.push({message:e})}));else if(Array.isArray(s)){const t=s.join(",");n.push({name:e,message:t})}else{const t=String(s);n.push({name:e,message:t})}}}else e instanceof Error&&t.push({message:e.message});return{genericErrors:t,fieldErrors:n}},cy=()=>Ks(ly),dy=(e,t)=>{const n=[],a=[];if(Qr(e)&&e.json&&"object"==typeof e.json){const s=e.json;if("detail"in s&&"string"==typeof s.detail)return n.push({message:s.detail}),{genericErrors:n,fieldErrors:a};if("non_field_errors"in s&&Array.isArray(s.non_field_errors))return s.non_field_errors.forEach((e=>{"string"==typeof e&&n.push({message:e})})),{genericErrors:n,fieldErrors:a};if("string"==typeof s)return n.push({message:s}),{genericErrors:n,fieldErrors:a};if("errors"in s&&Array.isArray(s.errors))for(const e of s.errors)if(e.source&&e.source.parameter)if(t){const n=t[e.source.parameter]??e.source.parameter;a.push({name:n,message:e.detail||e.title})}else a.push({name:e.source.parameter,message:e.detail||e.title});else n.push({message:e.detail||e.title});else for(const[e,t]of Object.entries(s))if(Array.isArray(t)&&t.length>0){const n=t.map((e=>e)).join("\n");a.push({name:e,message:n})}else a.push({name:e,message:t})}else e instanceof Error&&n.push({message:e.message});return a.length>0&&a.forEach((e=>{["filename"].includes(e.name)&&(e.name="file")})),{genericErrors:n,fieldErrors:a}},uy=()=>Ks(dy);function my(e){const{t}=(0,I.Bd)(),n=gr(),a=qg(),i=(0,Re.g)(),r=(0,l.useMemo)((()=>e.additionalTableColumns?.filter((e=>e.priority!==Jt.last))),[e.additionalTableColumns]),c=(0,l.useMemo)((()=>e.additionalTableColumns?.filter((e=>e.priority===Jt.last))),[e.additionalTableColumns]),d=(0,l.useMemo)((()=>[{header:e.tableColumnFunctions.name.label,type:"text",sort:e.tableColumnFunctions.name.sort,value:e.tableColumnFunctions.name.function,to:e.tableColumnFunctions.name.to},...r||[],{header:t("Role"),type:"description",value:e=>e.summary_fields.role_definition.name,sort:"role_definition__name"},...c||[]]),[e.tableColumnFunctions.name.label,e.tableColumnFunctions.name.sort,e.tableColumnFunctions.name.function,e.tableColumnFunctions.name.to,r,t,c]),u=(0,l.useMemo)((()=>[...["user","team"].includes(e.accessListType)&&e.toolbarNameColumnFiltersValues?[{key:"name",label:e.toolbarNameColumnFiltersValues.label,type:Ia.SingleText,query:e.toolbarNameColumnFiltersValues.query,comparison:"contains"}]:[],{key:"role_definition__name",label:t("Role name"),type:Ia.SingleText,query:"role_definition__name__contains",comparison:"contains"},...e.additionalTableFilters?e.additionalTableFilters:[]]),[e.accessListType,e.toolbarNameColumnFiltersValues,e.additionalTableFilters,t]),m=(0,l.useMemo)((()=>{let t={};switch(e.accessListType){case"user":case"team":t={object_id:e.id,content_type__model:e.content_type_model};break;case"user-roles":t={user_id:e.id};break;case"team-roles":t={team_id:e.id};break;default:t={}}return t}),[e.content_type_model,e.id,e.accessListType]),p=function(e){let{url:t}=e;const{toolbarFilters:n,tableColumns:a,disableQueryString:s}=e;let o=e.defaultSort,i=e.defaultSortDirection;if(a&&a.length){const e=a.find((e=>e.defaultSort))??a[0];o=e?.sort,i=e?.defaultSortDirection}const r=Ur({defaultValues:{sort:o,sortDirection:i},disableQueryString:s}),c=(0,l.useRef)({itemCount:void 0}),{page:d,perPage:u,sort:m,sortDirection:p,filterState:h}=r;let b=e?.queryParams?`?${f=e.queryParams,Object.entries(f).map((([e,t=""])=>Array.isArray(t)?t.map((t=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"):`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}`:"";var f;if(h)for(const e in h){const t=n?.find((t=>t.key===e));if(t){const n=h[e];n&&n.length>0&&(b+=b?"&":"?",n.length>1?b+=n.map((e=>`or__${t.query}=${e}`)).join("&"):b+=`${t.query}=${n.join(",")}`)}}m&&!b.includes("order_by")&&(b+=b?"&":"?",b+="desc"===p?`order_by=-${m}`:`order_by=${m}`),b+=b?"&":"?",b+=`page=${e?.viewPage||d}`,b+=b?"&":"?",b+=`page_size=${e?.viewPerPage||u}`,t+=b;const g=rl(),y=(0,_e.Ay)(t,g,{...cl}),{data:x,mutate:j}=y,_=(0,l.useCallback)((async()=>{await j().finally((()=>{}))}),[j]);(0,_e.Ay)(x?.next,g,cl);let v=y.error;v instanceof Xr&&404===v.statusCode&&r.page>1&&(r.setPage(1),v=void 0);const w=os(x?.results??[],ll,e.defaultSelection);void 0!==x?.count&&(c.current.itemCount=x?.count);const k=(0,l.useCallback)((e=>{w.selectItems(e),_()}),[_,w]),S=(0,l.useCallback)((e=>{w.unselectItems(e),_()}),[_,w]),[C,T]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{T(x?.results)}),[x?.results]);const I=(0,l.useCallback)((e=>{if(!e)return;const t=C?.findIndex((t=>ll(t)===ll(e)));if(void 0!==t&&-1!==t){const n=[...C||[]];n[t]=e,T(n)}}),[C]);return(0,l.useMemo)((()=>({refresh:_,itemCount:c.current.itemCount,pageItems:C,updateItem:I,error:v,...r,...w,selectItemsAndRefresh:k,unselectItemsAndRefresh:S})),[C,I,v,_,k,w,S,r])}({url:e.url,tableColumns:d,toolbarFilters:u,queryParams:m}),h=function(t){const{t:n}=(0,I.Bd)(),a=d,s=(0,l.useMemo)((()=>[a[0]]),[a]),o=cy(),i=Lc(),r=uy(),c="awx"===e.service?i:"eda"===e.service?o:r;return(0,l.useCallback)((o=>{let i="team"===e.content_type_model?n("Yes, I confirm that I want to remove these {{count}} users.",{count:o.length}):n("Yes, I confirm that I want to remove these {{count}} roles.",{count:o.length});e.removeConfirmationText&&(i=e.removeConfirmationText(o.length)),c({title:e.removeRoleText??n("Remove role"),confirmText:i,actionButtonText:e.removeRoleText??n("Remove role"),items:o,keyFn:Oc,isDanger:!0,confirmationColumns:a,actionColumns:s,onComplete:t,actionFn:(t,n)=>ol(e.url+`${t.id.toString()}/`,n)})}),[s,c,a,t,n])}(p.unselectItemsAndRefresh),b=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,variant:g.Ak.primary,icon:Nd.Kf,isPinned:!0,label:t("Remove role"),onClick:e=>h([e])}]),[t,h]),f=(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:e.addRoleButtonText??t("Add roles"),href:n(e.addRolesRoute??"",{params:{id:i.id}})},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Remove roles"),onClick:e=>h(e),isDanger:!0}]),[t,n,e.addRolesRoute,e.addRoleButtonText,i.id,h]),y=(0,l.useMemo)((()=>{let n;switch(e.accessListType){case"user":n=e.content_type_model?t("There are currently no users assigned to this {{resourceType}}.",{resourceType:a(e.content_type_model)}):t("There are currently no users assigned to this resource.");break;case"team":n=e.content_type_model?t("There are currently no teams assigned to this {{resourceType}}.",{resourceType:a(e.content_type_model)}):t("There are currently no teams assigned to this resource.");break;case"user-roles":n=t("There are currently no roles assigned to this user.");break;case"team-roles":n=t("There are currently no roles assigned to this team.");break;default:n=t("There are currently no roles assigned to this resource.")}return n}),[a,e.accessListType,e.content_type_model,t]);return(0,z.jsx)($s,{id:e.content_type_model?`${e.service}-${e.content_type_model}-access-table`:`${e.service}-${e.accessListType}-table`,tableColumns:d,toolbarActions:f,toolbarFilters:u,rowActions:b,errorStateTitle:t("Error loading access data."),emptyStateTitle:y,emptyStateDescription:t("Add a role by clicking the button below."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:e.addRoleButtonText??t("Add roles"),emptyStateActions:f.slice(0,1),...p})}function py(e){const{type:t,service:n,...a}=e,{t:s}=(0,I.Bd)(),o="awx"===n?xl`/role_team_assignments/`:"eda"===n?ry`/role_team_assignments/`:gl`/_ui/v2/role_team_assignments/`;return(0,z.jsx)(my,{...a,service:n,tableColumnFunctions:{name:{function:e=>e?.summary_fields?.team?.name,sort:"team__name",label:s("Team name")}},toolbarNameColumnFiltersValues:{label:s("Team name"),query:"team__name__icontains"},url:o,content_type_model:t,accessListType:"team"})}function hy(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"credential",addRolesRoute:fc.CredentialAddTeams})}function by(e){const{type:t,service:n,...a}=e,{t:s}=(0,I.Bd)(),o="awx"===n?xl`/role_user_assignments/`:"eda"===n?ry`/role_user_assignments/`:gl`/_ui/v2/role_user_assignments/`;return(0,z.jsx)(my,{...a,service:n,tableColumnFunctions:{name:{function:e=>e?.summary_fields?.user?.username,sort:"user__username",label:s("Username")}},additionalTableColumns:[{header:s("First name"),type:"text",value:e=>e?.summary_fields?.user?.first_name,sort:"user__first_name"},{header:s("Last name"),type:"text",value:e=>e?.summary_fields?.user?.last_name,sort:"user__last_name"}],toolbarNameColumnFiltersValues:{label:s("Username"),query:"user__username__icontains"},url:o,content_type_model:t,accessListType:"user"})}function fy(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"credential",addRolesRoute:fc.CredentialAddUsers})}function gy(){const{t:e}=(0,I.Bd)(),t=gr(),n=yr(),a=td();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create credential type"),breadcrumbs:[{label:e("Credential Types"),to:t(fc.CredentialTypes)},{label:e("Create credential type")}]}),(0,z.jsx)(nd,{submitText:e("Create credential type"),onSubmit:async e=>{const t=await a(xl`/credential_types/`,{...e,kind:"cloud"});n(fc.CredentialTypeDetails,{params:{id:t.id.toString()}})},onCancel:()=>n(fc.CredentialTypes),defaultValue:jy(),children:(0,z.jsx)(xy,{})})]})}function yy(){const{t:e}=(0,I.Bd)(),t=gr(),n=yr(),a=(0,Re.g)(),s=Number(a.id),{data:o}=ec(xl`/credential_types/${s.toString()}/`),i=ed(),r=!!o;return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name?e("Edit {{credentialtypeName}}",{credentialtypeName:o?.name}):e("Credential Types"),breadcrumbs:[{label:e("Credential Types"),to:t(fc.CredentialTypes)},{label:o?.name?e("Edit {{credentialtypeName}}",{credentialtypeName:o?.name}):e("Credential Types")}]}),r&&(0,z.jsx)(nd,{submitText:e("Save credential type"),onSubmit:async e=>{await i(xl`/credential_types/${s.toString()}/`,e),n(fc.CredentialTypeDetails,{params:{id:s.toString()}})},onCancel:()=>n(fc.CredentialTypeDetails,{params:{id:s}}),defaultValue:jy(o),children:(0,z.jsx)(xy,{})})]})}function xy(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:e("Name"),placeholder:e("Enter name"),isRequired:!0}),(0,z.jsx)(li,{name:"description",label:e("Description"),placeholder:e("Enter description")}),(0,z.jsxs)(_d,{singleColumn:!0,children:[(0,z.jsx)(Go,{name:"inputs",label:e("Input configuration"),labelHelpTitle:e("Input configuration"),labelHelp:e("Input schema which defines a set of ordered fields for that type, either in JSON or YAML syntax. Refer to the Ansible Controller documentation for example syntax."),format:"object"}),(0,z.jsx)(Go,{name:"injectors",label:e("Injector configuration"),labelHelpTitle:e("Injector configuration"),labelHelp:e("Environment variables or extra variables that specify the values a credential type can inject, either in JSON or YAML syntax. Refer to the Ansible Controller documentation for example syntax."),format:"object"})]})]})}function jy(e){return e||{name:"",description:"",inputs:{},injectors:{}}}function _y(){const{id:e=""}=(0,Re.g)();return(0,z.jsx)(Fg,{url:xl`/credential_types/${e}/credentials/`})}function vy(){const e=(0,Re.g)(),{data:t}=tc(xl`/credential_types/`,e.id);return t?(0,z.jsx)(wy,{credentialType:t}):null}function wy(e){const{t}=(0,I.Bd)(),n=(0,Re.Zp)(),a=gr();return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Name"),children:(s=e.credentialType,s.managed?(0,z.jsxs)(z.Fragment,{children:[s.name,(0,z.jsx)(Ee.J,{style:{marginLeft:"10px"},children:t("Read-only")})]}):(0,z.jsx)(z.Fragment,{children:s.name}))}),(0,z.jsx)(Ft,{label:t("Description"),children:e.credentialType.description}),(0,z.jsx)(Wu,{helpText:t("Input schema which defines a set of ordered fields for that type, either in JSON or YAML syntax. Refer to the Ansible Controller documentation for example syntax."),label:t("Input configuration"),value:om(JSON.stringify(e.credentialType.inputs))}),(0,z.jsx)(Wu,{helpText:t("Environment variables or extra variables that specify the values a credential type can inject, either in JSON or YAML syntax. Refer to the Ansible Controller documentation for example syntax."),label:t("Injector configuration"),value:om(JSON.stringify(e.credentialType.injectors))}),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:e.credentialType.created,author:e.credentialType.summary_fields?.created_by?.username,onClick:()=>n(a(fc.UserDetails,{params:{id:(e.credentialType.summary_fields?.created_by?.id??0).toString()}}))})}),(0,z.jsx)(Xd,{value:e.credentialType.modified,author:e.credentialType.summary_fields?.modified_by?.username,onClick:()=>n(a(fc.UserDetails,{params:{id:(e.credentialType.summary_fields?.modified_by?.id??0).toString()}}))})]});var s}function ky(e){const{t}=(0,I.Bd)(),n=cg(),a=(0,l.useMemo)((()=>({header:t("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name}),sort:"name",maxWidth:200})),[t]),s=(0,l.useMemo)((()=>[a]),[a]),o=e=>e.summary_fields?.user_capabilities?.delete?"":t("The credential type cannot be deleted due to insufficient permissions."),i=e=>e.managed?t("The credential type is provided by the system and is read-only."):"",r=Lc();return a=>{const l=a.filter((e=>e.managed)),c=a.filter((e=>!e.managed)).filter(o);r({title:t("Permanently delete credential types",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} credential types.",{count:a.length-l.length-c.length}),actionButtonText:t("Delete credential types",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length||c.length?[...l.length?[t("{{count}} of the selected credential types cannot be deleted because they are read-only.",{count:l.length})]:[],...c.length?[t("{{count}} of the selected credential types cannot be deleted due to insufficient permissions.",{count:c.length})]:[]]:void 0,isItemNonActionable:e=>i(e)?i(e):o(e),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/credential_types/${e.id.toString()}/`,t)})}}function Sy(e){const t=yr(),n=ky(e),{t:a}=(0,I.Bd)();return(0,l.useMemo)((()=>{const e=e=>e.managed?a("The credential type cannot be deleted because it is read-only."):"",i=e=>e.managed?a("The credential type cannot be edited because it is read-only."):"";return[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,variant:g.Ak.primary,label:a("Edit credential type"),isDisabled:e=>i(e)?i(e):(e=>e.summary_fields?.user_capabilities?.edit?"":a("The credential type cannot be edited due to insufficient permissions."))(e),onClick:e=>t(fc.EditCredentialType,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:a("Delete credential type"),isDisabled:t=>e(t)?e(t):(e=>e.summary_fields?.user_capabilities?.delete?"":a("The credential type cannot be deleted due to insufficient permissions."))(t),onClick:e=>n([e]),isDanger:!0}]}),[n,t,a])}function Cy(){const{t:e}=(0,I.Bd)(),t=Tg("credential_type"),n=(0,Re.g)(),{error:a,data:s,refresh:o}=tc(xl`/credential_types`,n.id),i=yr(),r=Sy((()=>i(fc.CredentialTypes))),l=gr();return a?(0,z.jsx)(Ic,{error:a,handleRefresh:o}):s?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.name,breadcrumbs:[{label:e("Credential Types"),to:l(fc.CredentialTypes)},{label:s?.name}],headerActions:(0,z.jsx)(oe,{actions:[...t,...r],position:te.nU.right,selectedItem:s})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Credential Types"),page:fc.CredentialTypes,persistentFilterKey:"credential_types"},tabs:[{label:e("Details"),page:fc.CredentialTypeDetails},{label:e("Credentials"),page:fc.CredentialTypeCredentials}],params:{id:s.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Ty(){const{t:e}=(0,I.Bd)(),t=sc();Fc("credential_types");const n=lg(),a=cg(),i=yr(),r=Uc({url:xl`/credential_types/`,toolbarFilters:n,tableColumns:a}),c=function(e){const{t}=(0,I.Bd)(),n=gr(),a=ky(e),{data:i}=dd(xl`/credential_types/`),r=Boolean(i&&i.actions&&i.actions.POST);return(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create credential type"),isDisabled:r?void 0:t("You do not have permission to create a credential type. Please contact your system administrator if there is an issue with your access."),href:`${n(fc.CreateCredentialType)}`},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete credential types"),onClick:a,isDanger:!0}]),[t,r,n,a])}(r.unselectItemsAndRefresh),d=Sy(r.unselectItemsAndRefresh),{data:u}=dd(xl`/credential_types/`),m=Boolean(u&&u.actions&&u.actions.POST);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Credential Types"),description:e("Define custom credential types to support authentication with other systems during automation."),titleHelpTitle:e("Credential Types"),titleHelp:e("Define custom credential types to support authentication with other systems during automation."),titleDocLink:pc(t,"credentialTypes"),headerActions:(0,z.jsx)(cd,{type:"credential_type"})}),(0,z.jsx)($s,{id:"awx-credential-types",toolbarFilters:n,toolbarActions:c,tableColumns:a,rowActions:d,errorStateTitle:e("Error loading credential types"),emptyStateTitle:e(m?"There are currently no credential types added.":"You do not have permission to create a credential type."),emptyStateDescription:e(m?"Please create a credential type by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:m?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:m?e("Create credential type"):void 0,emptyStateButtonClick:m?()=>i(fc.CreateCredentialType):void 0,...r})]})}function Iy(e){const{t}=(0,I.Bd)(),n=qp({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete execution environments",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} execution environments.",{count:a.length}),actionButtonText:t("Delete execution environments",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/execution_environments/${e.id.toString()}/`,t)})}}function Ay({onDelete:e,onCopy:t}){const{t:n}=(0,I.Bd)(),a=yr(),i=Iy(e),r=ue(),c=td();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:yc.oo,variant:g.Ak.primary,isPinned:!0,label:n("Edit execution environment"),isDisabled:e=>Ig(e,n),onClick:e=>a(fc.EditExecutionEnvironment,{params:{id:e.id}})},{type:s.Button,selection:o.Single,icon:yo.Td,isPinned:!1,label:n("Copy execution environment"),isDisabled:e=>Eg(e,n),onClick:e=>{const a={variant:"success",title:n(`${e.name} copied.`),timeout:2e3};c(xl`/execution_environments/${e?.id.toString()??""}/copy/`,{name:`${e.name} @ ${(new Date).toTimeString()}`}).then((async e=>{r.addAlert(a),await t(e)})).catch((e=>{r.replaceAlert(a,{variant:"danger",title:n("Failed to copy execution environment"),children:e instanceof Error&&e.message})}))}},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete execution environment"),isHidden:e=>e.managed,isDisabled:e=>Ag(e,n),onClick:e=>i([e]),isDanger:!0}]),[a,i,r,c,t,n])}function Dy(){const e=(0,Re.g)(),{t}=(0,I.Bd)(),n=gr(),a=yr(),{data:s}=tc(xl`/execution_environments/`,e.id),o=Ay({onDelete:()=>a(fc.ExecutionEnvironments),onCopy:e=>a(fc.ExecutionEnvironmentDetails,{params:{id:e.id}})}),i=Tg("execution_environment");return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t(`${s?.name}`),breadcrumbs:[{label:t("Execution Environments"),to:n(fc.ExecutionEnvironments)},{label:s?.name??""}],headerActions:(0,z.jsx)(oe,{actions:[...i,...o],position:te.nU.right,selectedItem:s})}),(0,z.jsx)(Nc,{backTab:{label:t("Back to Execution Environments"),page:fc.ExecutionEnvironments,persistentFilterKey:"execution_environments"},tabs:s?.managed||null===s?.organization?[{label:t("Details"),page:fc.ExecutionEnvironmentDetails},{label:t("Templates"),page:fc.ExecutionEnvironmentTemplates}]:[{label:t("Details"),page:fc.ExecutionEnvironmentDetails},{label:t("Templates"),page:fc.ExecutionEnvironmentTemplates},{label:t("Team Access"),page:fc.ExecutionEnvironmentTeamAccess},{label:t("User Access"),page:fc.ExecutionEnvironmentUserAccess}],params:{id:s?.id??""}})]})}function Ey({url:e,hideOrgColumn:t}){const{t:n}=(0,I.Bd)(),a=yr(),i=Up({url:e}),r=qp(),c=t?r.filter((e=>"Organization"!==e.header)):r,d=Uc({url:e||xl`/execution_environments/`,toolbarFilters:i,tableColumns:r}),{data:u}=dd(e||xl`/execution_environments/`),m=Ay({onDelete:d.unselectItemsAndRefresh,onCopy:d.refresh}),p=Boolean(u&&u.actions&&u.actions.POST),h=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Iy(e.unselectItemsAndRefresh),{data:i}=dd(xl`/execution_environments/`),r=Boolean(i&&i.actions&&i.actions.POST);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create execution environment"),isDisabled:r?void 0:t("You do not have permission to create an execution environment. Please contact your organization administrator if there is an issue with your access."),onClick:()=>n(fc.CreateExecutionEnvironment)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete execution environments"),isDisabled:e=>Dg(e,t),onClick:a,isDanger:!0}]),[t,r,a,n])}(d);return(0,z.jsx)($s,{id:"awx-execution-environments-table",toolbarFilters:i,toolbarActions:h,tableColumns:c,rowActions:m,errorStateTitle:n("Error loading execution environments"),emptyStateTitle:n(p?"No execution environments yet":"You do not have permission to create an execution environment."),emptyStateDescription:n(p?"To get started, create an execution environment.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:p?n("Create execution environment"):void 0,emptyStateButtonClick:p?()=>a(fc.CreateExecutionEnvironment):void 0,...d,defaultSubtitle:n("Execution environment")})}function Py(){const{t:e}=(0,I.Bd)(),t=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Execution Environments"),description:e("An execution environment allows you to have a customized image to run jobs."),titleHelpTitle:e("Execution Environments"),titleHelp:[e("An execution environment allows you to have a customized image to run jobs."),e("Execution environments are container images that make it possible to incorporate system-level dependencies and collection-based content. Each execution environment allows you to have a customized image to run jobs, and each of them contain only what you need when running the job, nothing more.")],titleDocLink:pc(t,"executionEnvironments"),headerActions:(0,z.jsx)(cd,{type:"execution_environment"})}),(0,z.jsx)(Ey,{hideOrgColumn:!1})]})}function Ry(){const e=(0,Re.g)(),{data:t}=tc(xl`/execution_environments/`,e.id);return t?(0,z.jsx)(By,{execution_env:t}):null}function By(e){const{t}=(0,I.Bd)(),n=gr(),a=yr(),s=e.execution_env;return(0,z.jsxs)(Mt,{"data-cy":"execution-environment-page-detail",children:[(0,z.jsx)(Ft,{"data-cy":"execution-environment-name",label:t("Name"),children:s.name}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-image",label:t("Image"),helpText:(0,z.jsxs)("span",{children:[t("The full image location, including the container registry, image name, and version tag."),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),t("Examples"),(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:(0,z.jsx)("b",{children:"quay.io/ansible/awx-ee:latest"})})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:(0,z.jsx)("b",{children:"repo/project/image-name:tag"})})})]})]}),children:s.image}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-description",label:t("Description"),children:s.description}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-managed",label:t("Managed"),children:`${s.managed}`}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-org",label:t("Organization"),children:s.summary_fields?.organization?(0,z.jsx)(Fe,{text:s.summary_fields?.organization?.name,to:n(fc.OrganizationDetails,{params:{id:s.summary_fields?.organization?.id}})}):t("Globally Available")}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-pull",label:t("Pull"),children:""===s.pull?t("Missing"):s.pull}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-reg-cred",label:t("Registry Credential"),children:s?.summary_fields?.credential?.name?(0,z.jsx)(Ee.J,{variant:"outline",color:"blue",children:s?.summary_fields?.credential?.name}):void 0}),(0,z.jsx)(Ft,{"data-cy":"execution-environment-created",label:t("Created"),children:(0,z.jsx)(Ie,{value:s.created,author:s?.summary_fields?.created_by?.username,onClick:()=>a(fc.UserDetails,{params:{id:s?.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{"data-cy":"execution-environment-modified",value:s.modified,author:s?.summary_fields?.modified_by?.username,onClick:()=>a(fc.UserDetails,{params:{id:s?.summary_fields?.modified_by?.id}})})]})}const Fy={Always:"Always pull container before running.",Missing:"Only pull the image if not present before running.",Never:"Never pull container before running."};function Ny(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),[a]=jr(),s=td(),o=gr(),i={image:a.get("image")??""};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create execution environment"),breadcrumbs:[{label:e("Execution Environments"),to:o(fc.ExecutionEnvironments)},{label:e("Create execution environment")}]}),(0,z.jsx)(nd,{submitText:e("Create execution environment"),onSubmit:async e=>{const t=await s(xl`/execution_environments/`,e);n(fc.ExecutionEnvironmentDetails,{params:{id:t.id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:i,children:(0,z.jsx)(My,{mode:"create"})})]})}function $y(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=(0,Re.g)(),{data:s}=(0,_e.Ay)(xl`/execution_environments/${a.id??""}/`,nl,cl),o=gr();return s?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.name?e("Edit {{executionenvironmentName}}",{executionenvironmentName:s?.name}):e("Execution Environment"),breadcrumbs:[{label:e("Execution Environments"),to:o(fc.ExecutionEnvironments)},{label:s?.name?e("Edit {{executionenvironmentName}}",{executionenvironmentName:s?.name}):e("Execution Environment")}]}),(0,z.jsx)(nd,{submitText:e("Save execution environment"),onSubmit:async e=>{const t=await sl(xl`/execution_environments/${a.id??""}/`,e);n(fc.ExecutionEnvironmentDetails,{params:{id:t.id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:s,children:(0,z.jsx)(My,{mode:"edit",executionEnv:s})})]}):(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{breadcrumbs:[{label:e("Execution Environments"),to:o(fc.ExecutionEnvironments)},{label:e("Edit Execution Environment")}]})})}function My(e){const{t}=(0,I.Bd)(),n=!e.executionEnv?.organization;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:t("Name"),placeholder:t("Enter a name"),isRequired:!0,isDisabled:e?.executionEnv?.managed||!1,maxLength:150}),(0,z.jsx)(li,{name:"image",label:t("Image"),labelHelp:(0,z.jsxs)("span",{children:[t("The full image location, including the container registry, image name, and version tag."),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),t("Examples"),(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:(0,z.jsx)("b",{children:"quay.io/ansible/awx-ee:latest"})})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:(0,z.jsx)("b",{children:"repo/project/image-name:tag"})})})]})]}),isDisabled:e?.executionEnv?.managed||!1,placeholder:t("Enter an image"),isRequired:!0,maxLength:150}),(0,z.jsx)(ti,{name:"pull",label:t("Pull"),placeholderText:t("---------"),options:[{label:t(`${Fy.Always}`),value:"always"},{label:t(`${Fy.Missing}`),value:"missing"},{label:t(`${Fy.Never}`),value:"never"}]}),(0,z.jsx)(li,{name:"description",label:t("Description"),placeholder:t("Enter a description"),isDisabled:e?.executionEnv?.managed||!1}),"edit"===e.mode&&n?(0,z.jsx)(sg,{name:"organization",isDisabled:t("Globally available execution environment can not be reassigned to a specific Organization."),helperText:t("Leave this field blank to make the execution environment globally available.")}):void 0,"edit"!==e.mode||n?void 0:(0,z.jsx)(sg,{name:"organization",helperText:t("Leave this field blank to make the execution environment globally available.")}),"create"===e.mode?(0,z.jsx)(sg,{name:"organization",helperText:t("Leave this field blank to make the execution environment globally available."),isRequired:!1}):void 0,(0,z.jsx)(Hp,{name:"credential",label:t("Registry credential"),labelHelp:t("Credential to authenticate with a protected container registry."),placeholder:t("Select registry credential"),isDisabled:e?.executionEnv?.managed?t("Disabled"):void 0,queryParams:{credential_type__namespace:"registry"}})]})}function Ly(){const{id:e=""}=(0,Re.g)();return(0,z.jsx)(Og,{url:xl`/unified_job_templates/`,executionEnvironmentId:e})}function Oy(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/execution_environments/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{executionenvironmentName}}.",{executionenvironmentName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"executionenvironment",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{executionenvironmentName}}.",{executionenvironmentName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Execution Environments"),to:t(fc.ExecutionEnvironments)},{label:s?.name,to:t(fc.ExecutionEnvironmentDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.ExecutionEnvironmentTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"awx.executionenvironment",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.ExecutionEnvironmentTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.ExecutionEnvironmentTeamAccess,{params:{id:s?.id}})}})]})}function zy(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/execution_environments/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{executionenvironmentName}}.",{executionenvironmentName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"executionenvironment",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{executionenvironmentName}}.",{executionenvironmentName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Execution Environments"),to:t(fc.ExecutionEnvironments)},{label:a?.name,to:t(fc.ExecutionEnvironmentDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.ExecutionEnvironmentUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"awx.executionenvironment",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.ExecutionEnvironmentUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.ExecutionEnvironmentUserAccess,{params:{id:a?.id}})}})]})}function Hy(){const e=(0,Re.g)(),t=yr(),{data:n}=tc(xl`/execution_environments/`,e.id);return(0,l.useEffect)((()=>{(n?.managed||null===n?.organization)&&t(fc.ExecutionEnvironmentDetails,{params:{id:n?.id}})}),[t,n?.managed,n?.organization,n?.id]),(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"executionenvironment",addRolesRoute:fc.ExecutionEnvironmentAddTeams})}function qy(){const e=(0,Re.g)(),t=yr(),{data:n}=tc(xl`/execution_environments/`,e.id);return(0,l.useEffect)((()=>{(n?.managed||null===n?.organization)&&t(fc.ExecutionEnvironmentDetails,{params:{id:n?.id}})}),[t,n?.managed,n?.organization,n?.id]),(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"executionenvironment",addRolesRoute:fc.ExecutionEnvironmentAddUsers})}function Uy(e){const{data:t,refresh:n,error:a}=tc(xl`/hosts`,e.toString());return{host:t,refresh:n,error:a}}function Wy(e){const t=yr(),n=pu({...e,onClick:(0,l.useCallback)((e=>t(fc.HostDetails,{params:{id:e.id}})),[t])}),a=hu({tableViewOption:void 0,disableSort:!1}),s=yu(fc.InventoryDetails,{tableViewOption:void 0}),o=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Activity"),cell:t=>{const n=t.summary_fields.recent_jobs.map((e=>({...e,canceled_on:null})));return t.summary_fields?.recent_jobs&&t.summary_fields.recent_jobs.length>0?(0,z.jsx)(Ph,{jobs:n}):e("No job data available")},table:zt.expanded,card:"hidden",list:"hidden"})),[e])}();return(0,l.useMemo)((()=>[n,a,s,o]),[n,a,s,o])}function Jy(e){const{t}=(0,I.Bd)(),n=Wy({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete hosts",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} hosts.",{count:a.length}),actionButtonText:t("Delete hosts",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/hosts/${e.id.toString()}/`,t)})}}function Vy(e,t){const{t:n}=(0,I.Bd)(),a=yr(),i=Jy(e),r=(0,Re.g)(),c=(0,l.useCallback)((async(e,n)=>{const a=await sl(xl`/hosts/${e.id.toString()}/`,{enabled:n});t(a)}),[t]),d=(0,l.useMemo)((()=>[{type:s.Switch,ariaLabel:e=>n(e?"Click to disable host":"Click to enable host"),selection:o.Single,onToggle:(e,t)=>c(e,t),isSwitchOn:e=>!!e.enabled,label:n("Host enabled"),labelOff:n("Host disabled"),showPinnedLabel:!1,isPinned:!0,isDisabled:e=>Ig(e,n),tooltip:n("Indicates if a host is available and should be included in running jobs. For hosts that are part of an external inventory, this may be reset by the inventory sync process.")},{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,variant:g.Ak.primary,label:n("Edit host"),onClick:e=>{r.id&&r.inventory_type?a(fc.InventoryHostEdit,{params:{id:r.id,inventory_type:r.inventory_type,host_id:e.id}}):r.id?a(fc.EditHost,{params:{id:r.id}}):a(fc.EditHost,{params:{id:e.id}})},isDisabled:e=>Ig(e,n)},{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete host"),isDisabled:e=>Ag(e,n),onClick:e=>{i([e])},isDanger:!0}]),[n,c,a,r.id,r.inventory_type,i]);return"smart_inventory"===r.inventory_type||"constructed_inventory"===r.inventory_type?[]:d}function Gy(){const e=Tg("host"),{t}=(0,I.Bd)(),n=yr(),a=(0,Re.g)(),{host:s,refresh:o,error:i}=Uy(a.id),r=gr(),l=Vy((e=>{n(fc.Hosts,{params:{id:a.id}})}),o);return i?(0,z.jsx)(Ic,{error:i,handleRefresh:o}):s?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.name,breadcrumbs:[{label:t("Hosts"),to:r(fc.Hosts)},{label:s?.name}],headerActions:(0,z.jsx)(oe,{actions:[...e,...l],position:te.nU.right,selectedItem:s})}),(0,z.jsx)(Nc,{backTab:{label:t("Back to Hosts"),page:fc.Hosts,persistentFilterKey:"hosts"},tabs:[{label:t("Details"),page:fc.HostDetails},{label:t("Facts"),page:fc.HostFacts},{label:t("Groups"),page:fc.HostGroups},{label:t("Jobs"),page:fc.HostJobs}],params:{id:s.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Yy(){return Pp({optionsPath:"hosts",preSortedKeys:["name","description","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:"hosts"},id:{apiPath:"hosts"}},additionalFilters:[Np(),$p()],removeFilters:["last_job_host_summary"]})}function Ky(){const{t:e}=(0,I.Bd)(),t=yr(),n=Yy(),a=Wy(),i=Uc({url:xl`/hosts/`,toolbarFilters:n,tableColumns:a}),r=sc(),c=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Jy(e.unselectItemsAndRefresh),{data:i}=dd(xl`/hosts/`),r=Boolean(i&&i.actions&&i.actions.POST);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create host"),isDisabled:r?void 0:t("You do not have permission to create a host. Please contact your system administrator if there is an issue with your access."),onClick:()=>n(fc.CreateHost)},{type:s.Button,selection:o.None,variant:g.Ak.secondary,isPinned:!0,label:t("Smart inventory"),isDisabled:()=>e?.filterState&&0!==Object.keys(e.filterState).length?"":"Enter at least one search filter to create a new Smart Inventory",onClick:()=>n(fc.CreateSmartInventory,{query:{...e.filterState}})},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete hosts"),onClick:a,isDanger:!0,isDisabled:e=>Dg(e,t)}]),[n,a,r,e.filterState,t])}(i),d=Vy(i.unselectItemsAndRefresh,i.updateItem),{data:u}=dd(xl`/hosts/`),m=Boolean(u&&u.actions&&u.actions.POST);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Hosts"),description:e("A system managed by {{product}}, which may include a physical, virtual, cloud-based server, or other device.",{product:"AWX"}),titleHelpTitle:e("Hosts"),titleHelp:[e("A system managed by {{product}}, which may include a physical, virtual, cloud-based server, or other device. Typically an operating system instance. Hosts are contained in Inventory. Sometimes referred to as a “node”.",{product:"AWX"}),e("Ansible works against multiple managed nodes or “hosts” in your infrastructure at the same time, using a list or group of lists known as inventory. Once your inventory is defined, you use patterns to select the hosts or groups you want Ansible to run against.")],titleDocLink:pc(r,"hosts"),headerActions:(0,z.jsx)(cd,{type:"host"})}),(0,z.jsx)($s,{id:"awx-hosts-table",toolbarFilters:n,toolbarActions:c,tableColumns:a,rowActions:d,errorStateTitle:e("Error loading hosts"),emptyStateTitle:e(m?"There are currently no hosts added":"You do not have permission to create a host."),emptyStateDescription:e(m?"Please create a host by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:m?e("Create host"):void 0,emptyStateButtonClick:m?()=>t(fc.CreateHost):void 0,...i,defaultSubtitle:e("Host")})]})}function Zy(e){const{t}=(0,I.Bd)(),n=If({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=td(),r=e=>!e.summary_fields?.user_capabilities?.start&&kf(e.status)?t("The job cannot be canceled due to insufficient permission"):"",c=e=>kf(e.status)?"":t("The job cannot be canceled because it is not running");return a=>{const l=a.filter(c),d=a.filter((e=>kf(e.status))).filter(r);o({title:t("Cancel jobs",{count:a.length}),confirmText:t("Yes, I confirm that I want to cancel these {{count}} jobs.",{count:a.length-d.length-l.length}),actionButtonText:t("Cancel jobs",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length||d.length?[...l.length?[t("{{count}} of the selected jobs cannot be canceled because they are not running.",{count:l.length})]:[],...d.length?[t("{{count}} of the selected jobs cannot be cancelled due to insufficient permissions.",{count:d.length})]:[]]:void 0,isItemNonActionable:e=>c(e)?c(e):r(e),keyFn:ll,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:e=>i(`${wf(e.type)}${e.id}/cancel/`,{})})}}function Xy(e){const{t}=(0,I.Bd)(),n=If({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=e=>e.summary_fields.user_capabilities.delete||kf(e.status)?"":t("The job cannot be deleted due to insufficient permission"),r=e=>kf(e.status)?t("The job cannot be deleted because it is running"):"";return a=>{const l=a.filter(r),c=a.filter((e=>!kf(e.status))).filter(i);o({title:t("Permanently delete jobs",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} jobs.",{count:a.length-c.length-l.length}),actionButtonText:t("Delete jobs",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length||c.length?[...l.length?[t("{{count}} of the selected jobs cannot be deleted because they are running.",{count:l.length})]:[],...c.length?[t("{{count}} of the selected jobs cannot be deleted due to insufficient permissions.",{count:c.length})]:[]]:void 0,isItemNonActionable:e=>r(e)?r(e):i(e),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(`${wf(e.type)}${e.id}/`,t)})}}function Qy(e){const t=ue(),{t:n}=(0,I.Bd)(),a=(0,Re.Zp)(),s=td(),o=Ah(),i=yr();return async r=>{if(!Sf)return Promise.reject(new Error("Unable to retrieve launch configuration"));try{let t;switch(r.type){case"ad_hoc_command":case"workflow_job":case"job":case"inventory_update":case"project_update":t=await nl(Sf(r))}if(t.passwords_needed_to_start&&t.passwords_needed_to_start?.length)return void i(fc.TemplateLaunchWithPasswordsWizard,{params:{id:r.id,job_type:"playbook"}});{let t;switch(r.type){case"ad_hoc_command":case"workflow_job":case"inventory_update":case"project_update":t=await s(Sf(r),{});break;case"job":t=await s(Sf(r),{...e})}a(o(t))}}catch(e){t.addAlert({variant:"danger",title:n("Failed to relaunch job"),children:e instanceof Error&&e.message,timeout:2e3})}}}function ex(){const{t:e}=(0,I.Bd)(),t=Qy(),n=Qy({hosts:"all"}),a=Qy({hosts:"failed"});return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,variant:g.Ak.primary,isPinned:!0,icon:mb.Ab,label:e("Relaunch job"),isHidden:e=>!("system_job"!==e.type&&e.summary_fields?.user_capabilities?.start)||"failed"===e.status&&"job"===e.type,onClick:e=>{t(e)}},{type:s.Dropdown,selection:o.Single,isPinned:!0,icon:mb.Ab,label:e("Relaunch using host parameters"),isHidden:e=>!("system_job"!==e.type&&e.summary_fields?.user_capabilities?.start&&"failed"===e.status&&"job"===e.type),actions:[{type:s.Button,selection:o.Single,label:e("Relaunch on all hosts"),onClick:e=>{n(e)}},{type:s.Button,selection:o.Single,label:e("Relaunch on failed hosts"),onClick:e=>{a(e)}}]}]),[e,n,a,t])}const tx=(e,t)=>kf(e.status)?e.summary_fields.user_capabilities.start?"":t("The job cannot be canceled due to insufficient permission"):t("The job cannot be canceled because it is not running");function nx(e={}){return Pp({optionsPath:"unified_jobs",preSortedKeys:["name","description","status"],preFilledValueKeys:{name:{apiPath:"unified_jobs",queryParams:e},id:{apiPath:"unified_jobs",queryParams:e}}})}function ax(e){const{t}=(0,I.Bd)(),n=nx(e.queryParams??{}),a=e.columns,i=Uc({url:xl`/unified_jobs/`,toolbarFilters:n,tableColumns:a,queryParams:e?.queryParams??{}}),r=function(e){const{t}=(0,I.Bd)(),n=Xy(e),a=Zy(e),i=ex();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,variant:g.Ak.secondary,isPinned:!0,icon:Nd.Kf,label:t("Cancel job"),isHidden:e=>Boolean(tx(e,t)),onClick:e=>a([e])},...i,{type:s.Button,selection:o.Single,icon:Nd.Kf,label:t("Cancel job"),isDisabled:e=>tx(e,t),isHidden:e=>Boolean(!tx(e,t)),onClick:e=>a([e])},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete job"),isDisabled:e=>(e=>e.summary_fields.user_capabilities.delete?kf(e.status)?t("The job cannot be deleted due to a running job status"):"":t("The job cannot be deleted due to insufficient permission"))(e),onClick:e=>n([e]),isDanger:!0}]),[n,a,i,t])}(i.unselectItemsAndRefresh),c=function(e){const{t}=(0,I.Bd)(),n=Xy(e),a=Zy(e);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Multiple,icon:eu.tP,label:t("Cancel jobs"),onClick:a},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete jobs"),onClick:n,isDanger:!0}]),[n,a,t])}(i.unselectItemsAndRefresh);return Fc("jobs"),(0,z.jsx)($s,{id:"awx-jobs-table",toolbarFilters:n,tableColumns:a,rowActions:r,toolbarActions:c,errorStateTitle:t("Error loading jobs"),emptyStateTitle:t("No jobs yet"),emptyStateDescription:t("Please run a job to populate this list."),emptyStateIcon:Xa.IN,...i})}function sx(e,t,n,s,o,i){const{t:r}=(0,I.Bd)(),c=Tf();return(0,l.useMemo)((()=>({header:r("Launched by"),cell:e=>{const{value:t,link:n}=c(e)??{};return n?(0,z.jsx)(a.N_,{to:`${n}`,children:t}):t},table:e??zt.expanded,card:t??qt.hidden,list:n??Ht.hidden,defaultSortDirection:i??"desc",modal:s??Ut.hidden,dashboard:o??Wt.hidden})),[t,o,i,n,s,r,e,c])}function ox(e,t,n,s,o,i){const{t:r}=(0,I.Bd)(),c=gr();return(0,l.useMemo)((()=>({header:r("Job template"),cell:e=>(0,z.jsx)(a.N_,{to:c(fc.JobTemplateDetails,{params:{id:e.summary_fields?.job_template?.id}}),children:e.summary_fields?.job_template?.name}),value:e=>!!e.summary_fields?.job_template,table:e??zt.expanded,card:t??qt.hidden,list:n??Ht.hidden,defaultSortDirection:i??"desc",modal:s??Ut.hidden,dashboard:o??Wt.hidden})),[t,o,i,c,n,s,r,e])}function ix(e,t,n,s,o,i){const{t:r}=(0,I.Bd)(),c=gr();return(0,l.useMemo)((()=>({header:r("Source workflow job"),cell:e=>(0,z.jsx)(a.N_,{to:c(fc.JobDetails,{params:{job_type:"workflow",id:e.summary_fields.source_workflow_job?.id}}),children:e.summary_fields.source_workflow_job?.name}),value:e=>!!e.summary_fields?.source_workflow_job,table:e??zt.expanded,card:t??qt.hidden,list:n??Ht.hidden,defaultSortDirection:i??"desc",modal:s??Ut.hidden,dashboard:o??Wt.hidden})),[t,o,i,c,n,s,r,e])}function rx(e,t,n,a,s,o){const{t:i}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:i("Job slice"),cell:e=>(0,z.jsx)("span",{children:`${e.job_slice_number??0}/${(e.job_slice_count??0).toString()}`}),value:e=>e.job_slice_count,table:e??zt.expanded,card:t??qt.hidden,list:n??Ht.hidden,defaultSortDirection:o??"desc",modal:a??Ut.hidden,dashboard:s??Wt.hidden})),[t,s,o,n,a,i,e])}function lx(e,t,n,s,o,i){const{t:r}=(0,I.Bd)(),c=gr();return(0,l.useMemo)((()=>({header:r("Execution environment"),cell:e=>(0,z.jsx)(a.N_,{to:c(fc.ExecutionEnvironmentDetails,{params:{id:e.summary_fields.execution_environment?.id}}),children:e.summary_fields.execution_environment?.name}),value:e=>"workflow_job"!==e.type&&!kf(e.status)&&"canceled"!==e.status&&!!e.summary_fields?.execution_environment,table:e??zt.expanded,card:t??qt.hidden,list:n??Ht.hidden,defaultSortDirection:i??"desc",modal:s??Ut.hidden,dashboard:o??Wt.hidden})),[t,o,i,c,n,s,r,e])}function cx(e){const t=yr(),{t:n}=(0,I.Bd)(),a=(0,l.useMemo)((()=>({header:n("ID"),cell:e=>e.id,sort:"id",card:"hidden",list:"hidden",dashboard:"hidden",minWidth:0})),[n]),s=(0,l.useMemo)((()=>({project_update:"project",inventory_update:"inventory",job:"playbook",ad_hoc_command:"command",system_job:"management",workflow_job:"workflow"})),[]),o=pu({...e,onClick:(0,l.useCallback)((e=>t(fc.JobDetails,{params:{id:e.id,job_type:s[e.type]}})),[s,t]),defaultSort:!1}),i=(0,l.useMemo)((()=>({header:n("Status"),cell:e=>(0,z.jsx)(au,{status:e.status}),sort:"status"})),[n]),r=(0,l.useMemo)((()=>({header:n("Started"),cell:e=>(0,z.jsx)(Ie,{value:e.started}),sort:"started"})),[n]),c=(0,l.useMemo)((()=>({header:n("Finished"),cell:e=>(0,z.jsx)(Ie,{value:e.finished}),sort:"finished",defaultSortDirection:"desc",defaultSort:!0})),[n]),d=sx(),u=yu(fc.InventoryDetails),m=rx(),p=ox(),h=ix(),b=xu(fc.ProjectDetails),f=lx();return(0,l.useMemo)((()=>[a,o,i,r,c,d,p,h,u,b,f,m]),[a,o,i,r,c,d,p,h,u,b,f,m])}function dx(){Fc("inventories");const e=cx(),{id:t=""}=(0,Re.g)(),n={job__hosts:t,not__launch_type:"sync"};return(0,z.jsx)(ax,{queryParams:n,columns:e})}function ux(e){const{t}=(0,I.Bd)(),n=ah({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=e=>e?.summary_fields?.user_capabilities?.delete?void 0:t("The inventory cannot be deleted due to insufficient permission.");return a=>{const r=a.filter(i);o({title:t("Permanently delete inventories",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} inventories.",{count:a.length-r.length}),actionButtonText:t("Delete inventories",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/inventories/${e.id.toString()}/`,t),alertPrompts:r.length>0?[t("{{count}} of the selected inventories cannot be deleted due to insufficient permission.",{count:r.length})]:void 0,isItemNonActionable:i})}}function mx({onInventoriesDeleted:e,onInventoryCopied:t=()=>null,detail:n}){const{t:a}=(0,I.Bd)(),i=yr(),r=ux(e),c=function(e){const{t}=(0,I.Bd)(),n=td(),a=ue();return s=>{const o={variant:"success",title:t(`${s.name} copied.`),timeout:2e3};n(xl`/inventories/${s.id.toString()}/copy/`,{name:`${s.name} @ ${(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")}`}).then((()=>{a.addAlert(o)})).catch((e=>{a.replaceAlert(o,{variant:"danger",title:t("Failed to copy inventory"),children:e instanceof Error&&e.message})})).finally(e)}}(t),[d,u]=(0,l.useState)(void 0),[m,p]=(0,l.useState)(void 0),h=(0,Re.g)(),b=ue(),f=(0,l.useCallback)((async()=>{try{await al(xl`/inventory_updates/${d?.toString()||""}/cancel/`,void 0),p(!0)}catch(e){if("SyntaxError: Unexpected end of JSON input"===e?.toString())return;b.addAlert({variant:"danger",title:a("Failed to cancel inventory source"),children:e instanceof Error&&e.message,timeout:5e3})}}),[b,a,d]),y=(0,l.useCallback)((async e=>{try{const t=await al(xl`/inventory_sources/${e.source?.id.toString()||""}/update/`,{});u(t.inventory_update),p(!1)}catch(e){b.addAlert({variant:"danger",title:a("Failed to update inventory source"),children:e instanceof Error&&e.message,timeout:5e3})}}),[b,a]);return(0,l.useMemo)((()=>{const e=e=>e?.source?.summary_fields?.user_capabilities?.start?"":a("The inventory cannot be synced due to insufficient permission"),t={"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"};return[{type:s.Button,selection:o.Single,icon:yc.oo,variant:g.Ak.primary,isPinned:!0,label:a("Edit inventory"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.edit?"":a("The inventory cannot be edited due to insufficient permission"))(e),onClick:e=>i(fc.EditInventory,{params:{inventory_type:t[e.kind],id:e.id}})},{type:s.Button,selection:o.Single,icon:yo.Td,label:a("Copy inventory"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.copy?e?.has_inventory_sources?a("Inventories with sources cannot be copied"):"":a("The inventory cannot be copied due to insufficient permission"))(e),onClick:e=>c(e)},{type:s.Button,selection:o.Single,icon:Tc.Fj,isPinned:!0,label:a("Sync inventory"),isDisabled:t=>e(t),onClick:e=>y(e),isHidden:e=>!("constructed_inventory"===h.inventory_type&&!0===n&&(!0!==px(e)||!0===m))},{type:s.Button,selection:o.Single,icon:Tc.Fj,isPinned:!0,label:a("Cancel Sync"),isDisabled:t=>e(t),onClick:()=>f(),isHidden:e=>!("constructed_inventory"===h.inventory_type&&!0===n&&!0===px(e)&&void 0!==d&&!0!==m)},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:a("Delete inventory"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.delete?"":a("The inventory cannot be deleted due to insufficient permission"))(e),onClick:e=>r([e]),isDanger:!0}]}),[r,c,i,a,h.inventory_type,n,f,y,m,d])}function px(e){const t=e?.source?.summary_fields?.current_job||e?.source?.summary_fields?.last_job||void 0;let n;if(t){const e=t.status;n="pending"===e||"running"===e||"waiting"===e}return n}function hx(){const{t:e}=(0,I.Bd)(),t=Tg("inventory"),n=(0,Re.g)(),a="constructed_inventory"===n.inventory_type?"constructed_inventories":"inventories",s=(0,Re.zy)(),o=gr()(fc.InventoryDetails,{params:{inventory_type:n.inventory_type,id:n.id}}),i=s.pathname===o,r=ec(xl`/${a}/${n.id||""}/`),c=r?.data,d=ec("constructed"===c?.kind&&!0===i?xl`/inventories/${n.id??""}/inventory_sources/`:""),u=d.data?.results[0],m=(0,l.useMemo)((()=>c?{...c,source:u}:void 0),[c,u]),p=d.refresh;dc({control:["limit_reached_1"],jobs:["status_changed"]},(0,l.useCallback)((e=>{if("jobs"===e?.group_name)switch(e?.type){case"job":case"workflow_job":case"project_update":case"inventory_update":p()}}),[p]));const h=yr(),b=mx({onInventoriesDeleted:()=>h(fc.Inventories),detail:i}),f=gr(),g="smart"===m?.kind,y="constructed"===m?.kind;return d.error?(0,z.jsx)(Ic,{error:d.error}):r.error?(0,z.jsx)(Ic,{error:r.error}):!r.data||!d.data&&"constructed_inventory"===n.inventory_type&&!0===i?(0,z.jsx)(zr,{}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:m?.name,breadcrumbs:[{label:e("Inventories"),to:f(fc.Inventories)},{label:m?.name}],headerActions:(0,z.jsx)(oe,{actions:[...t,...b],position:te.nU.right,selectedItem:m})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Inventories"),page:fc.Inventories,persistentFilterKey:"inventories"},tabs:[{label:e("Details"),page:fc.InventoryDetails},{label:e("User Access"),page:fc.InventoryUserAccess},{label:e("Team Access"),page:fc.InventoryTeamAccess},!g&&{label:e("Groups"),page:fc.InventoryGroups},{label:e("Hosts"),page:fc.InventoryHosts},!g&&!y&&{label:e("Sources"),page:fc.InventorySources},{label:e("Jobs"),page:fc.InventoryJobs},{label:e("Job Templates"),page:fc.InventoryJobTemplates}],params:n,componentParams:{inventory:m}})]})}function bx(e,t){const n="constructed_inventory"===t?"constructed_inventories":"inventories",{data:a}=ec(e?xl`/${n}/${e}/`:"");return a}function fx(){const[e,t]=(0,l.useState)(""),{t:n}=(0,I.Bd)(),a=(0,Re.Zp)(),s=yr(),o=gr(),i=gx("create"),r=td(),c=nc();(0,l.useEffect)((()=>{(async()=>{await async function(){if(i?.group_id){const e=await c(xl`/groups/${i?.group_id}/`);e?.name&&t(e.name)}}()})()}),[c,i?.group_id]);const d=bx(i.id,i.inventory_type);let u=[];return u=i.inventory_host?[{label:n("Inventories"),to:o(fc.Inventories)},{label:n(`${d?.name}`),to:o(fc.InventoryDetails,{params:{id:i.id,inventory_type:i.inventory_type}})},i?.group_id?{label:n("Groups"),id:"group",to:o(fc.InventoryGroups,{params:{id:i.group_id,inventory_type:i.inventory_type}})}:{label:n("Hosts"),id:"hosts",to:o(fc.InventoryHosts,{params:{id:i.id,inventory_type:i.inventory_type,host_id:i.host_id}})},i?.group_id?{label:n(`${e}`),to:o(fc.InventoryGroupDetails,{params:{id:i.group_id,inventory_type:i.inventory_type,group_id:i.group_id}})}:{},{label:n("Create host")}]:[{label:n("Hosts"),to:o(fc.Hosts)},{label:n("Create host")}],(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{breadcrumbs:u,title:n("Create host")}),(0,z.jsx)(nd,{submitText:n("Create host"),onSubmit:async e=>{const t=i.id||e.inventory?.id,n={...e,inventory:Number(t)},a=i?.group_id?await r(xl`/groups/${i.group_id}/hosts/`,n):await r(xl`/hosts/`,n);i.inventory_host?s(fc.InventoryHostDetails,{params:{inventory_type:i.inventory_type,id:t,host_id:a.id}}):s(fc.HostDetails,{params:{id:a.id}})},cancelText:n("Cancel"),onCancel:()=>a(-1),defaultValue:{name:"",description:"",variables:"---\n"},children:(0,z.jsx)(xx,{edit_mode:!1,inventory_host:i.inventory_host})})]})}function gx(e){const t=(0,Re.g)();let n=t.id,a=t.host_id,s=!1;return a||"edit"!==e||(a=n,n=void 0),n&&(s=!0),{id:n,host_id:a,inventory_type:t.inventory_type,group_id:t.group_id,inventory_host:s}}function yx(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=gr(),s=gx("edit"),{host:o}=Uy(s.host_id??""),[i,r]=(0,l.useState)(o);if((0,l.useEffect)((()=>r(o)),[o]),!i)return(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{})});const c={name:i.name,description:i.description,variables:i.variables,inventory:{name:i.summary_fields?.inventory?.name}};let d=[];return d=s.inventory_host?[{label:e("Inventories"),to:a(fc.Inventories)},{label:e(`${o?.summary_fields?.inventory?.name}`),to:a(fc.InventoryDetails,{params:{id:s.id,inventory_type:s.inventory_type}})},{label:e("Hosts"),to:a(fc.InventoryHosts,{params:{id:s.id,inventory_type:s.inventory_type,host_id:s.host_id}})},{label:e("Edit {{hostName}}",{hostName:i?.name})}]:[{label:e("Hosts"),to:a(fc.Hosts)},{label:e("Edit {{hostName}}",{hostName:i?.name})}],(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{breadcrumbs:d,title:e("Edit {{hostName}}",{hostName:i?.name})}),(0,z.jsx)(nd,{submitText:e("Save host"),onSubmit:async e=>{await sl(xl`/hosts/${s.host_id??""}/`,e),s.inventory_host?n(fc.InventoryHostDetails,{params:{inventory_type:s.inventory_type,id:s.id,host_id:s.host_id}}):n(fc.HostDetails,{params:{id:s.host_id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:c,children:(0,z.jsx)(xx,{edit_mode:!0,inventory_host:s.inventory_host})})]})}function xx(e){const{t}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:t("Name"),placeholder:t("Enter a name"),isRequired:!0,maxLength:150}),(0,z.jsx)(li,{name:"description",label:t("Description"),placeholder:t("Enter a description")}),!e.inventory_host&&e.edit_mode&&(0,z.jsx)(li,{name:"inventory.name",label:t("Inventory"),isDisabled:!0,labelHelp:t("The inventory that this host belongs to.")}),!e.inventory_host&&!e.edit_mode&&(0,z.jsx)(rh,{name:"inventory.id",isRequired:!0,labelHelp:t("Select the inventory that this host will belong to.")}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{format:"yaml",name:"variables",label:t("Variables")})})]})}function jx(){const e=(0,Re.g)();let t=e.id,n=e.host_id;return n||(n=t,t=void 0),{id:t,host_id:n,inventory_type:e.inventory_type}}function _x(){const e=jx(),{host:t}=Uy(e.host_id);return t?(0,z.jsx)(vx,{host:t}):null}function vx(e){const{t}=(0,I.Bd)(),n=yr(),a=gr(),s=jx(),o=e.host,i=o.summary_fields.recent_jobs.map((e=>({...e,canceled_on:null})));return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Name"),children:o.name}),i.length>0&&(0,z.jsx)(Ft,{label:t("Activity"),children:(0,z.jsx)(Ph,{jobs:i})}),(0,z.jsx)(Ft,{label:t("Description"),children:o.description}),(0,z.jsx)(Ft,{label:t("Inventory"),helpText:t("The inventory that this host belongs to."),children:(0,z.jsx)(Fe,{text:o.summary_fields?.inventory?.name,to:a(fc.InventoryDetails,{params:{id:o.summary_fields?.inventory?.id,inventory_type:(r=o.summary_fields?.inventory?.kind,"smart"===r?"smart_inventory":"constructed"===r?"constructed_inventory":"inventory")}})})}),("constructed_inventory"===s.inventory_type||"smart_inventory"===s.inventory_type)&&(0,z.jsx)(Ft,{label:t("Enabled"),children:(0,z.jsx)(Fe,{text:o.enabled?"On":"Off"})}),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:o.created,author:o.summary_fields?.created_by?.username,onClick:()=>n(fc.UserDetails,{params:{id:o.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:o.modified,author:o.summary_fields?.modified_by?.username,onClick:()=>n(fc.UserDetails,{params:{id:o.summary_fields?.modified_by?.id}})}),(0,z.jsx)(Wu,{label:t("Variables"),showCopyToClipboard:!0,value:o.variables||"---"})]});var r}function wx(e){return Pp({optionsPath:e||"groups",preFilledValueKeys:{name:{apiPath:e||"groups"},id:{apiPath:e||"groups"}},preSortedKeys:["name","id","description","created-by","modified-by"],additionalFilters:[Np(),$p()]})}function kx(e){const t=yr(),n=(0,Re.g)(),a=(0,l.useCallback)((a=>{t(fc.InventoryGroupDetails,{params:{id:!0===e?.useGroupInventory?a.summary_fields.inventory.id:n.id,group_id:a.id,inventory_type:!0===e?.useGroupInventory?Sx(a.summary_fields.inventory.kind):n.inventory_type}})}),[t,n.id,n.inventory_type,e?.useGroupInventory]),s=pu({...e,onClick:a});return(0,l.useMemo)((()=>[s]),[s])}function Sx(e){let t="";return""===e&&(t="inventory"),"smart"===e&&(t="smart_inventory"),"constructed"===e&&(t="constructed_inventory"),t}function Cx(e){const t=wx(`inventories/${e.inventoryId??""}/groups`),n=kx({disableLinks:!0}),a=Uc({url:xl`/inventories/${e.inventoryId??""}/groups/`,queryParams:{not__hosts:e.hostId??""},toolbarFilters:t,tableColumns:n});return(0,z.jsx)(Xs,{title:(0,po.t)("Select groups"),toolbarFilters:t,tableColumns:n,onSelect:e.onAdd,errorStateTitle:(0,po.t)("Error loading groups to associate"),emptyStateTitle:(0,po.t)("No groups available to add to host"),view:a})}function Tx(){const[e,t]=ss(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{t(n?(0,z.jsx)(Cx,{...n}):void 0)}),[n,t]),a}function Ix(e,t){const{t:n}=(0,I.Bd)(),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Vf();return a=>{o({title:n("Add host to groups",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,actionColumns:s,onComplete:e,actionFn:async(e,n)=>{await al(xl`/hosts/${t??""}/groups/`,{id:e.id},n)},processingText:n("Adding host to group...",{count:a.length})})}}var Ax=n(5433);function Dx(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)(""),s=td(),o=kd(),[i,r]=(0,l.useState)([]),[c,d]=(0,l.useState)("");return(0,z.jsx)(Zt.a,{titleIconVariant:"danger",title:t("Delete group"),variant:Zt.d.small,description:t("Are you sure you want to delete the groups below?"),isOpen:!0,onClose:e.onClose,"data-cy":"delete-groups-dialog",actions:[(0,z.jsx)(g.$n,{"data-cy":"delete-group-modal-delete-button",ouiaId:"delete-group-modal-delete-button",variant:"danger",onClick:()=>{(async()=>{const a=[],l=[];d("");for(const t of e.groups)if(!i.includes(t))try{"delete"===n?await o(xl`/groups/${t.id.toString()}/`):await s(xl`/inventories/${t.inventory.toString()}/groups/`,{id:t.id,disassociate:!0}),a.push(t)}catch(e){l.push(t)}let c="";r(a),l.length>0?(c=t("Deletion of those groups failed: "),l.forEach(((e,t)=>{0!==t&&(c+=", "),c+=e.name})),d(c)):(e.onDelete(),e.onClose())})()},isDisabled:""===n,"aria-label":t`Confirm delete`,children:t("Delete")},"delete"),(0,z.jsx)(g.$n,{ouiaId:"delete-group-modal-cancel-button",variant:"link",onClick:e.onClose,children:t("Cancel")},"cancel")],children:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Wo.E,{className:"pf-v5-u-pb-lg","data-cy":"delete-groups-dialog-names",children:e.groups.map((e=>(0,z.jsx)(Jo.j,{variant:"error",children:e.name},e.name)))}),(0,z.jsx)(Ax.s,{"data-cy":"delete-groups-dialog-radio-delete",isChecked:"delete"===n,name:"radio-delete-group",onChange:()=>{a("delete")},label:t("Delete all groups and hosts"),id:"radio-delete-group"}),(0,z.jsx)(Ax.s,{"data-cy":"delete-groups-dialog-radio-promote",isChecked:"promote"===n,name:"radio-promote-group",onChange:()=>{a("promote")},label:t("Promote child groups and hosts"),id:"radio-promote-group"}),c&&(0,z.jsx)(Ic,{error:new Error(c)})]})})}function Ex(e){const[t,n]=ss(),a=()=>n(void 0);return t=>{n((0,z.jsx)(Dx,{groups:t,onClose:a,onDelete:e}))}}function Px(e,t){const n=yr(),{t:a}=(0,I.Bd)(),i=dd(xl`/inventories/${e.id??""}/ad_hoc_commands/`).data,r=Boolean(i&&i.actions&&i.actions.POST),c=(0,l.useCallback)((t=>{const a=t.map((e=>e.name)).join(", "),s={};a.length<1800?a&&(s.limit=a):(s.storage="true",localStorage.setItem("runCommandActionSelectedItems",a)),n(fc.InventoryRunCommand,{params:{inventory_type:e.inventory_type,id:e.id},query:s})}),[n,e.inventory_type,e.id]),d=(0,l.useCallback)((()=>r?void 0:a("You do not have permission to run an ad hoc command. Please contact your organization administrator if there is an issue with your access.")),[r,a]),u=(0,l.useMemo)((()=>({type:s.Button,selection:o.None,variant:g.Ak.secondary,isPinned:void 0===t?.isPinned||t?.isPinned,label:a("Run command"),onClick:()=>{c(e.selectedItems||[])},isDisabled:()=>d()})),[a,t?.isPinned,c,d,e.selectedItems]),m=(0,l.useMemo)((()=>({type:s.Button,selection:o.Single,isPinned:t?.isPinned,icon:Jm.DP,label:a("Run command"),onClick:e=>{c([e])},isDisabled:()=>d()})),[a,c,d,t?.isPinned]);return"toolbar"===e.actionType?u:"row"===e.actionType?m:{}}function Rx(e){const{t}=(0,I.Bd)(),n=kx({useGroupInventory:!0}),a="host"===e.page,i=(0,Re.g)(),{host:r}=Uy(a?i.id??"":i.host_id??""),c=String(r?.inventory)??"",d=a?i.id??"":i.host_id??"",u=wx(`hosts/${d??""}/all_groups`),m=Uc({url:xl`/hosts/${d??""}/all_groups/`,toolbarFilters:u,tableColumns:n}),p=function(e,t,n,a){const{t:i}=(0,I.Bd)(),r=function(e,t){const{t:n}=(0,I.Bd)(),a=kx({disableLinks:!0,disableSort:!0}),s=pu({disableLinks:!0,disableSort:!0}),o=(0,l.useMemo)((()=>[s]),[s]),i=Lc();return s=>{i({title:n("Disassociate group from host?",{count:s.length}),confirmText:n("Yes, I confirm that I want to disassociate these {{count}} groups from the inventory.",{count:s.length}),actionButtonText:n("Disassociate groups",{count:s.length}),items:s.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:a,actionColumns:o,onComplete:e,actionFn:async(e,n)=>{await al(xl`/hosts/${t??""}/groups/`,{disassociate:!0,id:e.id},n)}})}}(e.unselectItemsAndRefresh,n),c=dd(xl`/groups/`).data,d=Boolean(c&&c.actions&&c.actions.POST),u=Tx(),m=Ix(e.unselectItemsAndRefresh,n),p=Px({...(0,Re.g)(),selectedItems:e.selectedItems||[],actionType:"toolbar"});return(0,l.useMemo)((()=>{const l=[];return l.push({type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:i("Associate group"),onClick:()=>u({onAdd:m,inventoryId:t??"",hostId:n??""}),isDisabled:()=>d?void 0:i("You do not have permission to create a host. Please contact your organization administrator if there is an issue with your access.")}),l.push({type:s.Seperator}),"inventoryHost"===a&&l.push(p),l.push({type:s.Seperator}),l.push({type:s.Button,selection:o.Multiple,label:i("Disassociate groups"),isDisabled:0===e.selectedItems.length?i("Select at least one item from the list"):void 0,onClick:r,isPinned:!0}),l}),[i,e.selectedItems.length,r,u,m,d,n,t,p,a])}(m,c,d,a?"standaloneHost":"inventoryHost"),h=function(e){const{t}=(0,I.Bd)(),n=yr(),{data:a}=tc(xl`/inventories/`,e),i=a?.type;return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:t("Edit group"),onClick:t=>n(fc.InventoryGroupEdit,{params:{inventory_type:i,id:e,group_id:t.id}}),isDisabled:e=>Ig(e,t)}]),[t,n,e,i])}(c),b=Tx(),f=Ix(m.unselectItemsAndRefresh,d),y=dd(xl`/groups/`).data,x=Boolean(y&&y.actions&&y.actions.POST);return Fc("inventories"),(0,z.jsx)(Ui,{children:(0,z.jsx)($s,{id:"awx-inventory-groups-table",toolbarFilters:u,toolbarActions:p,tableColumns:n,rowActions:h,errorStateTitle:t("Error loading associated groups"),emptyStateTitle:t(x?"There are currently no groups associated with this host":"You do not have permission to add a group"),emptyStateDescription:t(x?"Please add a group by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:x?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:x?t("Associate groups"):void 0,emptyStateButtonClick:x?()=>b({onAdd:f,inventoryId:c,hostId:d}):void 0,...m})})}function Bx(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),{data:a}=ec(xl`/hosts/${"host"===e.page?n.id??"":n.host_id??""}/ansible_facts/`);return(0,z.jsx)(Mt,{children:(0,z.jsx)(Wu,{label:t("Facts"),value:JSON.stringify(a)||"{}"})})}function Fx(){return Pp({optionsPath:"instances",preSortedKeys:["hostname","node_type","id"],preFilledValueKeys:{hostname:{apiPath:"instances"},id:{apiPath:"instances"}}})}function Nx(e,t){const{t:n}=(0,I.Bd)(),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Vf();return a=>{o({title:n("Associate instance to instance groups",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,actionColumns:s,onComplete:e,actionFn:async(e,n)=>{await al(xl`/instance_groups/${t}/instances/`,{id:e.id},n)},processingText:n("Adding host to group",{count:a.length})})}}function $x(e){const{t}=(0,I.Bd)(),n=Cu(),a=Fx(),{instanceGroupId:s,onAssociate:o}=e,i=Uc({url:xl`/instances/`,queryParams:{not__node_type:["control","hop"],not__rampart_groups__id:s},toolbarFilters:a,tableColumns:n});return(0,z.jsx)(Xs,{title:t("Select instances"),view:i,tableColumns:n,toolbarFilters:a,onSelect:o})}function Mx(){const{pushDialog:e,popDialog:t}=as(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{n?e((0,z.jsx)($x,{...n})):t()}),[n,e,t]),a}function Lx(e){const t=Fx(),{t:n}=(0,I.Bd)(),a=yr(),{useToolbarActions:s,useRowActions:o,tableColumns:i,instanceGroupId:r}=e,l=Uc({url:r?xl`/instance_groups/${r}/instances/`:xl`/instances/`,toolbarFilters:t,tableColumns:i}),c=o(l.unselectItemsAndRefresh),d=s(l),{data:u}=dd(r?xl`/instance_groups/${r}/instances/`:xl`/instances/`),m=Boolean(u&&u.actions&&u.actions.POST);Fc("instances");const p=Nx(l.unselectItemsAndRefresh,r??""),h=Mx();return(0,z.jsx)($s,{id:"awx-instances-table",toolbarFilters:t,toolbarActions:d,tableColumns:i,rowActions:c,errorStateTitle:n("Error loading instances"),emptyStateTitle:n(m?"There are currently no instances added":"You do not have permission to create an instance."),emptyStateDescription:n(m?r?"Please associate an instance by using the button below.":"Please create an instance by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:m?n(r?"Associate instance":"Create instance"):void 0,emptyStateButtonClick:m?r?()=>h({onAssociate:p,instanceGroupId:r}):()=>a(fc.AddInstance):void 0,...l})}function Ox(e){const{activeAwxUser:t}=_l(),{data:n}=ec(xl`/settings/system/`),a=n?.IS_K8S,i=zx(e),r=function(){const e=yr(),{activeAwxUser:t}=_l(),{data:n}=ec(xl`/settings/system/`),a=n?.IS_K8S,{t:i}=(0,I.Bd)(),r=(t?.is_superuser||t?.is_system_auditor)&&n?.IS_K8S;return(0,l.useMemo)((()=>({type:s.Button,isHidden:()=>!1===a,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:i("Create instance"),onClick:()=>e(fc.AddInstance),isDisabled:r?void 0:i("You do not have permission to add instances. Please contact your organization administrator if there is an issue with your access.")})),[i,r,e,a])}(),c=function(e){const t=Tu(e.unselectItemsAndRefresh),{t:n}=(0,I.Bd)(),{data:a}=ec(xl`/settings/system/`),i=a?.IS_K8S,{activeAwxUser:r}=_l();return(0,l.useMemo)((()=>({type:s.Button,selection:o.Multiple,icon:Nd.Kf,label:n("Remove instance"),onClick:e=>t(e),isDisabled:e=>Fu(e,n,r,i??!1),isDanger:!0})),[n,t,i,r])}(e);return(0,l.useMemo)((()=>a&&(t?.is_superuser||t?.is_system_auditor)?[r,c,i]:[i]),[r,c,i,a,t?.is_superuser,t?.is_system_auditor])}function zx(e,t,n){const{t:a}=(0,I.Bd)(),i=function(e){const{t}=(0,I.Bd)(),n=Cu({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=e=>"execution"!==e.node_type?t("Health checks can only be run on execution instances."):"",r=e=>e.health_check_pending?t("Instance has pending health checks. Wait for those to complete before attempting another health check."):"";return a=>{const l=a.filter(i).filter(r);o({title:t("Run health checks on these instances",{count:a.length}),confirmText:t("Yes, I confirm that I want to run health checks on these {{count}} instances.",{count:a.length-l.length}),actionButtonText:t("Run health check",{count:a.length}),items:a.sort(((e,t)=>Js(e.hostname,t.hostname))),alertPrompts:l.length?[...l.length?[t("Cannot run health checks on {{count}} of the selected instances.  Health checks can only be run on execution instances.",{count:l.length})]:[]]:void 0,isItemNonActionable:e=>i(e)||r(e),keyFn:ll,isDanger:!1,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:async e=>al(xl`/instances/${e.id.toString()}/health_check/`,{})})}}(e.unselectItemsAndRefresh),{activeAwxUser:r}=_l();return(0,l.useMemo)((()=>({type:s.Button,selection:o.Multiple,variant:g.Ak.primary,icon:Iu.og,label:a("Run health check"),isPinned:t??!1,isHidden:n??!1,onClick:e=>i(e),isDisabled:e=>e.some((e=>$u(e,a)||Lu(r,a)||Mu(e,a)||Nu(e,a)))?"Cannot run health checks on one or more of the selected instances":""})),[a,i,t,n,r])}function Hx(e){const t=zx(e,!0),n=function(e){const t=(0,Re.g)(),{id:n}=t,a=Nx(e.unselectItemsAndRefresh,n??""),i=Mx(),{data:r}=dd(xl`/instance_groups/${n??""}/instances/`),c=Boolean(r&&r.actions&&r.actions.POST);return(0,l.useMemo)((()=>({type:s.Button,selection:o.None,variant:g.Ak.primary,icon:Za.GY,label:(0,po.t)("Associate instance"),isPinned:!0,isDisabled:()=>c?"":(0,po.t)("You do not have permission to associate an instance."),onClick:()=>i({onAssociate:a,instanceGroupId:n??""})})),[a,n,i,c])}(e),a=function(e){const t=function(e){const{t}=(0,I.Bd)(),n=Lc(),a=Cu({disableLinks:!0,disableSort:!0}),s=pu({disableLinks:!0,disableSort:!0}),o=(0,l.useMemo)((()=>[s]),[s]),i=(0,Re.g)();return s=>{n({title:t("Disassociate instance from instance group"),confirmText:t("Yes, I confirm that I want to disassociate these {{count}} instances.",{count:s.length}),actionButtonText:t("Disassociate instances",{count:s.length}),items:s.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:a,actionColumns:o,onComplete:e,actionFn:(e,t)=>al(xl`/instance_groups/${String(i.id)}/instances/`,{id:e.id,disassociate:!0},t)})}}(e.unselectItemsAndRefresh),n=(0,Re.g)(),{id:a}=n,{data:i}=tc(xl`/instance_groups/`,a);return(0,l.useMemo)((()=>({type:s.Button,selection:o.Multiple,variant:g.Ak.primary,label:(0,po.t)("Disassociate instance"),isPinned:!0,onClick:t,isDisabled:e=>function(e,t){if(t){const t=e.filter((e=>"instance"===e.type?"control"===e.node_type||"hybrid"===e.node_type:!e.summary_fields?.user_capabilities?.delete)).map((e=>e.name??e.hostname)).join(", ");if(t)return(0,po.t)(`You do not have permission to disassociate the following: ${t}`)}return""}(e,"controlplane"===i?.name)})),[t,i?.name])}(e);return(0,l.useMemo)((()=>[n,a,t]),[n,a,t])}function qx(e){const t=Du(e),n=Eu(e,!1);return(0,l.useMemo)((()=>[t,n]),[t,n])}function Ux(){const e=yr(),t=(0,Re.g)(),{id:n}=t,a=Cu(void 0,(0,l.useCallback)((t=>e(fc.InstanceGroupInstanceDetails,{params:{id:n,instance_id:t.id}})),[e,n]));return(0,z.jsx)(Lx,{useToolbarActions:Hx,useRowActions:qx,tableColumns:a,instanceGroupId:n})}function Wx(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=tc(xl`/instances`,t.instance_id),{data:o}=tc(xl`/instance_groups`,t.id),i=qx(s),r=gr();return n?(0,z.jsx)(Ic,{error:n,handleRefresh:s}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.hostname,breadcrumbs:[{label:e("Instance groups"),to:r(fc.InstanceGroups)},{label:o?.name},{label:e("Instances"),to:r(fc.InstanceGroupInstances,{params:t})},{label:e(a?.hostname)}],headerActions:(0,z.jsx)(oe,{actions:i,position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Instances"),page:fc.InstanceGroupInstances,persistentFilterKey:"instances"},tabs:[{label:e("Details"),page:fc.InstanceGroupInstanceDetails}],params:{id:t.id,instance_id:a.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Jx(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"instancegroup",addRolesRoute:fc.InstanceGroupAddTeams})}function Vx(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"instancegroup",addRolesRoute:fc.InstanceGroupAddUsers})}function Gx(){const{t:e}=(0,I.Bd)(),t=gr(),n=yr(),a=td();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create instance group"),breadcrumbs:[{label:e("Instance Groups"),to:t(fc.InstanceGroups)},{label:e("Create instance group")}]}),(0,z.jsx)(nd,{submitText:e("Create instance group"),onSubmit:async e=>{const t=await a(xl`/instance_groups/`,e);n(fc.InstanceGroupDetails,{params:{id:t.id}})},cancelText:e("Cancel"),onCancel:()=>{n(fc.InstanceGroups)},defaultValue:{name:"",policy_instance_minimum:0,policy_instance_percentage:0,max_concurrent_jobs:0,max_forks:0},children:(0,z.jsx)(Kx,{})})]})}function Yx(){const{t:e}=(0,I.Bd)(),t=gr(),n=yr(),a=(0,Re.g)(),s=ed(),{data:o,isLoading:i,error:r}=tc(xl`/instance_groups/`,a?.id?.toString());return r?(0,z.jsx)(Ic,{error:r}):i||!o?(0,z.jsx)(zr,{}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name?e("Edit {{instancegroupName}}",{instancegroupName:o?.name}):e("Instance Group"),breadcrumbs:[{label:e("Instance Groups"),to:t(fc.InstanceGroups)},{label:o?.name?e("Edit {{instancegroupName}}",{instancegroupName:o?.name}):e("Instance Group")}]}),(0,z.jsx)(nd,{submitText:e("Save instance group"),onSubmit:async e=>{const t=await s(xl`/instance_groups/${a?.id}/`,e);n(fc.InstanceGroupDetails,{params:{id:t.id}})},cancelText:e("Cancel"),onCancel:()=>{n(fc.InstanceGroups)},defaultValue:{name:o.name,policy_instance_minimum:o.policy_instance_minimum||0,policy_instance_percentage:o.policy_instance_percentage||0,max_concurrent_jobs:o.max_concurrent_jobs||0,max_forks:o.max_forks||0},children:(0,z.jsx)(Kx,{})})]})}function Kx(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:e("Name"),placeholder:e("Enter a name"),isRequired:!0,maxLength:150}),(0,z.jsx)(li,{name:"policy_instance_minimum",type:"number",labelHelp:e("Minimum number of instances that will be automatically assigned to this group when new instances come online."),min:0,label:e("Policy instance minimum")}),(0,z.jsx)(li,{name:"policy_instance_percentage",labelHelp:e("Minimum percentage of all instances that will be automatically assigned to this group when new instances come online."),type:"number",min:0,label:e("Policy instance percentage")}),(0,z.jsx)(li,{name:"max_concurrent_jobs",labelHelp:e("Maximum number of jobs to run concurrently on this group. Zero means no limit will be enforced."),type:"number",min:0,label:e("Max concurrent jobs")}),(0,z.jsx)(li,{labelHelp:e("Maximum number of forks to allow across all jobs running concurrently on this group. Zero means no limit will be enforced."),name:"max_forks",min:0,type:"number",label:e("Max forks")})]})}function Zx(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/instance_groups/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{instanceGroupName}}.",{instanceGroupName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"instancegroup",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{instanceGroupName}}.",{instanceGroupName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Instance groups"),to:t(fc.InstanceGroups)},{label:s?.name,to:t(fc.InstanceGroupDetails,{params:{id:s?.id}})},{label:e("Team access"),to:t(fc.InstanceGroupTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"instancegroup",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.InstanceGroupTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.InstanceGroupTeamAccess,{params:{id:s?.id}})}})]})}function Xx(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/instance_groups/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{instanceGroupName}}.",{instanceGroupName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"instancegroup",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{instanceGroupName}}.",{instanceGroupName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Instance groups"),to:t(fc.InstanceGroups)},{label:a?.name,to:t(fc.InstanceGroupDetails,{params:{id:a?.id}})},{label:e("User access"),to:t(fc.InstanceGroupUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"instancegroup",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.InstanceGroupUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.InstanceGroupUserAccess,{params:{id:a?.id}})}})]})}function Qx(){const e=(0,Re.g)(),{data:t,isLoading:n,error:a,refresh:s}=tc(xl`/instance_groups/`,e.id);return a?(0,z.jsx)(Ic,{error:a,handleRefresh:s}):n&&!t?(0,z.jsx)(zr,{}):t?(0,z.jsx)(ej,{instanceGroup:t}):null}function ej(e){const{t}=(0,I.Bd)(),{instanceGroup:n}=e,s=gr();return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Name"),children:n.name}),(0,z.jsx)(Ft,{label:t("Type"),children:n.is_container_group?t("Container Group"):t("Instance Group")}),(0,z.jsx)(Ft,{label:t("Policy instance minimum"),helpText:t("Minimum number of instances that will be automatically assigned to this group when new instances come online."),isEmpty:n.is_container_group,children:n.policy_instance_minimum}),(0,z.jsxs)(Ft,{label:t("Policy instance percentage"),helpText:t("Minimum percentage of all instances that will be automatically assigned to this group when new instances come online."),isEmpty:n.is_container_group,children:[n.policy_instance_percentage,"%"]}),(0,z.jsx)(Ft,{label:t("Max concurrent jobs"),helpText:t("Maximum number of jobs to run concurrently on this group. Zero means no limit will be enforced."),children:n.max_concurrent_jobs}),(0,z.jsx)(Ft,{label:t("Max forks"),helpText:t("Maximum number of forks to allow across all jobs running concurrently on this group. Zero means no limit will be enforced."),children:n.max_forks}),(0,z.jsx)(Ft,{label:t("Used capacity"),isEmpty:n.is_container_group,children:n.capacity?`${Math.round(100-n.percent_capacity_remaining)}%`:(0,z.jsx)(Su,{children:t("Unavailable")})}),(0,z.jsx)(Ft,{label:t("Credential"),isEmpty:!n.is_container_group||!n.summary_fields.credential,children:(0,z.jsx)(De.o,{children:(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:s(fc.CredentialDetails,{params:{id:n?.summary_fields?.credential?.id}}),children:n?.summary_fields?.credential?.name})})})}),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:n.created})}),(0,z.jsx)(Ft,{label:t("Last modified"),children:(0,z.jsx)(Ie,{value:n.modified})}),(0,z.jsx)(Wu,{fullWidth:!0,isEmpty:!n.pod_spec_override.length,helpText:t("Custom Kubernetes or OpenShift Pod specification."),label:t("Pod spec override"),showCopyToClipboard:!0,value:n.pod_spec_override})]})}function tj(){const e=function(e){const t=yr(),{t:n}=(0,I.Bd)(),s=(0,l.useMemo)((()=>({header:n("ID"),cell:e=>e.id,sort:"id",card:"hidden",list:"hidden",dashboard:"hidden",minWidth:0})),[n]),o=(0,l.useMemo)((()=>({project_update:"project",inventory_update:"inventory",job:"playbook",ad_hoc_command:"command",system_job:"management",workflow_job:"workflow"})),[]),i=pu({...e,onClick:(0,l.useCallback)((e=>t(fc.JobDetails,{params:{id:e.id,job_type:o[e.type]}})),[o,t]),defaultSort:!1}),r=(0,l.useMemo)((()=>({header:n("Status"),cell:e=>(0,z.jsx)(au,{status:e.status}),sort:"status"})),[n]),c=(0,l.useMemo)((()=>({header:n("Started"),cell:e=>(0,z.jsx)(Ie,{value:e.started}),sort:"started"})),[n]),d=(0,l.useMemo)((()=>({header:n("Finished"),cell:e=>(0,z.jsx)(Ie,{value:e.finished}),sort:"finished",defaultSortDirection:"desc",defaultSort:!0})),[n]),u=function(e,t,n){const{t:a}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:a("Type"),cell:e=>{const t={project_update:a`Source control update`,inventory_update:a`Inventory sync`,job:"check"===e.job_type?a`Playbook check`:a`Playbook run`,ad_hoc_command:a`Command`,system_job:a`Management job`,workflow_job:a`Workflow job`};return(0,z.jsx)(Fe,{text:t[e.type]})},sort:"type",card:qt.subtitle,list:Ht.subtitle,dashboard:Wt.hidden})),[e,n,t,a])}(),m=sx(),p=yu(fc.InventoryDetails),h=rx(),b=ox(),f=ix(),g=xu(fc.ProjectDetails),y=lx(),x=function(e,t,n,s,o,i){const{t:r}=(0,I.Bd)(),c=Cf();return(0,l.useMemo)((()=>({header:r("Schedule"),cell:e=>{const t=c(e);return(0,z.jsx)(a.N_,{to:e.summary_fields?.schedule&&t?t:"",children:e.summary_fields?.schedule?.name})},value:e=>e.summary_fields?.schedule?.name,table:zt.expanded,card:qt.hidden,list:Ht.hidden,defaultSortDirection:"desc",modal:Ut.hidden,dashboard:Wt.hidden})),[t,o,i,n,s,r,e,c])}();return(0,l.useMemo)((()=>[s,i,r,u,c,d,m,x,b,f,p,g,y,h]),[s,i,r,u,c,d,m,x,b,f,p,g,y,h])}(),{id:t=""}=(0,Re.g)(),n={instance_group:t,not__launch_type:"sync"};return(0,z.jsx)(ax,{queryParams:n,columns:e})}function nj(){const{t:e}=(0,I.Bd)(),t=gr(),n=yr(),a=td(),{data:s,error:o,isLoading:i}=dd(xl`/instance_groups/`);return i?(0,z.jsx)(zr,{}):o?(0,z.jsx)(Ic,{error:o}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create container group"),breadcrumbs:[{label:e("Instance Groups"),to:t(fc.InstanceGroups)},{label:e("Create container group")}]}),(0,z.jsx)(nd,{submitText:e("Create container group"),onSubmit:async e=>{const{override:t,pod_spec_override:s,...o}=e,i=t?s:"",r=await a(xl`/instance_groups/`,{...o,pod_spec_override:i,is_container_group:!0});n(fc.InstanceGroupDetails,{params:{id:r.id}})},cancelText:e("Cancel"),onCancel:()=>{n(fc.InstanceGroups)},defaultValue:{name:"",override:!1,credential:null,pod_spec_override:om(JSON.stringify(s?.actions?.POST?.pod_spec_override.default)),max_concurrent_jobs:0,max_forks:0},children:(0,z.jsx)(sj,{})})]})}function aj(){const{t:e}=(0,I.Bd)(),t=gr(),n=yr(),a=(0,Re.g)(),s=ed(),{data:o,isLoading:i,error:r}=tc(xl`/instance_groups/`,a?.id?.toString()),{data:l,error:c,isLoading:d}=dd(xl`/instance_groups/`),u=r||c;return u?(0,z.jsx)(Ic,{error:u}):i||!o||d?(0,z.jsx)(zr,{}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name?e("Edit {{containergroupName}}",{containergroupName:o?.name}):e("Container Group"),breadcrumbs:[{label:e("Instance Groups"),to:t(fc.InstanceGroups)},{label:o?.name?e("Edit {{containergroupName}}",{containergroupName:o?.name}):e("Container Group")}]}),(0,z.jsx)(nd,{submitText:e("Save container group"),onSubmit:async e=>{const{override:t,pod_spec_override:o,...i}=e,r=t?o:"",l=await s(xl`/instance_groups/${a?.id}/`,{...i,pod_spec_override:r,is_container_group:!0});n(fc.InstanceGroupDetails,{params:{id:l.id}})},cancelText:e("Cancel"),onCancel:()=>{n(fc.InstanceGroups)},defaultValue:{name:o.name,credential:o.credential??null,max_concurrent_jobs:o.max_concurrent_jobs||0,max_forks:o.max_forks||0,pod_spec_override:o?.pod_spec_override.length?o?.pod_spec_override:om(JSON.stringify(l?.actions?.POST.pod_spec_override.default)),override:Boolean(o.pod_spec_override)},children:(0,z.jsx)(sj,{})})]})}function sj(){const{t:e}=(0,I.Bd)(),t=(0,oo.FH)({name:"override"});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:e("Name"),placeholder:e("Enter a name"),isRequired:!0,maxLength:150}),(0,z.jsx)(Hp,{name:"credential",label:e("Credential"),labelHelp:e('Credential to authenticate with Kubernetes or OpenShift. Must be of type "Kubernetes/OpenShift API Bearer Token". If left blank, the underlying Pod\'s service account will be used.'),queryParams:{credential_type__kind:"kubernetes"}}),(0,z.jsx)(li,{name:"max_concurrent_jobs",helperText:e("Maximum number of jobs to run concurrently on this group. Zero means no limit will be enforced."),type:"number",min:0,label:e("Max concurrent jobs")}),(0,z.jsx)(li,{name:"max_forks",helperText:e("Maximum number of forks to allow across all jobs running concurrently on this group. Zero means no limit will be enforced."),type:"number",min:0,label:e("Max forks")}),(0,z.jsx)(go,{label:e("Customize pod spec"),name:"override"}),t&&(0,z.jsx)(Kc,{hidden:e=>!e,watch:"override",children:(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{format:"yaml",helperText:e("Field for passing a custom Kubernetes or OpenShift Pod specification."),label:e("Pod spec override"),name:"pod_spec_override"})})})]})}function oj(){const{t:e}=(0,I.Bd)(),t=Tg("instance_group"),n=yr(),a=(0,Re.g)(),{error:s,data:o,refresh:i}=tc(xl`/instance_groups`,a.id),r=Yp((()=>n(fc.InstanceGroups))),l=gr();return s?(0,z.jsx)(Ic,{error:s,handleRefresh:i}):o?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name,breadcrumbs:[{label:e("Instance groups"),to:l(fc.InstanceGroups)},{label:o?.name}],headerActions:(0,z.jsx)(oe,{actions:[...t,...r],position:te.nU.right,selectedItem:o})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Instance Groups"),page:fc.InstanceGroups,persistentFilterKey:"instance_groups"},tabs:[{label:e("Details"),page:fc.InstanceGroupDetails},...o?.is_container_group?[]:[{label:e("Instances"),page:fc.InstanceGroupInstances}],{label:e("Team Access"),page:fc.InstanceGroupTeamAccess},{label:e("User Access"),page:fc.InstanceGroupUserAccess},{label:e("Jobs"),page:fc.InstanceGroupJobs}],params:{id:o.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function ij(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=td(),s=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create instance"),breadcrumbs:[{label:e("Instances"),to:s(fc.Instances)},{label:e("Create instance")}]}),(0,z.jsx)(nd,{submitText:e("Create instance"),onSubmit:async e=>{const t=await a(xl`/instances/`,e);n(fc.InstanceDetails,{params:{id:t.id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:{node_type:"execution",node_state:"installed",enabled:!0,peers_from_control_nodes:!1,managed_by_policy:!0},children:(0,z.jsx)(lj,{mode:"create"})})]})}function rj(){const e=(0,Re.g)(),t=Number(e.id),{t:n}=(0,I.Bd)(),a=(0,Re.Zp)(),s=yr(),{data:o}=ec(xl`/instances/${t?.toString()}/`),{cache:i}=(0,_e.iX)(),r=gr();if(o)return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.hostname?n("Edit {{instanceName}}",{instanceName:o?.hostname}):n("Instances"),breadcrumbs:[{label:n("Instances"),to:r(fc.Instances)},{label:o?.hostname?n("Edit {{instanceName}}",{instanceName:o?.hostname}):n("Instances")}]}),(0,z.jsx)(nd,{submitText:n("Save instance"),onSubmit:async e=>{e.listener_port=e.listener_port&&Number(e?.listener_port),await sl(xl`/instances/${t.toString()}/`,e),i.clear?.(),s(fc.InstanceDetails,{params:{id:t}})},cancelText:n("Cancel"),onCancel:()=>a(-1),defaultValue:o,children:(0,z.jsx)(lj,{mode:"edit"})})]})}function lj(e){const{mode:t}=e,{t:n}=(0,I.Bd)(),a=(0,oo.FH)({name:"peers_from_control_nodes"});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"hostname",label:n("Host name"),placeholder:n("Enter a host name"),isRequired:!0,maxLength:150,isDisabled:"edit"===t}),(0,z.jsx)(li,{name:"node_state",label:n("Instance state"),placeholder:n("installed"),isDisabled:!0,labelHelp:n('Sets the current life cycle stage of this instance. Default is "installed."')}),(0,z.jsx)(li,{name:"listener_port",type:"number",label:n("Listener port"),placeholder:n("Enter a listener port"),isRequired:a,min:0,max:65353,labelHelp:n("Select the port that receptor will listen on for incoming connections, e.g. 27199.")}),(0,z.jsx)(ti,{name:"node_type",label:n("Instance type"),placeholderText:n("Select a client type"),options:[{label:n("Execution"),value:"execution"},{label:n("Hop"),value:"hop"}],isRequired:!0,isDisabled:"edit"===t}),(0,z.jsxs)(_d,{title:n("Options"),singleColumn:!0,children:[(0,z.jsx)(go,{name:"enabled",label:n("Enable instance"),labelHelp:n("Set the instance enabled or disabled. If disabled, jobs will not be assigned to this instance.")}),(0,z.jsx)(go,{name:"managed_by_policy",label:n("Managed by policy"),labelHelp:n("Controls whether or not this instance is managed by policy. If enabled, the instance will be available for automatic assignment to and unassignment from instance groups based on policy rules.")}),(0,z.jsx)(go,{name:"peers_from_control_nodes",label:n("Peers from control nodes"),labelHelp:n("If enabled, control nodes will peer to this instance automatically. If disabled, instance will be connected only to associated peers.")})]})]})}function cj(){const{t:e}=(0,I.Bd)(),t=Cu();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Instances"),titleHelpTitle:e("Instances"),titleHelp:e("Ansible node instances dedicated for a particular purpose indicated by node type."),description:e("Ansible node instances dedicated for a particular purpose indicated by node type."),headerActions:(0,z.jsx)(cd,{type:"instance"})}),(0,z.jsx)(Lx,{useToolbarActions:Ox,useRowActions:Au,tableColumns:t})]})}function dj(){const e=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"address",label:e("Instance name"),type:Ia.SingleText,query:"address__icontains",comparison:"contains"})),[e])}();return(0,l.useMemo)((()=>[e]),[e])}function uj(){const{t:e}=(0,I.Bd)(),t=Tg("instance"),n=(0,Re.g)(),{error:a,data:s,refresh:o}=tc(xl`/instances`,n.id),{data:i}=ec(xl`/settings/system/`),r=!i?.IS_K8S,l=[...Bu()],c=gr();return a?(0,z.jsx)(Ic,{error:a,handleRefresh:o}):s?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.hostname,breadcrumbs:[{label:e("Instances"),to:c(fc.Instances)},{label:s?.hostname}],headerActions:(0,z.jsx)(oe,{actions:[...t,...l],position:te.nU.right,selectedItem:s})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Instances"),page:fc.Instances,persistentFilterKey:"instances"},tabs:[{label:e("Details"),page:fc.InstanceDetails,dataCy:"instances-details-tab"},!r&&{label:e("Listener Addresses"),page:fc.InstanceListenerAddresses,dataCy:"instances-listener-addresses-tab"},!r&&{label:e("Peers"),page:fc.InstancePeers,dataCy:"instances-peers-tab"}],params:{id:s.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function mj(e){const t=(0,Re.g)(),n=Number(t.id),{data:a}=tc(xl`/instances`,n),{t:s}=(0,I.Bd)(),o=gr();return(0,l.useMemo)((()=>[{header:s("Instance name"),cell:e=>(0,z.jsx)(Fe,{text:e.address,to:o(fc.InstanceDetails,{params:{id:e.instance}})}),card:"name",list:"name",sort:"pk",maxWidth:200},{header:s("Address"),type:"text",value:t=>e?.isListenerAddresses?a?.hostname:t.address,sort:"address"},{header:s("Port"),type:"text",value:t=>e?.isListenerAddresses?a?.listener_port?.toString():t.port?.toString(),sort:"port"},{header:s("Node type"),type:"text",value:e=>function(e){const{data:t}=ec(xl`/instances/${e.instance.toString()}/`);return t?.node_type}(e),sort:void 0},{header:s("Protocol"),type:"text",value:t=>e?.isListenerAddresses?a?.protocol:t.protocol,sort:"protocol"},{header:s("Canonical"),type:"text",value:t=>e?.isListenerAddresses?function(e){const{data:t}=ec(xl`/receptor_addresses/`),n=t?.results.find((t=>t.address===e?.hostname));return n?.canonical}(a)?.toString():t.canonical.toString(),sort:"canonical"}]),[e?.isListenerAddresses,o,a,s])}function pj(e){const{t}=(0,I.Bd)(),{instanceId:n,onPeer:a}=e,s=dj(),o=mj(),i=(0,l.useMemo)((()=>o.filter((e=>["Instance name","Address","Port","Node type","Protocol"].includes(e.header)))),[o]),{results:r}=cm(xl`/receptor_addresses/`),{results:c}=cm(xl`/instances`,{not__node_type:["control","hybird"]}),{data:d}=tc(xl`/instances/`,n),u=d?.peers?.map((e=>String(e)))??[];let m=[];r&&d&&!d.managed&&c&&(m=r.filter((e=>!u.includes(String(e.instance))&&!d.peers?.includes(e.id)&&!(d.id===e.instance)&&!e.is_internal&&c&&c.some((t=>t.id===e.instance)))).map((e=>String(e.instance))));const p={is_internal:"false",order_by:"address",not__instance:[String(d?.id??"")]};u.length>0&&(p.not__id__in=u),m.length>0&&(p.not__instance=[...p.not__instance,...m]);const h=Uc({url:xl`/receptor_addresses/`,toolbarFilters:s,tableColumns:i,disableQueryString:!0,queryParams:p});return(0,z.jsx)(Xs,{title:t("Select peer addresses"),onSelect:a,toolbarFilters:s,tableColumns:i,view:h,confirmText:t("Associate peers")})}function hj(){const e=(0,Re.g)(),{data:t}=tc(xl`/instances`,e.id);return t?(0,z.jsx)(bj,{instance:t}):null}function bj(e){const{instance:t}=e;return(0,z.jsx)(fj,{url:xl`/instances/${t.id.toString()}/peers/`})}function fj(e){const{t}=(0,I.Bd)(),{url:n}=e,a=dj(),i=mj(),r=(0,l.useMemo)((()=>i.filter((e=>["Instance name","Address","Port","Node type","Canonical"].includes(e.header)))),[i]),c=Uc({url:n,toolbarFilters:a,tableColumns:r,disableQueryString:!0}),{id:d}=(0,Re.g)(),u=function(e,t){const{t:n}=(0,I.Bd)(),a=Vf(),{data:s}=tc(xl`/instances`,t);return(0,l.useCallback)((o=>{a({title:n("Associating {{count}} peers",{count:o.length}),keyFn:e=>e.id,items:o,actionColumns:[{header:"Name",cell:e=>e.address}],actionFn:()=>{const e=o.map((e=>e.id));return sl(xl`/instances/${t}/`,{peers:s?.peers?[...s.peers,...e]:e})},processingText:n("Associating {{count}} peers...",{count:o.length}),onComplete:e})}),[a,n,e,t,s])}(c.unselectItemsAndRefresh,d??""),m=function(){const{pushDialog:e,popDialog:t}=as(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{n?e((0,z.jsx)(pj,{...n})):t()}),[n,e,t]),a}(),p=function(e,t){const n=(0,Re.g)(),a=Number(n.id),{t:s}=(0,I.Bd)(),o=function(e){const{onClick:t,disableSort:n,disableLinks:a}=e??{},{t:s}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e?.header??s("Instance name"),cell:e=>(0,z.jsx)(Fe,{text:e.address,iconSize:"sm",onClick:!a&&t?()=>t?.(e):void 0}),sort:n?void 0:e?.sort??"name",card:"name",list:"name",defaultSort:!0})),[a,n,e?.sort,t,e?.header,s])}({disableLinks:!0,disableSort:!0}),i=(0,l.useMemo)((()=>[o]),[o]),r=Lc(),c=mj(),d=(0,l.useMemo)((()=>c.filter((e=>["Peer name","Address","Port","Node type","Protocol"].includes(e.header)))),[c]),{data:u}=tc(xl`/instances`,t);return t=>{r({title:s("Disassociate peers",{count:t.length}),confirmText:1===t.length?s("Yes, I confirm that I want to disassociate this peer."):s("Yes, I confirm that I want to disassociate these {{count}} peers.",{count:t.length}),actionButtonText:s("Disassociate peers",{count:t.length}),items:t.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:d,actionColumns:i,onComplete:e,actionFn:()=>{const e=t.map((e=>e.id)),n=u?.peers?u?.peers.filter((t=>!e.includes(t))):[];return sl(xl`/instances/${a.toString()}/`,{peers:n})}})}}(c.unselectItemsAndRefresh,d??""),h=(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Associate peers"),onClick:()=>m({onPeer:u,instanceId:d??""})},{type:s.Seperator},{type:s.Button,selection:o.Multiple,variant:g.Ak.primary,icon:Nd.Kf,label:t("Disassociate peers"),onClick:e=>p(e),isDanger:!0}]),[m,u,p,d,t]);return(0,z.jsx)($s,{toolbarFilters:a,toolbarActions:h,tableColumns:r,errorStateTitle:t("Error loading peers"),emptyStateTitle:t("No peers found"),emptyStateDescription:t("Please associate peers to populate this list."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:t("Associate peers"),emptyStateButtonClick:()=>m({onPeer:u,instanceId:d??""}),...c})}function gj(){const{t:e}=(0,I.Bd)(),{id:t}=(0,Re.g)(),{data:n}=tc(xl`/instances`,t),a=function(){const e=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"hostname",label:e("Host name"),type:Ia.SingleText,query:"hostname__icontains",comparison:"contains"})),[e])}();return(0,l.useMemo)((()=>[e]),[e])}(),s=mj({isListenerAddresses:!0}),o=(0,l.useMemo)((()=>s.filter((e=>["Address","Port","Protocol","Canonical"].includes(e.header)))),[s]),i=n?.hostname,r=Uc({url:xl`/instances/`,toolbarFilters:a,tableColumns:o,queryParams:{order_by:"hostname",hostname:i},disableQueryString:!0});return(0,z.jsx)($s,{tableColumns:o,errorStateTitle:e("Error loading listener addresses"),emptyStateTitle:e("No listener addresses found"),emptyStateDescription:e("Please add Listener Addresses to populate this list."),...n?.listener_port?r:{itemCount:0,keyFn:()=>"",perPage:0,pageItems:[],page:0,setPage:()=>{},setPerPage:()=>{}}})}function yj(){const{t:e}=(0,I.Bd)(),{data:t}=dd(xl`/inventories/`),n=Boolean(t&&t.actions&&t.actions.POST),a=sh(),i=ah(),r=Uc({url:xl`/inventories/`,toolbarFilters:a,tableColumns:i}),{refresh:c,pageItems:d}=r,u=function(e){const{t}=(0,I.Bd)(),n=yr(),a=ux(e.unselectItemsAndRefresh),{data:i}=dd(xl`/inventories/`),r=Boolean(i&&i.actions&&i.actions.POST);return(0,l.useMemo)((()=>[{type:s.Dropdown,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create inventory"),isDisabled:()=>r?void 0:t("You do not have permission to create an inventory. Please contact your organization administrator if there is an issue with your access."),selection:o.None,actions:[{type:s.Button,selection:o.None,label:t("Create inventory"),onClick:()=>n(fc.CreateInventory)},{type:s.Button,selection:o.None,label:t("Create smart inventory"),onClick:()=>n(fc.CreateSmartInventory)},{type:s.Button,selection:o.None,label:t("Create constructed inventory"),onClick:()=>n(fc.CreateConstructedInventory)}]},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete inventories"),onClick:a,isDanger:!0}]),[r,a,n,t])}(r),m=mx({onInventoriesDeleted:r.unselectItemsAndRefresh,onInventoryCopied:r.refresh,detail:!1});Fc("inventories");const p=sc();return dc({control:["limit_reached_1"],jobs:["status_changed"],inventories:["status_changed"]},(0,l.useCallback)((e=>{if(e?.inventory_id)switch(e?.group_name){case"inventories":"deleted"===e?.status&&c();break;case"jobs":if("inventory_update"===e?.type){switch(e?.status){case"canceled":case"error":case"failed":case"pending":case"running":case"successful":{const t=(d??[]).find((t=>t.id===e.inventory_id));if(!t)return;t.status=e.status;break}}c()}}}),[c,d])),(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Inventories"),titleHelpTitle:e("Inventories"),titleHelp:e("An inventory defines the hosts and groups of hosts upon which commands, modules, and tasks in a playbook operate."),titleDocLink:pc(p,"inventories"),description:e("An inventory defines the hosts and groups of hosts upon which commands, modules, and tasks in a playbook operate."),headerActions:(0,z.jsx)(cd,{type:"inventory"})}),(0,z.jsx)($s,{id:"awx-inventories-table",toolbarFilters:a,toolbarActions:u,tableColumns:i,rowActions:m,errorStateTitle:e("Error loading inventories"),emptyStateTitle:e(n?"There are currently no inventories added.":"You do not have permission to create an inventory."),emptyStateDescription:e(n?"Please create an inventory by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:n?void 0:Xa.IN,emptyStateActions:n?u.slice(0,1):void 0,...r,defaultSubtitle:e("Inventory")})]})}var xj=n(30155),jj=n(3179),_j=n(69621);function vj(){const e=sc(),{t}=(0,I.Bd)();return(0,z.jsxs)(le.F,{isExpandable:!0,isInline:!0,variant:"info",title:t`How to use constructed inventory plugin`,actionLinks:(0,z.jsxs)(xj.v,{href:pc(e,"constructedInventories"),component:"a",target:"_blank",rel:"noopener noreferrer",children:[t`View constructed inventory documentation here`," ",(0,z.jsx)(et._,{})]}),children:[(0,z.jsxs)("span",{children:[t`This table gives a few useful parameters of the constructed
               inventory plugin. For the full list of parameters `," ",(0,z.jsx)("a",{href:t`https://docs.ansible.com/ansible/latest/collections/ansible/builtin/constructed_inventory.html`,children:t`view the constructed inventory plugin docs here.`})]}),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),(0,z.jsxs)(hn.X,{"aria-label":t`Constructed inventory parameters table`,variant:"compact",children:[(0,z.jsx)(fn.d,{children:(0,z.jsxs)(gn.Tr,{children:[(0,z.jsx)(yn.Th,{children:t`Parameter`}),(0,z.jsx)(yn.Th,{children:t`Description`})]})}),(0,z.jsxs)(bn.N,{children:[(0,z.jsxs)(gn.Tr,{ouiaId:"plugin-row",children:[(0,z.jsxs)(xn.Td,{dataLabel:t`name`,children:[(0,z.jsx)("code",{children:t`plugin`}),(0,z.jsx)("p",{style:{color:"blue"},children:t`string`}),(0,z.jsx)("p",{style:{color:"red"},children:t`required`})]}),(0,z.jsx)(xn.Td,{dataLabel:t`description`,children:t`Token that ensures this is a source file
              for the ‘constructed’ plugin.`})]}),(0,z.jsxs)(gn.Tr,{children:[(0,z.jsxs)(xn.Td,{dataLabel:t`name`,children:[(0,z.jsx)("code",{children:t("strict")}),(0,z.jsx)("p",{style:{color:"blue"},children:t`boolean`})]}),(0,z.jsxs)(xn.Td,{dataLabel:t`description`,children:[t`If yes make invalid entries a fatal error, otherwise skip and
              continue.`," ",(0,z.jsx)("br",{}),t`If users need feedback about the correctness
              of their constructed groups, it is highly recommended
              to use strict: true in the plugin configuration.`]})]},"strict"),(0,z.jsxs)(gn.Tr,{children:[(0,z.jsxs)(xn.Td,{dataLabel:t`name`,children:[(0,z.jsx)("code",{children:t("groups")}),(0,z.jsx)("p",{style:{color:"blue"},children:t`dictionary`})]}),(0,z.jsx)(xn.Td,{dataLabel:t`description`,children:t`Add hosts to group based on Jinja2 conditionals.`})]},"groups"),(0,z.jsxs)(gn.Tr,{children:[(0,z.jsxs)(xn.Td,{dataLabel:t`name`,children:[(0,z.jsx)("code",{children:t("compose")}),(0,z.jsx)("p",{style:{color:"blue"},children:t`dictionary`})]}),(0,z.jsx)(xn.Td,{dataLabel:t`description`,children:t`Create vars from jinja2 expressions. This can be useful
              if the constructed groups you define do not contain the expected
              hosts. This can be used to add hostvars from expressions so
              that you know what the resultant values of those expressions are.`})]},"compose")]})]}),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),(0,z.jsx)(Pd.Z,{children:(0,z.jsx)(fs.b,{children:(0,z.jsxs)(ao.l,{autoComplete:"off",children:[(0,z.jsx)("div",{style:{paddingTop:25,paddingLeft:20},children:(0,z.jsx)("b",{children:t`Constructed inventory examples`})}),(0,z.jsx)(wj,{}),(0,z.jsx)(kj,{}),(0,z.jsx)(Cj,{})]})})})]})}function wj(){const{t:e}=(0,I.Bd)(),[t,n]=l.useState(!1),a='plugin: constructed\nstrict: true\ngroups:\n  shutdown_in_product_dev: state | default("running") == "shutdown" and account_alias == "product_dev"';return(0,z.jsxs)(jj.S,{header:(0,z.jsx)(_j.n,{titleText:{text:e`Construct 2 groups, limit to intersection`,id:"intersection-example"},titleDescription:e`This constructed inventory input 
            creates a group for both of the categories and uses 
            the limit (host pattern) to only return hosts that 
            are in the intersection of those two groups.`}),children:[(0,z.jsx)(qo.g,{label:e`Limit`,fieldId:"intersection-example-limit",children:(0,z.jsx)(be.Ck,{isReadOnly:!0,hoverTip:e`Copy`,clickTip:e`Copied`,children:"is_shutdown:&product_dev"})}),(0,z.jsx)(qo.g,{label:e`Source variables`,fieldId:"intersection-example-source-vars",children:(0,z.jsx)(qu.N,{actions:(0,z.jsx)(zu.j,{children:(0,z.jsx)(Hu.M,{id:"intersection-example-source-vars",textId:"intersection-example-source-vars","aria-label":e`Copy to clipboard`,onClick:e=>(((e,t)=>{Sj(t)})(0,a),void n(!0)),exitDelay:t?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:()=>n(!1),children:t?e`Successfully copied to clipboard!`:e`Copy to clipboard`})}),children:(0,z.jsx)(Uu.s,{id:"intersection-example-source-vars",children:a})})})]})}function kj(){const{t:e}=(0,I.Bd)(),[t,n]=l.useState(!1),a="plugin: constructed";return(0,z.jsxs)(jj.S,{header:(0,z.jsx)(_j.n,{titleText:{text:e`Filter on nested group name`,id:"nested-groups-example"},titleDescription:e`This constructed inventory input
            creates a group for both of the categories and uses
            the limit (host pattern) to only return hosts that
            are in the intersection of those two groups.`}),children:[(0,z.jsxs)(qo.g,{children:[(0,z.jsx)("p",{children:e`Nested groups inventory definition:`}),(0,z.jsx)(qu.N,{children:(0,z.jsx)(Uu.s,{id:"nested-groups-example-inventory",children:"all:\n  children:\n    groupA:\n      children:\n        groupB:\n          hosts:\n            host1: {}\n      vars:\n        filter_var: filter_val\n    ungrouped:\n      hosts:\n        host2: {}"})})]}),(0,z.jsx)(qo.g,{label:e`Limit`,fieldId:"nested-groups-example-limit",children:(0,z.jsx)(be.Ck,{isReadOnly:!0,hoverTip:e`Copy`,clickTip:e`Copied`,children:"groupA"})}),(0,z.jsx)(qo.g,{label:e`Source variables`,fieldId:"nested-groups-example-source-vars",children:(0,z.jsx)(qu.N,{actions:(0,z.jsx)(zu.j,{children:(0,z.jsx)(Hu.M,{id:"nested-groups-example-source-vars",textId:"nested-groups-example-source-vars","aria-label":e`Copy to clipboard`,onClick:e=>(((e,t)=>{Sj(t)})(0,a),void n(!0)),exitDelay:t?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:()=>n(!1),children:t?e`Successfully copied to clipboard!`:e`Copy to clipboard`})}),children:(0,z.jsx)(Uu.s,{id:"nested-groups-example-source-vars",children:a})})})]})}function Sj(e){navigator.clipboard.writeText(e)}function Cj(){const{t:e}=(0,I.Bd)(),[t,n]=l.useState(!1),a="plugin: constructed\nstrict: true\ngroups:\n  intel_hosts: \"'GenuineIntel' in ansible_processor\"";return(0,z.jsxs)(jj.S,{header:(0,z.jsx)(_j.n,{titleText:{text:e`Hosts by processor type`,id:"processor-example"},titleDescription:"It is hard to give a specification for the inventory for Ansible facts, because to populate the system facts you need to run a playbook against the inventory that has `gather_facts: true`. The actual facts will differ system-to-system."}),children:[(0,z.jsx)(qo.g,{label:e`Limit`,fieldId:"processor-example-limit",children:(0,z.jsx)(be.Ck,{isReadOnly:!0,hoverTip:e`Copy`,clickTip:e`Copied`,children:"intel_hosts"})}),(0,z.jsx)(qo.g,{label:e`Source variables`,fieldId:"processor-example-source-vars",children:(0,z.jsx)(qu.N,{actions:(0,z.jsx)(zu.j,{children:(0,z.jsx)(Hu.M,{id:"processor-example-source-vars",textId:"processor-example-source-vars","aria-label":e`Copy to clipboard`,onClick:e=>(((e,t)=>{Sj(t)})(0,a),void n(!0)),exitDelay:t?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:()=>n(!1),children:t?e`Successfully copied to clipboard!`:e`Copy to clipboard`})}),children:(0,z.jsx)(Uu.s,{id:"processor-example-source-vars",children:a})})})]})}const Tj={ec2:"https://docs.ansible.com/ansible/latest/collections/amazon/aws/aws_ec2_inventory.html",azure_rm:"https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_inventory.html",controller:"https://docs.ansible.com/ansible/latest/collections/awx/awx/tower_inventory.html",gce:"https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_inventory.html",insights:"https://docs.ansible.com/ansible/latest/collections/redhatinsights/insights/insights_inventory.html",openstack:"https://docs.ansible.com/ansible/latest/collections/openstack/cloud/openstack_inventory.html",satellite6:"https://docs.ansible.com/ansible/latest/collections/theforeman/foreman/foreman_inventory.html",rhv:"https://docs.ansible.com/ansible/latest/collections/ovirt/ovirt/ovirt_inventory.html",vmware:"https://docs.ansible.com/ansible/latest/collections/community/vmware/vmware_vm_inventory_inventory.html",constructed:"https://docs.ansible.com/ansible/latest/collections/ansible/builtin/constructed_inventory.html",terraform:"https://console.redhat.com/ansible/automation-hub/repo/published/cloud/terraform/content/inventory/terraform_state/"};function Ij(e){const{t}=(0,I.Bd)(),n=e.inventoryKind,s=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(I.x6,{children:"Variables must be in JSON or YAML syntax. Use the radio button to toggle between the two."}),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),(0,z.jsx)(I.x6,{children:"JSON:"}),(0,z.jsx)("pre",{children:'\n  {\n    "somevar": "somevalue"\n    "somepassword": "Magic"\n  }\n'}),(0,z.jsx)("br",{}),(0,z.jsx)(I.x6,{children:"YAML:"}),(0,z.jsx)("pre",{children:"\n  ---\n  somevar: somevalue\n  somepassword: magic\n"}),(0,z.jsx)("br",{}),(0,z.jsxs)(I.x6,{children:["View JSON examples at"," ",(0,z.jsx)(a.N_,{to:"https://www.json.org",target:"_blank",rel:"noopener noreferrer",children:"www.json.org"})]}),(0,z.jsx)("br",{}),(0,z.jsxs)(I.x6,{children:["View YAML examples at"," ",(0,z.jsx)(a.N_,{to:"https://docs.ansible.com/YAMLSyntax.html",target:"_blank",rel:"noopener noreferrer",children:"docs.ansible.com"})]})]}),o=(0,z.jsx)(z.Fragment,{children:t("Enter inventory variables using either JSON or YAML syntax. \n  Use the radio button to toggle between the two. \n  Refer to the Ansible Controller documentation for example syntax.\n  ")}),i=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(I.x6,{children:["Variables used to configure the constructed inventory plugin. For a detailed description of how to configure this plugin, see"," ",(0,z.jsx)("a",{href:Tj.constructed,target:"_blank",rel:"noopener noreferrer",children:"constructed inventory"})," ","plugin configuration guide."]}),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),(0,z.jsx)("hr",{}),(0,z.jsx)("br",{}),(0,z.jsx)(I.x6,{children:"Variables must be in JSON or YAML syntax. Use the radio button to toggle between the two."}),(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),(0,z.jsx)(I.x6,{children:"YAML:"}),(0,z.jsx)("pre",{children:"\n      ---\n      plugin: constructed\n      strict: true\n      use_vars_plugins: true\n    "})]});return""===n?s:"smart"===n?o:i}const Aj={"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"};function Dj(e){const{t}=(0,I.Bd)(),{inventoryKind:n}=e,a=yr(),s=td(),o=gr(),i=t(""===n?"Create inventory":"smart"===n?"Create smart inventory":"Create constructed inventory"),r="smart"===n?{kind:n,name:"",description:"",instanceGroups:[],variables:"---\n"}:"constructed"===n?{kind:n,name:"",description:"",instanceGroups:[],inputInventories:[],verbosity:0,update_cache_timeout:0,limit:"",source_vars:""}:{kind:n,name:"",description:"",instanceGroups:[],labels:[],variables:"---\n",prevent_instance_group_fallback:!1};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:i,breadcrumbs:[{label:t("Inventories"),to:o(fc.Inventories)},{label:i}]}),(0,z.jsx)(nd,{submitText:t("Create inventory"),onSubmit:async n=>{const{instanceGroups:o,...i}=n;let r=[];"constructed"===e.inventoryKind&&(r=await $j(n.inventories||[],t),n.inputInventories=r);const l="constructed"===e.inventoryKind?"constructed_inventories":"inventories",c=await s(xl`/${l}/`,i),d=[];o?.length>0&&d.push(Fj(c,o??[],[])),"constructed"===e.inventoryKind&&n?.inventories?.length&&n.inventories.length>0&&d.push(Nj(c,r||[],[])),""===c.kind&&n.labels.length>0&&d.push(Bj(c,n.labels)),await Promise.all(d),a(fc.InventoryDetails,{params:{inventory_type:Aj[c.kind],id:c.id}})},disableSubmitOnEnter:!0,onCancel:()=>a(fc.Inventories),defaultValue:r,children:(0,z.jsx)(Rj,{inventoryKind:n})})]})}function Ej(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.g)(),a=Number(n.id),s="constructed_inventory"===n.inventory_type?"constructed_inventories":"inventories",o=ec(xl`/${s}/${a.toString()}/`),i=ec(xl`/inventories/${a.toString()}/instance_groups/`),r=o.data,l=i.data,c=ec("constructed_inventory"===n.inventory_type?xl`/inventories/${a.toString()}/input_inventories/`:""),d=c.data,u=l?.results,m=gr(),p=!(!r||!l||"constructed_inventory"===n.inventory_type&&!d),h=o.error||i.error||c.error;if(!p||!r||h)return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{breadcrumbs:[{label:e("Inventories"),to:m(fc.Inventories)},{label:e("Edit Inventory")}]}),!p&&!h&&(0,z.jsx)(zr,{}),o.error&&(0,z.jsx)(Ic,{error:o.error}),i.error&&(0,z.jsx)(Ic,{error:i.error}),c.error&&(0,z.jsx)(Ic,{error:c.error})]});const b="smart"===r.kind?{...r,instanceGroups:u}:"constructed"===r.kind?{...r,instanceGroups:u,inventories:d?.results}:{...r,instanceGroups:u,labels:r.summary_fields?.labels?.results??[]};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:r?.name?e("Edit {{inventoryName}}",{inventoryName:r?.name}):e("Inventory"),breadcrumbs:[{label:e("Inventories"),to:m(fc.Inventories)},{label:r?.name?e("Edit {{inventoryName}}",{inventoryName:r?.name}):e("Inventory")}]}),(0,z.jsx)(nd,{submitText:e("Save inventory"),onSubmit:async o=>{const{labels:i,instanceGroups:l,...c}=o;let m=[];"constructed_inventory"===n.inventory_type&&(m=await $j(o.inventories||[],e),o.inputInventories=m);const p=await sl(xl`/${s}/${a.toString()}/`,c),h=[];h.push(Fj(p,l??[],u??[])),"inventory"===n.inventory_type&&h.push(Bj(r,i||[])),"constructed_inventory"===n.inventory_type&&o?.inventories?.length&&o.inventories.length>0&&h.push(Nj(o,m||[],d?.results||[])),await Promise.all(h),t(fc.InventoryDetails,{params:{id:p.id,inventory_type:n.inventory_type}})},disableSubmitOnEnter:!0,onCancel:()=>t(fc.InventoryDetails,{params:{id:a,inventory_type:Aj[r.kind]}}),defaultValue:b,children:(0,z.jsx)(Rj,{inventoryKind:r.kind})})]})}function Pj(){const{t:e}=(0,I.Bd)();return{labels:e('Optional labels that describe this inventory, such as "dev" or "test". Labels can be used to group and filter inventories and completed jobs.'),verbosity:e("The verbosity level for the related auto-created inventory source, special to constructed inventory."),cache_timeout:e("The cache timeout for the related auto-created inventory source, special to constructed inventory."),limit:e("The limit to restrict the returned hosts for the related auto-created inventory source, special to constructed inventory."),prevent_instance_group_fallback:e("Prevent instance group fallback: If enabled, the inventory will prevent adding any organization instance groups to the list of preferred instances groups to run associated job templates on. Note: If this setting is enabled and you provided an empty list, the global instance groups will be applied."),input_inventories:e("Input inventories for the constructed inventory plugin. The order of the displayed chips in the field will be the order of execution.")}}function Rj(e){const{t}=(0,I.Bd)(),{inventoryKind:n}=e,a=Pj();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:t("Name"),placeholder:t("Enter name"),isRequired:!0}),(0,z.jsx)(li,{label:t("Description"),name:"description",placeholder:t("Enter description")}),(0,z.jsx)(sg,{name:"organization",isRequired:!0}),"smart"===n&&(0,z.jsx)(li,{name:"host_filter",label:t("Smart host filter"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(I.x6,{children:["Populate the hosts for this inventory by using a search filter.",(0,z.jsx)("br",{}),"Example: ","",(0,z.jsx)("br",{}),(0,z.jsx)("code",{children:(0,z.jsx)("b",{children:"name__icontains=RedHat"})}),(0,z.jsx)("br",{})]}),t("Note: Smart inventories have been deprecated in favor of constructed inventories. Refer to the Ansible Controller documentation for further syntax and examples.")]}),placeholder:t("Enter smart host filter"),isRequired:!0}),(0,z.jsx)(Xp,{name:"instanceGroups",labelHelp:t("Select the instance groups for this inventory to run on.")}),"constructed"===n&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Mj,{}),(0,z.jsx)(li,{name:"update_cache_timeout",id:"update_cache_timeout",type:"number",label:t("Cache timeout (seconds)"),labelHelp:a.cache_timeout,validate:e=>Number.parseFloat(e)>=0?void 0:t("This field must be a number and have a value between 0 and 2147483647")}),(0,z.jsx)(vc,{name:"verbosity",id:"verbosity",label:t("Verbosity"),placeholder:"",labelHelp:a.verbosity,options:[{value:0,label:t("0 (Normal)")},{value:1,label:t("1 (Verbose)")},{value:2,label:t("2 (More Verbose)")},{value:3,label:t("3 (Debug)")},{value:4,label:t("4 (Connection Debug)")},{value:5,label:t("5 (WinRM Debug)")}]}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(vj,{})}),(0,z.jsx)(li,{name:"limit",id:"limit",label:t("Limit"),labelHelp:a.limit})]}),""===n&&(0,z.jsx)(Qp,{labelHelpTitle:t("Labels"),labelHelp:a.labels,name:"labels"}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{name:"constructed"===n?"source_vars":"variables",label:t("constructed"===n?"Source variables":"Variables"),format:"yaml",isRequired:"constructed"===n,labelHelp:(0,z.jsx)(Ij,{inventoryKind:n}),validate:e=>{if("constructed"===n)return Zo(e).plugin?void 0:t("The plugin parameter is required.")}})}),""===n&&(0,z.jsx)(Vo,{label:t("Options"),children:(0,z.jsx)(go,{label:t("Prevent instance group fallback"),labelHelpTitle:t("Prevent instance group fallback"),labelHelp:a.prevent_instance_group_fallback,name:"prevent_instance_group_fallback"})})]})}async function Bj(e,t){const{added:n,removed:a}=dm(e.summary_fields?.labels?.results||[],t??[]),s=a.map((t=>al(xl`/inventories/${e.id.toString()}/labels/`,{id:t.id,disassociate:!0}))),o=n.map((t=>al(xl`/inventories/${e.id.toString()}/labels/`,{name:t.name,organization:e.organization})));return await Promise.all([...s,...o])}async function Fj(e,t,n){const{added:a,removed:s}=dm(n,t);if(0===a.length&&0===s.length)return;const o=s.map((t=>al(xl`/inventories/${e.id.toString()}/instance_groups/`,{id:t.id,disassociate:!0}))),i=a.map((t=>al(xl`/inventories/${e.id.toString()}/instance_groups/`,{id:t.id})));return await Promise.all([...o,...i])}async function Nj(e,t,n){for(const t of n)await al(xl`/inventories/${e.id.toString()}/input_inventories/`,{id:t.id,disassociate:!0});for(const n of t)await al(xl`/inventories/${e.id.toString()}/input_inventories/`,{id:n.id})}async function $j(e,t){const n=[],a=e.map((e=>({id:e.id,url:"",type:"",name:""})));return e.forEach((e=>{const s=nl(xl`/inventories/?id=${e.id.toString()}`).then((t=>{if(t.results.length>0){const n=a.find((t=>t.id===e.id));n&&(n.url=t.results[0].url||"",n.type=t.results[0].type||"")}})).catch((()=>{throw new Error(t("Error loading input inventory with id {{id}}.",{id:e.id}))}));n.push(s)})),await Promise.all(n),a}function Mj(){const e=sh(),t=ah(),{t:n}=(0,I.Bd)(),a=Pj();return(0,z.jsx)(Op,{name:"inventories",id:"inventories",label:n("Input inventories"),placeholder:n("Select inventories"),queryPlaceholder:n("Loading inventories..."),queryErrorText:n("Error loading inventories"),isRequired:!0,labelHelp:a.input_inventories,url:xl`/inventories/`,tableColumns:t,toolbarFilters:e,queryParams:{kind:""},compareOptionValues:(e,t)=>e.id===t.id})}const Lj=(0,A.Ay)(Ws.Pi).withConfig({componentId:"ans__sc-1afdzru-0"})(["color:var(--pf-v5-global--warning-color--100);margin-left:18px;cursor:pointer;"]),Oj=(0,A.Ay)(Ws.Pi).withConfig({componentId:"ans__sc-1afdzru-1"})(["color:var(--pf-v5-global--warning-color--100);margin-left:18px;cursor:pointer;"]);function zj(e){const{executionEnvironment:t,isDefaultEnvironment:n,virtualEnvironment:s,verifyMissingVirtualEnv:o,helpText:i}=e,{t:r}=(0,I.Bd)(),l=pc(sc(),"eeMigration"),c=r(n?"Default execution environment":"Execution environment"),d=gr();return t?(0,z.jsx)(Ft,{label:c,helpText:i,children:(0,z.jsx)(a.N_,{to:d(fc.ExecutionEnvironmentDetails,{params:{id:t.id}}),children:t.name})}):o&&s&&!t?(0,z.jsxs)(Ft,{label:c,helpText:i,children:[r`Missing resource`,(0,z.jsx)("span",{children:(0,z.jsx)(Ze.A,{className:"missing-execution-environment",headerContent:(0,z.jsx)("div",{children:r`Execution environment missing`}),bodyContent:(0,z.jsx)("div",{children:(0,z.jsxs)(I.x6,{children:["Custom virtual environment ",s," must be replaced by an execution environment. For more information about migrating to execution environments see"," ",(0,z.jsx)("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:"the documentation."})]})}),position:"right",children:(0,z.jsx)(Oj,{})})})]}):o||s||t?null:(0,z.jsxs)(Ft,{label:r`Execution environment`,helpText:i,children:[r`Missing resource`,(0,z.jsx)("span",{children:(0,z.jsx)(x.m,{content:r`Execution environment is missing or deleted.`,children:(0,z.jsx)(Lj,{})})})]})}function Hj(e){const{t}=(0,I.Bd)(),n=yr(),s=(0,Re.g)(),o=e?.inventorySourceId?e.inventorySourceId:s.source_id,i=gr(),{data:r,error:c,refresh:d}=tc(xl`/inventory_sources/`,o),{data:u}=dd(xl`/inventory_sources/`);dc({control:["limit_reached_1"],jobs:["status_changed"]},(0,l.useCallback)((e=>{if("jobs"===e?.group_name)switch(e?.type){case"job":case"workflow_job":case"project_update":case"inventory_update":d()}}),[d]));const m={};if(u?.actions?.GET?.source?.choices?.length){const{actions:e}=u;e?.GET?.source?.choices?.forEach((([e,t])=>m[`${e}`]=t))}const p=tp(r?.verbosity);if(c)return(0,z.jsx)(Ic,{error:c,handleRefresh:d});if(!r)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const{summary_fields:h,overwrite:b,overwrite_vars:f,update_on_launch:g,source:y}=r;let j=null;(b||f||g)&&(j=(0,z.jsxs)(Yl.K,{component:Yl.C.ul,children:[b&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Overwrite`,(0,z.jsx)(Bt,{header:"",content:t('If checked, any hosts and groups that were previously present on the external source but are now removed will be removed from the inventory. Hosts and groups that were not managed by the inventory source will be promoted to the next manually created group or if there is no manually created group to promote them into, they will be left in the "all" default group for the inventory. \n \n When not checked, local child hosts and groups not found on the external source will remain untouched by the inventory update process.')})]}),f&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Overwrite variables`,(0,z.jsx)(Bt,{header:"",content:"If checked, all variables for child groups and hosts will be removed and replaced by those found on the external source. \n \n When not checked, a merge will be performed, combining local variables with those found on the external source."})]}),g&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Update on launch`,(0,z.jsx)(Bt,{header:"",content:t("Each time a job runs using this inventory, refresh the inventory from the selected source before executing job tasks. This will ensure the most up-to-date inventory information is used during the job run.")})]})]}));const _=h.current_job||h.last_job;return(0,z.jsxs)(Mt,{disableScroll:e.disableScroll,children:[(0,z.jsx)(Ft,{label:t`Name`,children:e.inventorySourceId?(0,z.jsx)(a.N_,{to:i(fc.InventorySourceDetail,{params:{source_id:r.id,id:r?.inventory,inventory_type:""===r?.summary_fields?.inventory.kind?"inventory":r?.summary_fields?.inventory.kind}}),children:r.name}):r.name}),_?(0,z.jsx)(Ft,{label:t`Last job status`,children:(0,z.jsx)(x.m,{position:"top",content:_?(0,z.jsx)(qj,{job:_}):void 0,children:(0,z.jsx)(a.N_,{to:i(fc.JobOutput,{params:{id:_.id,job_type:"inventory"}}),children:(0,z.jsx)(su,{status:_.status})})},_.id)}):null,(0,z.jsx)(Ft,{label:t`Description`,children:r.description}),(0,z.jsx)(Ft,{label:t`Source`,children:m[y]}),(0,z.jsx)(Ft,{isEmpty:!h.organization,label:t`Organization`,children:(0,z.jsx)(a.N_,{to:i(fc.OrganizationDetails,{params:{id:h.organization.id}}),children:h.organization.name})}),h.execution_environment?(0,z.jsx)(zj,{isDefaultEnvironment:!1,virtualEnvironment:r.custom_virtualenv??void 0,executionEnvironment:h.execution_environment}):null,(0,z.jsx)(Ft,{isEmpty:!h.source_project,label:t`Project`,children:(0,z.jsx)(a.N_,{to:i(fc.ProjectDetails,{params:{id:h.source_project?.id}}),children:h?.source_project?.name})}),(0,z.jsx)(Ft,{isEmpty:!r.source,label:t`Inventory file`,helpText:t("The inventory file to be synced by this source. You can select from the dropdown or enter a file within the input."),children:""===r.source_path?t`/ (project root)`:r.source_path}),(0,z.jsx)(Ft,{label:t`Verbosity`,helpText:t(t`Control the level of output Ansible
        will produce for inventory source update jobs.`),children:p}),(0,z.jsx)(Ft,{label:t`Source control branch`,helpText:t("Branch to use on inventory sync. Project default used if blank. Only allowed if project allow_override field is set to true."),children:r.scm_branch}),(0,z.jsx)(Ft,{label:t`Cache timeout`,helpText:t("Time in seconds to consider an inventory sync to be current. During job runs and callbacks the task system will evaluate the timestamp of the latest sync. If it is older than Cache Timeout, it is not considered current, and a new inventory sync will be performed."),children:`${r.update_cache_timeout} ${t`seconds`}`}),(0,z.jsx)(Ft,{label:t`Host filter`,helpText:t("Regular expression where only matching host names will be imported. The filter is applied as a post-processing step after any inventory plugin filters are applied."),children:r.host_filter}),(0,z.jsx)(Ft,{label:t`Enabled variable`,helpText:t("Retrieve the enabled state from the given dict of host variables.\n        The enabled variable may be specified using dot notation, e.g: 'foo.bar'"),children:r.enabled_var}),(0,z.jsx)(Ft,{label:t`Enabled value`,helpText:t("This field is ignored unless an Enabled Variable is set. If the enabled variable matches this value, the host will be enabled on import."),children:r.enabled_value}),(0,z.jsx)(Ft,{label:t`Credential`,isEmpty:!h.credential,children:(0,z.jsx)(uu,{credential:h.credential})}),j&&(0,z.jsx)(Ft,{label:t`Enabled options`,children:j}),(0,z.jsx)(Wu,{label:t`Source variables`,helpText:(e=>{let t="";if(e&&"scm"!==e){const n=Tj[e]?.split(/[/,.]/)??[];t=n[n.length-2]}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(I.x6,{children:["Variables used to configure the inventory source. For a detailed description of how to configure this plugin, see"," ",(0,z.jsx)("a",{href:"https://docs.ansible.com/ansible/latest/plugins/inventory.html#inventory-plugins",target:"_blank",rel:"noopener noreferrer",children:"Inventory Plugins"})," ","in the documentation and the"," ",(0,z.jsx)("a",{href:Tj[e],target:"_blank",rel:"noopener noreferrer",children:t})," ","plugin configuration guide."]}),(0,z.jsx)("br",{}),(0,z.jsx)("br",{})]})})(r.source),showCopyToClipboard:!0,"data-cy":"inventory-source-detail-variables",value:r.source_vars||"---"}),(0,z.jsx)(Ft,{label:t`Created`,children:(0,z.jsx)(Ie,{value:r.created,author:h?.created_by?.username,onClick:()=>n(fc.UserDetails,{params:{id:h?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:r.modified,author:h?.modified_by?.username,onClick:()=>n(fc.UserDetails,{params:{id:h?.modified_by?.id}})})]})}function qj(e){const t=e.job,{t:n}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:n`MOST RECENT SYNC`}),(0,z.jsxs)("div",{children:[n`JOB ID:`," ",t.id]}),(0,z.jsxs)("div",{children:[n`STATUS:`," ",t.status.toUpperCase()]}),t.finished&&(0,z.jsxs)("div",{children:[n`FINISHED:`," ",Jh(t.finished)]})]})}function Uj(){const{inventory:e}=(0,Re.KC)();return e?(0,z.jsx)(Wj,{inventory:e}):null}function Wj(e){const{t}=(0,I.Bd)(),n=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({"":e("Inventory"),smart:e("Smart inventory"),constructed:e("Constructed inventory")})),[e])}(),s=e.inventory,o=yr(),i=function(e){const{data:t}=ec(xl`/inventories/${e}/instance_groups/`);return t?.results??[]}((0,Re.g)().id||"0"),r=tp(s.verbosity),c=gr(),{data:d,error:u}=ec("constructed"===s.kind?xl`/inventories/${s.id.toString()}/input_inventories/`:""),m=s.source,p=Pj(),h=m?.summary_fields?.current_job||m?.summary_fields?.last_job||void 0;return u?(0,z.jsx)(Ic,{error:u}):(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Name"),children:s.name}),(0,z.jsx)(Jj,{job:h,isEmpty:"constructed"!==s.kind}),(0,z.jsx)(Ft,{label:t("Description"),children:s.description}),(0,z.jsx)(Ft,{label:t("Type"),children:n[s.kind]}),(0,z.jsx)(Ft,{label:t("Organization"),children:(0,z.jsx)(Fe,{text:s.summary_fields?.organization?.name,to:c(fc.OrganizationDetails,{params:{id:s.summary_fields?.organization?.id}})})}),(0,z.jsx)(Ft,{label:t("Smart host filter"),isEmpty:"smart"!==s.kind,children:(0,z.jsx)(De.o,{children:(0,z.jsx)(Ee.J,{children:s.host_filter})})}),(0,z.jsx)(Ft,{label:t("Total hosts"),helpText:t("This field is deprecated and will be removed in a future release. Total number of hosts in this inventory."),children:s.total_hosts}),(0,z.jsx)(Ft,{label:t("Hosts with active failures"),isEmpty:"constructed"!==s.kind||0===s.hosts_with_active_failures,children:s.hosts_with_active_failures}),(0,z.jsx)(Ft,{label:t("Total groups"),helpText:t("This field is deprecated and will be removed in a future release. Total number of groups in this inventory."),isEmpty:"constructed"!==s.kind,children:s.total_groups}),(0,z.jsx)(Ft,{label:t("Total inventory sources"),helpText:t("Total number of external inventory sources configured within this inventory."),isEmpty:"constructed"!==s.kind,children:s.total_inventory_sources}),(0,z.jsx)(Ft,{label:t("Inventory sources with active failures"),helpText:t("Number of external inventory sources in this inventory with failures."),isEmpty:"constructed"!==s.kind,children:s.inventory_sources_with_failures}),(0,z.jsx)(Ft,{label:t("Limit"),helpText:p.limit,isEmpty:"constructed"!==s.kind,children:s.limit}),(0,z.jsx)(Ft,{label:t("Verbosity"),helpText:p.verbosity,isEmpty:"constructed"!==s.kind,children:r}),(0,z.jsx)(Ft,{label:t("Update cache timeout"),helpText:p.cache_timeout,isEmpty:"constructed"!==s.kind,children:s.update_cache_timeout}),(0,z.jsx)(Ft,{label:t`Instance groups`,isEmpty:0===i.length,children:(0,z.jsx)(De.o,{children:i.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:c(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))})}),(0,z.jsx)(Ft,{label:t`Input inventories`,helpText:p.input_inventories,isEmpty:void 0===u&&(!d||0===d?.results.length),children:u?t`There was an error fetching the input inventories`:(0,z.jsx)(De.o,{children:d?.results.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:c(fc.InventoryDetails,{params:{inventory_type:Mf[e.kind],id:e.id}}),children:e.name})},e.id)))})}),(0,z.jsx)(Ft,{label:t`Labels`,isEmpty:0===s.summary_fields.labels.results.length,helpText:p.labels,children:(0,z.jsx)(De.o,{children:s.summary_fields.labels.results.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:e.name},e.id)))})}),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:s.created,author:s.summary_fields?.created_by?.username,onClick:()=>o(fc.UserDetails,{params:{id:s.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:s.modified,author:s.summary_fields?.modified_by?.username,onClick:()=>o(fc.UserDetails,{params:{id:s.summary_fields?.modified_by?.id}})}),(0,z.jsx)(Ft,{label:t("Enabled options"),isEmpty:!s.prevent_instance_group_fallback,helpText:p.prevent_instance_group_fallback,children:(0,z.jsx)(Yl.K,{component:Yl.C.ul,children:s.prevent_instance_group_fallback&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Prevent instance group fallback`})})}),(0,z.jsx)(Wu,{helpText:(0,z.jsx)(Ij,{inventoryKind:s.kind}),label:"constructed"===s.kind?t("Source variables"):t("Variables"),showCopyToClipboard:!0,value:"constructed"===s.kind?s.source_vars||"---":s.variables||"---"})]})}function Jj(e){const{t}=(0,I.Bd)(),n=gr(),s=e.job;return s?(0,z.jsx)(Ft,{label:t`Last job status`,isEmpty:e.isEmpty,children:(0,z.jsx)(x.m,{position:"top",content:s?(0,z.jsx)(qj,{job:s}):void 0,children:(0,z.jsx)(a.N_,{to:n(fc.JobOutput,{params:{id:s.id,job_type:"inventory"}}),children:(0,z.jsx)(su,{status:s.status})})},s.id)}):null}function Vj({onInventorySourcesDeleted:e,onInvUpdateCanceled:t}){const{t:n}=(0,I.Bd)(),a=yr(),i=function(e){const{t}=(0,I.Bd)(),n=_h({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=e=>e?.summary_fields?.user_capabilities?.delete?void 0:t("The inventory source cannot be deleted due to insufficient permission.");return a=>{const r=a.filter(i);o({title:t("Permanently delete inventory source",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} inventory sources.",{count:a.length-r.length}),actionButtonText:t("Delete inventory sources",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/inventory_sources/${e.id.toString()}/`,t),alertPrompts:r.length>0?[t("{{count}} of the selected inventory sources cannot be deleted due to insufficient permission.",{count:r.length})]:void 0,isItemNonActionable:i})}}(e),r=(0,Re.g)(),{activeAwxUser:c}=_l(),d=ue(),u=td(),m=(0,l.useCallback)((async e=>{try{await u(xl`/inventory_sources/${e.id.toString()}/update/`,{})}catch(e){d.addAlert({variant:"danger",title:n("Failed to update inventory source"),children:e instanceof Error&&e.message,timeout:5e3})}}),[d,u,n]),p=function(e){const{t}=(0,I.Bd)(),n=Lc(),a=td(),s=_h({disableLinks:!0}),o=pu({disableLinks:!0,disableSort:!0}),i=(0,l.useMemo)((()=>[o]),[o]);return o=>{n({title:t("Cancel Inventory Update"),confirmText:t("Yes, I confirm that I want to cancel inventory update."),actionButtonText:t("Cancel Update"),items:o.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:s,actionColumns:i,onComplete:e,actionFn:(e,t)=>{let n;return e.summary_fields?.current_job?n=e.summary_fields.current_job:e.summary_fields?.last_job&&(n=e.summary_fields.last_job),a(xl`/inventory_updates/${String(n?.id)}/cancel/`,t)}})}}(t);return(0,l.useMemo)((()=>{const e=e=>e.summary_fields.user_capabilities.start&&c?.is_superuser?"":n("The inventory source cannot be updated due to insufficient permission");return[{type:s.Button,selection:o.Single,icon:yc.oo,variant:g.Ak.primary,isPinned:!0,label:n("Edit inventory source"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.edit&&c?.is_superuser?"":n("The inventory source cannot be edited due to insufficient permission"))(e),onClick:e=>a(fc.InventorySourceEdit,{params:{id:e.inventory,inventory_type:r.inventory_type,source_id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:mb.Ab,label:n("Launch inventory update"),isPinned:!0,isHidden:e=>{const t=e?.summary_fields.user_capabilities.start;let n,a;return e.summary_fields?.current_job?n=e.summary_fields.current_job:e.summary_fields?.last_job&&(n=e.summary_fields.last_job),n&&(a=["new","running","pending","waiting"].includes(n?.status)),!(t&&!a)},isDisabled:t=>e(t),onClick:e=>m(e)},{type:s.Button,selection:o.Single,icon:Nd.Kf,label:n("Cancel inventory update"),isPinned:!0,isHidden:e=>{const t=e?.summary_fields.user_capabilities.start;let n,a;return e.summary_fields?.current_job?n=e.summary_fields.current_job:e.summary_fields?.last_job&&(n=e.summary_fields.last_job),n&&(a=["new","running","pending","waiting"].includes(n?.status)),!t||!a},isDisabled:t=>e(t),onClick:e=>p([e])},{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete inventory source"),isDisabled:e=>(e=>"running"===e?.status?n("The inventory source cannot be deleted due to the source currently running"):e?.summary_fields?.user_capabilities?.delete||c?.is_system_auditor?"":n("The inventory source cannot be deleted due to insufficient permission"))(e),onClick:e=>i([e]),isDanger:!0}]}),[i,a,m,p,c,n,r.inventory_type])}function Gj(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{data:n,error:a,refresh:s}=tc(xl`/inventory_sources/`,t.source_id),o=yr(),i=gr(),r=Vj({onInventorySourcesDeleted:()=>o(fc.InventorySources,{params:{id:t.id,inventory_type:t.inventory_type}}),onInvUpdateCanceled:s});return a?(0,z.jsx)(Ic,{error:a,handleRefresh:s}):n?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:n?.name,breadcrumbs:[{label:e("Inventories"),to:i(fc.Inventories)},{label:`${n?.summary_fields.inventory.name}`,to:i(fc.InventoryDetails,{params:{id:n?.summary_fields.inventory.id,inventory_type:"inventory"}})},{label:e("Inventory Sources"),to:i(fc.InventorySources,{params:{id:t.id,inventory_type:t.inventory_type}})},{label:n?.name}],headerActions:(0,z.jsx)(oe,{actions:r,position:te.nU.right,selectedItem:n})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Inventory Sources"),page:fc.InventorySources,persistentFilterKey:"inventory_sources"},tabs:[{label:e("Details"),page:fc.InventorySourceDetail},{label:e("Schedules"),page:fc.InventorySourceSchedules},{label:e("Notifications"),page:fc.InventorySourceNotifications}],params:t})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}Oj.displayName="ExclamationTrianglePopover";var Yj=n(71211);let Kj=function(e){return e.Rules="rules",e.Exceptions="exceptions",e}({});const Zj="inventory",Xj={freq:Yj.jN.YEARLY,interval:1,wkst:Yj.p3.SU,byweekday:null,byweekno:null,bymonth:null,bymonthday:null,byyearday:null,bysetpos:null,until:{date:"",time:""},count:null,byminute:null,byhour:null,endType:"never"},Qj=Array.from({length:52},((e,t)=>t+1)).map((e=>({value:e,label:`${e}`}))),e_=Array.from(Array(366),((e,t)=>t+1)).map((e=>({value:e,label:`${e}`}))),t_=Array.from(Array(60),((e,t)=>t)).map((e=>({value:e,label:`${e}`}))),n_=Array.from(Array(31),((e,t)=>t+1)).map((e=>({value:e,label:`${e}`}))),a_=Array.from(Array(24),((e,t)=>t)).map((e=>({value:e,label:`${e}`})));var s_=n(14243);function o_(e){const{dateValue:t,timeValue:n,datePlaceHolder:a,timePlaceHolder:s,onDateChange:o,onTimeChange:i,id:r}=e;return(0,z.jsx)(Vo,{...e,fieldId:r,children:(0,z.jsxs)(ga.M,{children:[(0,z.jsx)(ya.b,{children:(0,z.jsx)(ma.l,{isDisabled:e.isDisabled,placeholder:a,value:t,onChange:(e,t,n)=>{n&&(0,ua.v)(n)&&t===(0,ma._)(n)&&o(t)}})}),(0,z.jsx)(ya.b,{children:(0,z.jsx)(s_.A,{isDisabled:e.isDisabled,placeholder:s,time:n,inputProps:{value:n??""},onChange:i})})]})})}function i_(e){const{control:t}=(0,oo.xW)();return(0,z.jsx)(oo.xI,{name:e.name,control:t,shouldUnregister:!0,render:({field:t})=>(0,z.jsx)(o_,{...e,id:e.name,"data-cy":"dateTime",dateValue:t?.value?.date,timeValue:t?.value?.time,onDateChange:e=>t.onChange({...t.value,date:e}),datePlaceHolder:e.datePlaceHolder,onTimeChange:(e,n)=>{t.onChange({...t.value,time:n})},timePlaceHolder:e.timePlaceHolder,isRequired:e.isRequired})})}function r_(e){return"string"==typeof e?e:e<10?`0${e}`:e}function l_(e){const{t}=(0,I.Bd)(),n=(0,l.useCallback)((e=>({hour:je.c9.fromFormat(e,"h:mm a").hour,minute:je.c9.fromFormat(e,"h:mm a").minute})),[]),{getValues:a,reset:s,formState:{defaultValues:o},setValue:i}=(0,oo.xW)(),{activeStep:r,wizardData:c}=vr(),d="number"==typeof e.isOpen&&e.isOpen,u=(0,oo.FH)({name:"endType"}),{timezone:m="America/New_York",startDateTime:{date:p,time:h}}=c,b=r&&"rules"===r.id,f=function(){const{t:e}=(0,I.Bd)();return[{value:Yj.p3.SU,label:e("Sunday")},{value:Yj.p3.MO,label:e("Monday")},{value:Yj.p3.TU,label:e("Tuesday")},{value:Yj.p3.WE,label:e("Wednesday")},{value:Yj.p3.TH,label:e("Thursday")},{value:Yj.p3.FR,label:e("Friday")},{value:Yj.p3.SA,label:e("Saturday")}]}(),y=function(){const{t:e}=(0,I.Bd)();return[{label:e("Yearly"),value:Yj.jN.YEARLY},{label:e("Monthly"),value:Yj.jN.MONTHLY},{label:e("Weekly"),value:Yj.jN.WEEKLY},{label:e("Daily"),value:Yj.jN.DAILY},{label:e("Hourly"),value:Yj.jN.HOURLY},{label:e("Minutely"),value:Yj.jN.MINUTELY}]}(),x=function(){const{t:e}=(0,I.Bd)();return[{value:1,label:e("January")},{value:2,label:e("February")},{value:3,label:e("March")},{value:4,label:e("April")},{value:5,label:e("May")},{value:6,label:e("June")},{value:7,label:e("July")},{value:8,label:e("August")},{value:9,label:e("September")},{value:10,label:e("October")},{value:11,label:e("November")},{value:12,label:e("December")}]}();return(0,z.jsxs)(_d,{title:e.title,children:[(0,z.jsxs)(_d,{children:[(0,z.jsx)(ti,{name:"freq",isRequired:!0,label:t("Frequency"),labelHelp:t("This is the freq field.  It is required."),options:y}),(0,z.jsx)(li,{labelHelp:t("This is the interval field."),name:"interval",label:t("Interval"),type:"number"}),(0,z.jsx)(ti,{name:"wkst",label:t("Week start"),labelHelp:t("This is the wkst field. Select first day of the week."),options:f}),(0,z.jsx)(Yc,{label:t("Weekdays"),name:"byweekday",options:f,placeholder:t("Select weekdays"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the byweekday field. Select day(s) of the week on which to run the schedule.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:t("Sunday")}),(0,z.jsx)(Mn.v,{disabled:!0,children:t("Wednesday")}),(0,z.jsx)(Mn.v,{disabled:!0,children:t("Friday")})]})]}),disableSortOptions:!0}),(0,z.jsx)(Yc,{name:"bymonth",label:t("Months"),options:x,labelHelpTitle:t("Months"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the bymonth field. This field is used to declare which months of the year the schedule should run.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:t("June")}),(0,z.jsx)(Mn.v,{disabled:!0,children:t("August")}),(0,z.jsx)(Mn.v,{disabled:!0,children:t("January")})]})]}),placeholder:t("Select months"),disableSortOptions:!0}),(0,z.jsx)(Yc,{name:"byweekno",options:Qj,placeholder:t("Select weeks"),label:t("Annual week(s) number"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the byweekno field. This field is used to declare numbered weeks of the year the schedule should run.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:"17"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"43"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"52"})]})]}),labelHelpTitle:t("Annual weeks(s) number"),disableSortOptions:!0}),(0,z.jsx)(Yc,{name:"byminute",placeholder:t("Select hours"),options:t_,label:t("Minute(s) of hour"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the byminute field. This field is used to declare minute(s) of the hour the schedule should run.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:"1"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"37"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"59"})]})]}),labelHelpTitle:t("Minute(s) of hour"),disableSortOptions:!0}),(0,z.jsx)(Yc,{name:"byhour",placeholder:t("Select hours"),options:a_,label:t("Hour of day"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the byhour field. This field is used to declare hours of day the schedule should run.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:"0"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"7"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"18"})]})]}),labelHelpTitle:t("Hour of day"),disableSortOptions:!0}),(0,z.jsx)(Yc,{name:"bymonthday",placeholder:t("Select days"),options:n_,label:t("Month day(s)"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the bymonthday field. This field is used to declare ordinal days number of the month the schedule should run.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:"1"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"15"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"28"})]})]}),labelHelpTitle:t("Month day(s)"),disableSortOptions:!0}),(0,z.jsx)(Yc,{name:"byyearday",placeholder:t("Select days"),options:e_,label:t("Day(s) of year"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the byyearday field. This field is used to declare ordinal number days of the year the schedule should run. Do not use commas between the selected values")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:"1"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"235"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"300"})]})]}),labelHelpTitle:t("Day(s) of year"),disableSortOptions:!0}),(0,z.jsx)(Yc,{placeholder:t("Select positions"),options:e_,name:"bysetpos",labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:t("This is the bysetpos field. Use this field to filter down recurrence instances within a single interval of the rule. See the iCalendar RFC for bysetpos field more information.")}),(0,z.jsxs)(Ln.I,{children:[(0,z.jsx)(Mn.v,{disabled:!0,children:"1"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"235"}),(0,z.jsx)(Mn.v,{disabled:!0,children:"300"})]})]}),labelHelpTitle:t("Occurrences"),label:t("Occurrences"),disableSortOptions:!0}),(0,z.jsx)(vc,{disableSortOptions:!0,name:"endType",label:t("Schedule ending type"),placeholder:t("Method used to stop schedule"),options:[{value:"never",label:t("Never"),description:t("Never ending schedule")},{value:"count",label:t("Count"),description:t("Stop after a number of runs")},{value:"until",label:t("Until"),description:t("Stop on a specific date")}],isRequired:!0}),"count"===u&&(0,z.jsx)(li,{labelHelpTitle:t("Count"),label:t("Count"),name:"count",placeholder:"5",labelHelp:t("The number of time this rule should be used."),min:0,max:999,type:"number",isRequired:!0}),"until"===u&&(0,z.jsx)(i_,{name:"until",timePlaceHolder:"HH:MM AM/PM",label:t("Until"),labelHelpTitle:t("Until"),labelHelp:t("Use this rule until the specified date/time")})]}),(0,z.jsxs)(no.K,{className:"pf-v5-u-pt-xl",children:[(0,z.jsx)(g.$n,{variant:"secondary","data-cy":d?"update-rule-button":"add-rule-button",onClick:()=>{const t=a();delete t.endType,delete t.id;const{rules:r=[],exceptions:l=[],endType:c,until:u=null,...f}=t,g=je.c9.fromISO(`${p}`).set(n(h)),{year:y,month:x,day:j,hour:_,minute:v}=g,w=`${y}${r_(x)}${r_(j)}T${r_(_)}${r_(v)}00`,k=`DTSTART;TZID=${m}:${w}`,S=Yj.p3.fromString(k),C=new Yj.p3({...S.options,...f});if(null!==u){const e=u?.time,t=u?.date;if(t&&e){const a=je.c9.fromISO(`${t}`).set(n(e)).toUTC(),{year:s,month:o,day:i,hour:r,minute:l}=a;C.options.until=(0,Yj.w$)(s,o,i,r,l)}else{if(t){const e=je.c9.fromISO(`${t}`).toUTC(),{year:n,day:a,month:s,hour:o,minute:i}=e;C.options.until=(0,Yj.w$)(n,s,a,o,i)}if(e){const{year:t,day:a,month:s,hour:o,minute:i}=je.c9.now().plus({days:1}).set(n(e)).toUTC();C.options.until=(0,Yj.w$)(t,s,a,o,i)}}}const T={rule:C,id:d||(b?r.length+1||1:l.length+1||1)},I=b?r.findIndex((e=>e.id===d)):l.findIndex((e=>e.id===d));b&&i("rules",d?r.splice(I,1,T):r.push(T)),b||i("exceptions",d?l.splice(I,1,T):l.push(T)),s({...o,rules:r,exceptions:l},{keepDefaultValues:!0}),e.setIsOpen(!1)},children:t(d?b?"Update rule":"Update exception":b?"Save rule":"Save exception")}),(0,z.jsx)(g.$n,{"data-cy":"discard-rule-button",variant:"secondary",isDanger:!0,onClick:()=>{const{rules:n=[],exceptions:i=[]}=a(),r=e.title===t("Define rules")?Kj.Rules:Kj.Exceptions,l=r===Kj.Rules?[...n]:[...i];s({...o,[`${r}`]:l},{keepDefaultValues:!0}),e.setIsOpen(!1)},children:t("Discard")})]})]})}class c_ extends De.o{constructor(...e){return super(...e),this.toggleCollapse=e=>{e.preventDefault(),this.setState((e=>{const t=this.headingRef.current;return{isOpen:!e.isOpen,isTooltipVisible:Boolean(t&&t.offsetWidth<t.scrollWidth)}}))},this}}function d_(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)();(0,l.useEffect)((()=>{e.rrule&&async function(){const{local:t,utc:n}=await al(xl`/schedules/preview/`,{rrule:e.rrule});a({local:t,utc:n})}()}),[e.rrule]);const s=e.isLocal?n?.local:n?.utc;return(0,z.jsxs)(i.s,{children:[!e.hideColumnTitle&&(0,z.jsx)(r.Z,{children:t("Schedule summary")}),(0,z.jsx)(r.Z,{children:(0,z.jsx)(c_,{numLabels:5,children:s?.map(((e,t)=>(0,z.jsx)(Ee.J,{children:je.c9.fromISO(e,{setZone:!0}).toLocaleString(je.c9.DATETIME_SHORT_WITH_SECONDS)},t)))})})]})}function u_(e){const{isLocal:t,setIsLocal:n}=e,{t:a}=(0,I.Bd)();return(0,z.jsxs)(Oa.O,{isCompact:!0,children:[(0,z.jsx)(za.d,{id:"toggle-local","data-cy":"toggle-local","aria-label":a("Toggle to {{localTimezone}}",{timezone:e.localTimezone}),isSelected:e.isLocal,text:e.localTimezone,type:"button",onChange:()=>n(!0)}),(0,z.jsx)(za.d,{id:"toggle-utc","data-cy":"toggle-utc","aria-label":a("Toggle to UTC"),isSelected:!t,text:"UTC",type:"button",onChange:()=>n(!1)})]})}function m_(e){const[t,n]=(0,l.useState)(!0),{t:a}=(0,I.Bd)(),i=sc(),r="exception"===e.ruleType,c=function(e,t){const{t:n}=(0,I.Bd)(),a=(0,oo.xW)(),i=vr();return(0,l.useMemo)((()=>{if(!t)return[];const r=i.activeStep&&"exceptions"===i.activeStep.id,l=a.getValues("rules"),c=a.getValues("exceptions");return[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:n(r?"Edit exception":"Edit rule"),onClick:n=>{t(n.id);const s=e.find((e=>e.id===n.id));let o;if(void 0===s||!s.rule)return;null!==s?.rule?.options?.until&&(o=Vh(s?.rule?.options?.until?.toISOString()??"",s?.rule?.options?.tzid));const i={...s.rule.options,endType:s.rule.options.count?"count":s.rule.options.until?"until":"never",id:s.id,rules:l||[],exceptions:c||[],until:null!==s?.rule?.options?.until?{date:o[0],time:o[1]}:null};a.reset(i)}},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:n(r?"Delete exception":"Delete rule"),isPinned:!0,onClick:t=>{(t=>{const n=e.filter((e=>e.id!==t.id));r?a.setValue("exceptions",n):a.setValue("rules",n),i.setStepData((e=>(r?e.exceptions={...Xj,exceptions:n}:e.rules={...Xj,rule:n},{...e})))})(t)},isDanger:!0}]}),[n,e,a,i,t])}(e.rules,e.setIsOpen),d=(0,l.useMemo)((()=>[{header:"rules"===e.ruleType?a("Next occurrence timestamps"):a("Next exclusion timestamps"),cell:n=>(0,z.jsx)(d_,{rrule:n.rule.toString(),isLocal:void 0!==e.isLocalForDetails?e.isLocalForDetails:t,hideColumnTitle:!0})},{header:"rules"===e.ruleType?a("RRule"):a("Exrule"),cell:e=>(0,z.jsx)(ye,{text:e.rule.toString()}),modal:Ut.hidden,dashboard:Ut.hidden}]),[a,e.ruleType,t,e.isLocalForDetails]),u={pageItems:e.rules,keyFn:e=>e?.id?.toString(),tableColumns:d,itemCount:e.rules?.length||0},m=a(r?"Schedule exceptions are a component of an overall schedule.  A schedule exception is used to exclude dates from the schedule.  A schedule can have multiple exceptions.":"Schedule rules are a component of an overall schedule.  A schedule rule is used to determine when a schedule will run.  A schedule can have multiple rules."),p=pc(i,"schedules");return(0,z.jsxs)("div",{children:[e.needsHeader?(0,z.jsx)(qi,{controls:(0,z.jsx)(u_,{isLocal:t,setIsLocal:e=>n(e),localTimezone:e.timezone}),title:a(r?"Schedule Exceptions":"Schedule Rules"),titleHelpTitle:a(r?"Schedule Exceptions":"Schedule Rules"),titleHelp:a("Create as many schedule rules as you need."),titleDocLink:p,description:m,headerActions:(0,z.jsxs)(z.Fragment,{children:[a("iCalendar RFC "),(0,z.jsx)("a",{target:"_blank",href:"https://datatracker.ietf.org/doc/html/rfc5545",rel:"noreferrer",children:a("documentation")},"refDocLink")]})}):null,(0,z.jsx)($s,{id:"awx-schedule-rules-table",rowActions:c,errorStateTitle:a(r?"Error loading exceptions":"Error loading rules"),emptyStateTitle:a(r?"No exceptions yet":"No rules yet"),emptyStateDescription:a(r?"To get started, create an exception.":"To get started, create an rule."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:a(r?"Create exception":"Create Rule"),emptyStateButtonClick:()=>e.setIsOpen?e.setIsOpen(!0):null,defaultSubtitle:a(r?"Exceptions":"Rules"),disablePagination:!0,page:1,perPage:1,setPage:()=>1,setPerPage:()=>1,...u})]})}function p_(){const{t:e}=(0,I.Bd)(),[t,n]=(0,l.useState)(!1),{setValue:a,getValues:s}=(0,oo.xW)(),{wizardData:o}=vr(),{timezone:i}=o,r=s("rules"),c=r?.length>0;return(0,l.useEffect)((()=>{const{timezone:e,startDateTime:{date:t,time:n}}=o,[s,i]=n.split(":"),l=n.includes("PM"),c=je.c9.fromISO(`${t}`).set({hour:l?parseInt(s,10)+12:parseInt(`${s}`,10),minute:parseInt(i,10)}),{year:d,month:u,day:m,hour:p,minute:h}=c,b=(r||[]).map((({rule:t,id:n})=>({rule:new Yj.p3({...t.options,tzid:e,dtstart:(0,Yj.w$)(d,u,m,p,h)}),id:n})));a("rules",b)}),[r,o,a]),(0,z.jsxs)(_d,{singleColumn:!0,children:[!t&&c&&(0,z.jsx)(g.$n,{"data-cy":"add-rule-toolbar-button",icon:(0,z.jsx)(Za.GY,{}),onClick:()=>{n(!0)},variant:"link",children:e("Add rule")}),(t||!c)&&(0,z.jsx)(l_,{title:e("Define rules"),isOpen:t,setIsOpen:n}),c&&(0,z.jsx)(m_,{needsHeader:!0,timezone:i,rules:r,ruleType:"rules",setIsOpen:n})]})}function h_(){const{t:e}=(0,I.Bd)(),[t,n]=(0,l.useState)(!1),{getValues:a,setValue:s}=(0,oo.xW)(),o=a("exceptions"),i=o?.length>0,{setStepData:r,wizardData:c}=vr(),{rules:d,timezone:u}=c;return(0,l.useEffect)((()=>{s("rules",d);const{startDateTime:{date:e,time:t}}=c,[n,a]=t.split(":"),i=t.includes("PM"),r=je.c9.fromISO(`${e}`).set({hour:i?parseInt(n,10)+12:parseInt(`${n}`,10),minute:parseInt(a,10)}),{year:l,month:m,day:p,hour:h,minute:b}=r,f=(o||[]).map((({rule:e,id:t})=>({rule:new Yj.p3({...e.options,tzid:u,dtstart:(0,Yj.w$)(l,m,p,h,b)}),id:t})));s("exceptions",f)}),[r,s,o,u,d,c]),(0,z.jsxs)(_d,{singleColumn:!0,children:[!t&&i&&(0,z.jsx)(g.$n,{icon:(0,z.jsx)(Za.GY,{}),onClick:()=>{n(!0)},variant:"link",children:e("Add exception")}),t&&(0,z.jsx)(l_,{isOpen:t,title:e("Define exceptions"),setIsOpen:n}),(i||!t&&!i)&&(0,z.jsx)(m_,{rules:o,timezone:u,needsHeader:!0,ruleType:"exception",setIsOpen:n})]})}function b_(e){const t=Bp(),n=Fp(),a=Np(),s=$p(),o=(0,l.useMemo)((()=>[t,n,a,s]),[t,n,a,s]),i=Bh({disableLinks:!0}),r=Uc({url:xl`/workflow_job_templates/`,toolbarFilters:o,tableColumns:i,disableQueryString:!0});return(0,z.jsx)(Cp,{...e,toolbarFilters:o,tableColumns:i,view:r})}function f_(e){const{t}=(0,I.Bd)(),n=function(){const[e,t]=ss(),{t:n}=(0,I.Bd)();return(0,l.useCallback)((e=>{t((0,z.jsx)(b_,{title:n("Select workflow job template"),onSelect:e}))}),[t,n])}(),a=(0,l.useCallback)((async()=>{const e=await nl(xl`/workflow_job_templates/`.concat("?page_size=200"));return Promise.resolve({total:e.count,values:e.results})}),[]);return(0,z.jsx)(eh,{name:e.name,id:"workflow-job-template-select",label:t("Workflow job template"),query:a,valueToString:e=>e&&"string"==typeof e?e:e?.name??"",placeholder:t("Select workflow job template"),loadingPlaceholder:t("Loading workflow job templates..."),loadingErrorText:t("Error loading workflow job templates"),isRequired:e.isRequired,limit:200,openSelectDialog:n})}function g_(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),n=(0,oo.FH)({name:"resourceInventory"}),a=(0,oo.FH)({name:"schedule_type"});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(_d,{children:[(0,z.jsx)(ti,{isRequired:!t["*"]?.startsWith("schedules"),labelHelpTitle:e("Resource type"),labelHelp:e("Select a resource type onto which this schedule will be applied."),name:"schedule_type",id:"schedule_type","data-cy":"schedule-type",label:e("Resource type"),options:[{label:e("Job template"),value:"job_template"},{label:e("Workflow job template"),value:"workflow_job_template"},{label:e("Inventory source"),value:"inventory_source"},{label:e("Project sync"),value:"project"},{label:e("Management job template"),value:"management_job_template"}],placeholderText:e("Select job type")}),a&&{job_template:(0,z.jsx)(Nh,{isRequired:!0,name:"resource"}),workflow_job_template:(0,z.jsx)(f_,{isRequired:!0,name:"resource"}),inventory_source:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ih,{isRequired:!0,labelHelp:e("First, select the inventory to which the desired inventory source belongs."),name:"resourceInventory"}),n&&n?.id&&(0,z.jsx)(kh,{isRequired:!0,inventoryId:n?.id,name:"resource"})]}),project:(0,z.jsx)(Ih,{isRequired:!0,name:"resource"}),management_job_template:(0,z.jsx)(jh,{isRequired:!0,name:"resource"})}[a]]}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(k.c,{})})]})}function y_(){const{t:e}=(0,I.Bd)(),[t,n]=(0,l.useState)(""),a=(0,oo.FH)({name:"timezone"}),s=(0,oo.FH)({name:"resource"}),o=s?.name&&(s.name.includes("Cleanup Activity Stream")||s.name.includes("Cleanup Job Details")),{timeZones:i,links:r}=function(){const{data:e}=ec(xl`/schedules/zoneinfo/`);return{timeZones:(0,l.useMemo)((()=>(e?.zones||[]).map((e=>({value:e,key:e,label:e})))),[e?.zones]),links:e?.links}}();return(0,l.useEffect)((()=>{r&&(a?.length&&r[a]?n(e(`Warning: ${a} is a link to ${r[a]} and will be saved as that.`)):n(""))}),[a,e,r]),(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(_d,{children:[(0,z.jsx)(li,{name:"name",isRequired:!0,label:e("Schedule name")}),(0,z.jsx)(li,{name:"description",label:e("Description")}),(0,z.jsx)(i_,{label:e("Start date/time"),name:"startDateTime",isRequired:!0}),(0,z.jsx)(vc,{name:"timezone",placeholder:e("Select a time zone"),label:e("Time zone"),options:i,helperText:t,isRequired:!0}),o&&(0,z.jsx)(li,{name:"schedule_days_to_keep",isRequired:!0,label:e("Days of data to keep"),type:"number",min:1})]})})}function x_(e){const t=e.isTopLevelSchedule,n=(0,Re.g)(),{reset:a,getValues:s,setValue:o,formState:i,getFieldState:r,register:c,control:d}=(0,oo.xW)(),{defaultValues:u}=i,m=(0,oo.FH)({name:"resource"}),{setWizardData:p,setStepData:h,stepData:b,steps:f}=vr();c("schedule_type"),c("resource"),c("prompt"),(0,l.useEffect)((()=>{!m&&n?.id&&void 0!==e.resourceEndPoint&&(async()=>{let t;t=n.source_id?await nl(`${e.resourceEndPoint??""}${n.source_id}/`):await nl(`${e.resourceEndPoint??""}${n?.id}/`),a({...u,schedule_type:t.type,resource:t},{keepDefaultValues:!1})})()}),[n,m,u,e.resourceEndPoint,a,o]);const g=(0,oo.FH)({name:"schedule_type",control:d,defaultValue:u?.schedule_type});return(0,l.useEffect)((()=>{const{isDirty:e,isTouched:t}=r("schedule_type"),n=s();o("schedule_type",g,{shouldTouch:!0}),t&&!e&&(a(void 0,{keepDefaultValues:!0}),p({...n,launch_config:null}),h({...b,details:n}))}),[g,r,o,a,f,p,h,s,b]),(0,l.useEffect)((()=>{const t="job_template"!==m?.type&&"workflow_job_template"!==m?.type;m?.id&&(!t||e.resourceEndPoint?.includes("/job_template")||e.resourceEndPoint?.includes("/workflow_job_template"))&&(async()=>{let t="";t="job_template"===m.type?xl`/job_templates/${m.id.toString()}/launch/`:"workflow_job_template"===m.type?xl`/workflow_job_templates/${m.id.toString()}/launch/`:`${e.resourceEndPoint??""}/${m.id.toString()}/launch/`;let n={};const a=await nl(t),{job_tags:s="",skip_tags:i="",inventory:l,...c}=a.defaults;n={...c,instance_groups:c.instance_groups||[],execution_environment:c.execution_environment?.id,inventory:l?.id?l:null,job_tags:xm(s||""),skip_tags:xm(i||"")};const d=!km(a),h=a.survey_enabled;if(d||h){if(p((e=>({...e,launch_config:a}))),b.promptStep&&m){const{isDirty:e}=r("schedule_type");o("prompt",e||m?.id!==u?.resource?.id?n:{...b.promptStep?.prompt})}}else p((e=>({...e,launch_config:null})))})()}),[f,u,r,s,m,g,o,p,b,t,e.resourceEndPoint]),(0,z.jsx)(z.Fragment,{children:t?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(g_,{}),m&&(0,z.jsx)(y_,{})]}):(0,z.jsx)(y_,{})})}const j_=()=>{const e=(0,Re.g)(),t=function(){const e=(()=>{const e=Hs(),t=td(),n=td();return(0,l.useCallback)((async(a,s,o)=>{const i=s||[],r=o?.defaults.credentials||[];if(i){const{added:s,removed:o}=dm(i.length?i:[],r),l=o.map((n=>t(xl`/schedules/${a.toString()}/credentials/`,{id:n.id,disassociate:!0},e.signal))),c=s.map((t=>n(xl`/schedules/${a.toString()}/credentials/`,{id:t.id},e.signal)));await Promise.all([...l,...c])}}),[t,n,e])})(),t=(()=>{const e=Hs(),t=td(),n=td();return(0,l.useCallback)((async(a,s,o)=>{const i=o?.ask_instance_groups_on_launch,r=o?.defaults.instance_groups;if(i){const{added:o,removed:i}=dm(r||[],s||[]),l=i.map((n=>t(xl`/schedules/${a.toString()}/instance_groups/`,{id:n.id,disassociate:!0},e.signal))),c=o.map((t=>n(xl`/schedules/${a.toString()}/instance_groups/`,{id:t.id},e.signal)));await Promise.all([...l,...c])}else if(r){const n=r.map((n=>t(xl`/schedules/${a.toString()}/instance_groups/`,{id:n.id,disassociate:!0},e.signal)));await Promise.all(n)}}),[t,n,e])})(),n=(()=>{const e=Hs(),t=td(),n=td();return(0,l.useCallback)((async(a,s,o,i)=>{const r=o?.ask_labels_on_launch,l=o?.defaults?.labels;if(r){const o=i??await async function(){return(await nl(xl`/organizations/`)).results[0].id||1}(),{added:r,removed:c}=dm(l||[],s||[]),d=c.map((n=>t(xl`/schedules/${a.toString()}/labels/`,{id:n.id,disassociate:!0},e.signal))),u=r.map((t=>n(xl`/schedules/${a.toString()}/labels/`,t.id?{id:t.id}:{name:t.name,organization:t?.organization??o},e.signal)));await Promise.all([...d,...u])}else if(l){const n=l.map((n=>t(xl`/schedules/${a.toString()}/labels/`,{id:n.id,disassociate:!0},e.signal)));await Promise.all(n)}}),[t,n,e])})();return(0,l.useCallback)((async(a,s)=>{s.credentials&&await e(a.id,s.credentials,s.launch_config),s.instance_groups&&await t(a.id,s.instance_groups,s.launch_config),s.labels&&await n(a.id,s.labels,s.launch_config,s.organization)}),[e,t,n])}(),n=td(),a=ed();return(0,l.useCallback)((async s=>{const{resource:o,prompt:i,schedule_days_to_keep:r,survey:l,enabled:c,...d}=s,u=(t,s)=>e.schedule_id&&e.id?a(xl`/schedules/${e.schedule_id.toString()}/`,{...s,unified_job_template:o.id}):n(t,s),{execution_environment:m,credentials:p,job_tags:h,skip_tags:b,inventory:f,...g}=i||{execution_environment:null,job_tags:"",skip_tags:""},{type:y,id:x}=o;let j;const _={},v=h&&h?.length>0,w=i&&i?.skip_tags&&i?.skip_tags?.length>0;r&&Object.assign(_,{days:r}),l&&Object.keys(l).forEach((e=>{_[e]=l[e]}));const k={...d,...g,inventory:f?.id,execution_environment:m,skip_tags:w?jm(i?.skip_tags):void 0,job_tags:v?jm(h):void 0,enabled:c,extra_data:_};switch(y){case"inventory_source":return{schedule:await u(xl`/inventory_sources/${x.toString()}/schedules/`,k)};case"project":return{schedule:await u(xl`/projects/${x.toString()}/schedules/`,k)};case"system_job_template":return{schedule:await u(xl`/system_job_templates/${x.toString()}/schedules/`,k)};case"workflow_job_template":return j=await u(xl`/workflow_job_templates/${x.toString()}/schedules/`,k),await t(j,k),{schedule:j};default:return j=await u(xl`/job_templates/${x.toString()}/schedules/`,k),await t(j,k),{schedule:j}}}),[e.schedule_id,a,n,e.id,t])},__={inventory_update:fc.InventorySourceDetail,job:fc.JobTemplateDetails,project:fc.ProjectDetails,management_job_template:fc.ManagementJobSchedules,workflow_approval:fc.WorkflowApprovalDetails,workflow_job:fc.WorkflowJobTemplateDetails};function v_(){const{t:e}=(0,I.Bd)(),t=gr(),[n,s]=(0,l.useState)(!0),{wizardData:o,visibleSteps:i}=vr(),{schedule_type:r,resource:c,schedule_days_to_keep:d,name:u,description:m,startDateTime:p,timezone:h,exceptions:b,rules:f}=o,g=Boolean(i.find((e=>"promptStep"===e.id||"survey"===e.id))),y=function(e){const{t}=(0,I.Bd)();return{job:t("Job Template"),job_template:t("Job Template"),workflow_job:t("Workflow Job Template"),workflow_job_template:t("Workflow Job Template"),project_update:t("Project Update"),inventory_update:t("Inventory Update"),system_job:t("Management Job"),management_job_template:t("Management Job")}[e]}(r);let x=t(__[r],{params:{id:c?.id}});c&&"type"in c&&"inventory_source"===c.type&&(x=t(fc.InventorySourceDetail,{params:{source_id:c?.id,id:c?.inventory,inventory_type:""===c?.summary_fields?.inventory.kind?"inventory":c?.summary_fields?.inventory.kind}}));const j=new Yj.Dz;return j.options.dtstart,f.forEach((({rule:e},t)=>{const{options:{dtstart:n,tzid:a,...s}}=e;0!==t?j.rrule(new Yj.p3({...s})):j.rrule(new Yj.p3({...s,dtstart:n,tzid:a}))})),b.length>0&&b.forEach((({rule:e})=>{const{options:{dtstart:t,tzid:n,...a}}=e;j.exrule(new Yj.p3({...a}))})),(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(_d,{title:e("Review"),singleColumn:!0,children:[(0,z.jsxs)(Mt,{numberOfColumns:"two",disablePadding:!0,children:[(0,z.jsx)(Ft,{label:e("Resource type"),children:y}),(0,z.jsx)(Ft,{label:e("Resource"),children:(0,z.jsx)(a.N_,{to:x,children:c?.name})}),(0,z.jsx)(Ft,{label:e("Name"),children:u}),(0,z.jsx)(Ft,{label:e("Description"),children:m}),p&&(0,z.jsx)(Ft,{label:e("Start date/time"),children:p.date+", "+p.time}),(0,z.jsx)(Ft,{label:e("Local time zone"),children:h}),(0,z.jsx)(Ft,{label:e("Days of data to keep"),children:d}),g?(0,z.jsx)(dh,{}):null]}),(0,z.jsx)(Ft,{fullWidth:!0,label:e("Toggle timezone"),children:(0,z.jsx)(u_,{isLocal:n,setIsLocal:s,localTimezone:h})}),(0,z.jsx)(m_,{ruleType:"rules",rules:f,timezone:h,isLocalForDetails:n}),b.length?(0,z.jsx)(m_,{ruleType:"exceptions",rules:b,timezone:h,isLocalForDetails:n}):null]})})}function w_(){const{t:e}=(0,I.Bd)();return(0,l.useCallback)(((t,n)=>{const a=n.summary_fields.unified_job_template.unified_job_type;let s={id:n.summary_fields.unified_job_template?.id.toString(),schedule_id:n.id.toString()};return"inventory_update"===a&&n.summary_fields.inventory?.id?(s={id:n.summary_fields.inventory?.id.toString(),source_id:n.summary_fields.unified_job_template.id.toString(),schedule_id:n.id.toString(),inventory_type:"inventory"},{name:e("Inventory sync"),details:{pageId:fc.InventorySourceScheduleDetails,params:s},create:{pageId:fc.InventorySourceScheduleCreate,params:s},edit:{pageId:fc.InventorySourceScheduleEdit,params:s},resource:{pageId:fc.InventorySourceDetail,params:s},scheduleList:{pageId:fc.InventorySourceSchedules,params:s}}[t]):"job"===a?{name:e("Playbook run"),details:{pageId:fc.JobTemplateScheduleDetails,params:s},create:{pageId:fc.JobTemplateScheduleCreate,params:s},edit:{pageId:fc.JobTemplateScheduleEdit,params:s},resource:{pageId:fc.JobTemplateDetails,params:s},scheduleList:{pageId:fc.JobTemplateSchedules,params:s}}[t]:"project_update"===a?{name:e("Project update"),details:{pageId:fc.ProjectScheduleDetails,params:s},create:{pageId:fc.ProjectScheduleCreate,params:s},edit:{pageId:fc.ProjectScheduleEdit,params:s},resource:{pageId:fc.ProjectDetails,params:s},scheduleList:{pageId:fc.ProjectSchedules,params:s}}[t]:"system_job"===a?{name:e("Management job"),details:{pageId:fc.ManagementJobScheduleDetails,params:s},create:{pageId:fc.ManagementJobScheduleCreate,params:s},edit:{pageId:fc.ManagementJobScheduleEdit,params:s},resource:{pageId:fc.ManagementJobSchedules,params:s},scheduleList:{pageId:fc.ManagementJobSchedules,params:s}}[t]:"workflow_job"===a?{name:e("Workflow job"),details:{pageId:fc.WorkflowJobTemplateScheduleDetails,params:s},create:{pageId:fc.WorkflowJobTemplateScheduleCreate,params:s},edit:{pageId:fc.WorkflowJobTemplateScheduleEdit,params:s},resource:{pageId:fc.WorkflowJobTemplateDetails,params:s},scheduleList:{pageId:fc.WorkflowJobTemplateSchedules,params:s}}[t]:""}),[e])}function k_(){return(0,l.useCallback)(((e,t)=>{const n=new Yj.Dz;return e.forEach(((e,t)=>{const{rule:{options:{dtstart:a,tzid:s,...o}}}=e;0===t?n.rrule(new Yj.p3({...o,dtstart:a,tzid:s})):n.rrule(new Yj.p3({...o}))})),t.length&&t?.forEach((e=>{const{rule:{options:{dtstart:t,tzid:a,...s}}}=e;n.exrule(new Yj.p3({...s}))})),n}),[])}function S_(e){const{t}=(0,I.Bd)(),n=gr(),a=yr(),s=(0,Re.Zp)(),o=j_(),i=w_(),r=k_(),c=je.c9.now(),d=je.c9.fromMillis(9e5*Math.ceil(c.toMillis()/9e5)),[u,m]=Vh(d.toISO()),p=(0,l.useMemo)((()=>[{id:"details",label:t("Details"),inputs:(0,z.jsx)(x_,{...e})},{id:"promptStep",label:t("Prompts"),inputs:(0,z.jsx)(ch,{}),hidden:e=>{const{resource:t,schedule_type:n,launch_config:a}=e;return"workflow_job_template"!==n&&"job_template"!==n||!t||!a||km(a)}},{id:"survey",label:t("Survey"),inputs:(0,z.jsx)(Wh,{}),hidden:e=>0===Object.keys(e).length||!e.launch_config?.survey_enabled},{id:"rules",label:t("Rules"),inputs:(0,z.jsx)(p_,{}),validate:e=>{if(!e?.rules?.length){const e={__all__:[t("Schedules must have at least one rule.")]};throw new Xr("","",400,"",e)}}},{id:"exceptions",label:t("Exceptions"),inputs:(0,z.jsx)(h_,{})},{id:"review",label:t("Review"),inputs:(0,z.jsx)(v_,{}),validate:async(e,n)=>{if(!n?.rules?.length){const e={__all__:[t("Schedules must have at least one rule.")]};throw new Xr("","",400,"",e)}const a=r(n.rules,n.exceptions??[]),{utc:s,local:o}=await al(xl`/schedules/preview/`,{rrule:a.toString().split("\n").join(" ")});if(!o.length&&!s.length){const e={__all__:[t("This schedule will never run.  If you have defined exceptions it is likely that the exceptions cancel out all the rules defined in the rules step.")]};throw new Xr("","",400,"",e)}}}]),[r,t,e]),h={details:{name:"",description:"",schedule_type:"",resource:"",startDateTime:{date:u,time:m},timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},rules:{...Xj,rules:[]},exceptions:{...Xj,exceptions:[]}};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("Create schedule"),breadcrumbs:[{label:t("Schedules"),to:n(fc.Schedules)},{label:t("Create schedule")}]}),(0,z.jsx)(Lr,{steps:p,singleColumn:!1,onCancel:()=>s(location.pathname.replace("create","")),defaultValue:h,onSubmit:async e=>{const{rules:t,exceptions:n,...s}=e,l={rrule:r(t,n).toString().split("\n").join(" "),...s};try{const{schedule:e}=await o(l),t=i("details",e);a(t.pageId,{params:t.params})}catch(e){const{fieldErrors:t}=Mc(e),n=t.find((e=>"resources_needed_to_start"===e?.name));if(n){const e={__all__:[n.message]};throw new Xr("","",400,"",e)}}},errorAdapter:Mc})]})}function C_(e){const t=yr();return(0,z.jsx)(Ft,{label:e.label,children:(0,z.jsx)(Ie,{value:e.date,author:e?.user.username,onClick:()=>t(fc.UserDetails,{params:{id:e.user.id}})})})}function T_(e){const{t}=(0,I.Bd)(),[n,a]=(0,l.useState)(!0),s=(0,Re.g)(),o=yr(),{data:i,error:r,refresh:c}=tc(xl`/schedules/`,s.schedule_id),d="string"==typeof i?.job_tags?xm(i?.job_tags):i?.job_tags,u="string"==typeof i?.skip_tags?xm(i?.skip_tags):i?.skip_tags;if(r)return(0,z.jsx)(Ic,{error:r,handleRefresh:c});if(!i)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const m=JSON.stringify(i?.extra_data).includes("days"),p=i?.extra_data,h=(0,Yj.YI)(i.rrule,{forceset:!0}),b=h.rrules().map(((e,t)=>({rule:e,id:t}))),f=h.exrules().map(((e,t)=>({rule:e,id:t})));return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Mt,{numberOfColumns:"multiple",children:[(0,z.jsx)(Ft,{label:t("Name"),children:i?.name}),(0,z.jsx)(Ft,{label:t("Description"),children:i?.description}),(0,z.jsx)(Ft,{label:t("First run"),children:Jh(i?.dtstart,i.timezone)}),i.next_run?(0,z.jsx)(Ft,{label:t("Next run"),children:Jh(i?.next_run,i.timezone)}):null,i.dtend?(0,z.jsx)(Ft,{label:t("Last run"),children:Jh(i?.dtend,i.timezone)}):null,(0,z.jsx)(Ft,{label:t("Time zone"),children:i?.timezone}),(0,z.jsx)(Ft,{label:t("RruleSet"),fullWidth:!0,children:(0,z.jsx)(ye,{text:i?.rrule.toString()})}),!e.isSystemJobTemplateSchedule&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(C_,{label:t("Created"),date:i.created,user:i.summary_fields.created_by}),(0,z.jsx)(Xd,{value:i.modified,author:i.summary_fields.modified_by?.username,onClick:()=>o(fc.UserDetails,{params:{id:i.summary_fields.modified_by?.id}})})]}),(0,z.jsx)(Ft,{fullWidth:!0,children:(0,z.jsx)(k.c,{})}),(0,z.jsx)(Ft,{label:t("Inventory"),children:i.summary_fields.inventory?.name}),(0,z.jsx)(Ft,{label:t("Job type"),children:i.job_type}),(0,z.jsx)(Ft,{label:t("Limit"),children:i.limit}),(0,z.jsx)(Ft,{label:t("Forks"),children:i.forks}),(0,z.jsx)(Ft,{label:t("Verbosity"),children:i.verbosity}),(0,z.jsx)(Ft,{label:t("Show changes"),children:i.diff_mode?t`On`:t`Off`}),(0,z.jsx)(Ft,{label:t("Job tags"),isEmpty:!i.job_tags,children:(0,z.jsx)(De.o,{children:d?.map((({name:e})=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{label:t("Skip tags"),isEmpty:!i.skip_tags,children:(0,z.jsx)(De.o,{children:u?.map((({name:e})=>(0,z.jsx)(Ee.J,{children:e},e)))})}),!m&&(0,z.jsx)(Ft,{fullWidth:!0,children:(0,z.jsx)(Wu,{label:t("Extra variables"),value:JSON.stringify(i.extra_data)})}),m&&(0,z.jsx)(Ft,{fullWidth:!0,label:t("Days of data to keep"),children:"string"==typeof p?p.toString().replace("}","").split(":")[1]:i.extra_data.days?.toString()}),i&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ft,{fullWidth:!0,label:t("Toggle timezone"),children:(0,z.jsx)(u_,{isLocal:n,setIsLocal:a,localTimezone:i.timezone})}),(0,z.jsx)(d_,{rrule:i.rrule,isLocal:n})]}),(0,z.jsxs)(Ft,{fullWidth:!0,children:[(0,z.jsx)(m_,{ruleType:"rules",timezone:i.timezone,rules:b,isLocalForDetails:n}),f.length?(0,z.jsx)(m_,{ruleType:"exceptions",timezone:i.timezone,rules:f,isLocalForDetails:n}):null]})]})})}function I_(e){const{t}=(0,I.Bd)(),n=w_(),a=yr(),s=ju({...e,makeReadable:e=>n("name",e),sort:"unified_job_template__polymorphic_ctype__model"}),o=(0,l.useCallback)((e=>{const t=n("details",e);return a(t.pageId,{params:t.params})}),[n,a]),i=pu({...e,onClick:o}),r=(0,l.useCallback)((e=>{const t=n("resource",e);return a(t.pageId,{params:t.params})}),[n,a]),c=hu();return(0,l.useMemo)((()=>[i,c,{header:t("Related resource"),sort:"unified_job_template",cell:e=>(0,z.jsx)(Fe,{text:e.summary_fields.unified_job_template.name,onClick:()=>r(e)})},s,{header:t("Next run"),sort:"next_run",cell:e=>(0,z.jsx)(Ie,{value:e.next_run})}]),[i,c,t,s,r])}function A_(e){const{t}=(0,I.Bd)(),n=I_({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete schedule",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} schedules.",{count:a.length}),actionButtonText:t("Delete schedule",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/schedules/${e.id.toString()}/`,t)})}}function D_(e){const{t}=(0,I.Bd)(),n=A_(e?.onScheduleDeleteCompleted),{data:a}=dd(xl`/schedules/`),i=Boolean(a&&a.actions&&a.actions.POST),r=(0,l.useCallback)((async(t,n)=>{const a=await sl(xl`/schedules/${t.id.toString()}/`,{enabled:n});e.onScheduleToggleCompleted(a)}),[e]),c=gr(),d=w_(),u=(0,l.useCallback)((e=>{const t=d("edit",e);return c(t.pageId,{params:t.params})}),[c,d]);return(0,l.useMemo)((()=>[{isPinned:!0,ariaLabel:e=>t(e?"Click to disable schedule":"Click to enable schedule"),type:s.Switch,selection:o.Single,labelOff:t("Schedule disabled"),label:t("Schedule enabled"),isDisabled:e=>Ig(e,t,i),onToggle:(e,t)=>r(e,t),isSwitchOn:e=>e.enabled},{type:s.Link,selection:o.Single,icon:yc.oo,variant:g.Ak.primary,label:t("Edit schedule"),isDisabled:e=>Ig(e,t,i),href:e=>u(e),isPinned:!0},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete schedule"),isDisabled:e=>Ag(e,t),onClick:e=>n([e]),isDanger:!0}]),[t,i,r,u,n])}function E_(e){const t=Tg("schedule"),n=Hs(),[a,s]=(0,l.useState)(null),o=e.initialBreadCrumbs.some((({id:e})=>"inventory_sources"===e)),i=gr(),r=(0,Re.g)(),{error:c,data:d,refresh:u}=tc(xl`/schedules`,r.schedule_id),m=(0,Re.Zp)(),{error:p,data:h,refresh:b}=tc(`${e.resourceEndPoint}`,o?r.source_id:r.id),f=w_();let g={id:fc.Schedules};if(d){const{pageId:e,params:t}=f("scheduleList",d);g={id:e,params:t}}const y=D_({onScheduleDeleteCompleted:()=>m(i(g.id,{params:g.params})),onScheduleToggleCompleted:u});(0,l.useEffect)((()=>{!async function(){o&&r.id&&await nl(xl`/inventories/${r.id}/`,n.signal).then((e=>{s(e)}))}()}),[o,r.id,n.signal]);const x=(0,l.useMemo)((()=>[...e.initialBreadCrumbs.map((e=>{const t={id:o?a?.id:h?.id,inventory_type:o?Zj:void 0,source_id:o?h?.id:void 0};return"data"===e.id?{label:`${h?.name}`,to:i(e.to,{params:t})}:"inventory"===e.id&&o?{label:`${a?.name}`,to:i(e.to,{params:{id:a?.id,inventory_type:o?Zj:void 0,source_id:o?h?.id:void 0}})}:"schedules"===e.id?{label:e.label,to:i(e.to,{params:t})}:"inventory_sources"===e.id?{label:e.label,to:i(e.to,{params:{id:a?.id,inventory_type:o?Zj:void 0}})}:{label:e.label,to:i(e.to)}})),{label:d?.name}]),[i,h?.id,h?.name,a?.id,a?.name,o,e.initialBreadCrumbs,d?.name]),j=p||c,_=u??b;return j?(0,z.jsx)(Ic,{error:j,handleRefresh:_}):d&&h?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:d?.name,breadcrumbs:x,headerActions:(0,z.jsx)(oe,{actions:[...t,...y],position:te.nU.right,selectedItem:d})}),(0,z.jsx)(Nc,{backTab:e.backTab,tabs:e.tabs,params:r})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function P_(){const{id:e=""}=(0,Re.g)();return(0,z.jsx)(Og,{url:xl`/job_templates/`,inventoryId:e})}function R_(e){const{t}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:"Activity"===e?t("Activity"):"Recent jobs"===e?t("Recent jobs"):"",cell:e=>(0,z.jsx)(Ph,{jobs:e.summary_fields?.recent_jobs}),value:e=>e.summary_fields?.recent_jobs&&e.summary_fields?.recent_jobs?.length>0,card:"hidden",list:"hidden"})),[t,e])}function B_(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Description"),type:"description",value:e=>e.description,list:"description",card:"description"})),[e])}function F_(){const{t:e}=(0,I.Bd)(),t=yr(),n=Yy(),a=function(e){const t=yr(),n=(0,Re.g)(),a=(0,l.useCallback)((e=>t(fc.InventoryHostDetails,{params:{inventory_type:n.inventory_type,id:n.id,host_id:e.id}})),[t,n.id,n.inventory_type]),s=pu({...e,onClick:a}),o=B_(),i=bu(e),r=fu(e),c=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Related groups"),cell:t=>{const n=t?.summary_fields?.groups??{results:[],count:0};return(0,z.jsx)(Ln.I,{"aria-label":e`Related groups`,children:n.results.map((e=>(0,z.jsx)(Mn.v,{isReadOnly:!0,children:e.name},e.name)))})},sort:void 0,defaultSortDirection:"desc"})),[e])}(),d=R_("Recent jobs"),u=yu(fc.InventoryDetails,{tableViewOption:void 0});return(0,l.useMemo)((()=>{let e=[];return"inventory"===n.inventory_type&&(e=[s,o,c,i,r]),"smart_inventory"!==n.inventory_type&&"constructed_inventory"!==n.inventory_type||(d.sort="",u.sort="",e=[s,d,u]),e}),[s,o,c,i,r,d,u,n.inventory_type])}(),i=(0,Re.g)(),r=Uc({url:xl`/inventories/${i.id??""}/hosts/`,toolbarFilters:n,tableColumns:a}),c=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Jy(e.unselectItemsAndRefresh),i=(0,Re.g)(),r=i.inventory_type,c=e.selectedItems||[],d=Px({...i,selectedItems:c,actionType:"toolbar"}),u=dd(xl`/hosts/`).data,m=Boolean(u&&u.actions&&u.actions.POST);return(0,l.useMemo)((()=>{const e=[];return"inventory"===r&&e.push({type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create host"),onClick:()=>n(String(fc.InventoryHostAdd),{params:{inventory_type:i.inventory_type,id:i.id}}),isDisabled:()=>m?void 0:t("You do not have permission to create a host. Please contact your organization administrator if there is an issue with your access.")}),e.push(d),"inventory"===r&&(e.push({type:s.Seperator}),e.push({type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete hosts"),onClick:a,isDanger:!0,isDisabled:e=>Dg(e,t)})),e}),[t,a,n,i.inventory_type,i.id,m,d,r])}(r),d=Vy(r.unselectItemsAndRefresh,r.updateItem),u=dd(xl`/hosts/`).data,m=Boolean(u&&u.actions&&u.actions.POST&&"inventory"===i.inventory_type);let p="",h="";return"inventory"===i.inventory_type?(p=e(m?"There are currently no hosts added to this inventory.":"You do not have permission to create a host."),h=e(m?"Please create a host by using the button below.":"Please contact your organization administrator if there is an issue with your access.")):(p=e("No hosts Found"),h=e("Please add hosts to populate this list")),Fc("inventories"),(0,z.jsx)(Ui,{children:(0,z.jsx)($s,{id:"awx-inventory-hosts-table",toolbarFilters:n,toolbarActions:c,tableColumns:a,rowActions:d,errorStateTitle:e("Error loading inventory hosts"),emptyStateTitle:p,emptyStateDescription:h,emptyStateIcon:m?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:m?e("Create host"):void 0,emptyStateButtonClick:m?()=>t(fc.InventoryHostAdd,{params:{id:i.id,inventory_type:i.inventory_type}}):void 0,...r})})}function N_(e,t){const{t:n}=(0,I.Bd)(),a=yr(),i=function(e){const{t}=(0,I.Bd)(),n=function(e){const t=yr(),n=(0,l.useCallback)((e=>t(fc.InventorySourceDetail,{params:{id:e.id}})),[t]),a=pu({...e,onClick:n}),s=hu(),o=bu(e),i=fu(e);return(0,l.useMemo)((()=>[a,s,o,i]),[a,s,o,i])}({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete sources",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} sources.",{count:a.length}),actionButtonText:t("Delete sources",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/inventory_sources/${e.id.toString()}/`,t)})}}(e.unselectItemsAndRefresh),r=(0,Re.g)(),c=dd(xl`/inventory_sources/`).data,d=Boolean(c&&c.actions&&c.actions.POST),{activeAwxUser:u}=_l();let m="";void 0!==e.pageItems&&0!==e.pageItems.length||(m=n("There are no inventory sources to update")),(e.pageItems&&!e.pageItems.every((e=>e.summary_fields.user_capabilities.start))||u?.is_system_auditor)&&(m=n("The inventory source cannot be updated due to insufficient permission"));const p=function(e,t){const n=xl`/inventories/${e}/update_inventory_sources/`,a=td(),s=ue(),{t:o}=(0,I.Bd)();return()=>{(async()=>{try{await a(n,{}),t()}catch(e){s.addAlert({variant:"danger",title:o("Failed to sync all inventory sources"),children:e instanceof Error?e.message:String(e),timeout:5e3})}})()}}(t,e.refresh);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:n("Create source"),onClick:()=>a(String(fc.InventorySourcesAdd),{params:{inventory_type:r.inventory_type,id:r.id}}),isDisabled:()=>d?void 0:n("You do not have permission to create a source. Please contact your organization administrator if there is an issue with your access.")},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:n("Delete sources"),onClick:i,isDanger:!0,isDisabled:e=>Dg(e,n)},{type:s.Button,selection:o.None,icon:mb.Ab,label:n("Launch inventory updates"),onClick:p,isDisabled:()=>m}]),[n,i,a,r.inventory_type,r.id,d,m,p])}function $_(){const{t:e}=(0,I.Bd)(),t=yr(),n=_h(),a=(0,Re.g)(),s=vh(`inventories/${a.id??""}/inventory_sources/`),o=Uc({url:xl`/inventories/${a.id??""}/inventory_sources/`,toolbarFilters:s,tableColumns:n}),i=N_(o,a.id||""),r=Vj({onInventorySourcesDeleted:o.unselectItemsAndRefresh,onInvUpdateCanceled:o.unselectItemsAndRefresh}),c=dd(xl`/inventory_sources/`).data,d=Boolean(c&&c.actions&&c.actions.POST);return Fc("inventories"),dc({control:["limit_reached_1"],jobs:["status_changed"],inventories:["status_changed"]},(0,l.useCallback)((e=>{if(e?.inventory_id)switch(e?.group_name){case"inventories":"deleted"===e?.status&&o.refresh();break;case"jobs":"inventory_update"===e?.type&&o.refresh()}}),[o])),(0,z.jsx)(Ui,{children:(0,z.jsx)($s,{id:"awx-inventory-sources-table",toolbarFilters:s,toolbarActions:i,tableColumns:n,rowActions:r,errorStateTitle:e("Error loading inventory sources"),emptyStateTitle:e(d?"There are currently no sources added to this inventory.":"You do not have permission to create a host"),emptyStateDescription:e(d?"Please create a source by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:d?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:d?e("Create source"):void 0,emptyStateButtonClick:d?()=>t(fc.InventorySourcesAdd,{params:{id:a.id,inventory_type:a.inventory_type}}):void 0,...o})})}function M_({url:e,queryParams:t}){const n=Np();return Pp({optionsPath:e||"groups",preFilledValueKeys:{name:{apiPath:e||"groups",queryParams:t||{}},id:{apiPath:e||"groups",queryParams:t||{}}},preSortedKeys:["name","id","description","created-by","modified-by","group"],additionalFilters:[$p(),n,function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({key:"group",label:e("Group type"),type:Ia.MultiSelect,query:"parents__isnull",options:[{label:e("Show only root groups"),value:"true"}],placeholder:e("Filter by group type")})),[e])}()],removeFilters:["inventory"]})}function L_(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.g)(),a=Px({...n,actionType:"row"},{isPinned:!1});return(0,l.useMemo)((()=>"constructed_inventory"===n.inventory_type?[]:[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:e("Edit group"),onClick:e=>t(fc.InventoryGroupEdit,{params:{inventory_type:n.inventory_type,id:e.inventory,group_id:e.id}}),isDisabled:t=>Ig(t,e)},a]),[e,t,a,n.inventory_type])}function O_(){const{t:e}=(0,I.Bd)(),t=yr(),n=function(e){const t=yr(),n=(0,Re.g)(),a=(0,l.useCallback)((e=>t(fc.InventoryGroupDetails,{params:{inventory_type:n.inventory_type,id:e.inventory,group_id:e.id}})),[t,n.inventory_type]),s=pu({...e,onClick:a}),o=bu(e),i=fu(e),r=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({header:e("Related groups"),cell:t=>{const n=t?.summary_fields?.groups??{results:[],count:0};return(0,z.jsx)(Ln.I,{"aria-label":e`Related groups`,children:n.results.map((e=>(0,z.jsx)(Mn.v,{isReadOnly:!0,children:e.name},e.name)))})},sort:void 0,defaultSortDirection:"desc"})),[e])}();return(0,l.useMemo)((()=>{let e=[];return"inventory"===n.inventory_type&&(e=[s,r,o,i]),"constructed_inventory"===n.inventory_type&&(e=[s]),e}),[s,r,o,i,n.inventory_type])}(),a=(0,Re.g)(),i=M_({url:`inventories/${a.id??""}/groups`}),r=Uc({url:xl`/inventories/${a.id??""}/groups/`,toolbarFilters:i,tableColumns:n}),c=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Ex((()=>{e.unselectAll(),e.refresh()})),i=(0,Re.g)(),r=dd(xl`/inventories/${i.id??""}/groups/`).data,c=Boolean(r&&r.actions&&r.actions.POST),d=e.selectedItems||[],u=Px({...i,selectedItems:d,actionType:"toolbar"});return(0,l.useMemo)((()=>{const r=[];return"inventory"===i.inventory_type&&r.push({type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create group"),onClick:()=>n(String(fc.InventoryGroupCreate),{params:{inventory_type:i.inventory_type,id:i.id}}),isDisabled:()=>c?void 0:t("You do not have permission to create a group. Please contact your organization administrator if there is an issue with your access.")}),r.push(u),"inventory"===i.inventory_type&&(r.push({type:s.Seperator}),r.push({type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete groups"),onClick:a,isDanger:!0,isDisabled:0===e.selectedItems.length?t("Select at least one item from the list"):e=>Dg(e,t)})),r}),[t,a,n,i.inventory_type,i.id,c,u,e.selectedItems.length])}(r),d=L_(),u="constructed_inventory"===a.inventory_type,m=dd(xl`/groups/`).data,p=Boolean(m&&m.actions&&m.actions.POST&&!u);return(0,z.jsx)($s,{id:"awx-inventory-group-table",toolbarFilters:i,toolbarActions:c,tableColumns:n,rowActions:d,errorStateTitle:e("Error loading inventory groups"),emptyStateTitle:e(p?"There are currently no groups added to this inventory.":u?"No Items Found":"You do not have permission to create a group"),emptyStateDescription:e(p?"Please create a group by using the button below.":u?"Please add Items to populate this list":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:p?void 0:Ld.XR,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:p?e("Create group"):void 0,emptyStateButtonClick:p?()=>t(fc.InventoryGroupCreate,{params:{id:a.id,inventory_type:a.inventory_type}}):void 0,...r})}function z_(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:i}=tc(xl`/groups/`,t.group_id),r=gr(),c=function(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.g)(),a=Ex((()=>{t(fc.InventoryGroups,{params:{inventory_type:n.inventory_type,id:n.id}})}));return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,variant:g.Ak.primary,label:e("Edit group"),isHidden:()=>"constructed_inventory"===n.inventory_type,onClick:e=>t(fc.InventoryGroupEdit,{params:{inventory_type:n.inventory_type,id:e.inventory,group_id:e.id}}),isDisabled:t=>Ig(t,e)},{type:s.Button,selection:o.Single,icon:$c.uc,label:e("Delete group"),isHidden:()=>"constructed_inventory"===n.inventory_type,onClick:e=>a([e]),isDisabled:t=>Ag(t,e),isDanger:!0}]),[e,t,n.inventory_type,a])}();return n?(0,z.jsx)(Ic,{error:n,handleRefresh:i}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.name,breadcrumbs:[{label:e("Inventories"),to:r(fc.Inventories)},{label:`${a?.summary_fields.inventory.name}`,to:r(fc.InventoryDetails,{params:{id:a?.inventory,inventory_type:t.inventory_type}})},{label:e("Groups"),to:r(fc.InventoryGroups,{params:{id:a?.inventory,inventory_type:t.inventory_type}})},{label:a?.name}],headerActions:(0,z.jsx)(oe,{actions:c,position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Groups"),page:fc.InventoryGroups,persistentFilterKey:"groups"},tabs:[{label:e("Details"),page:fc.InventoryGroupDetails},{label:e("Related Groups"),page:fc.InventoryGroupRelatedGroups},{label:e("Hosts"),page:fc.InventoryGroupHost}],params:{id:a.inventory,inventory_type:t.inventory_type,group_id:a.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function H_(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),n=bx(t.id,t.inventory_type),{host:a,refresh:s}=Uy(t.host_id),o=yr(),i=Vy((e=>{o(fc.InventoryHosts,{params:{inventory_type:t.inventory_type,id:t.id}})}),s),r=gr();let l=[];return l="inventory"===t.inventory_type?[{label:e("Details"),page:fc.InventoryHostDetails},{label:e("Facts"),page:fc.InventoryHostFacts},{label:e("Groups"),page:fc.InventoryHostGroups},{label:e("Jobs"),page:fc.InventoryHostJobs}]:[{label:e("Details"),page:fc.InventoryHostDetails}],(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.name,breadcrumbs:[{label:e("Inventories"),to:r(fc.Inventories)},{label:e(`${n?.name}`),to:r(fc.InventoryDetails,{params:{id:t.id,inventory_type:t.inventory_type}})},{label:e("Hosts"),to:r(fc.InventoryHosts,{params:{id:t.id,inventory_type:t.inventory_type}})},{label:e(`${a?.name}`)}],headerActions:(0,z.jsx)(oe,{actions:i,position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Hosts"),page:fc.InventoryHosts,persistentFilterKey:"inventories"},tabs:l,params:t})]})}function q_(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=td(),s=td(),o=(0,Re.g)();return(0,z.jsxs)(nd,{submitText:e("Create group"),onSubmit:async e=>{const{name:t,description:i,variables:r}=e,l={name:t,description:i??"",inventory:parseInt(o.id),variables:r??""},c=await a(xl`/groups/`,l);if(o.group_id){const e={id:c.id};await s(xl`/groups/${o.group_id}/children/`,e),n(fc.InventoryGroupRelatedGroups,{params:{inventory_type:o.inventory_type,id:c.inventory,group_id:o.group_id}})}else n(fc.InventoryGroupDetails,{params:{inventory_type:o.inventory_type,id:c.inventory,group_id:c.id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:{name:"",description:"",variables:"---\n"},children:[(0,z.jsx)(li,{name:"name",label:e("Name"),placeholder:e("Enter name"),isRequired:!0}),(0,z.jsx)(li,{name:"description",label:e("Description"),placeholder:e("Enter description")}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{name:"variables",label:e("Variables"),format:"yaml"})})]})}function U_(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=ed(),a=yr(),s=(0,Re.g)(),{data:o}=tc(xl`/groups/`,s.group_id),i=(0,l.useMemo)((()=>({name:o?.name,description:o?.description??"",variables:o?.variables??"---\n"})),[o]);return o?(0,z.jsxs)(nd,{submitText:e("Save group"),onSubmit:async e=>{const{name:t,description:s,variables:i}=e,r={name:t,description:s,variables:i,inventory:o?.inventory??0},l=await n(xl`/groups/${o?.id.toString()??""}/`,r);a(fc.InventoryGroupDetails,{params:{inventory_type:"inventory",id:l.inventory,group_id:l.id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:i,children:[(0,z.jsx)(li,{name:"name",label:e("Name"),isRequired:!0}),(0,z.jsx)(li,{name:"description",label:e("Description")}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{name:"variables",label:e("Variables"),format:"yaml"})})]}):null}function W_(e){const{t}=(0,I.Bd)(),n=gr(),a={id:e.urlParams.id},s={inventory_type:e.urlParams.inventory_type},o={group_id:e.urlParams.group_id},i={inventories:{label:t("Inventories"),to:n(fc.Inventories)},inventory:{label:`${e.inventoryName}`,to:n(fc.InventoryDetails,{params:{...a,...s}})},groups:{label:t("Groups"),to:n(fc.InventoryGroups,{params:{...a,...s}})},group:{label:`${e.groupName}`,to:n(fc.InventoryGroupDetails,{params:{...a,...s,...o}})},relatedGroups:{label:t("Related Groups"),to:n(fc.InventoryGroupRelatedGroups,{params:{...a,...s,...o}})},createGroup:{label:t("Create group")},editGroup:{label:t("Edit {{groupName}}",{groupName:e.groupName})}};return(0,z.jsx)(qi,{title:e.title,breadcrumbs:e.breadcrumbs.map((e=>i[e]))})}function J_(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=ec(xl`/inventories/${t.id?.toString()??""}/`);return n?(0,z.jsx)(Ic,{error:n,handleRefresh:s}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(W_,{title:e("Create group"),breadcrumbs:["inventories","inventory","groups","createGroup"],urlParams:t,inventoryName:a?.name}),(0,z.jsx)(q_,{})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function V_(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=ec(xl`/groups/${t.group_id?.toString()??""}/`);return n?(0,z.jsx)(Ic,{error:n,handleRefresh:s}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(W_,{title:e("Edit {{groupName}}",{groupName:a?.name}),breadcrumbs:["inventories","inventory","groups","editGroup"],urlParams:t,inventoryName:a?.summary_fields.inventory.name,groupName:a?.name}),(0,z.jsx)(U_,{})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function G_(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=tc(xl`/groups/`,t.group_id);return n?(0,z.jsx)(Ic,{error:n,handleRefresh:s}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(W_,{title:e("Create group"),breadcrumbs:["inventories","inventory","groups","group","relatedGroups","createGroup"],urlParams:t,inventoryName:a?.summary_fields.inventory.name,groupName:a?.name}),(0,z.jsx)(q_,{})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Y_(e){const{t}=(0,I.Bd)(),n=(0,oo.FH)({name:e.watch}),a=n?.id?.toString()??"",s=(0,l.useCallback)((async()=>{const e=(a?await nl(xl`/projects/${a}/inventories/`):[]).map((e=>({name:e})));return Promise.resolve({total:e.length,values:[{name:"/ (project root)"},...e]})}),[a]);return(0,z.jsx)(eh,{name:e.name,id:"inventory",variant:"typeahead",additionalControls:e.additionalControls,label:t("Inventory file"),query:s,valueToString:e=>e?.name??"",placeholder:t("Select inventory file"),labelHelpTitle:t("Inventory"),labelHelp:e.labelHelp??t("Select the inventory containing the playbook you want this job to execute."),loadingPlaceholder:t("Loading inventories..."),loadingErrorText:t("Error loading inventories"),isRequired:e.isRequired,limit:200})}function K_(){const{t:e}=(0,I.Bd)(),t=(0,oo.FH)({name:"update_on_launch"}),n=(0,oo.FH)({name:"source"}),a=["ec2","gce","azure_rm","vmware","satellite6","openstack","rhv","controller","insights","terraform","openshift_virtualization"];return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Kc,{watch:"source",hidden:e=>!a.includes(e)&&"scm"!==e,children:(0,z.jsxs)(_d,{title:e("Source Details"),children:[(0,z.jsx)(Hp,{name:"credential",label:e("Credential"),labelHelp:e('Select credentials for accessing the nodes this job will be ran against. You can only select one credential of each type. For machine credentials (SSH), checking "Prompt on launch" without selecting credentials will require you to select a machine credential at run time. If you select credentials and check "Prompt on launch", the selected credential(s) become the defaults that can be updated at run time.'),isRequired:a.slice(1).includes(n),queryParams:(e=>{switch(e){case"scm":return{credential_type__kind__in:"cloud,kubernetes"};case"ec2":return{credential_type__namespace:"aws"};case"openshift_virtualization":return{credential_type__namespace:"kubernetes_bearer_token"};default:return{credential_type__namespace:e}}})(n)}),(0,z.jsxs)(Kc,{watch:"source",hidden:e=>"scm"!==e,children:[(0,z.jsx)(Ih,{name:"source_project",isRequired:!0}),(0,z.jsx)(Y_,{watch:"source_project",name:"source_path",isRequired:!0})]}),(0,z.jsx)(vc,{placeholder:e("Select a verbosity value"),name:"verbosity",options:[{value:"0",label:e("0 (Warning)")},{value:"1",label:e("1 (Info)")},{value:"2",label:e("2 (Debug)")}],defaultValue:"1",labelHelpTitle:e("Limit"),labelHelp:e("Control the level of output Ansible will produce as the playbook executes."),label:e("Verbosity"),isRequired:!0}),(0,z.jsx)(li,{name:"host_filter",labelHelp:e("Regular expression where only matching host names will be imported. The filter is applied as a post-processing step after any inventory plugin filters are applied."),label:e("Host filter")}),(0,z.jsx)(li,{name:"enabled_var",labelHelp:e("Retrieve the enabled state from the given dict of host variables. The enabled variable may be specified using dot notation, e.g: 'foo.bar'"),label:e("Enabled variable")}),(0,z.jsx)(li,{name:"enabled_value",labelHelp:e("This field is ignored unless an Enabled Variable is set. If the enabled variable matches this value, the host will be enabled on import."),label:e("Enabled value")}),(0,z.jsxs)(_d,{title:e("Update options"),children:[(0,z.jsx)(go,{label:e("Overwrite"),labelHelpTitle:e("Overwrite"),labelHelp:e('If checked, any hosts and groups that were previously present on the external source but are now removed will be removed from the inventory. Hosts and groups that were not managed by the inventory source will be promoted to the next manually created group or if there is no manually created group to promote them into, they will be left in the "all" default group for the inventory. \nWhen not checked, local child hosts and groups not found on the external source will remain untouched by the inventory update process.'),name:"overwrite"}),(0,z.jsx)(go,{label:e("Overwrite variables"),labelHelpTitle:e("Overwrite variables"),labelHelp:e("If checked, all variables for child groups and hosts will be removed and replaced by those found on the external source.\nWhen not checked, a merge will be performed, combining local variables with those found on the external source."),name:"overwrite_vars"}),(0,z.jsx)(go,{label:e("Update on Launch"),labelHelpTitle:e("Update on launch"),labelHelp:e("Each time a job runs using this inventory, refresh the inventory from the selected source before executing job tasks."),name:"update_on_launch"}),t?(0,z.jsx)(_d,{title:e("Cache timeout (seconds)"),children:(0,z.jsx)(li,{name:"update_cache_timeout",placeholder:e("0"),isRequired:!0,type:"number"})}):null]}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{name:"source_vars",label:e("Source variables"),format:"yaml"})})]})})})}function Z_(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.Zp)(),a=td(),s=(0,Re.g)(),{data:o}=ec(xl`/inventories/${s.id?.toString()??""}/`),i=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create source"),breadcrumbs:[{label:e("Inventories"),to:i(fc.Inventories)},{label:`${o?.name}`,to:i(fc.InventoryDetails,{params:{id:o?.id,inventory_type:o?.type}})},{label:e("Sources"),to:i(fc.InventorySources,{params:{id:o?.id,inventory_type:o?.type}})},{label:e("Create source")}]}),(0,z.jsx)(nd,{submitText:e("Create source"),onSubmit:async e=>{const n={...e,execution_environment:e?.execution_environment?e.execution_environment:null,source_path:e?.source_path?.name,inventory:parseInt(s.id??""),source_project:e?.source_project?.id},i=await a(xl`/inventory_sources/`,n);t(fc.InventorySourceDetail,{params:{source_id:i.id,inventory_type:o?.type,id:s.id}})},onCancel:()=>n(-1),defaultValue:{name:"",description:"",credential:null},children:(0,z.jsx)(Q_,{})})]})}function X_(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.Zp)(),a=ed(),s=(0,Re.g)(),{data:o}=ec(xl`/inventories/${s.id?.toString()??""}/`),{data:i}=ec(xl`/inventory_sources/${s.source_id?.toString()??""}/`),r=(0,l.useMemo)((()=>({name:i?.name,description:i?.description??"",execution_environment:i?.summary_fields?.execution_environment?.id,source:i?.source,credential:i?.credential??null,source_project:i?.summary_fields?.source_project,source_path:{name:i?.source_path},verbosity:i?.verbosity,host_filter:i?.host_filter,enabled_var:i?.enabled_var,enabled_value:i?.enabled_value,overwrite:i?.overwrite,overwrite_vars:i?.overwrite_vars,update_on_launch:i?.update_on_launch,update_cache_timeout:i?.update_cache_timeout,source_vars:i?.source_vars})),[i]),c=gr();return i?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Edit {{sourceName}}",{sourceName:i?.name}),breadcrumbs:[{label:e("Inventories"),to:c(fc.Inventories)},{label:`${o?.name}`,to:c(fc.InventoryDetails,{params:{id:o?.id,inventory_type:o?.type}})},{label:e("Sources"),to:c(fc.InventorySources,{params:{id:o?.id,inventory_type:o?.type}})},{label:e("Edit {{sourceName}}",{sourceName:i?.name})}]}),(0,z.jsx)(nd,{submitText:e("Save source"),onSubmit:async e=>{const n={...e,execution_environment:e?.execution_environment?e.execution_environment:null,source_path:e?.source_path?.name??"",inventory:parseInt(s.id??""),source_project:e?.source_project?.id},i=await a(xl`/inventory_sources/${s.source_id??""}/`,n);t(fc.InventorySourceDetail,{params:{source_id:i.id,inventory_type:o?.type,id:s.id}})},onCancel:()=>n(-1),defaultValue:r,children:(0,z.jsx)(Q_,{})})]}):null}function Q_(){const{t:e}=(0,I.Bd)(),{data:t}=dd(xl`/inventory_sources/`),n=(0,oo.FH)({name:"source"}),a=(0,oo.xW)(),[s,o]=(0,l.useState)(n),i=t?.actions?.GET?.source?.choices?.filter((([e,t])=>{if(!["file","constructed"].includes(e))return{label:t,value:e}}));return(0,l.useEffect)((()=>{a.clearErrors(),s!==n&&(a.resetField("credential",{defaultValue:null}),a.resetField("source_project",{defaultValue:{}}),a.resetField("source_path",{defaultValue:""}),o(n))}),[n]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:e("Name"),placeholder:e("Enter name"),isRequired:!0}),(0,z.jsx)(li,{label:e("Description"),name:"description",placeholder:e("Enter description")}),(0,z.jsx)(Wp,{isRequired:"terraform"===n,name:"execution_environment"}),(0,z.jsx)(ti,{isRequired:!0,name:"source",id:"source_control_type",label:e("Source"),options:i?i.map((([e,t])=>({label:t,value:e}))):[],placeholderText:e("Select a source")}),(0,z.jsx)(K_,{})]})}function ev(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.g)(),{data:a}=tc(xl`/groups/`,n.group_id);return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:e("Name"),children:a?.name}),(0,z.jsx)(Ft,{label:e("Description"),children:a?.description}),(0,z.jsx)(Ft,{label:e("Created"),children:(0,z.jsx)(Ie,{value:a?.created,author:a?.summary_fields?.created_by?.username,onClick:()=>t(fc.UserDetails,{params:{id:a?.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:a?.created,author:a?.summary_fields?.created_by?.username,onClick:()=>t(fc.UserDetails,{params:{id:a?.summary_fields?.created_by?.id}})}),(0,z.jsx)(Wu,{label:e("Variables"),showCopyToClipboard:!0,toggleLanguage:!0,value:a?.variables||"---"})]})}function tv(){Fc("inventories");const e=cx(),{host_id:t=""}=(0,Re.g)(),n={job__hosts:t,not__launch_type:"sync"};return(0,z.jsx)(ax,{queryParams:n,columns:e})}function nv({onSelectedHosts:e,groupId:t,inventoryId:n}){const{t:a}=(0,I.Bd)(),s=pu(),o=bu(),i=fu(),r=(0,l.useMemo)((()=>[s,o,i]),[s,o,i]),c=M_({url:`inventories/${n}/hosts/?not__groups=${t}`}),d=Uc({url:xl`/inventories/${n}/hosts/?not__groups=${t}&order_by=name&page=1&page_size=5`,toolbarFilters:c,tableColumns:r});return(0,z.jsx)(Xs,{title:a("Select host"),onSelect:t=>{e(t)},toolbarFilters:c,tableColumns:r,view:d,confirmText:a("Add hosts")})}function av(){const{t:e}=(0,I.Bd)(),t=Yy(),n=function(e){const t=yr(),n=(0,Re.g)(),a=(0,l.useCallback)((e=>t(fc.InventoryHostDetails,{params:{inventory_type:n.inventory_type,id:n.id,host_id:e.id}})),[t,n.id,n.inventory_type]),s=pu({...e,onClick:a}),o=R_("Activity"),i=B_(),r=bu(e),c=fu(e);return(0,l.useMemo)((()=>[s,i,o,r,c]),[s,i,o,r,c])}(),a=Uc({url:xl`/groups/${(0,Re.g)().group_id??""}/all_hosts/`,toolbarFilters:t,tableColumns:n}),i=function(e){const[t,n]=ss(),{t:a}=(0,I.Bd)(),i=yr(),r=function(e){const{t}=(0,I.Bd)(),n=Wy({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=(0,Re.g)(),i=Lc();return a=>{i({title:t("Disassociate host from group?"),confirmText:t("Yes, I confirm that I want to disassociate these {{count}} hosts.",{count:a.length}),actionButtonText:t("Disassociate hosts",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>al(xl`/groups/${o.group_id}/hosts/`,{disassociate:!0,id:e.id},t)})}}(e.unselectItemsAndRefresh),c=(0,Re.g)(),d=ue(),u=Px({...c,selectedItems:e.selectedItems||[],actionType:"toolbar"}),m=dd(xl`/hosts/`).data,p=Boolean(m&&m.actions&&m.actions.POST),h=(0,l.useCallback)((async t=>{for(const n of t)try{await al(xl`/groups/${c.group_id}/hosts/`,{id:n.id}).then((()=>{e.refresh()}))}catch(e){d.addAlert({variant:"danger",title:a(`Failed to add ${n.name} to related groups`),children:e instanceof Error&&e.message})}n(void 0)}),[n,c.group_id,e,d,a]);return(0,l.useMemo)((()=>{const t=[{type:s.Dropdown,selection:o.None,variant:g.Ak.primary,isPinned:!0,isHidden:()=>"constructed_inventory"===c.inventory_type,icon:Za.GY,label:a("Add host"),actions:[{type:s.Button,selection:o.None,label:a("Add existing host"),onClick:()=>n((0,z.jsx)(nv,{inventoryId:c.id,groupId:c.group_id,onSelectedHosts:h}))},{type:s.Button,selection:o.None,label:a("Create host"),onClick:()=>i(fc.InventoryGroupHostAdd,{params:{id:c?.id,inventory_type:c.inventory_type,group_id:c.group_id}}),isDisabled:()=>p?void 0:a("You do not have permission to create a host. Please contact your organization administrator if there is an issue with your access.")}]},u],l={type:s.Button,selection:o.Multiple,isPinned:!0,label:a("Disassociate hosts"),onClick:r,isDisabled:0===e.selectedItems.length?a("Select at least one item from the list"):void 0};return"inventory"===c.inventory_type&&t.push(l),t}),[a,r,e.selectedItems.length,n,c.id,c.group_id,c.inventory_type,h,i,p,u])}(a),r=function(e){const{t}=(0,I.Bd)(),n=yr(),a=ed(),i=(0,Re.g)(),r=(0,l.useCallback)((async(t,n)=>(await a(xl`/hosts/${t.id.toString()}/`,{enabled:n}),await e(),Promise.resolve())),[e,a]);return(0,l.useMemo)((()=>[{type:s.Switch,ariaLabel:e=>t(e?"Click to disable instance":"Click to enable instance"),selection:o.Single,onToggle:(e,t)=>r(e,t),isSwitchOn:e=>!!e.enabled,label:t("Enabled"),labelOff:t("Disabled"),showPinnedLabel:!1,isPinned:!0,isDisabled:e=>Ig(e,t),tooltip:t("Indicates if a host is available and should be included in running jobs. For hosts that are part of an external inventory, this may be reset by the inventory sync process.")},{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:t("Edit host"),onClick:e=>n(fc.InventoryHostEdit,{params:{id:i.id,inventory_type:i.inventory_type,host_id:e.id}}),isDisabled:e=>Ig(e,t),isHidden:e=>"constructed_inventory"===i.inventory_type}]),[t,r,n,i.id,i.inventory_type])}(a.refresh),c=function(e){const[t,n]=ss(),{t:a}=(0,I.Bd)(),i=(0,Re.g)(),r=ue(),c=yr(),d=dd(xl`/inventories/${i.id??""}/hosts/`).data,u=Boolean(d&&d.actions&&d.actions.POST),m=(0,l.useCallback)((async t=>{for(const n of t)try{await al(xl`/groups/${i.group_id}/hosts/`,{id:n.id}).then((()=>{e.refresh()}))}catch(e){r.addAlert({variant:"danger",title:a(`Failed to add ${n.name} to related groups`),children:e instanceof Error&&e.message})}n(void 0)}),[n,i.group_id,r,a,e]);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,icon:Za.GY,label:a("Add existing host"),isPinned:!0,onClick:()=>n((0,z.jsx)(nv,{inventoryId:i.id,groupId:i.group_id,onSelectedHosts:m}))},{type:s.Button,selection:o.None,variant:g.Ak.primary,icon:Za.GY,label:a("Create host"),isPinned:!0,onClick:()=>i?.group_id?c(fc.InventoryGroupHostAdd,{params:{id:i.id,inventory_type:i.inventory_type,group_id:i.group_id}}):c(fc.CreateHost),isDisabled:()=>u?void 0:a("You do not have permission to create a group. Please contact your organization administrator if there is an issue with your access.")}]),[u,m,c,i.group_id,i.id,i.inventory_type,n,a])}(a),d=dd(xl`/hosts/`).data,u=Boolean(d&&d.actions&&d.actions.POST);return Fc("inventories"),(0,z.jsx)($s,{id:"awx-inventory-hosts-table",toolbarFilters:t,toolbarActions:i,tableColumns:n,rowActions:r,errorStateTitle:e("Error loading inventory hosts"),emptyStateTitle:e(u?"There are currently no hosts added to this inventory.":"You do not have permission to create a host"),emptyStateDescription:e(u?"Please add hosts by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:u?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:u?e("Create host"):void 0,emptyStateActions:c,...a})}function sv(e){const{t}=(0,I.Bd)(),n=function(e){const t=yr(),n=(0,l.useCallback)((e=>t(fc.InventoryGroupDetails,{params:{id:e.id}})),[t]),a=pu({...e,onClick:n}),s=hu(),o=fu(e);return(0,l.useMemo)((()=>[a,s,o]),[a,s,o])}({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=(0,Re.g)(),i=Lc();return a=>{i({title:t("Permanently disassociate groups",{count:a.length}),confirmText:t("Yes, I confirm that I want to disassociate these {{count}} groups.",{count:a.length}),actionButtonText:t("Disassociate groups",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>al(xl`/groups/${o.group_id}/children/`,{disassociate:parseInt(o.group_id??""),id:e.id},t)})}}function ov({onSelectedGroups:e,groupId:t}){const{t:n}=(0,I.Bd)(),a=M_({url:`groups/${t}/potential_children`,queryParams:{not__id:t,not__parents:t}}),s=pu(),o=bu(),i=fu(),r=(0,l.useMemo)((()=>[s,o,i]),[s,o,i]),c=Uc({url:xl`/groups/${t}/potential_children/?not__id=${t}&not__parents=${t}&order_by=name&page=1&page_size=5`,toolbarFilters:a,tableColumns:r});return(0,z.jsx)(Xs,{title:n("Select groups"),onSelect:t=>{e(t)},toolbarFilters:a,tableColumns:r,view:c,confirmText:n("Add groups")})}function iv(){const{t:e}=(0,I.Bd)(),t=function(e){const t=yr(),n=(0,Re.g)(),a=(0,l.useCallback)((e=>t(fc.InventoryGroupDetails,{params:{inventory_type:n.inventory_type,id:e.inventory,group_id:e.id}})),[t,n.inventory_type]),s=pu({...e,onClick:a}),o=bu(e),i=fu(e);return(0,l.useMemo)((()=>[s,o,i]),[s,o,i])}(),n=(0,Re.g)(),a=M_({url:`groups/${n.group_id??""}/children`}),i=Uc({url:xl`/groups/${n.group_id??""}/children/`,toolbarFilters:a,tableColumns:t}),r=function(e){const[t,n]=ss(),{t:a}=(0,I.Bd)(),i=yr(),r=sv(e.unselectItemsAndRefresh),c=(0,Re.g)(),d=td(),u=ue(),m="constructed_inventory"===c.inventory_type,p=Px({...c,selectedItems:e.selectedItems||[],actionType:"toolbar"}),h=dd(xl`/inventories/${c.id??""}/groups/`).data,b=Boolean(h&&h.actions&&h.actions.POST),f=(0,l.useCallback)((async t=>{for(const n of t)try{await d(xl`/groups/${c.group_id}/children/`,{id:n.id}).then((()=>{e.refresh()}))}catch(e){u.addAlert({variant:"danger",title:a(`Failed to add ${n.name} to related groups`),children:e instanceof Error&&e.message})}n(void 0)}),[n,d,c.group_id,e,u,a]);return(0,l.useMemo)((()=>{const t=[];return!1===m&&t.push({type:s.Dropdown,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:a("Add group"),actions:[{type:s.Button,selection:o.None,label:a("Add existing group"),onClick:()=>n((0,z.jsx)(ov,{groupId:c.group_id,onSelectedGroups:f}))},{type:s.Button,selection:o.None,label:a("Create group"),isHidden:()=>m,onClick:()=>i(String(fc.InventoryGroupRelatedGroupsCreate),{params:{inventory_type:c.inventory_type,id:c.id,group_id:c.group_id}}),isDisabled:()=>b?void 0:a("You do not have permission to create a group. Please contact your organization administrator if there is an issue with your access.")}]}),t.push(p),!1===m&&(t.push({type:s.Seperator}),t.push({type:s.Button,selection:o.Multiple,icon:$c.uc,label:a("Disassociate groups"),onClick:r,isDanger:!0,isDisabled:0===e.selectedItems.length?a("Select at least one item from the list"):void 0})),t}),[a,r,i,c.inventory_type,c.id,b,p,e.selectedItems.length,c.group_id,f,n,m])}(i),c=L_(),d=function(e){const[t,n]=ss(),{t:a}=(0,I.Bd)(),i=yr(),r=(0,Re.g)(),c=ue(),d=dd(xl`/inventories/${r.id??""}/groups/`).data,u=Boolean(d&&d.actions&&d.actions.POST),m=(0,l.useCallback)((async t=>{for(const n of t)try{await al(xl`/groups/${r.group_id}/children/`,{id:n.id}).then((()=>{e.refresh()}))}catch(e){c.addAlert({variant:"danger",title:a(`Failed to add ${n.name} to related groups`),children:e instanceof Error&&e.message})}n(void 0)}),[n,r.group_id,c,a,e]);return(0,l.useMemo)((()=>"constructed_inventory"===r.inventory_type?[]:[{type:s.Button,selection:o.None,variant:g.Ak.primary,icon:Za.GY,label:a("Add existing group"),isPinned:!0,onClick:()=>n((0,z.jsx)(ov,{groupId:r.group_id,onSelectedGroups:m}))},{type:s.Button,selection:o.None,variant:g.Ak.primary,icon:Za.GY,label:a("Create group"),isPinned:!0,onClick:()=>i(String(fc.InventoryGroupRelatedGroupsCreate),{params:{inventory_type:r.inventory_type,id:r.id,group_id:r.group_id}}),isDisabled:()=>u?void 0:a("You do not have permission to create a group. Please contact your organization administrator if there is an issue with your access.")}]),[u,m,i,r.group_id,r.id,r.inventory_type,n,a])}(i),u=dd(xl`/groups/`).data,m=Boolean(u&&u.actions&&u.actions.POST),p="constructed_inventory"===n.inventory_type;return(0,z.jsx)($s,{id:"awx-inventory-group-related-groups-table",toolbarFilters:a,toolbarActions:r,tableColumns:t,rowActions:c,errorStateTitle:e("Error loading related groups"),emptyStateTitle:e(m?p?"No Related Groups Found":"There are currently no groups related to this group.":"You do not have permission to add related groups."),emptyStateDescription:e(m?p?"Please add Related Groups to populate this list":"Please add related groups by using the buttons below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:m?void 0:Ld.XR,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:m&&!p?e("Add related groups"):void 0,emptyStateActions:d,...i})}function rv({resourceType:e,id:t}){const{t:n}=(0,I.Bd)(),a={inventory_sources:"inventory source",projects:"project",job_templates:"job template",workflow_job_templates:"workflow job template",organizations:"organization",system_job_templates:"system job templates"},i=(0,Re.g)(),r=t??i[{inventory_sources:"source_id",projects:"id",job_templates:"id",workflow_job_templates:"id",organizations:"id",system_job_templates:"id"}[e]??""],{data:c,refresh:d}=ec(xl`/${e}/${r??""}/notification_templates_started/`),{data:u,refresh:m}=ec(xl`/${e}/${r??""}/notification_templates_success/`),{data:p,refresh:h}=ec(xl`/${e}/${r??""}/notification_templates_error/`),b=ec("system_job_templates"===e||"job_templates"===e||"projects"===e?"":xl`/${e}/${r??""}/notification_templates_approvals/`),{data:f,refresh:g}="organizations"===e||"workflow_job_templates"===e?b:{data:{results:[]},refresh:()=>{}},y=function(){const{t:e}=(0,I.Bd)(),t=Bp(),n=Fp(),a=Np(),s=$p(),{data:o}=dd(xl`/notification_templates/`),i=o?.actions?.GET?.notification_type?.choices?.map((([t,n])=>({label:e(n),value:t})));return(0,l.useMemo)((()=>[t,n,{key:"type",label:e("Notification type"),type:Ia.MultiSelect,query:"notification_type",options:i??[],placeholder:e("Select types")},a,s]),[t,n,e,a,s,i])}(),x=function(e){const{t}=(0,I.Bd)(),n=yr(),a=pu({onClick:(0,l.useCallback)((e=>n(fc.NotificationTemplateDetails,{params:{id:e.id}})),[n])}),s=(0,l.useMemo)((()=>({header:t("Type"),type:"text",value:e=>ho(e.notification_type),card:"subtitle",list:"subtitle"})),[t]);return(0,l.useMemo)((()=>[a,s]),[a,s])}(),j=function({notificationApproval:e,notificationApprovalRefresh:t,notificationStarted:n,notificationStartedRefresh:a,notificationSuccess:i,notificationSuccessRefresh:r,notificationError:c,notificationErrorRefresh:d,resourceType:u,resourceId:m}){const{t:p}=(0,I.Bd)(),h=(0,l.useCallback)((async(e,n,s)=>{const o={id:e,disassociate:!n};n&&delete o.disassociate,await al(xl`/${u}/${m??""}/notification_templates_${s}/`,o),t(),a(),r(),d()}),[u,m,t,a,r,d]);return(0,l.useMemo)((()=>{const t=(e,t,n,a)=>({isPinned:!0,ariaLabel:t=>p(t?`Click to disable ${e}`:`Click to enable ${e}`),type:s.Switch,selection:o.Single,labelOff:p(t),label:p(t),onToggle:(e,t)=>h(e.id,t,n),isSwitchOn:e=>((e,t=[])=>{for(const n of t)if(e.id===n.id)return!0;return!1})(e,a),showPinnedLabel:!0,isReversed:!0}),a=[t("start","Start","started",n),t("success","Success","success",i),t("failure","Failure","error",c)];return"organizations"!==u&&"workflow_job_templates"!==u||a.unshift(t("approval","Approval","approvals",e)),a}),[n,i,c,u,p,h,e])}({notificationApproval:f?.results,notificationApprovalRefresh:g,notificationStarted:c?.results,notificationStartedRefresh:d,notificationSuccess:u?.results,notificationSuccessRefresh:m,notificationError:p?.results,notificationErrorRefresh:h,resourceType:e,resourceId:r}),_=Uc({url:xl`/notification_templates/`,toolbarFilters:y,tableColumns:x});return Fc("inventories"),(0,z.jsx)(Ui,{children:(0,z.jsx)($s,{id:"awx-inventory-sources-table",toolbarFilters:y,tableColumns:x,rowActions:j,errorStateTitle:n(`Error loading ${a[e]} notifications`),emptyStateTitle:n(`There are currently no notifications added to this ${a[e]}.`),emptyStateDescription:n("Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:Xa.IN,..._})})}function lv(e){const{t}=(0,I.Bd)(),n=yr(),a=gr(),i=(0,Re.g)(),r=i.source_id??i.id,c=(0,Re.KC)(),d=!!c?.template&&Rh(c?.template),u=e.sublistEndpoint?`${e.sublistEndpoint}/${r}/schedules/`:void 0,m=function({url:e}={}){const t=(e?e.replace(yl,""):"")||"schedules";return Pp({optionsPath:t,preSortedKeys:["name","id","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:t},id:{apiPath:t}},additionalFilters:[Np(),$p()]})}({url:e.url?e.url:u}),p=I_(),h=Uc({url:u??xl`/schedules/`,toolbarFilters:m,tableColumns:p});Fc(e.resourceType?`${e.resourceType}-schedules`:"schedules");const{data:b}=dd(u??xl`/schedules/`),f=Boolean(b&&b.actions&&b.actions.POST),y=function(e,t,n){const{t:a}=(0,I.Bd)(),{data:i}=dd(xl`/schedules/`),r=Boolean(i&&i.actions&&i.actions.POST),c=A_(e);return(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:a("Create schedule"),isDisabled:r?n?a("Resources are missing from this template."):void 0:a("You do not have permission to create a schedule. Please contact your organization administrator if there is an issue with your access."),href:t},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:a("Delete schedules"),onClick:c,isDisabled:e=>Dg(e,a),isDanger:!0}]),[r,t,c,a,n])}(h.unselectItemsAndRefresh,a(e.createSchedulePageId,{params:i}),d),x=D_({onScheduleDeleteCompleted:h.unselectItemsAndRefresh,onScheduleToggleCompleted:h.updateItem,sublistEndpoint:u});return(0,z.jsx)($s,{id:"awx-schedules-table",toolbarFilters:m,toolbarActions:y,tableColumns:p,rowActions:x,errorStateTitle:t("Error loading schedules"),emptyStateTitle:t(f?d?"Resources are missing from this template.":"No schedules yet":"You do not have permission to create a schedule"),emptyStateDescription:f?d?void 0:t("Please create a schedule by using the button below."):t("Please contact your organization administrator if there is an issue with your access."),emptyStateNoDataIcon:f?d?Ws.Pi:void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:f&&!d?t("Create schedule"):void 0,emptyStateButtonClick:f&&!d?()=>n(e.createSchedulePageId,{params:i}):void 0,...h})}function cv(){Fc("inventories");const e=cx(),{id:t=""}=(0,Re.g)(),n={not__launch_type:"sync",or__adhoccommand__inventory:t,or__inventoryupdate__inventory_source__inventory:t,or__job__inventory:t,or__workflowjob__inventory:t};return(0,z.jsx)(ax,{queryParams:n,columns:e})}function dv(){const{t:e}=(0,I.Bd)(),t=(0,oo.FH)({name:"module_name"}),n=[{label:e("command"),value:"command"},{label:e("shell"),value:"shell"},{label:e("yum"),value:"yum"},{label:e("apt"),value:"apt"},{label:e("apt_key"),value:"apt_key"},{label:e("apt_repository"),value:"apt_repository"},{label:e("apt_rpm"),value:"apt_rpm"},{label:e("service"),value:"service"},{label:e("group"),value:"group"},{label:e("user"),value:"user"},{label:e("mount"),value:"mount"},{label:e("ping"),value:"ping"},{label:e("selinux"),value:"selinux"},{label:e("setup"),value:"setup"},{label:e("win_ping"),value:"win_ping"},{label:e("win_service"),value:"win_service"},{label:e("win_updates"),value:"win_updates"},{label:e("win_group"),value:"win_group"},{label:e("win_user"),value:"win_user"}],s=[{label:e("0 (Normal)"),value:"0"},{label:e("1 (Verbose)"),value:"1"},{label:e("2 (More Verbose)"),value:"2"},{label:e("3 (Debug)"),value:"3"},{label:e("4 (Connection Debug)"),value:"4"},{label:e("5 (WinRM Debug)"),value:"5"}];return(0,z.jsxs)(_d,{singleColumn:!0,children:[(0,z.jsx)(ti,{name:"module_name",placeholderText:e("Select a module"),isRequired:!0,label:e("Module"),options:n,labelHelpTitle:e("Module"),labelHelp:e("These are the modules that AWX supports running commands against.")}),(0,z.jsx)(li,{name:"module_args",placeholder:e("Enter arguments"),isRequired:"command"===t||"shell"===t,label:e("Arguments"),labelHelpTitle:e("Arguments"),labelHelp:e("These arguments are used with the specified module.")}),(0,z.jsx)(ti,{name:"verbosity",label:e("Verbosity"),options:s,labelHelpTitle:e("Verbosity"),labelHelp:e("These are the verbosity levels for standard out of the command run that are supported.")}),(0,z.jsx)(li,{name:"limit",label:e("Limit"),labelHelpTitle:e("Limit"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(I.x6,{children:["The pattern used to target hosts in the inventory. Leaving the field blank, all, and * will all target all hosts in the inventory. You can find more information about Ansible&aposs host patterns"," "]}),(0,z.jsx)(I.x6,{children:(0,z.jsx)(a.N_,{to:"https://docs.ansible.com/ansible/latest/user_guide/intro_patterns.html",target:"_blank",rel:"noopener noreferrer",children:"here"})})]})}),(0,z.jsx)(li,{name:"forks",label:e("Forks"),type:"number",min:0,labelHelpTitle:e("Forks"),labelHelp:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(I.x6,{children:["The number of parallel or simultaneous processes to use while executing the playbook. Inputting no value will use the default value from the ansible configuration file. You can find more information"," "]}),(0,z.jsx)(I.x6,{children:(0,z.jsx)(a.N_,{to:"https://docs.ansible.com/ansible/latest/installation_guide/intro_configuration.html#the-ansible-configuration-file",target:"_blank",rel:"noopener noreferrer",children:"here"})})]})}),(0,z.jsx)(ni,{name:"diff_mode",label:e("Show changes"),labelHelpTitle:e("Show changes"),labelHelp:e("If enabled, show the changes made by Ansible tasks, where supported. This is equivalent to Ansible’s --diff mode.")}),(0,z.jsx)(go,{name:"become_enabled",label:e("Privilege escalation"),labelHelpTitle:e("Privilege escalation"),labelHelp:e("Enables creation of a provisioning callback URL. Using the URL a host can contact AWX and request a configuration update using this job template --become option to the  ansible command")}),(0,z.jsx)(Go,{labelHelpTitle:e("Extra Variables"),labelHelp:e("Optional extra variables to be applied to run command"),format:"yaml",label:e("Extra Variables"),name:"extra_vars"})]})}function uv(e){const{t}=(0,I.Bd)();return(0,z.jsx)(_d,{children:(0,z.jsx)(Wp,{name:"execution_environment",label:t("Execution Environment"),organizationId:Number(e.orgId)??""})})}function mv(){const{t:e}=(0,I.Bd)();return(0,z.jsx)(_d,{children:(0,z.jsx)(Hp,{name:"credential",label:e("Credential"),labelHelp:e("Select the credential you want to use when accessing the remote hosts to run the command. Choose the credential containing the username and SSH key or password that Ansible will need to log into the remote hosts."),queryParams:{credential_type__namespace:"ssh"},isRequired:!0})})}function pv(){const{t:e}=(0,I.Bd)(),{wizardData:t}=vr(),n=gr(),{module_name:s,module_args:o,verbosity:i,limit:r,forks:l,diff_mode:c,become_enabled:d,extra_vars:u,execution_environment:m,credential:p}=t,{data:h}=ec(xl`/credentials/${p.toString()}/`),{data:b}=tc(xl`/execution_environments/`,m);return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(_d,{title:e("Review"),singleColumn:!0,children:(0,z.jsxs)(Mt,{disablePadding:!0,children:[(0,z.jsx)(Ft,{label:e("Module"),children:s}),(0,z.jsx)(Ft,{label:e("Arguments"),children:o}),(0,z.jsx)(Ft,{label:e("Verbosity"),children:i}),(0,z.jsx)(Ft,{label:e("Limit"),children:r}),(0,z.jsx)(Ft,{label:e("Forks"),children:l}),(0,z.jsx)(Ft,{label:e("Show changes"),children:e(c?"On":"Off")}),(0,z.jsx)(Ft,{label:e("Privilege escalation"),children:e(d?"On":"Off")}),(0,z.jsx)(Wu,{label:e("Extra vars"),value:u}),h?(0,z.jsx)(Ft,{label:e("Credentials"),isEmpty:!h,children:(0,z.jsx)(De.o,{children:(0,z.jsx)(uu,{credential:{name:h.name,id:parseInt(h.id.toString()),kind:"ssh",cloud:!1,description:h.name}},h.id)})}):null,(0,z.jsx)(Ft,{label:e("Execution environment"),children:(0,z.jsx)(a.N_,{to:n(fc.ExecutionEnvironmentDetails,{params:{id:String(m)}}),children:b?.name})})]})})})}function hv(){const{t:e}=(0,I.Bd)(),t=gr(),{id:n}=(0,Re.g)(),[a]=jr();let s=a.get("limit")||"all";a.get("storage")&&(s=localStorage.getItem("runCommandActionSelectedItems")||s);const o=yr(),{data:i}=ec(xl`/inventories/${n}/`),r=(0,Re.Zp)(),l=[{id:"details",label:e("Details"),inputs:(0,z.jsx)(dv,{})},{id:"execution_environment",label:e("Execution Environment"),inputs:(0,z.jsx)(uv,{orgId:i?.summary_fields.organization.id.toString()??""})},{id:"credential",label:e("Credential"),inputs:(0,z.jsx)(mv,{})},{id:"review",label:e("Review"),inputs:(0,z.jsx)(pv,{})}],c={details:{module_name:"",module_args:"",verbosity:0,limit:s,forks:0,diff_mode:!1,become_enabled:!1,extra_vars:""}};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Run command"),breadcrumbs:[{label:e("Inventories"),to:t(fc.Inventories)},{label:e("Run command")}]}),(0,z.jsx)(Lr,{steps:l,singleColumn:!1,onCancel:()=>r(-1),defaultValue:c,onSubmit:async e=>{const t=e.execution_environment,a={...e,verbosity:e.verbosity,forks:e.forks,credential:e.credential,execution_environment:t},s=await al(xl`/inventories/${n??""}/ad_hoc_commands/`,a);o(fc.JobOutput,{params:{id:s.id,job_type:"command"}})},errorAdapter:Mc})]})}function bv(e){const{t}=(0,I.Bd)(),n=gr(),a=(0,Re.Zp)(),s=yr(),o=j_(),i=w_(),r=k_(),c=(0,Re.g)(),{data:d}=tc(xl`/schedules/`,c.schedule_id),[u,m]=Vh(d?.dtstart,d?.timezone),p=(0,l.useMemo)((()=>[{id:"details",label:t("Details"),inputs:(0,z.jsx)(x_,{...e})},{id:"promptStep",label:t("Prompts"),inputs:(0,z.jsx)(ch,{}),hidden:e=>{const{launch_config:t,resource:n,schedule_type:a}=e;return"workflow_job"!==a&&"job"!==a||!n||!t||km(t)}},{id:"survey",label:t("Survey"),inputs:(0,z.jsx)(Wh,{}),hidden:e=>0===Object.keys(e).length||!e.launch_config?.survey_enabled},{id:"rules",label:t("Rules"),inputs:(0,z.jsx)(p_,{}),validate:e=>{if(!e?.rules?.length){const e={__all__:[t("Schedules must have at least one rule.")]};throw new Xr("","",400,"",e)}}},{id:"exceptions",label:t("Exceptions"),inputs:(0,z.jsx)(h_,{})},{id:"review",label:t("Review"),inputs:(0,z.jsx)(v_,{}),validate:async(e,n)=>{if(!n?.rules?.length){const e={__all__:[t("Schedules must have at least one rule.")]};throw new Xr("","",400,"",e)}const a=r(n.rules,n.exceptions??[]),{utc:s,local:o}=await al(xl`/schedules/preview/`,{rrule:a.toString().split("\n").join(" ")});if(!o.length&&!s.length){const e={__all__:[t("This schedule will never run.  If you have defined exceptions it is likely that the exceptions cancel out all the rules defined in the rules step.")]};throw new Xr("","",400,"",e)}}}]),[r,t,e]);if(!d)return;const h=(0,Yj.YI)(d.rrule,{forceset:!0}),b=h.rrules().map(((e,t)=>({rule:e,id:t+1}))),f=h.exrules().map(((e,t)=>({rule:e,id:t+1}))),g={details:{name:d?.name,description:d?.description,schedule_type:d?.summary_fields.unified_job_template.unified_job_type,resource:d?.summary_fields.unified_job_template,startDateTime:{date:u,time:m},timezone:d?.timezone,schedule_days_to_keep:d.extra_data.days},promptStep:{prompt:{}},rules:{...Xj,rules:b},exceptions:{...Xj,exceptions:f}};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:d?.name?t("Edit {{scheduleName}}",{scheduleName:d?.name}):t("Schedule"),breadcrumbs:[{label:t("Schedules"),to:n(fc.Schedules)},{label:d?.name?t("Edit {{scheduleName}}",{scheduleName:d?.name}):t("Schedule")}]}),(0,z.jsx)(Lr,{steps:p,singleColumn:!1,onCancel:()=>a(-1),defaultValue:g,onSubmit:async e=>{const{rules:t,exceptions:n,...a}=e,l={rrule:r(t,n).toString().split("\n").join(" "),...a};try{const{schedule:e}=await o(l),t=i("details",e);return s(t.pageId,{params:t.params})}catch(e){const{fieldErrors:t}=Mc(e),n=t.find((e=>"resources_needed_to_start"===e?.name));if(n){const e={__all__:[n.message]};throw new Xr("","",400,"",e)}}},errorAdapter:Mc})]})}function fv(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"inventory",addRolesRoute:fc.InventoryAddTeams})}function gv(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"inventory",addRolesRoute:fc.InventoryAddUsers})}function yv(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/inventories/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{inventoryName}}.",{inventoryName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"inventory",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{inventoryName}}.",{inventoryName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Inventories"),to:t(fc.Inventories)},{label:a?.name,to:t(fc.InventoryDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.InventoryUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"awx.inventory",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.InventoryUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.InventoryUserAccess,{params:{id:a?.id}})}})]})}function xv(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/inventories/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{inventoryName}}.",{inventoryName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"inventory",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{inventoryName}}.",{inventoryName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Inventories"),to:t(fc.Inventories)},{label:s?.name,to:t(fc.InventoryDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.InventoryTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"awx.inventory",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.InventoryTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.InventoryTeamAccess,{params:{id:s?.id}})}})]})}function jv(){const{t:e}=(0,I.Bd)(),t=If(),n=gr(),s=yr(),{job:o}=(0,Re.KC)(),i=tp(o.verbosity||0),r=e`No timeout specified`;return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Kt,{columns:t,item:o}),(0,z.jsx)(Ft,{isEmpty:!o.playbook,label:e("Playbook"),children:o.playbook}),(0,z.jsx)(Ft,{isEmpty:!o.summary_fields.project_update?.status,label:e("Project update status"),children:(0,z.jsx)(au,{status:o.summary_fields.project_update?.status,to:`/jobs/project_update/${o.summary_fields.project_update?.id}`})}),(0,z.jsx)(Ft,{isEmpty:!o.scm_revision,label:e("Revision"),children:o.scm_revision}),(0,z.jsx)(Ft,{isEmpty:!o.controller_node,label:e("Controller node"),children:o.controller_node}),(0,z.jsx)(Ft,{isEmpty:!o.execution_node,label:e("Execution node"),helpText:e("The execution node used to run the job."),children:o.execution_node}),(0,z.jsx)(Ft,{helpText:e("Instance group used on this job run."),isEmpty:!o.summary_fields.instance_group?.is_container_group,label:e("Instance group"),children:(0,z.jsx)(a.N_,{to:n(fc.InstanceGroupDetails,{params:{id:o.summary_fields?.instance_group?.id}}),children:o.summary_fields?.instance_group?.name})}),(0,z.jsx)(Ft,{isEmpty:!o.summary_fields.instance_group?.is_container_group,label:e("Container group"),children:(0,z.jsx)(a.N_,{to:n(fc.InstanceGroupDetails,{params:{id:o.summary_fields?.instance_group?.id}}),children:o.summary_fields?.instance_group?.name})}),(0,z.jsx)(Ft,{label:e("Forks"),helpText:e("The number of parallel or simultaneous processes to use while executing the playbook. An empty value, or a value less than 1 will use the Ansible default which is usually 5. The default number of forks can be overwritten with a change to ansible.cfg. Refer to the Ansible documentation for details about the configuration file."),children:o.forks}),(0,z.jsx)(Ft,{label:e("Timeout"),helpText:e("The amount of time (in seconds) to run before the job is canceled. Defaults to 0 for no job timeout."),children:0===o.timeout?r:o.timeout}),(0,z.jsx)(Ft,{label:e("Verbosity"),helpText:e("Control the level of output Ansible will produce as the playbook executes."),children:i}),(0,z.jsx)(Ft,{label:e("Job tags"),helpText:e("Job tags used during this job."),isEmpty:!o.job_tags,children:(0,z.jsx)(De.o,{children:o.job_tags?.split(",")?.map((e=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{helpText:e("Skip tags used during this job."),label:e("Skip tags"),isEmpty:!o.skip_tags,children:(0,z.jsx)(De.o,{children:o.skip_tags?.split(",")?.map((e=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{label:e("Module arguments"),isEmpty:!o.module_args,children:o.module_args}),(0,z.jsx)(Ft,{isEmpty:!o.summary_fields?.created_by?.username,label:e("Created"),children:(0,z.jsx)(Ie,{value:o.created,author:o.summary_fields.created_by?.username,onClick:()=>s(fc.UserDetails,{params:{id:o.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:o.modified,author:o.summary_fields?.modified_by?.username,onClick:()=>s(fc.UserDetails,{params:{id:o.summary_fields?.modified_by?.id}})}),(0,z.jsx)(Wu,{label:e`Extra variables`,helpText:e("Extra variables used on this job.  This is the -e or --extra-vars command line parameter for ansible-playbook. Provide key/value pairs using either YAML or JSON. Refer to the documentation for example syntax."),showCopyToClipboard:!0,"data-cy":"inventory-source-detail-variables",value:o.extra_vars??""})]})}function _v(e){const{t}=(0,I.Bd)(),{id:n}=(0,Re.g)(),{workflowNodes:s}=e,o=gr(),[i,r]=(0,l.useState)(!1),[c,d]=(0,l.useState)(),[u,m]=(0,l.useState)(s),p=s.length||0,h=(0,l.useMemo)((()=>({failed:["error","failed"],successful:["successful"]})),[]),b=(0,l.useMemo)((()=>Object.values(h).reduce(((e,t)=>[...e,...t]),[])),[h]),f=()=>{r(!i)};return(0,z.jsxs)(On.l,{id:"select-workflow-navigation",isOpen:i,selected:c,onSelect:(e,t)=>{if(void 0===t)return;const a=t.toString();if(a===c)d(void 0),m(s);else{if(d(a),!b.includes(a))return;m(s.filter((e=>e.summary_fields?.job?.status&&h[a].includes(e.summary_fields?.job?.status)&&e.job?.toString()!==n)))}},onOpenChange:e=>r(e),toggle:e=>(0,z.jsx)(_.S,{ref:e,onClick:f,isExpanded:i,style:{width:"180px"},children:t("Workflow Job 1/{{totalResults}}",{totalResults:p})}),shouldFocusToggleOnSelect:!0,children:[(0,z.jsx)(Vn.s,{label:t`Workflow statuses`,"data-cy":"workflow-status",children:(0,z.jsxs)(Yn.B,{children:[(0,z.jsx)(Jn.O,{value:"failed",icon:(0,z.jsx)(an.$Q,{}),description:t`Filter by failed jobs`,children:t`Failed`},"failed"),(0,z.jsx)(Jn.O,{value:"successful",icon:(0,z.jsx)(nn.C1,{}),description:t`Filter by successful jobs`,children:t`Successful`},"successful")]})},"workflow-status"),(0,z.jsx)(Vn.s,{label:t`Workflow nodes`,"data-cy":"workflow-nodes",children:(0,z.jsx)(Yn.B,{children:u.map((e=>(0,z.jsx)(Jn.O,{to:o(fc.JobOutput,{params:{job_type:e.summary_fields.job?.type?tb[e.summary_fields.job?.type]:"",id:e.summary_fields.job?.id}}),component:a.N_,value:e.summary_fields?.job?.name,children:du(e.identifier)?e.summary_fields?.job?.name:e.identifier},e.id)))})},"workflow-nodes")]})}function vv(){const{t:e}=(0,I.Bd)(),{id:t}=(0,Re.g)(),n=yr(),a=gr(),c=(0,Re.g)(),{job:d}=kv(c.id,c.job_type),u=d?.summary_fields?.source_workflow_job?.id,{data:m}=ec(u?xl`/workflow_jobs/${u.toString()}/workflow_nodes/`:""),p=m?.results.filter((({job:e,summary_fields:n})=>e&&e.toString()!==t&&"workflow_approval"!==n?.job?.type))??[],h=function(e){const{t}=(0,I.Bd)(),n=Zy(e),a=Xy(e),i=async e=>{const t=`${e.related.stdout}?format=txt_download`,n=await tl({url:t,method:"GET"});if(!n.ok)throw await Zr(n);const a=await n.text();Ho(e.name,a)},r=ex();return(0,l.useMemo)((()=>[...r,{type:s.Button,selection:o.Single,variant:g.Ak.secondary,isPinned:!0,icon:Nd.Kf,label:t("Cancel job"),isDisabled:e=>tx(e,t),onClick:e=>n([e])},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:jo.s3,label:t("Download output"),onClick:e=>i(e),ouiaId:"job-detail-download-button",isHidden:e=>!e.related.stdout},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete job"),isDisabled:e=>(e=>e.summary_fields.user_capabilities.delete?kf(e.status)?t("The job cannot be deleted due to a running job status"):"":t("The job cannot be deleted due to insufficient permission"))(e),onClick:e=>{e&&a([e])},ouiaId:"job-detail-delete-button",isDanger:!0}]),[n,a,r,i,t])}((()=>n(fc.Jobs)));return(0,z.jsx)(qi,{title:d?.name,breadcrumbs:[{label:e("Jobs"),to:a(fc.Jobs)},{label:d?.name}],headerActions:(0,z.jsxs)(i.s,{children:[p?.length>0&&(0,z.jsx)(r.Z,{children:(0,z.jsx)(_v,{workflowNodes:p})}),(0,z.jsx)(r.Z,{children:(0,z.jsx)(oe,{actions:h,position:te.nU.right,selectedItem:d})})]})})}function wv(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{job:n,isLoading:a,error:s,refreshJob:o}=kv(t.id,t.job_type);return s?(0,z.jsx)(Ic,{error:s,handleRefresh:o}):!n||a?(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(vv,{}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Jobs"),page:fc.Jobs,persistentFilterKey:"jobs"},tabs:[{label:e("Output"),page:fc.JobOutput},{label:e("Details"),page:fc.JobDetails}],params:t,componentParams:{job:n}})]})}function kv(e,t){const n=t?{project:"project_updates",inventory:"inventory_updates",playbook:"jobs",command:"ad_hoc_commands",management:"system_jobs",workflow:"workflow_jobs"}[t]:"jobs",{data:a,refresh:s,isLoading:o,error:i}=ec(e?xl`/${n}/${e}/`:"");return{job:a,refreshJob:s,isLoading:o,error:i}}const Sv=A.Ay.div.withConfig({componentId:"ans__sc-lx0w6f-0"})(["background-color:var(--pf-v5-global--Color--light-300);display:flex;min-height:7px;margin-top:16px;margin-bottom:8px;width:100%;"]),Cv=A.Ay.div.withConfig({componentId:"ans__sc-lx0w6f-1"})(["background-color:",";flex-grow:",";"],(e=>e.color||"inherit"),(e=>e.count||0));Cv.displayName="BarSegment";const Tv=A.Ay.div.withConfig({componentId:"ans__sc-lx0w6f-2"})(["align-items:center;display:flex;span.pf-v5-c-badge{margin-left:10px;}"]),Iv=A.Ay.div.withConfig({componentId:"ans__sc-lx0w6f-3"})(["display:flex;gap:16px;justify-content:end;font-size:var(--pf-v5-global--FontSize--sm);"]),Av=A.Ay.span.withConfig({componentId:"ans__sc-lx0w6f-4"})(["display:inline-block;width:10px;height:10px;background-color:",";margin-right:8px;"],(e=>e.color));function Dv(e){const{t}=(0,I.Bd)(),n={successful:{color:P,label:t`Success`},canceled:{color:B,label:t`Canceled`},new:{color:F,label:t`New`},pending:{color:F,label:t`Pending`},waiting:{color:F,label:t`Waiting`},running:{color:F,label:t`Running`},error:{color:R,label:t`Error`},failed:{color:R,label:t`Failed`}},a={};return e.nodes.map((e=>{if(!e?.summary_fields?.job?.status)return;const t=e.summary_fields.job.status,n=a[t];a[t]=t in a&&n?n+1:1})),(0,z.jsx)(Pv,{counts:a,status:n})}function Ev(e){const{t}=(0,I.Bd)(),n={ok:{color:P,label:t`Success`},skipped:{color:F,label:t`Skipped`},changed:{color:B,label:t`Changed`},failures:{color:R,label:t`Failed`},dark:{color:$,label:t`Unreachable`}};return(0,z.jsx)(Pv,{counts:e.counts,status:n})}function Pv(e){const{t}=(0,I.Bd)(),{counts:n,status:a}=e,s=0===Object.keys(n).length,o=Object.values(n).reduce(((e,t)=>e+t),0),i=Object.keys(a).map((e=>{const t=n[e]||0,s=a[e]??a.dark;return(0,z.jsx)(x.m,{content:(0,z.jsxs)(Tv,{children:[s.label,(0,z.jsx)(bb.E,{isRead:!0,children:t})]}),children:(0,z.jsx)(Cv,{color:s.color,count:t},e)},e)}));return s?(0,z.jsx)(Sv,{"data-cy":"status-bar",children:(0,z.jsx)(x.m,{content:t`Host status information for this job is unavailable.`,children:(0,z.jsx)(Cv,{count:1})})}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Sv,{"data-cy":"status-bar",children:i}),(0,z.jsx)(Iv,{children:Object.keys(n).map((e=>(0,z.jsx)(Rv,{color:a[e]?.color??a.dark.color,label:a[e]?.label??a.dark.label,percent:(n[e]??0)/o*100},e)))})]})}function Rv(e){const{color:t,label:n,percent:a}=e;return(0,z.jsxs)("div",{children:[(0,z.jsx)(Av,{color:t}),n," ",Math.round(a),"%"]})}function Bv(e){return(0,l.useEffect)((()=>{e.queryJobOutputEvent(e.counter)}),[e]),(0,z.jsxs)("div",{className:"output-grid-row",children:[(0,z.jsx)("div",{className:"expand-column"}),(0,z.jsx)("div",{className:"stdout-column",children:(0,z.jsx)(kn.E,{children:`Loading ${e.counter}`})})]})}var Fv=n(77728),Nv=n.n(Fv);function $v(e){const t=Nv().ansiToJson(e.input,Mv);return(0,z.jsx)(z.Fragment,{children:t.map(((e,t)=>(0,z.jsx)("span",{className:e.fg?`${e.fg}-fg`:void 0,children:e.content},t)))})}const Mv={json:!0,remove_empty:!0,use_classes:!0},Lv=A.Ay.div.withConfig({componentId:"ans__sc-1qosnml-0"})(["border-radius:1em;background-color:white;font-size:0.6rem;width:max-content;padding:0em 1em;margin-left:auto;margin-right:-0.3em;color:black;"]);function Ov(){return(0,z.jsx)(Lv,{children:"..."})}const zv=A.Ay.div.withConfig({componentId:"ans__sc-gp6s9n-0"})(["position:sticky;left:0px;display:flex;gap:8px;padding-block:2px;padding-inline:8px;border-right:1px solid var(--pf-v5-global--BorderColor--100);background-color:var(--pf-v5-global--BackgroundColor--200);z-index:1;.pf-v5-theme-dark &{background-color:var(--pf-v5-global--BackgroundColor--100);}"]),Hv=A.Ay.button.withConfig({componentId:"ans__sc-gp6s9n-1"})(["background-color:unset;border:0;line-height:1;align-self:start;"]),qv=A.Ay.div.withConfig({componentId:"ans__sc-gp6s9n-2"})(["flex:1;text-align:right;"]),Uv=A.Ay.div.withConfig({componentId:"ans__sc-gp6s9n-3"})(["padding-block:2px;padding-inline:16px;"]);function Wv(e){const{index:t,row:n,collapsed:a,setCollapsed:s,canCollapseEvents:o}=e,i=(0,l.useRef)(null);(0,Ne.A)(i,(()=>e.setHeight(t,i.current?.clientHeight??0)));const r=!0===a[n.uuid??""],c=!n.canCollapse&&""!==n.taskUuid&&n.taskUuid!==n.uuid;return(0,z.jsxs)("div",{style:{cursor:c?"pointer":"auto"},ref:i,className:"output-grid-row",role:"button",tabIndex:0,onClick:()=>{e.onClick(n)},children:[(0,z.jsxs)(zv,{children:[o&&n.canCollapse&&(0,z.jsx)(Hv,{onClick:()=>s(n.uuid,n.counter,!r),children:(0,z.jsx)(Ke.D0,{style:{transform:r?"rotate(0deg)":"rotate(90deg)",transition:"transform"}})}),(0,z.jsxs)(qv,{children:[n.line,n.canCollapse&&r&&(0,z.jsx)(Ov,{})]})]}),(0,z.jsxs)(Uv,{children:[(0,z.jsx)($v,{input:n.stdout}),n.isHeaderLine&&n.canCollapse&&(0,z.jsxs)(z.Fragment,{children:["  ",(0,z.jsx)(Ee.J,{isCompact:!0,children:new Date(n.created??"").toLocaleTimeString()})]})]})]})}function Jv(e){const t=e.event_data.play_uuid??"",n=e.event_data.task_uuid??"";if(!e.counter)return[];if(!e.stdout)return[];const a=e.stdout.split("\r\n");let s=!1;switch(e.event){case"playbook_on_play_start":case"playbook_on_task_start":case"playbook_on_stats":s=""!==t||""!==n}let o=!1,i=!1;return a.map(((a,r)=>(e.parent_uuid&&(a?(o=!i,i=!0):o=!1),{line:e.start_line+r,counter:e.counter,stdout:a,uuid:e.uuid??"",playUuid:t??"",taskUuid:n??"",eventLine:r,canCollapse:s&&o,isHeaderLine:o,created:e.created})))}var Vv=n(53098),Gv=n(16082),Yv=n(80613);const Kv=A.Ay.div.withConfig({componentId:"ans__sc-1hj6n1j-0"})(["display:flex;height:35px;border:1px solid #d7d7d7;width:100%;justify-content:space-between;"]),Zv=A.Ay.div.withConfig({componentId:"ans__sc-1hj6n1j-1"})(["display:flex;justify-content:flex-end;"]),Xv=A.Ay.div.withConfig({componentId:"ans__sc-1hj6n1j-2"})(["display:flex;justify-content:flex-start;& > Button{padding-left:8px;}"]);function Qv(e){const{onScrollFirst:t,onScrollLast:n,onScrollNext:a,onScrollPrevious:s,toggleExpandCollapseAll:o,isAllCollapsed:i,isFlatMode:r,isTemplateJob:l}=e,{t:c}=(0,I.Bd)();return(0,z.jsxs)(Kv,{children:[(0,z.jsx)(Xv,{children:!r&&l&&(0,z.jsx)(g.$n,{"aria-label":i?c`Expand job events`:c`Collapse all job events`,variant:"plain",type:"button",onClick:o,children:i?(0,z.jsx)(Ke.D0,{}):(0,z.jsx)(Oo.RM,{})})}),(0,z.jsxs)(Zv,{children:[(0,z.jsx)(g.$n,{ouiaId:"job-output-scroll-previous-button","aria-label":c`Scroll previous`,onClick:s,variant:"plain",children:(0,z.jsx)(Vv.QX,{})}),(0,z.jsx)(g.$n,{ouiaId:"job-output-scroll-next-button","aria-label":c`Scroll next`,onClick:a,variant:"plain",children:(0,z.jsx)(Oo.RM,{})}),(0,z.jsx)(g.$n,{ouiaId:"job-output-scroll-first-button","aria-label":c`Scroll first`,onClick:t,variant:"plain",children:(0,z.jsx)(Gv.XB,{})}),(0,z.jsx)(g.$n,{ouiaId:"job-output-scroll-last-button","aria-label":c`Scroll last`,onClick:n,variant:"plain",children:(0,z.jsx)(Yv.c1,{})})]})]})}const ew=15,tw=["new","pending","waiting","running"],nw=["new","pending","waiting","running"];function aw(e){return!e||nw.includes(e)}const sw=e=>{let t;return t=e.event_data?.res?"string"==typeof e.event_data?.res?e.event_data?.res:Array.isArray(e.event_data?.res)?e.event_data?.res.join(" "):e.event_data?.res:"",t},ow=e=>{const t=e?.event_data?.task_action,n=e?.event_data?.res;let a="";return"debug"===t&&n?.result?.stdout?a=n.result.stdout:"yum"===t&&Array.isArray(n?.results)?a=n.results.join("\n"):n?.stdout&&(a=Array.isArray(n.stdout)?n.stdout.join(" "):n.stdout),a};function iw(e){const{onClose:t,hostEvent:n,isOpen:a=!1}=e,{t:s}=(0,I.Bd)(),[o,i]=(0,l.useState)(0),r=sw(n),c=n?.event_data?.res?.stderr,d=ow(n);return(0,z.jsx)(Zt.a,{isOpen:a,onClose:t,title:s`Host Details`,"aria-label":s`Host details modal`,width:"75%",ouiaId:"host-event-modal",children:(0,z.jsxs)(Ec.t,{"aria-label":s`Tabs`,activeKey:o,onSelect:(e,t)=>{i(t)},ouiaId:"host-event-tabs",children:[(0,z.jsx)(Dc.o,{"aria-label":s`Details tab`,ouiaId:"details-tab",eventKey:0,title:(0,z.jsx)(Pc.V,{children:s`Details`}),children:(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{isEmpty:!n.event_data?.host,label:s("Host"),children:n?.event_data?.host}),(0,z.jsx)(Ft,{label:s("Status"),children:(0,z.jsx)(au,{status:rw(n)})}),(0,z.jsx)(Ft,{isEmpty:!n.play,label:s("Play"),children:n?.play}),(0,z.jsx)(Ft,{isEmpty:!n.task,label:s("Task"),children:n?.task}),(0,z.jsx)(Ft,{isEmpty:!n.event_data?.task_action,label:s("Module"),children:n?.event_data?.task_action})]})}),(0,z.jsx)(Dc.o,{eventKey:1,title:(0,z.jsx)(Pc.V,{children:s`Data`}),"aria-label":s`Data tab`,ouiaId:"data-tab",children:1===o&&r?(0,z.jsx)(Wu,{showCopyToClipboard:!0,value:JSON.stringify(r,null,2)}):(0,z.jsx)(es,{description:s("There is no data"),title:s`No Data Available`})}),d?.length?(0,z.jsx)(Dc.o,{eventKey:2,title:(0,z.jsx)(Pc.V,{children:s`Output`}),"aria-label":s`Output tab`,ouiaId:"standard-out-tab",children:(0,z.jsx)(Wu,{value:d})}):null,c?.length?(0,z.jsx)(Dc.o,{eventKey:3,title:(0,z.jsx)(Pc.V,{children:s`Standard Error`}),"aria-label":s`Standard error tab`,ouiaId:"standard-error-tab",children:(0,z.jsx)(Wu,{value:c})}):null]})})}function rw(e){let t="";return"runner_on_unreachable"===e.event&&(t="unreachable"),e.failed&&(t="failed"),"runner_on_ok"!==e.event&&"runner_on_async_ok"!==e.event&&"runner_item_on_ok"!==e.event||(t="ok"),e.changed&&(t="changed"),"runner_on_skipped"===e.event&&(t="skipped"),t}const lw=A.Ay.div.withConfig({componentId:"ans__sc-udkz7c-0"})(["overflow:auto;backgroundcolor:var(--pf-v5-global--BackgroundColor--100);font-size:var(--pf-v5-global--FontSize--sm);border-bottom:1px solid var(--pf-v5-global--BorderColor--100);"]);function cw(e){const{job:t,reloadJob:n,toolbarFilters:a,filterState:s,isFollowModeEnabled:o,setIsFollowModeEnabled:i}=e,[r,c]=(0,l.useState)(null),d=Object.keys(s).length>0,{childrenSummary:u,isFlatMode:m}=function(e,t){let n=t||"job"!==e.type;const a=ec(xl`/jobs/${e.id.toString()}/job_events/children_summary/`),{data:s,error:o}=a;return o&&(n=!0),{childrenSummary:n||!s?void 0:s,isFlatMode:n||!s}}(t,aw(t.status)||d),{jobEventCount:p,getJobOutputEvent:h,queryJobOutputEvent:b}=function(e,t,n,a,s){const o=(0,l.useRef)({querying:!1}),i=(0,l.useRef)({}),r=(0,l.useRef)(void 0),[c,d]=(0,l.useState)(1),[u,m]=(0,l.useState)({}),p=(0,l.useCallback)((e=>u[e]),[u]),h=Object.keys(a).length>0,b=!e.status||tw.includes(e.status),f=(0,l.useCallback)((t=>{const n="job"===e.type?"job_events":"events";o.current.querying=!0,nl(xl`/${e.type}s/${e.id.toString()}/${n}/`.concat(`?${t.join("&")}`)).then((e=>{b||d(e.count),m((t=>{t={...t};let n=Object.keys(t).length+1;for(const a of e.results)h?(t[n]=a,n++):t[a.counter]=a;return t}))})).catch().finally((()=>{o.current.querying=!1}))}),[e.id,e.type,b,h]),g=(0,l.useCallback)((e=>{const t=u[e+1];if(t||o.current.querying)return t;if(b)return i.current[e+1]=!0,r.current||(r.current=setTimeout((()=>{const e=Object.keys(i.current).filter((e=>!u[Number(e)]));if(e.length>0){const t=["order_by=counter",`counter__in=${e.join(",")}`];f(t)}i.current={},r.current=void 0}),2500)),t;const s=Math.floor((e+1)/50)+1,l=function(e,t){if(!t)return"";const n=[];for(const a in t){const s=e?.find((e=>e.key===a));if(s){const e=t[a];e&&e.length>0&&(e.length>1?n.push(e.map((e=>`or__${s.query}=${e}`)).join("&")):n.push(`${s.query}=${e.join(",")}`))}}return n.join("&")}(n,a),c=["order_by=counter",`page=${s}`,"page_size=50"];return l&&c.push(l),f(c),t}),[u,50,a,n,b,f]),y=(0,l.useRef)([]),x=(0,l.useRef)(void 0),j=(0,l.useCallback)((()=>{if(h)return;const e=y.current.reduce(((e,t)=>Math.max(e,t.counter)),c);m((e=>(y.current.forEach((t=>{e[t.counter]=t})),y.current=[],e))),d(e)}),[h,c]),_=`${e.type}_events`,v=(0,l.useCallback)((n=>{if(n?.group_name===_){const e=n;y.current.push(e),clearTimeout(x.current),y.current.length>=ew?j():x.current=setTimeout(j,500)}"jobs"===n?.group_name&&n?.unified_job_id===e.id&&n?.status&&t()}),[j,_,t,e.id]);return dc({control:["limit_reached_1"],jobs:["summary","status_changed"],[_]:[e.id]},v),(0,l.useEffect)((()=>{d(1),m({})}),[a]),{jobEventCount:c,getJobOutputEvent:p,queryJobOutputEvent:g,jobEvents:u}}(t,n,a,s),f=(0,l.useMemo)((()=>{const e=[];if(t.result_traceback)for(const n of t.result_traceback.split("\n").map(((e,t)=>({line:void 0,counter:0,stdout:e,uuid:"",playUuid:"",taskUuid:"",eventLine:t,canCollapse:!1,isHeaderLine:!1,created:void 0}))))e.push(n);for(let t=1;t<=p;t++){const n=h(t);if(n)for(const t of Jv(n))e.push(t);else e.push(t)}return e}),[h,p,t.result_traceback]),[g,y]=(0,l.useState)({}),x=(e,t,n)=>{y((a=>({...a,[e]:n,[t]:n}))),!1===n&&_(!1)},[j,_]=(0,l.useState)(!1),v=function(e,t,n,a){return(0,l.useMemo)((()=>a.filter((a=>{if(e)return!0;if("number"!=typeof a)return!(n[a.playUuid]&&a.playUuid!==a.uuid||n[a.taskUuid]&&a.taskUuid!==a.uuid);if(!t)return!0;for(const e in t.children_summary){const s=t.children_summary[e];if(!s)return!0;const o=Number(e);if(o>=a)return!0;if(o+s.numChildren>a&&n[o])return!1}return!0}))),[e,t,n,a])}(m,u,g,f),w=(0,l.useRef)(null),{beforeRowsHeight:k,visibleItems:S,setRowHeight:C,afterRowsHeight:T}=function(e,t){const[n,a]=(0,l.useState)(0),[s,o]=(0,l.useState)(0),i=(0,l.useCallback)((()=>{e.current&&(a(e.current.scrollTop),o(e.current.clientHeight))}),[e]);(0,l.useEffect)((()=>{if(!e.current)return;const t=e.current;return t.addEventListener("scroll",i),()=>{t.removeEventListener("scroll",i)}}),[e,i]);const r=(0,l.useCallback)((()=>{e.current&&o(e.current.clientHeight)}),[e]);(0,Ne.A)(e,(()=>r()));const[c,d]=(0,l.useState)({}),[u,m]=(0,l.useState)(24),p=(0,l.useCallback)(((e,t)=>{d((n=>{if(n[e]===t)return n;u>t&&m(t);const a={...n};return a[e]=t,a}))}),[u]),h=t.length;let b=0,f=0;for(;f<h;){const e=c[f],t=void 0===e?u:e;if(b+t>=n-400)break;b+=t,f++}const g=f,y=b,x=n+s+400;let j=0;for(;f<h;){const e=c[f];if(b+=void 0===e?u:e,f++,j++,b>=x)break}const _=b-y;for(;f<h;){const e=c[f];b+=void 0===e?u:e,f++}const v=b-y-_;return{beforeRowsCount:g,beforeRowsHeight:y,visibleItems:t.slice(g,g+j),setRowHeight:p,afterRowsHeight:v}}(w,v),I=u?.event_processing_finished&&u.is_tree,A=5*f.length,D=String(A).length,{scrollToTop:E,scrollToBottom:P,scrollPageDown:R,scrollPageUp:B}=function(e,t,n,a,s){const[o,i]=(0,l.useState)(0);return(0,l.useEffect)((()=>{if(!t)return;const n=setInterval((()=>{e.current&&e.current.scrollTo({top:e.current.scrollHeight})}),200);return()=>{clearInterval(n)}}),[t,e]),(0,l.useEffect)((()=>{if(!t||s)return;const a=setInterval((()=>{e.current&&(o>=3?n(!1):function(e){const{clientHeight:t,scrollHeight:n,scrollTop:a}=e;return a>=n-t}(e.current)?i((e=>e+1)):i(0))}),200),r=setTimeout((()=>{n(!1)}),1200);return()=>{clearInterval(a),clearTimeout(r)}}),[t,s,e,o,n]),{scrollToTop:()=>{e.current?.scrollTo({top:0}),n(!1)},scrollToBottom:()=>{e.current&&(e.current.scrollTo({top:e.current.scrollHeight}),n(!0))},scrollPageDown:()=>{if(!e.current)return;const{height:t}=e.current.getBoundingClientRect();e.current?.scrollBy({top:t-48})},scrollPageUp:()=>{if(!e.current)return;const{height:t}=e.current.getBoundingClientRect();e.current?.scrollBy({top:-1*(t-48)}),n(!1)}}}(w,o,i,f.length,aw(t.status)),F=S.findIndex((e=>"object"==typeof e&&e.uuid===r?.uuid)),N=S[F],$="object"==typeof N&&N.counter,M=$?h($):void 0,L=r?.counter&&function(e){const{event:t,event_data:n,host:a,type:s}=e;let o;return o=!!("number"==typeof a||n&&n.res)||!("project_update_event"!==s||"runner_on_skipped"===t||!n?.host),o}(h(r.counter))&&r.uuid!==r.taskUuid;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Qv,{onScrollFirst:E,onScrollLast:P,onScrollNext:R,onScrollPrevious:B,toggleExpandCollapseAll:()=>(()=>{_(!j);let e=!1;S.forEach((t=>{"number"!=typeof t&&!0!==e&&t.canCollapse&&t.isHeaderLine&&t.stdout.startsWith("PLAY")&&(e=!0,x(t.playUuid,t.counter,!j))}))})(),isFlatMode:m,isTemplateJob:"job"===t.type,isAllCollapsed:j}),(0,z.jsx)(lw,{ref:w,tabIndex:0,children:(0,z.jsx)("pre",{children:(0,z.jsxs)("div",{className:"output-grid",style:{"--output-line-chars":D},children:[(0,z.jsx)("div",{style:{height:k}}),S.map(((e,t)=>{if("number"==typeof e){const t=e;return(0,z.jsx)(Bv,{counter:t,queryJobOutputEvent:b},t)}return(0,z.jsx)(Wv,{index:t,row:e,collapsed:g,setCollapsed:x,setHeight:C,onClick:c,canCollapseEvents:I},`${e.counter}-${e.eventLine}-${t}`)})),(0,z.jsx)("div",{style:{height:T}})]})})}),L&&void 0!==M&&(0,z.jsx)(iw,{isOpen:!0,onClose:()=>c(null),hostEvent:M})]})}function dw(e){const{toolbarFilters:t,filterState:n,setFilterState:a,jobStatus:s,isFollowModeEnabled:o,setIsFollowModeEnabled:i}=e,{t:r}=(0,I.Bd)();return(0,z.jsx)(vn.M,{clearAllFilters:()=>a({}),children:(0,z.jsxs)(_n.P,{children:[(0,z.jsx)(Da,{toolbarFilters:t,filterState:n,setFilterState:a}),aw(s)?(0,z.jsx)(g.$n,{variant:o?"secondary":"primary",onClick:()=>{i(!o)},children:r(o?"Unfollow":"Follow")}):null]})})}const uw=A.Ay.div.withConfig({componentId:"ans__sc-1aokut1-0"})(["display:inline-flex;align-items:baseline;gap:10px;h1{font-weight:var(--pf-v5-global--FontWeight--bold);}"]);function mw(e){const{job:t}=e,{t:n}=(0,I.Bd)(),a=yr(),[c,d]=(0,l.useState)("00:00:00");(0,l.useEffect)((()=>{let e;return t.finished||(e=setInterval((()=>{const e=hw(t.started);d(e)}),1e3)),()=>clearInterval(e)}),[t.started,t.finished]);const u=t.playbook_counts?.play_count,m=t.playbook_counts?.task_count,p=t.host_status_counts?.dark,h=t.host_status_counts?.failures,b=t.host_status_counts?Object.keys(t.host_status_counts||{}).reduce(((e,n)=>e+t.host_status_counts[n]),0):0,f=t.finished?je.dw.fromObject({seconds:Number(t.elapsed)}).toFormat("hh:mm:ss"):c,y=(0,l.useMemo)((()=>({type:s.Button,selection:o.None,variant:g.Ak.primary,icon:Mg.W$,label:n("View workflow visualizer"),onClick:()=>a(fc.WorkflowVisualizer,{params:{id:t.unified_job_template}})})),[n,t.unified_job_template,a]);return(0,z.jsxs)(ee.B,{hasGutter:!0,children:[(0,z.jsx)(xe.o,{isFilled:!0,children:(0,z.jsxs)(uw,{children:[(0,z.jsx)("h1",{children:t.name}),(0,z.jsx)(su,{status:t.status,dataCy:"job-status-label"})]})}),(0,z.jsx)(xe.o,{children:(0,z.jsxs)(i.s,{children:["workflow_job"===t.type&&(0,z.jsx)(ne,{iconOnly:!0,action:y}),(0,z.jsx)(pw,{label:n("Plays"),count:u}),(0,z.jsx)(pw,{label:n("Tasks"),count:m}),(0,z.jsx)(pw,{label:n("Hosts"),count:b}),(0,z.jsx)(pw,{label:n("Unreachable"),count:p}),(0,z.jsx)(pw,{label:n("Failed"),count:h}),(0,z.jsxs)(r.Z,{children:[n("Elapsed")," ",(0,z.jsx)(bb.E,{isRead:!0,children:f})]})]})})]})}function pw(e){const{label:t,count:n}=e;return n?(0,z.jsxs)(r.Z,{children:[t," ",(0,z.jsx)(bb.E,{isRead:!0,children:n})]}):null}const hw=e=>{if(!e)return"";const t=je.c9.now().diff(je.c9.fromISO(`${e}`),["milliseconds","seconds","minutes","hours"]).toObject();return je.dw.fromObject({...t}).toFormat("hh:mm:ss")},bw=(0,A.Ay)(Oe.d8).withConfig({componentId:"ans__sc-c06gl1-0"})(["display:flex;flex-direction:column;height:calc(100vh - 204px);"]);function fw(){const e=(0,Re.g)(),{job:t,refreshJob:n}=kv(e.id,e.job_type);return t?(0,z.jsx)(gw,{job:t,reloadJob:n}):null}function gw(e){const{job:t,reloadJob:n}=e,a=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>[{key:"stdout",label:e("Search output"),type:Ia.MultiText,query:"stdout__icontains",placeholder:e("Filter by keyword"),comparison:"contains"},{key:"event",label:e("Event"),type:Ia.MultiSelect,query:"event",placeholder:e("Select event type"),options:[{value:"debug",label:e("Debug")},{value:"deprecated",label:e("Deprecated")},{value:"error",label:e("Error")},{value:"runner_on_file_diff",label:e("File Difference")},{value:"playbook_on_setup",label:e("Gathering Facts")},{value:"runner_on_async_failed",label:e("Host Async Failure")},{value:"runner_on_async_ok",label:e("Host Async OK")},{value:"runner_on_failed",label:e("Host Failed")},{value:"runner_on_error",label:e("Host Failure")},{value:"runner_on_ok",label:e("Host OK")},{value:"runner_on_async_poll",label:e("Host Polling")},{value:"runner_retry",label:e("Host Retry")},{value:"runner_on_skipped",label:e("Host Skipped")},{value:"runner_on_start",label:e("Host Started")},{value:"runner_on_unreachable",label:e("Host Unreachable")},{value:"playbook_on_include",label:e("Including File")},{value:"runner_item_on_failed",label:e("Item Failed")},{value:"runner_item_on_ok",label:e("Item OK")},{value:"runner_item_on_skipped",label:e("Item Skipped")},{value:"playbook_on_no_hosts_matched",label:e("No Hosts Matched")},{value:"playbook_on_no_hosts_remaining",label:e("No Hosts Remaining")},{value:"runner_on_no_hosts",label:e("No Hosts Remaining")},{value:"playbook_on_play_start",label:e("Play Started")},{value:"playbook_on_stats",label:e("Playbook Complete")},{value:"playbook_on_start",label:e("Playbook Started")},{value:"playbook_on_notify",label:e("Running Handlers")},{value:"system_warning",label:e("System Warning")},{value:"playbook_on_task_start",label:e("Task Started")},{value:"playbook_on_vars_prompt",label:e("Variables Prompted")},{value:"verbose",label:e("Verbose")},{value:"warning",label:e("Warning")}]}]),[e])}(),[s,o]=(0,l.useState)({}),i=aw(t.status),[r,c]=(0,l.useState)(i),{results:d,refresh:u}=cm(xl`/workflow_jobs/${e.job.id.toString()||""}/workflow_nodes/`);return t?(0,z.jsxs)(bw,{variant:"light",children:[(0,z.jsx)(mw,{job:t}),"workflow_job"===t.type?(0,z.jsx)(Dv,{nodes:d||[]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ev,{counts:t.host_status_counts||{}}),(0,z.jsx)(dw,{toolbarFilters:a,filterState:s,setFilterState:o,jobStatus:t.status,isFollowModeEnabled:r,setIsFollowModeEnabled:c})]}),"workflow_job"===t.type?(0,z.jsx)(ib,{job:t,reloadJob:n,refreshNodeStatus:u}):(0,z.jsx)(cw,{job:t,reloadJob:n,toolbarFilters:a,filterState:s,isFollowModeEnabled:r,setIsFollowModeEnabled:c})]}):(0,z.jsx)(kn.E,{})}function yw(){const{t:e}=(0,I.Bd)(),t=If();Fc("jobs");const n=sc(),a=Uc({url:xl`/unified_jobs/`,toolbarFilters:nx(),tableColumns:t}),{refresh:s}=a;return dc({control:["limit_reached_1"],jobs:["status_changed"],schedules:["changed"]},(0,l.useCallback)((e=>{if("jobs"===e?.group_name)switch(e?.type){case"job":case"workflow_job":case"project_update":s()}}),[s])),(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Jobs"),titleHelpTitle:e("Jobs"),titleHelp:e("A job is an instance of {{product}} launching an Ansible playbook against an inventory of hosts.",{product:"AWX"}),titleDocLink:pc(n,"jobs"),description:e("A job is an instance of {{product}} launching an Ansible playbook against an inventory of hosts.",{product:"AWX"}),headerActions:(0,z.jsx)(cd,{type:"job"})}),(0,z.jsx)(ax,{columns:t})]})}function xw(e){const{config:t}=e,{t:n}=(0,I.Bd)(),{wizardData:a}=vr(),{prompt:{credentials:s}}=a,o=[];let i=!1,r=!1,l=!1;return"ask_credential_on_launch"in t&&t.ask_credential_on_launch||!("passwords_needed_to_start"in t)||!t.passwords_needed_to_start?s&&s.forEach((e=>{if(!("inputs"in e)&&"defaults"in t){const n=t.defaults.credentials.find((t=>t.id===e.id));if(n&&n?.passwords_needed.length>0){n.passwords_needed.includes("ssh_password")&&(i=!0),n.passwords_needed.includes("become_password")&&(r=!0),n.passwords_needed.includes("ssh_key_unlock")&&(l=!0);const e=n.passwords_needed.filter((e=>e.startsWith("vault_password"))).map((e=>e.split(/\.(.+)/)[1]||""));o.push(...e)}}else{const t="inputs"in e;t&&"ASK"===e?.inputs?.password&&(i=!0),t&&"ASK"===e?.inputs?.become_password&&(r=!0),t&&"ASK"===e?.inputs?.ssh_key_unlock&&(l=!0),t&&"ASK"===e?.inputs?.vault_password&&o.push(e.inputs.vault_id?.toString()??"")}})):t.passwords_needed_to_start.forEach((e=>{if("ssh_password"===e)i=!0;else if("become_password"===e)r=!0;else if("ssh_key_unlock"===e)l=!0;else if(e.startsWith("vault_password")){const t=e.split(/\.(.+)/)[1]||"";o.push(t)}})),(0,z.jsxs)(mo,{isVertical:!0,singleColumn:!0,children:[(0,z.jsx)(lh,{isHidden:!i,children:(0,z.jsx)(li,{id:"launch-ssh-password",label:n("SSH password"),name:"credential_passwords.ssh_password",placeholder:n("Enter a password"),type:"password",isRequired:!0})}),(0,z.jsx)(lh,{isHidden:!l,children:(0,z.jsx)(li,{id:"launch-private-key-passphrase",label:n("Private key password"),name:"credential_passwords.ssh_key_unlock",placeholder:n("Enter a password"),type:"password",isRequired:!0})}),(0,z.jsx)(lh,{isHidden:!r,children:(0,z.jsx)(li,{id:"launch-privilege-escalation-password",label:n`Privilege escalation password`,name:"credential_passwords.become_password",placeholder:n("Enter a password"),type:"password",isRequired:!0})}),o.map((e=>{const t="vault_password"+(""!==e?`.${e}`:"");return(0,z.jsx)(li,{id:`launch-vault-password-${e}`,label:""===e?n`Vault password`:n("Vault password | {{credId}}",{credId:e}),name:`credential_passwords.${t}`,placeholder:n("Enter a password"),type:"password",isRequired:!0},e)}))]})}function jw(e){const{template:t}=e,{t:n}=(0,I.Bd)(),{wizardData:s}=vr(),o=gr(),{prompt:i,survey:r}=s,{data:l}=ec(function(e){if(!e)return"";switch(e?.type){case"job_template":return xl`/job_templates/${e?.id.toString()}/survey_spec/`;case"workflow_job_template":return xl`/workflow_job_templates/${e?.id.toString()}/survey_spec/`;default:return""}}(t)),{data:c}=tc(xl`/execution_environments/`,i?.execution_environment??""),{data:d}=tc(xl`/inventories/`,i?.inventory?.id??"");let u=i?.extra_vars||"{}";r&&(u=function(e,t,n){const a=e?JSON.parse(im(e)):{},s={...t};if(n?.spec){const e=function(e,t){const n={...e};return t.forEach((e=>{void 0!==n[e]&&(n[e]="$encrypted$")})),n}(t,n.spec.filter((e=>"password"===e.type)).map((e=>e.variable)));Object.keys(e).forEach((t=>{s[t]=e[t]}))}const o={...a,...s};return om(JSON.stringify(o))}(i?.extra_vars??"",r,l??null));const m=tp(i?.verbosity);return(0,z.jsxs)(Mt,{numberOfColumns:"multiple",children:[(0,z.jsx)(Ft,{label:n("Name"),children:t.name}),(0,z.jsx)(Ft,{label:n("Job type"),children:i?.job_type}),(0,z.jsx)(Ft,{label:n("Organization"),isEmpty:!t.summary_fields.organization,children:(0,z.jsx)(a.N_,{to:o(fc.OrganizationDetails,{params:{id:t.summary_fields?.organization?.id}}),children:t.summary_fields?.organization?.name})}),(0,z.jsx)(lh,{isHidden:!d,children:(0,z.jsx)(Ft,{label:n`Inventory`,isEmpty:!d?.id,children:(0,z.jsx)(a.N_,{to:o(fc.InventoryDetails,{params:{id:d?.id,inventory_type:{"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"}[d?.kind]}}),children:i?.inventory?.name})})}),"job_template"===t.type&&(0,z.jsx)(Ft,{label:n`Project`,isEmpty:!t.summary_fields.project,children:(0,z.jsx)(a.N_,{to:o(fc.ProjectDetails,{params:{id:t.summary_fields?.project?.id}}),children:t.summary_fields.project?.name})}),(0,z.jsx)(Ft,{label:n`Execution environment`,isEmpty:vw(i?.execution_environment),children:(0,z.jsx)(a.N_,{to:o(fc.ExecutionEnvironmentDetails,{params:i?.execution_environment?{id:i?.execution_environment}:{}}),children:c?.name})}),(0,z.jsx)(Ft,{label:n("Source control branch"),children:i?.scm_branch}),"job_template"===t.type&&(0,z.jsx)(Ft,{label:n("Playbook"),children:t?.playbook}),(0,z.jsx)(Ft,{label:n("Credentials"),isEmpty:vw(i?.credentials),children:(0,z.jsx)(De.o,{children:i?.credentials?.map((e=>(0,z.jsx)(_w,{credentialID:e.id},e.id)))})}),(0,z.jsx)(Ft,{label:n`Instance groups`,helpText:n`The instance groups for this job template to run on.`,isEmpty:vw(i?.instance_groups),children:(0,z.jsx)(De.o,{children:i?.instance_groups?.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:o(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))})}),(0,z.jsx)(Ft,{label:n("Forks"),children:i?.forks||0}),(0,z.jsx)(Ft,{label:n("Limit"),children:i?.limit}),(0,z.jsx)(Ft,{label:n("Verbosity"),children:m}),(0,z.jsx)(Ft,{label:n("Timeout"),children:i?.timeout||0}),(0,z.jsx)(Ft,{label:n("Show changes"),children:i?.diff_mode?n`On`:n`Off`}),(0,z.jsx)(Ft,{label:n("Job slicing"),children:i?.job_slice_count}),(0,z.jsx)(Ft,{label:n("Labels"),isEmpty:vw(i?.labels),children:(0,z.jsx)(De.o,{children:i?.labels?.map((e=>(0,z.jsx)(Ee.J,{children:e.name},e.id)))})}),(0,z.jsx)(Ft,{label:n("Job tags"),isEmpty:vw(i?.job_tags),children:(0,z.jsx)(De.o,{children:i?.job_tags?.map((({name:e})=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{label:n("Skip tags"),isEmpty:vw(i?.skip_tags),children:(0,z.jsx)(De.o,{children:i?.skip_tags?.map((({name:e})=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Wu,{label:n("Extra vars"),value:u})]})}function _w({credentialID:e}){const{data:t}=ec(xl`/credentials/${e.toString()}/`);return t?(0,z.jsx)(uu,{credential:t},e):null}function vw(e){return null==e||(Array.isArray(e)?0===e.length:"object"==typeof e&&(0===Object.keys(e).length||Object.values(e).every(vw)))}function ww(){const e=(0,Re.g)(),t=(0,Re.Zp)(),n=Ah(),a=gr(),s=td(),o=ue(),{t:i}=(0,I.Bd)(),{data:r,error:l,refresh:c}=ec(xl`/jobs/${e?.id||""}/relaunch/`),{data:d,error:u,refresh:m}=ec(xl`/jobs/${e?.id||""}/`),p=c||m,h=l||u;if(h)return(0,z.jsx)(Ic,{error:h,handleRefresh:p});if(!r||!d)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const b={credential_passwords:{}};r.passwords_needed_to_start.forEach((e=>b.credential_passwords[e]=""));const f=[{id:"credential-passwords",label:i("Credential Passwords"),inputs:(0,z.jsx)(xw,{config:r})},{id:"review",label:i("Review"),element:(0,z.jsxs)(Mt,{numberOfColumns:"multiple",children:[(0,z.jsx)(Ft,{label:i("Name"),children:d.name}),(0,z.jsx)(Ft,{label:i("Credentials"),children:(0,z.jsx)(De.o,{children:d.summary_fields.credentials?.map((e=>(0,z.jsx)(_w,{credentialID:e.id},e.id)))})})]})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:i("Relaunch job with passwords"),breadcrumbs:[{label:i("Jobs"),to:a(fc.Jobs)},{label:d.name,to:a(fc.JobDetails,{params:{job_type:"playbook",id:e.id}})}]}),(0,z.jsx)(Lr,{steps:f,defaultValue:b,onSubmit:async a=>{if(a)try{const o=await s(xl`/jobs/${e?.id||""}/relaunch/`,a);o&&t(n(o))}catch(e){o.addAlert({variant:"danger",title:i("Failure to launch"),children:e instanceof Error&&e.message})}},errorAdapter:Mc})]})}function kw(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=tc(xl`/system_job_templates`,t.id),o=gr(),{activeAwxUser:i}=_l(),{data:r,error:l,refresh:c}=ec(xl`/organizations/?role_level=notification_admin_role`);if(n)return(0,z.jsx)(Ic,{error:n,handleRefresh:s});if(l)return(0,z.jsx)(Ic,{error:l,handleRefresh:c});if(!a||!r)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const d=[{label:e("Schedules"),page:fc.ManagementJobSchedules}];return(i?.is_system_auditor||r&&r.results.length>0)&&d.push({label:e("Notifications"),page:fc.ManagementJobNotifications}),(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.name,breadcrumbs:[{label:e("Management Jobs"),to:o(fc.ManagementJobs)},{label:a?.name}],headerActions:[]}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Management Jobs"),page:fc.ManagementJobs,persistentFilterKey:"management-jobs"},tabs:d,params:{id:a.id}})]})}function Sw(e){const t=td(),n=(0,Re.Zp)(),a=Ah();return(0,z.jsx)(Zt.a,{"aria-label":po.t`Launch management job`,variant:"small",position:"default",title:po.t`Launch management job`,titleIconVariant:"info",hasNoBodyWrapper:!0,isOpen:!0,onClose:()=>e.popDialog(),children:(0,z.jsxs)(nd,{submitText:(0,po.t)("Launch"),onSubmit:async s=>{const o=await t(xl`/system_job_templates/${String(e.id)}/launch/`,s);e.popDialog(),n(a(o))},cancelText:(0,po.t)("Cancel"),onCancel:()=>e.popDialog(),singleColumn:!0,defaultValue:{extra_vars:{days:30}},children:[(0,z.jsx)("span",{children:(0,po.t)("Set how many days of data should be retained.")}),(0,z.jsx)(li,{name:"extra_vars.days",label:(0,po.t)("Retention Days"),placeholder:(0,po.t)("Enter days"),isRequired:!0,type:"number",min:0,max:99999})]})})}function Cw(){const{t:e}=(0,I.Bd)(),t=sc(),n=yh(),a=gh(),i=function(){const{t:e}=(0,I.Bd)(),t=function(){const{pushDialog:e,popDialog:t}=as(),[n,a]=(0,l.useState)();return(0,l.useEffect)((()=>{n?e((0,z.jsx)(Sw,{...n,popDialog:t})):t()}),[n,e,t]),a}(),n=td(),a=Ah(),i=(0,Re.Zp)(),r=(0,l.useCallback)((async e=>{if("cleanup_activitystream"===e.job_type||"cleanup_jobs"===e.job_type)t({id:e.id});else{const t=await n(xl`/system_job_templates/${String(e.id)}/launch/`,{});i(a(t))}}),[t,a,i,n]);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,variant:g.Ak.secondary,isPinned:!0,icon:mb.Ab,label:e("Launch management job"),onClick:r}]),[e,r])}(),r=Uc({url:xl`/system_job_templates/`,toolbarFilters:n,tableColumns:a});return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Management Jobs"),description:e("Management jobs assist in the cleaning of old data including system tracking information, tokens, job histories, and activity streams."),titleHelpTitle:e("Management Jobs"),titleHelp:e("Management jobs assist in the cleaning of old data including system tracking information, tokens, job histories, and activity streams."),titleDocLink:pc(t,"managementJobs")}),(0,z.jsx)($s,{id:"awx-management-jobs",toolbarFilters:n,tableColumns:a,rowActions:i,errorStateTitle:e("Error loading management jobs"),emptyStateTitle:"No management jobs yet",...r})]})}function Tw(e){const{t}=(0,I.Bd)(),n=gu(fc.OrganizationDetails),a=gr(),s=e?.runningNotifications;return(0,l.useMemo)((()=>[{header:t("Name"),cell:e=>(0,z.jsx)(Fe,{text:e.name,to:a(fc.NotificationTemplateDetails,{params:{id:e.id}})}),sort:"name",card:"name",list:"name",defaultSortDirection:"asc",defaultSort:!0},{header:t("Status"),cell:e=>s&&s[e.id]?(0,z.jsx)(au,{status:"running"}):(0,z.jsx)(au,{status:e.summary_fields?.recent_notifications&&e.summary_fields.recent_notifications.length>0?e.summary_fields?.recent_notifications[0].status:void 0})},{header:t("Type"),cell:e=>(0,z.jsx)(Fe,{text:e.notification_type}),sort:"notification_type"},n]),[t,n,a,s])}function Iw(e){const{t}=(0,I.Bd)(),n=Tw(),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Delete notifiers",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} notifiers.",{count:a.length}),actionButtonText:t("Delete notifiers",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/notification_templates/${e.id.toString()}/`,t)})}}var Aw=n(79284);function Dw(e){const{onComplete:t,onNotifierCopied:n,onNotifierStartTest:a,type:i,runningNotifications:r}=e,{t:c}=(0,I.Bd)(),d=yr(),u=Iw(t||(()=>{})),m=function(e){const{t}=(0,I.Bd)(),n=td(),a=ue();return s=>{const o={variant:"success",title:t(`${s.name} copied.`),timeout:2e3};n(xl`/notification_templates/${s.id.toString()}/copy/`,{name:`${s.name} @ ${(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")}`}).then((()=>{a.addAlert(o)})).catch((e=>{a.replaceAlert(o,{variant:"danger",title:t("Failed to copy notifier"),children:e instanceof Error&&e.message})})).finally(e)}}(n||(()=>{})),p=ue();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:yc.oo,variant:g.Ak.primary,label:c("Edit notifier"),onClick:e=>d(fc.EditNotificationTemplate,{params:{id:e.id}}),isDisabled:e=>Ig(e,c),isDanger:!1,isPinned:!0},{type:s.Button,selection:o.Single,icon:Aw.XF,label:c("Test notifier"),isDisabled:e=>{const t=r?.[e.id];return void 0!==t?c("Disabled while test is running."):void 0},onClick:e=>{(async()=>{try{const t=await al(xl`/notification_templates/${e.id.toString()}/test/`,{});a?.(e.id.toString(),t.id.toString())}catch(e){p.addAlert({variant:"danger",title:c("Failed to test notifier"),children:e instanceof Error&&e.message})}})()},isDanger:!1,isPinned:!0},{type:s.Button,selection:o.Single,icon:yo.Td,label:c("Copy notifier"),onClick:e=>m(e),isDisabled:e=>Eg(e,c),isDanger:!1,isPinned:!1,isHidden:()=>"detail"===i},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:c("Delete notifier"),onClick:e=>u([e]),isDisabled:e=>Ag(e,c),isDanger:!0}]),[d,m,u,i,c,a,p,r])}function Ew(){const[e,t]=(0,l.useState)({}),n=ue(),{t:a}=(0,I.Bd)();return{runningNotifications:e,setRunningNotifications:t,onNotifierStartTest:(n,a)=>{const s={...e};s[n]=a,t(s)},checkNotifiers:s=>{if(!s)return;const o={...e};s.forEach((t=>{const s=e[t.id.toString()],i=t.summary_fields?.recent_notifications,r=i.find((e=>e.id.toString()===s));r&&"pending"!==r.status&&(n.addAlert({variant:"failed"===r.status?"danger":"success",title:a("{{name}} (id {{id}})",{name:t.name,id:s}),children:(0,z.jsx)("div",{children:r.error})}),delete o[t.id])})),t(o)}}}function Pw(){const{t:e}=(0,I.Bd)(),{runningNotifications:t,onNotifierStartTest:n,checkNotifiers:a}=Ew(),i=Pp({optionsPath:"notification_templates",preSortedKeys:["name","id","created-by","modified-by"],preFilledValueKeys:{name:{apiPath:"notification_templates"},id:{apiPath:"notification_templates"}},additionalFilters:[Np(),$p()]}),r=Tw({runningNotifications:t}),c=Uc({url:xl`/notification_templates/`,toolbarFilters:i,tableColumns:r}),d=sc(),u=yr(),m=function(e){const{t}=(0,I.Bd)(),n=yr(),a=Iw(e),i=dd(xl`/notification_templates/`).data,r=Boolean(i&&i.actions&&i.actions.POST);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create notifier"),onClick:()=>n(fc.AddNotificationTemplate),isDisabled:()=>r?void 0:t("You do not have permission to add notifiers. Please contact your organization administrator if there is an issue with your access.")},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete notifiers"),onClick:a,isDisabled:e=>Dg(e,t),isDanger:!0}]),[r,n,a,t])}(c.unselectItemsAndRefresh),p=Dw({onComplete:c.unselectItemsAndRefresh,onNotifierCopied:()=>{c.refresh()},onNotifierStartTest:n,type:"list",runningNotifications:t}),h=dd(xl`/notification_templates/`).data,b=Boolean(h&&h.actions&&h.actions.POST);return(0,l.useEffect)((()=>{c.pageItems&&a(c.pageItems)}),[c.pageItems]),(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Notifiers"),description:e("Configure custom notifications to be sent based on predefined events."),titleHelpTitle:e("Notifiers"),titleHelp:e("Configure custom notifications to be sent based on predefined events."),titleDocLink:pc(d,"notifiers"),headerActions:(0,z.jsx)(cd,{type:"notification_template"})}),(0,z.jsx)($s,{id:"awx-host-metrics-table",toolbarFilters:i,tableColumns:r,toolbarActions:m,rowActions:p,errorStateTitle:e("Error loading notifiers"),emptyStateTitle:e(b?"No notifiers found.":"You do not have permission to create notifiers."),emptyStateDescription:e(b?"Please create notifiers to populate this list.":"Please contact your organization administrator if there is an issue with your access."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:b?e("Create notifier"):void 0,emptyStateButtonClick:b?()=>u(fc.AddNotificationTemplate):void 0,...c})]})}function Rw(e){const t=e.notification_type;return"email"===t?(0,z.jsx)(Bw,{}):"slack"===t?(0,z.jsx)(Fw,{}):"twilio"===t?(0,z.jsx)(Nw,{}):"pagerduty"===t?(0,z.jsx)($w,{}):"grafana"===t?(0,z.jsx)(Mw,{}):"webhook"===t?(0,z.jsx)(Lw,{}):"mattermost"===t?(0,z.jsx)(Ow,{}):"rocketchat"===t?(0,z.jsx)(zw,{}):"irc"===t?(0,z.jsx)(Hw,{}):(0,z.jsx)(z.Fragment,{})}function Bw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.username",label:e("Username")}),(0,z.jsx)(li,{type:"password",name:"notification_configuration.password",label:e("Password")}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.host",label:e("Host"),isRequired:!0}),(0,z.jsx)(ii,{name:"notification_configuration.recipients",label:e("Recipient list"),isRequired:!0,labelHelp:qw("email","recipients",e)}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.sender",label:e("Sender email"),isRequired:!0,validate:t=>function(e,t){if(""===e)return;const n=e?.split("@");return n.length>=2&&n[0]&&n[1]?void 0:t("Invalid email address")}(t,e)}),(0,z.jsx)(li,{type:"number",name:"notification_configuration.port",label:e("Port"),isRequired:!0,validate:t=>Uw(t,1,65535,e)}),(0,z.jsx)(li,{type:"number",name:"notification_configuration.timeout",label:e("Timeout"),isRequired:!0,validate:t=>Uw(t,1,120,e),labelHelp:qw("email","timeout",e)}),(0,z.jsxs)(Vo,{label:e("Email options "),labelHelpTitle:e("Email options"),labelHelp:(0,z.jsxs)(I.x6,{children:["See Django"," ",(0,z.jsx)("a",{href:"https://docs.djangoproject.com/en/4.0/ref/settings/#std:setting-EMAIL_USE_TLS",children:"documentation"})," ","for more information."]}),children:[(0,z.jsx)(go,{name:"notification_configuration.use_tls",label:e("Use TLS")}),(0,z.jsx)(go,{name:"notification_configuration.use_ssl",label:e("Use SSL")})]})]})}function Fw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"password",name:"notification_configuration.token",label:e("Token"),isRequired:!0}),(0,z.jsx)(ii,{name:"notification_configuration.channels",label:e("Destination channels"),isRequired:!0,labelHelp:qw("slack","channels",e)}),(0,z.jsx)(li,{name:"notification_configuration.hex_color",label:e("Notification color"),labelHelp:qw("slack","hex_color",e)})]})}function Nw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.account_sid",label:e("Account SID"),isRequired:!0}),(0,z.jsx)(li,{type:"password",name:"notification_configuration.account_token",label:e("Account token"),isRequired:!0}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.from_number",label:e("Source phone number"),validate:t=>Ww(t,e),isRequired:!0,labelHelp:qw("twilio","from_number",e)}),(0,z.jsx)(ii,{name:"notification_configuration.to_numbers",label:e("Destination SMS numbers"),validate:t=>Ww(t,e),labelHelp:qw("twilio","to_numbers",e),isRequired:!0})]})}function $w(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.subdomain",label:e("Pagerduty subdomain"),isRequired:!0}),(0,z.jsx)(li,{type:"password",name:"notification_configuration.token",label:e("API token"),isRequired:!0}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.service_key",label:e("API service/integration key"),isRequired:!0}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.client_name",label:e("Client identifier"),isRequired:!0})]})}function Mw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.grafana_url",label:e("Grafana URL"),labelHelp:qw("grafana","grafana_url",e),isRequired:!0}),(0,z.jsx)(li,{type:"password",name:"notification_configuration.grafana_key",label:e("Grafana API key"),isRequired:!0}),(0,z.jsx)(li,{name:"notification_configuration.dashboardId",label:e("ID of the dashboard")}),(0,z.jsx)(li,{name:"notification_configuration.panelId",label:e("ID of the panel")}),(0,z.jsx)(ii,{name:"notification_configuration.annotation_tags",label:e("Tags for the annotation"),labelHelp:qw("grafana","annotation_tags",e)}),(0,z.jsx)(go,{name:"notification_configuration.grafana_no_verify_ssl",label:e("Disable SSL verification")})]})}function Lw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.username",label:e("Username")}),(0,z.jsx)(li,{type:"password",name:"notification_configuration.password",label:e("Basic auth password")}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.url",label:e("Target URL"),isRequired:!0,validate:t=>Jw(t,e)}),(0,z.jsx)(go,{name:"notification_configuration.disable_ssl_verification",label:e("Disable SSL verification ")}),(0,z.jsx)(Go,{name:"notification_configuration.headers",label:e("HTTP headers"),format:"object",labelHelp:qw("webhook","headers",e),labelHelpTitle:e("HTTP headers")}),(0,z.jsx)(vc,{name:"notification_configuration.http_method",label:e("HTTP method"),placeholder:e("Choose an HTTP method"),isRequired:!0,options:[{label:"POST",value:"POST"},{label:"PUT",value:"PUT"}]})]})}function Ow(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.mattermost_url",label:e("Target URL"),isRequired:!0,validate:t=>Jw(t,e)}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.mattermost_username",label:e("Username")}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.mattermost_channel",label:e("Channel")}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.mattermost_icon_url",label:e("Icon URL"),validate:t=>Jw(t,e)}),(0,z.jsx)(go,{name:"notification_configuration.mattermost_no_verify_ssl",label:e("Verify SSL")})]})}function zw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"text",name:"notification_configuration.rocketchat_url",label:e("Target URL"),isRequired:!0,validate:t=>Jw(t,e)}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.rocketchat_username",label:e("Username")}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.rocketchat_icon_url",label:e("Icon URL"),validate:t=>Jw(t,e)}),(0,z.jsx)(go,{name:"notification_configuration.rocketchat_no_verify_ssl",label:e("Disable SSL verification")})]})}function Hw(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{type:"password",name:"notification_configuration.password",label:e("IRC server password")}),(0,z.jsx)(li,{type:"number",name:"notification_configuration.port",label:e("IRC server port"),isRequired:!0}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.server",label:e("IRC server address"),isRequired:!0,validate:t=>Jw(t,e)}),(0,z.jsx)(li,{type:"text",name:"notification_configuration.nickname",label:e("IRC nick"),isRequired:!0}),(0,z.jsx)(ii,{name:"notification_configuration.targets",label:e("Destination channels or users"),isRequired:!0,labelHelp:qw("irc","targets",e)}),(0,z.jsx)(go,{name:"notification_configuration.use_ssl",label:e("Disable SSL verification ")})]})}function qw(e,t,n){return"email"===e&&"recipients"===t?n("Use one email address per line to create a recipient list for this type of notification."):"email"===e&&"timeout"===t?n("The amount of time (in seconds) before the email notification stops trying to reach the host and times out. Ranges from 1 to 120 seconds."):"slack"===e&&"channels"===t?(0,z.jsxs)(I.x6,{children:["One Slack channel per line. The pound symbol (#) is required for channels. To respond to or start a thread to a specific message add the parent message Id to the channel where the parent message Id is 16 digits. A dot (.) must be manually inserted after the 10th digit. ie:#destination-channel, 1231257890.006423. See Slack"," ",(0,z.jsx)("a",{href:"https://api.slack.com/messaging/retrieving#individual_messages",children:"documentation"})," ","for more information."]}):"slack"===e&&"hex_color"===t?n("Specify a notification color. Acceptable colors are hex color code (example: #3af or #789abc)."):"twilio"===e&&"from_number"===t?n('The number associated with the "Messaging Service" in Twilio with the format +18005550199.'):"twilio"===e&&"to_numbers"===t?n("Use one phone number per line to specify where to route SMS messages. Phone numbers should be formatted +11231231234."):"grafana"===e&&"grafana_url"===t?n("The base URL of the Grafana server - the /api/annotations endpoint will be added automatically to the base Grafana URL."):"grafana"===e&&"annotation_tags"===t?n("Use one annotation tag per line, without commas."):"webhook"===e&&"headers"===t?n("Specify HTTP Headers in JSON or YAML format. Refer to the Ansible Controller documentation for example syntax."):"irc"===e&&"targets"===t?n("Use one IRC channel or username per line. The pound symbol (#) for channels, and the at (@) symbol for users, are not required."):null}function Uw(e,t,n,a){const s=Number.parseInt(e,10);if(!(s>=t&&s<=n))return a("This field must be a number and have a value between {{min}} and {{max}}",{min:t,max:n})}function Ww(e,t){if(""===e)return;const n=e?.split("\n");let a;return n?.forEach((e=>{""!==e&&(/^\s*(?:\+?(\d{1,3}))?[. (]*(\d{7,12})$/.test(e)||(a=t("Please enter valid phone numbers.")))})),a}function Jw(e,t){if(e)return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www\.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w\-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[.!/\\\w]*))?)/.test(e)?void 0:t`Please enter a valid URL`}function Vw(e){const{t}=(0,I.Bd)(),n=(0,oo.xW)(),a=n.getValues("notification_type"),[s,o]=(0,l.useState)("");let i=!1;s&&a!==s&&(""!==s&&(i=!0),o(a||""));let r=!0,c=!1;"email"!==a&&"pagerduty"!==a||(c=!0),"webhook"===a&&(c=!0,r=!1);const{data:d,customize_messages:u}=e,m=function(e){let t={started:{},success:{},error:{},workflow_approval:{denied:{},running:{},approved:{},timed_out:{}}};return"webhook"!==e&&(t={started:{message:"{{ job_friendly_name }} #{{ job.id }} '{{ job.name }}' {{ job.status }}: {{ url }}"},success:{message:"{{ job_friendly_name }} #{{ job.id }} '{{ job.name }}' {{ job.status }}: {{ url }}"},error:{message:"{{ job_friendly_name }} #{{ job.id }} '{{ job.name }}' {{ job.status }}: {{ url }}"},workflow_approval:{denied:{message:'The approval node "{{ approval_node_name }}" was denied. {{ workflow_url }}'},running:{message:'The approval node "{{ approval_node_name }}" needs review. This node can be viewed at: {{ workflow_url }}'},approved:{message:'The approval node "{{ approval_node_name }}" was approved. {{ workflow_url }}'},timed_out:{message:'The approval node "{{ approval_node_name }}" has timed out. {{ workflow_url }}'}}}),"email"===e&&(t.error.body=t.started.body=t.success.body="{{ job_friendly_name }} #{{ job.id }} had status {{ job.status }}, view details at {{ url }}\n      \n  {{ job_metadata }}"),"pagerduty"!==e&&"webhook"!==e||(t.error.body=t.started.body=t.success.body="{{ job_metadata }}"),"email"!==e&&"pagerduty"!==e||(t.workflow_approval.approved.body='The approval node "{{ approval_node_name }}" was approved. {{ workflow_url }}\n  \n  {{ job_metadata }}',t.workflow_approval.denied.body='The approval node "{{ approval_node_name }}" was denied. {{ workflow_url }}\n    \n  {{ job_metadata }}',t.workflow_approval.running.body='The approval node "{{ approval_node_name }}" needs review. This approval node can be viewed at: {{ workflow_url }}\n    \n  {{ job_metadata }}',t.workflow_approval.timed_out.body='The approval node "{{ approval_node_name }}" has timed out. {{ workflow_url }}\n    \n  {{ job_metadata }}'),"webhook"===e&&(t.workflow_approval.approved.body='{"body": "The approval node "{{ approval_node_name }}" was approved. {{ workflow_url }}"}',t.workflow_approval.denied.body='{"body": "The approval node "{{ approval_node_name }}" was denied. {{ workflow_url }}"}',t.workflow_approval.running.body='{"body": "The approval node "{{ approval_node_name }}" needs review. This node can be viewed at: {{ workflow_url }}"}',t.workflow_approval.timed_out.body='{"body": "The approval node "{{ approval_node_name }}" has timed out. {{ workflow_url }}"}'),t}(a),p=n.setValue,h=n.getValues;return i&&!0===u&&p("messages",m),!0===u&&!1===i&&(r&&(d?.messages?.error?.message?h("messages.error.message")||p("messages.error.message",d.messages.error.message):p("messages.error.message",m.error.message)),c&&(d?.messages?.error?.body?h("messages.error.body")||p("messages.error.body",d.messages.error.body):p("messages.error.body",m.error.body)),r&&(d?.messages?.started?.message?h("messages.started.message")||p("messages.started.message",d.messages.started.message):p("messages.started.message",m.started.message)),c&&(d?.messages?.started?.body?h("messages.started.body")||p("messages.started.body",d.messages.started.body):p("messages.started.body",m.started.body)),r&&(d?.messages?.success?.message?h("messages.success.message")||p("messages.success.message",d.messages.success.message):p("messages.success.message",m.success.message)),c&&(d?.messages?.success?.body?h("messages.success.body")||p("messages.success.body",d.messages.success.body):p("messages.success.body",m.success.body)),r&&(d?.messages?.workflow_approval?.approved?.message?h("messages.workflow_approval.approved.message")||p("messages.workflow_approval.approved.message",d.messages.workflow_approval.approved.message):p("messages.workflow_approval.approved.message",m.workflow_approval.approved.message)),c&&(d?.messages?.workflow_approval?.approved?.body?h("messages.workflow_approval.approved.body")||p("messages.workflow_approval.approved.body",d.messages.workflow_approval.approved.body):p("messages.workflow_approval.approved.body",m.workflow_approval.approved.body)),r&&(d?.messages?.workflow_approval?.denied?.message?h("messages.workflow_approval.denied.message")||p("messages.workflow_approval.denied.message",d.messages.workflow_approval.denied.message):p("messages.workflow_approval.denied.message",m.workflow_approval.denied.message)),c&&(d?.messages?.workflow_approval?.denied?.body?h("messages.workflow_approval.denied.body")||p("messages.workflow_approval.denied.body",d.messages.workflow_approval.denied.body):p("messages.workflow_approval.denied.body",m.workflow_approval.denied.body)),r&&(d?.messages?.workflow_approval?.running?.message?h("messages.workflow_approval.running.message")||p("messages.workflow_approval.running.message",d.messages.workflow_approval.running.message):p("messages.workflow_approval.running.message",m.workflow_approval.running.message)),c&&(d?.messages?.workflow_approval?.running?.body?h("messages.workflow_approval.running.body")||p("messages.workflow_approval.running.body",d.messages.workflow_approval.running.body):p("messages.workflow_approval.running.body",m.workflow_approval.running.body)),r&&(d?.messages?.workflow_approval?.timed_out?.message?h("messages.workflow_approval.timed_out.message")||p("messages.workflow_approval.timed_out.message",d.messages.workflow_approval.timed_out.message):p("messages.workflow_approval.timed_out.message",m.workflow_approval.timed_out.message)),c&&(d?.messages?.workflow_approval?.timed_out?.body?h("messages.workflow_approval.timed_out.body")||p("messages.workflow_approval.timed_out.body",d.messages.workflow_approval.timed_out.body):p("messages.workflow_approval.timed_out.body",m.workflow_approval.timed_out.body))),!0!==u?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)(z.Fragment,{children:[r&&(0,z.jsx)(li,{name:"messages.started.message",label:t("Start message")}),c&&(0,z.jsx)(ii,{name:"messages.started.body",label:t("Start message body")}),r&&(0,z.jsx)(li,{name:"messages.success.message",label:t("success message")}),c&&(0,z.jsx)(ii,{name:"messages.success.body",label:t("success message body")}),r&&(0,z.jsx)(li,{name:"messages.error.message",label:t("Error message")}),c&&(0,z.jsx)(ii,{name:"messages.error.body",label:t("Error message body")}),r&&(0,z.jsx)(li,{name:"messages.workflow_approval.approved.message",label:t("Workflow approved message")}),c&&(0,z.jsx)(ii,{name:"messages.workflow_approval.approved.body",label:t("Workflow approved body")}),r&&(0,z.jsx)(li,{name:"messages.workflow_approval.denied.message",label:t("Workflow denied message")}),c&&(0,z.jsx)(ii,{name:"messages.workflow_approval.denied.body",label:t("Workflow denied message body")}),r&&(0,z.jsx)(li,{name:"messages.workflow_approval.running.message",label:t("Workflow pending message")}),c&&(0,z.jsx)(ii,{name:"messages.workflow_approval.running.body",label:t("Workflow pending message body")}),r&&(0,z.jsx)(li,{name:"messages.workflow_approval.timed_out.message",label:t("Workflow timed out message")}),c&&(0,z.jsx)(ii,{name:"messages.workflow_approval.timed_out.body",label:t("Workflow timed out message body")})]})}function Gw(){return(0,z.jsx)(Kw,{mode:"edit"})}function Yw(){return(0,z.jsx)(Kw,{mode:"add"})}function Kw(e){const{t}=(0,I.Bd)(),n=gr(),{mode:a}=e,s=(0,Re.g)(),o=ec("add"===a?"":xl`/notification_templates/${s.id||""}/`),i=(0,Re.Zp)(),r=yr(),[c,d]=(0,l.useState)(""),u=ed(),m=td(),p=dd(xl`/notification_templates/`);if(o.error)return(0,z.jsx)(Ic,{error:o.error});if(p.error)return(0,z.jsx)(Ic,{error:p.error});if(!o.data&&"edit"===a)return(0,z.jsx)(zr,{});if(!p.data)return(0,z.jsx)(zr,{});const h="add"===a?{}:o.data;h&&"edit"===a&&function(e){if(e.notification_configuration)for(const t in e.notification_configuration){if(!Zw(t,e.notification_type||""))continue;const n=e?.notification_configuration[t];n&&n.join&&(e.notification_configuration[t]=n.join("\n"))}}(h);const b=(f=h,!(f?.messages?.error?.message||f?.messages?.error?.body||f?.messages?.started?.message||f?.messages?.started?.body||f?.messages?.success?.message||f?.messages?.success?.body||f?.messages?.workflow_approval?.approved?.message||f?.messages?.workflow_approval?.approved?.body||f?.messages?.workflow_approval?.denied?.message||f?.messages?.workflow_approval?.denied?.body||f?.messages?.workflow_approval?.running?.message||f?.messages?.workflow_approval?.running?.body||f?.messages?.workflow_approval?.timed_out?.message||f?.messages?.workflow_approval?.timed_out?.body));var f;h&&b&&(h.customize_messages=!1);const g=[{label:t("Notifiers"),to:n(fc.NotificationTemplates)},{label:t("add"===a?"Create notifier":o?.data?.name?`Edit ${o.data.name}`:"Edit notifier")}];return h&&!b&&(h.customize_messages=!0),(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("add"===a?"Create notifier":o?.data?.name?`Edit ${o.data.name}`:"Edit notifier"),breadcrumbs:g}),(0,z.jsxs)(nd,{submitText:t("Save notifier"),onSubmit:async e=>{try{const t="add"===a?e:{description:e.description,messages:e.messages,name:e.name,notification_configuration:e.notification_configuration,notification_type:e.notification_type,organization:e.organization,customize_messages:e.customize_messages};let n;!function(e){if(e.notification_configuration)for(const t in e.notification_configuration){if(!Zw(t,e.notification_type||""))continue;const n=e?.notification_configuration[t];n&&n.split&&(e.notification_configuration[t]=n.split("\n"))}}(t),!1===t.customize_messages&&(t.messages=null),delete t.customize_messages;const s=p.data?.actions.GET.notification_configuration[t.notification_type||""];if(s){const e=t.notification_configuration;for(const t in s){if(e[t]||(n=s[t],e[t]=""),n=s[t],"int"===n.type){const n=e[t];"string"==typeof n&&(e[t]=Number.parseInt(n,10))}"bool"===n.type&&""===e[t]&&(e[t]=!1)}}"webhook"===t.notification_type&&(t.notification_configuration.headers||(t.notification_configuration.headers={}));let o={};"add"===a?o=await m(xl`/notification_templates/`,t):await u(xl`/notification_templates/${e.id?.toString()||""}/`,t);const i="add"===a?o?.id:e.id;r(fc.NotificationTemplateDetails,{params:{id:i}})}catch(e){const t=e;if(t?.body?.messages){const e=JSON.stringify(t.body.messages,null,4);d(e)}throw t}},cancelText:t("Cancel"),onCancel:()=>i(-1),defaultValue:h,children:[(0,z.jsxs)(_d,{children:[(0,z.jsx)(li,{name:"name",label:t("Name"),placeholder:t("Enter a name"),isRequired:!0,maxLength:150}),(0,z.jsx)(li,{name:"description",label:t("Description"),placeholder:t("Enter a description")}),(0,z.jsx)(sg,{name:"organization",isRequired:!0}),(0,z.jsx)(vc,{name:"notification_type",id:"notification_type",label:t("Type"),placeholder:t("Choose a notification type"),isRequired:!0,options:[{value:"email",label:t("Email")},{value:"grafana",label:t("Grafana")},{value:"irc",label:t("IRC")},{value:"mattermost",label:t("Mattermost")},{value:"pagerduty",label:t("Pagerduty")},{value:"rocketchat",label:t("Rocket.Chat")},{value:"slack",label:t("Slack")},{value:"twilio",label:t("Twilio")},{value:"webhook",label:t("Webhook")}]})]}),(0,z.jsx)(_d,{children:(0,z.jsx)(fh,{watch:"notification_type",children:e=>(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Vo,{label:t("Type Details"),children:(0,z.jsx)(Rw,{notification_type:e})})})})}),(0,z.jsx)(_d,{children:(0,z.jsx)(ni,{labelHelp:(0,z.jsxs)(I.x6,{children:["Use custom messages to change the content of notifications sent when a job starts, succeeds, or fails. Use curly braces to access information about the job: ",(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),{job_friendly_name:"{{job_friendly_name}}"},", ",{url:"{{url}}"},", ",{status:"{{status}}"},".",(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),"You may apply a number of possible variables in the message. For more information, refer to the"," ",(0,z.jsx)("a",{href:"https://docs.ansible.com/automation-controller/latest/html/userguide/notifications.html#create-custom-notifications",children:"Ansible Controller Documentation."})]}),name:"customize_messages",label:t("Customize messages")})}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(fh,{watch:"customize_messages",children:e=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{color:E("red")},children:c}),(0,z.jsx)(Vw,{customize_messages:e,data:o.data})]})})})]})]})}function Zw(e,t){return"recipients"===e&&"email"===t||"channels"===e&&"slack"===t||"to_numbers"===e&&"twilio"===t||"annotation_tags"===e&&"grafana"===t||"targets"===e&&"irc"===t}function Xw(){const{t:e}=(0,I.Bd)(),{notificationTemplate:t,runningTest:n}=(0,Re.KC)(),s=gr(),o=yr(),i=t.summary_fields.recent_notifications.length>0?t.summary_fields.recent_notifications[0].status:"";return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(ze,{children:[(0,z.jsxs)(Mt,{disableScroll:!0,children:[(0,z.jsx)(Ft,{label:e("Name"),children:t.name}),(0,z.jsx)(Ft,{label:e("Description"),children:t.description}),i&&(0,z.jsxs)(Ft,{label:e("Status"),children:[!1===n&&(0,z.jsx)(su,{status:i}),!0===n&&(0,z.jsx)(su,{status:"running"})]}),(0,z.jsx)(Ft,{label:e("Created"),children:(0,z.jsx)(Ie,{value:t.created,author:t.summary_fields?.created_by?.username,onClick:()=>o(fc.UserDetails,{params:{id:t.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Ft,{label:e("Last modified"),children:(0,z.jsx)(Ie,{value:t.modified,author:t.summary_fields?.modified_by?.username,onClick:()=>o(fc.UserDetails,{params:{id:t.summary_fields?.modified_by?.id}})})}),(0,z.jsx)(Ft,{label:e("Organization"),children:(0,z.jsx)(a.N_,{to:s(fc.OrganizationDetails,{params:{id:t.summary_fields.organization.id}}),children:t.summary_fields.organization.name})}),(0,z.jsx)(Ft,{label:e("Notification type"),children:t.notification_type}),(0,z.jsx)(ek,{notificationTemplate:t})]}),t.messages&&(0,z.jsx)(Qw,{notificationTemplate:t})]})})}function Qw(e){const t=e.notificationTemplate.messages;return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Mt,{numberOfColumns:"single",disableScroll:!0,children:[t?.started?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Start message"),children:t?.started?.message}),t?.started?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Start message body"),children:t?.started?.body}),t?.success?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Success message"),children:t?.success?.message}),t?.success?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Success message body"),children:t?.success?.body}),t?.error?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Error message"),children:t?.error?.message}),t?.error?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Error message body"),children:t?.error?.body}),t?.workflow_approval?.approved?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow approved message"),children:t?.workflow_approval?.approved?.message}),t?.workflow_approval?.approved?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow approved message body"),children:t?.workflow_approval?.approved?.body}),t?.workflow_approval?.denied?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow denied message"),children:t?.workflow_approval?.denied?.message}),t?.workflow_approval?.denied?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow denied message body"),children:t?.workflow_approval?.denied?.body}),t?.workflow_approval?.running?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow pending message"),children:t?.workflow_approval?.running?.message}),t?.workflow_approval?.running?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow pending message body"),children:t?.workflow_approval?.running?.body}),t?.workflow_approval?.timed_out?.message&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow timed out message"),children:t?.workflow_approval?.timed_out?.message}),t?.workflow_approval?.timed_out?.body&&(0,z.jsx)(Ft,{label:(0,po.t)("Workflow timed out message body"),children:t?.workflow_approval?.timed_out?.body})]})})}function ek(e){const{notificationTemplate:t}=e;return(0,z.jsx)(z.Fragment,{children:Object.keys(t.notification_configuration||{}).map((e=>{try{let n=t.notification_configuration[e],a=!1,s=!1;if(Array.isArray(n)?(s=!0,n=n.join("\n")):"object"==typeof n&&(n=JSON.stringify(n,void 0,2),a=!0),void 0===n&&(n=""),"$encrypted$"===n)return(0,z.jsx)(z.Fragment,{});let o=function(e,t){if("email"===e){if("username"===t)return(0,po.t)("Username");if("password"===t)return(0,po.t)("Password");if("host"===t)return(0,po.t)("Host");if("recipients"===t)return(0,po.t)("Recipient list");if("sender"===t)return(0,po.t)("Sender email");if("port"===t)return(0,po.t)("Port");if("timeout"===t)return(0,po.t)("Timeout");if("use_tls"===t)return(0,po.t)("Use TLS");if("use_ssl"===t)return(0,po.t)("Use SSL")}if("slack"===e){if("token"===t)return(0,po.t)("Token");if("channels"===t)return(0,po.t)("Destination Channels");if("hex_color"===t)return(0,po.t)("Notification color")}if("twilio"===e){if("account_sid"===t)return(0,po.t)("Account SID");if("account_token"===t)return(0,po.t)("Account Token");if("from_number"===t)return(0,po.t)("Source Phone Number");if("to_numbers"===t)return(0,po.t)("Destination SMS Numbers")}if("pagerduty"===e){if("subdomain"===t)return(0,po.t)("Pagerduty subdomain");if("service_key"===t)return(0,po.t)("API Service/Integration Key");if("client_name"===t)return(0,po.t)("Client Identifier")}if("grafana"===e){if("grafana_url"===t)return(0,po.t)("Grafana URL");if("grafana_key"===t)return(0,po.t)("Grafana API Key");if("dashboardId"===t)return(0,po.t)("ID of the dashboard");if("panelId"===t)return(0,po.t)("ID of the panel");if("annotation_tags"===t)return(0,po.t)("Tags for the annotation");if("grafana_no_verify_ssl"===t)return(0,po.t)("Disable SSL verification")}if("webhook"===e){if("username"===t)return(0,po.t)("Username");if("password"===t)return(0,po.t)("Basic auth password");if("url"===t)return(0,po.t)("Target URL");if("disable_ssl_verification"===t)return(0,po.t)("Disable SSL verification ");if("http_method"===t)return(0,po.t)("HTTP Method");if("headers"===t)return(0,po.t)("Headers")}if("mattermost"===e){if("mattermost_url"===t)return(0,po.t)("Target URL");if("mattermost_username"===t)return(0,po.t)("Username");if("mattermost_channel"===t)return(0,po.t)("Channel");if("mattermost_icon_url"===t)return(0,po.t)("Icon URL");if("mattermost_no_verify_ssl"===t)return(0,po.t)("Verify SSL")}if("rocketchat"===e){if("rocketchat_url"===t)return(0,po.t)("Target URL");if("rocketchat_username"===t)return(0,po.t)("Username");if("rocketchat_icon_url"===t)return(0,po.t)("Icon URL");if("rocketchat_no_verify_ssl"===t)return(0,po.t)("Disable SSL verification")}if("irc"===e){if("server"===t)return(0,po.t)("IRC Server Address");if("nickname"===t)return(0,po.t)("IRC Nick");if("targets"===t)return(0,po.t)("Destination Channels or Users");if("password"===t)return(0,po.t)("IRC Server Password");if("port"===t)return(0,po.t)("IRC Server Port");if("use_ssl"===t)return(0,po.t)("Disable SSL verification ")}return""}(t.notification_type,e);o||(o=e);const i=qw(t.notification_type||"",e,po.t);return s||a?(0,z.jsx)(Ft,{label:o,helpText:i,children:(0,z.jsx)(ai.fs,{value:n.toString(),contentEditable:!1,rows:3})},e):(0,z.jsx)(Ft,{label:o,helpText:i,children:n.toString()},e)}catch(t){return(0,z.jsx)(Ft,{label:e,children:(0,po.t)("Error displaying field")},e)}}))})}function tk(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),n=Tg("notification_template"),{runningNotifications:a,onNotifierStartTest:s,checkNotifiers:o}=Ew(),{error:i,data:r,refresh:c}=tc(xl`/notification_templates`,t.id,{refreshInterval:void 0===a[t.id||""]?5e3:2e3}),d=yr(),u=gr(),m=Dw({onComplete:()=>{d(fc.NotificationTemplates)},onNotifierStartTest:s,type:"detail",runningNotifications:a});if((0,l.useEffect)((()=>{r&&o([r])}),[r]),i)return(0,z.jsx)(Ic,{error:i,handleRefresh:c});if(!r)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const p=a[r.id.toString()];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:r?.name,breadcrumbs:[{label:e("Notifiers"),to:u(fc.NotificationTemplates)},{label:r?.name}],headerActions:(0,z.jsx)(oe,{actions:[...n,...m],position:te.nU.right,selectedItem:r})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Notifiers"),page:fc.NotificationTemplates,persistentFilterKey:"credential-types"},tabs:[{label:e("Details"),page:fc.NotificationTemplateDetails},{label:e("Team Access"),page:fc.NotificationTemplateTeamAccess},{label:e("User Access"),page:fc.NotificationTemplateUserAccess}],params:t,componentParams:{notificationTemplate:r,runningTest:void 0!==p}})]})}function nk(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"notificationtemplate",addRolesRoute:fc.NotificationAddTeams})}function ak(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"notificationtemplate",addRolesRoute:fc.NotificationAddUsers})}function sk(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/notification_templates/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{credentialName}}.",{credentialName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"notificationtemplate",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{credentialName}}.",{credentialName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Notifiers"),to:t(fc.NotificationTemplates)},{label:a?.name,to:t(fc.NotificationTemplateDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.NotificationTemplateUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"awx.notificationtemplate",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.NotificationTemplateUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.NotificationTemplateUserAccess,{params:{id:a?.id}})}})]})}function ok(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/notification_templates/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{credentialName}}.",{credentialName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"notificationtemplate",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{credentialName}}.",{credentialName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Notifiers"),to:t(fc.NotificationTemplates)},{label:s?.name,to:t(fc.NotificationTemplateDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.NotificationTemplateTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"awx.notificationtemplate",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.NotificationTemplateTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.NotificationTemplateTeamAccess,{params:{id:s?.id}})}})]})}function ik(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr();Zc();const a=td(),s=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create organization"),breadcrumbs:[{label:e("Organizations"),to:s(fc.Organizations)},{label:e("Create organization")}]}),(0,z.jsx)(nd,{submitText:e("Create organization"),onSubmit:async e=>{const{instanceGroups:t,...s}=e,o=await a(xl`/organizations/`,s),i=[];for(const t of e.instanceGroups||[])i.push(a(xl`/organizations/${o.id.toString()}/instance_groups/`,{id:t.id}));await Promise.all(i),n(fc.OrganizationDetails,{params:{id:o.id}})},onCancel:()=>t(-1),children:(0,z.jsx)(lk,{})})]})}function rk(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=(0,Re.g)(),s=Number(a.id),o=td(),{data:i}=(0,_e.Ay)(xl`/organizations/${s.toString()}/`,nl,cl),{data:r}=(0,_e.Ay)(xl`/organizations/${s.toString()}/instance_groups/`,nl,cl),l=r?.results;Zc();const c=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:i?.name?e("Edit {{organizationName}}",{organizationName:i?.name}):e("Organization"),breadcrumbs:[{label:e("Organizations"),to:c(fc.Organizations)},{label:i?.name?e("Edit {{organizationName}}",{organizationName:i?.name}):e("Organization")}]}),i?(0,z.jsx)(nd,{submitText:e("Save organization"),onSubmit:async e=>{const{instanceGroups:t,...a}=e,{added:i,removed:r}=dm(l||[],t||[]),c=await sl(xl`/organizations/${s.toString()}/`,a),d=[];for(const e of r||[])d.push(o(xl`/organizations/${c.id.toString()}/instance_groups/`,{id:e.id,disassociate:!0}));await Promise.all(d);const u=[];for(const e of i||[])u.push(o(xl`/organizations/${c.id.toString()}/instance_groups/`,{id:e.id}));await Promise.all(u),n(fc.OrganizationDetails,{params:{id:c.id}})},onCancel:()=>t(-1),defaultValue:{...i,instanceGroups:l??[]},children:(0,z.jsx)(lk,{orgId:i.id})}):null]})}function lk(e){const{t}=(0,I.Bd)(),{orgId:n}=e;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{label:t("Name"),name:"name",placeholder:t("Enter name"),isRequired:!0}),(0,z.jsx)(li,{label:t("Description"),name:"description",placeholder:t("Enter description")}),(0,z.jsx)(Xp,{name:"instanceGroups",labelHelp:t("Select the instance groups for this organization to run on.")}),(0,z.jsx)(Wp,{name:"default_environment",label:t("Execution environment"),organizationId:n})]})}function ck(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"organization",addRolesRoute:fc.OrganizationAddUsers})}function dk(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{data:n}=tc(xl`/organizations/`,t.id),s=gr(),o=ag(),i=function(e){const{data:t}=ec(xl`/organizations/${e}/galaxy_credentials/`);return t?.results??[]}(t.id||"0"),r=function(e){const{data:t}=ec(xl`/organizations/${e}/instance_groups/`);return t?.results??[]}(t.id||"0"),c=(0,l.useMemo)((()=>o.filter((e=>"execution-environment"!==e.id))),[o]);return n?(0,z.jsx)(Mt,{children:(0,z.jsxs)(Kt,{columns:c,item:n,children:[(0,z.jsx)(zj,{verifyMissingVirtualEnv:!0,virtualEnvironment:n.custom_virtualenv||void 0,executionEnvironment:n.summary_fields?.default_environment,isDefaultEnvironment:!0,helpText:e`The execution environment that will be used for jobs
          inside of this organization. This will be used a fallback when
          an execution environment has not been explicitly assigned at the
          project, job template or workflow level.`}),(0,z.jsx)(Ft,{label:e`Instance groups`,helpText:e`The instance groups for this organization to run on.`,isEmpty:0===r.length,children:(0,z.jsx)(De.o,{children:r.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:s(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))})}),(0,z.jsx)(Ft,{label:e("Galaxy credentials"),isEmpty:0===i.length,children:(0,z.jsx)(De.o,{children:i?.map((e=>(0,z.jsx)(uu,{credential:e},e.id)))})})]})}):(0,z.jsx)(zr,{})}function uk(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{data:n,error:a,refresh:i}=tc(xl`/organizations/`,t.id),r=yr(),c=eg((e=>{e.length>0&&r(fc.Organizations)})),d=Tg("organization"),u=(0,l.useMemo)((()=>{const t=[...d,{type:s.Button,selection:o.Single,variant:g.Ak.primary,isPinned:!0,icon:yc.oo,label:e("Edit organization"),onClick:e=>r(fc.EditOrganization,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:e("Delete organization"),onClick:e=>{e&&c([e])},isDanger:!0}];return t}),[c,r,e,d]),m=gr();return a?(0,z.jsx)(Ic,{error:a,handleRefresh:i}):n?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:n?.name,breadcrumbs:[{label:e("Organizations"),to:m(fc.Organizations)},{label:n?.name}],headerActions:(0,z.jsx)(oe,{actions:u,position:te.nU.right,selectedItem:n})}),n&&(0,z.jsx)(mk,{organization:n})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function mk(e){const{organization:t}=e,{t:n}=(0,I.Bd)();return(0,z.jsx)(Nc,{backTab:{label:n("Back to Organizations"),page:fc.Organizations,persistentFilterKey:"organizations"},tabs:[{label:n("Details"),page:fc.OrganizationDetails},{label:n("Users Access"),page:fc.OrganizationUsersAccess},{label:n("Teams Access"),page:fc.OrganizationTeamsAccess},{label:n("Execution Environments"),page:fc.OrganizationExecutionEnvironments},{label:n("Notifications"),page:fc.OrganizationNotifications}],params:{id:t.id}})}function pk(){const e=(0,Re.g)(),{t}=(0,I.Bd)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"organization",addRoleButtonText:t("Add team"),removeRoleText:t("Remove team"),removeConfirmationText:e=>t("Yes, I confirm that I want to remove these {{count}} teams.",{count:e}),addRolesRoute:fc.OrganizationAddTeams})}function hk(){const{id:e=""}=(0,Re.g)();return(0,z.jsx)(Ey,{url:xl`/organizations/${e}/execution_environments/`,hideOrgColumn:!0})}function bk(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=tc(xl`/organizations/`,n.id),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{organizationName}}.",{organizationName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"organization",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{organizationName}}.",{organizationName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Organization"),to:t(fc.Organizations)},{label:a?.name,to:t(fc.OrganizationDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.OrganizationUsersAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"awx.organization",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.OrganizationUsersAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.OrganizationUsersAccess,{params:{id:a?.id}})}})]})}function fk(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/organizations/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{organizationName}}.",{organizationName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"organization",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{organizationName}}.",{organizationName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Organizations"),to:t(fc.Organizations)},{label:s?.name,to:t(fc.OrganizationDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.OrganizationTeamsAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"awx.organization",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.OrganizationTeamsAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.OrganizationTeamsAccess,{params:{id:s?.id}})}})]})}function gk(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),s=e?.projectId?e.projectId:n.id,{error:o,data:i,refresh:r}=tc(xl`/projects`,s),c=yr(),d=sc(),u=gr();dc({control:["limit_reached_1"],jobs:["status_changed"]},(0,l.useCallback)((e=>{if("jobs"===e?.group_name)switch(e?.type){case"job":case"workflow_job":case"project_update":r()}}),[r]));const m=t`Enable content signing to verify that the content has remained secure when a project is synced. If the content has been tampered with, the job will not run.`,p=t`Select from the list of directories found in the project base path. Together the base path and the playbook directory provide the full path used to locate playbooks.`,h=t`Time in seconds to consider a project
  to be current. During job runs and callbacks the task
  system will evaluate the timestamp of the latest project
  update. If it is older than cache timeout, it is not
  considered current, and a new project update will be
  performed.`,b=t`The execution environment that will be used for jobs
  inside of this organization. This will be used a fallback when
  an execution environment has not been explicitly assigned at the
  project, job template or workflow level.`,f=(0,z.jsxs)("span",{children:[t`A refspec to fetch (passed to the Ansible git
            module). This parameter allows access to references via
            the branch field not otherwise available.`,(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),t`Note: This field assumes the remote name is "origin".`,(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),t`Examples include:`,(0,z.jsx)("ul",{style:{margin:"10px 0 10px 20px"},children:(0,z.jsxs)(I.x6,{children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"refs/*:refs/remotes/origin/*"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"refs/pull/62/head:refs/remotes/origin/pull/62/head"})})]})}),t`The first fetches all references. The second
            fetches the Github pull request number 62, in this example
            the branch needs to be "pull/62/head".`,(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),t`For more information, refer to the`," ",(0,z.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:pc(d,"managePlaybooksSC"),children:t`Documentation.`})]}),g=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{children:t("Base path used for locating playbooks. Directories found inside this path will be listed in the playbook directory drop-down. Together the base path and selected playbook directory provide the full path used to locate playbooks.")}),(0,z.jsx)("br",{}),(0,z.jsx)("p",{children:(0,z.jsxs)(I.x6,{children:["Change PROJECTS_ROOT when deploying ",{product:"AWX"}," ",{brand:"AWX"}," to change this location."]})})]}),y=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{children:t("Example URLs for GIT Source Control include:")}),(0,z.jsx)(I.x6,{children:(0,z.jsx)("code",{children:"https://github.com/ansible/ansible.git git@github.com:ansible/ansible.git git://servername.example.com/ansible.git"})}),(0,z.jsx)("p",{children:t("Note: When using SSH protocol for GitHub or Bitbucket, enter an SSH key only, do not enter a username (other than git). Additionally, GitHub and Bitbucket do not support password authentication when using SSH. GIT read only protocol (git://) does not use username or password information.")})]});return o?(0,z.jsx)(Ic,{error:o,handleRefresh:r}):i?(0,z.jsxs)(Mt,{disableScroll:e.disableScroll,children:[(0,z.jsx)(Ft,{label:t("Name"),children:e.projectId?(0,z.jsx)(a.N_,{to:u(fc.ProjectDetails,{params:{id:e.projectId}}),children:i.name}):i.name}),(0,z.jsx)(Ft,{label:t("Description"),children:i.description}),i.summary_fields?.organization?.name&&(0,z.jsx)(Ft,{label:t("Organization"),children:(0,z.jsx)(Fe,{text:i.summary_fields?.organization?.name,to:u(fc.OrganizationDetails,{params:{id:i.summary_fields?.organization?.id}})})}),(0,z.jsx)(Ft,{label:t("Last job status"),children:i.summary_fields?.current_job||i.summary_fields?.last_job?(0,z.jsx)(au,{status:i.status,to:u(fc.JobOutput,{params:{job_type:i.type,id:i.summary_fields?.current_job?.id??i.summary_fields?.last_job?.id}})}):(0,z.jsx)(au,{status:i.status})}),(0,z.jsx)(Ft,{label:t("Source control type"),children:(0,z.jsx)(bp,{scmType:i.scm_type})}),i.scm_revision&&(0,z.jsx)(Ft,{label:t("Source control revision"),children:(0,z.jsx)(ye,{text:i.scm_revision})}),(0,z.jsx)(Ft,{label:t("Source control URL"),helpText:y,children:i.scm_url}),(0,z.jsx)(Ft,{label:t("Source control branch"),children:i.scm_branch}),(0,z.jsx)(Ft,{label:t("Source control refspec"),helpText:f,children:i.scm_refspec}),i.summary_fields.signature_validation_credential&&(0,z.jsx)(Ft,{label:t("Content signature validation credential"),helpText:m,children:(0,z.jsx)(De.o,{children:(0,z.jsx)(uu,{credential:i.summary_fields.signature_validation_credential},i.summary_fields.signature_validation_credential.id)})}),i.summary_fields.credential&&(0,z.jsx)(Ft,{label:t("Source control credential"),children:(0,z.jsx)(De.o,{children:(0,z.jsx)(uu,{credential:i.summary_fields.credential},i.summary_fields.credential.id)})}),(0,z.jsx)(Ft,{label:t("Cache timeout"),helpText:h,children:`${i.scm_update_cache_timeout} seconds`}),i.summary_fields.default_environment&&(0,z.jsx)(zj,{virtualEnvironment:i.custom_virtualenv||void 0,executionEnvironment:i.summary_fields.default_environment,isDefaultEnvironment:!0,helpText:b}),(0,z.jsx)(Ft,{label:t("Project base path"),helpText:g,children:d?.project_base_dir}),(0,z.jsx)(Ft,{label:t("Playbook directory"),helpText:p,children:i.local_path}),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:i.created,author:i.summary_fields?.created_by?.username,onClick:()=>c(fc.UserDetails,{params:{id:i.summary_fields?.created_by?.id}})})}),(0,z.jsx)(Xd,{value:i.modified,author:i.summary_fields?.modified_by?.username,onClick:()=>c(fc.UserDetails,{params:{id:i.summary_fields?.modified_by?.id}})}),(i.scm_clean||i.scm_delete_on_update||i.scm_track_submodules||i.scm_update_on_launch||i.allow_override)&&(0,z.jsx)(Ft,{label:t("Enabled options"),children:(x=i,(0,z.jsxs)(Yl.K,{component:Yl.C.ul,children:[x.scm_clean&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Discard local changes before syncing`,(0,z.jsx)(Bt,{header:"",content:t`Remove any local modifications prior to performing an update.`})]}),x.scm_delete_on_update&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Delete the project before syncing`,(0,z.jsx)(Bt,{header:"",content:t`Delete the local repository in its entirety prior to
                  performing an update. Depending on the size of the
                  repository this may significantly increase the amount
                  of time required to complete an update.`})]}),x.scm_track_submodules&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Track submodules latest commit on branch`,(0,z.jsx)(Bt,{header:"",content:t`Submodules will track the latest commit on
                  their master branch (or other branch specified in
                  .gitmodules). If no, submodules will be kept at
                  the revision specified by the main project.
                  This is equivalent to specifying the --remote
                  flag to git submodule update.`})]}),x.scm_update_on_launch&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Update revision on job launch`,(0,z.jsx)(Bt,{header:"",content:t`Each time a job runs using this project, update the
                  revision of the project prior to starting the job.`})]}),x.allow_override&&(0,z.jsxs)(Kl.L,{component:Kl.D.li,children:[t`Allow branch override`,(0,z.jsx)(Bt,{header:"",content:t`Allow changing the Source Control branch or revision in a job
                    template that uses this project.`})]})]}))})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});var x}function yk(e){const{t}=(0,I.Bd)();return(0,z.jsxs)(_d,{title:t("Options"),children:[(0,z.jsx)(go,{id:"option-scm-clean",label:t("Clean"),labelHelpTitle:t("Clean"),labelHelp:t("Remove any local modifications prior to performing an update."),name:"scm_clean"}),(0,z.jsx)(go,{id:"option-scm-delete-on-update",label:t("Delete"),labelHelpTitle:t("Delete"),labelHelp:t("Delete the local repository in its entirety prior to performing an update. Depending on the size of the repository this may significantly increase the amount of time required to complete an update."),name:"scm_delete_on_update"}),(0,z.jsx)(Kc,{watch:"scm_type",hidden:e=>"git"!==e,children:(0,z.jsx)(go,{id:"option-scm-track-submodules",label:t("Track submodules"),labelHelpTitle:t("Track submodules"),labelHelp:t("Submodules will track the latest commit on their master branch (or other branch specified in .gitmodules). If no, submodules will be kept at the revision specified by the main project. This is equivalent to specifying the --remote flag to git submodule update."),name:"scm_track_submodules"})}),(0,z.jsx)(go,{id:"option-scm-update-on-launch",label:t("Update revision on launch"),labelHelp:t("Each time a job runs using this project, update the revision of the project prior to starting the job."),name:"scm_update_on_launch"}),!e.hideAllowOverride&&(0,z.jsx)(go,{id:"option-allow-override",label:t("Allow branch override"),labelHelp:t("Allow changing the source control branch or revision in a job template that uses this project."),name:"allow_override"}),(0,z.jsx)(Kc,{watch:"scm_update_on_launch",hidden:e=>!e,children:(0,z.jsx)(_d,{title:t("Option Details"),children:(0,z.jsx)(li,{name:"scm_update_cache_timeout",type:"number",labelHelp:t("Time in seconds to consider a project to be current. During job runs and callbacks the task system will evaluate the timestamp of the latest project update. If it is older than Cache Timeout, it is not considered current, and a new project update will be performed."),label:t("Cache Timeout"),min:"0"})})})]})}function xk(){const{t:e}=(0,I.Bd)(),t=(0,z.jsx)(I.x6,{i18nKey:"archiveSourceControlUrlHelp",children:(0,z.jsxs)("span",{children:["Example URLs for Remote Archive Source Control include:",(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"https://github.com/username/project/archive/v0.0.1.tar.gz"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"https://github.com/username/project/archive/v0.0.2.zip"})})]})]})});return(0,z.jsx)(Kc,{watch:"scm_type",hidden:e=>"archive"!==e,children:(0,z.jsxs)(_d,{title:e("Type Details"),children:[(0,z.jsx)(li,{name:"scm_url",label:e("Source control URL"),labelHelpTitle:e("Source control URL"),labelHelp:t,isRequired:!0}),(0,z.jsx)(Hp,{name:"credential",label:e("Source control credential"),queryParams:{credential_type__namespace:"scm"}}),(0,z.jsx)(yk,{})]})})}function jk(){const{t:e}=(0,I.Bd)(),t=sc(),n=(0,z.jsx)(I.x6,{i18nKey:"gitSourceControlUrlHelp",children:(0,z.jsxs)("span",{children:["Example URLs for GIT Source Control include:",(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"https://github.com/ansible/ansible.git"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"git@github.com:ansible/ansible.git"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"git://servername.example.com/ansible.git"})})]}),"Note: When using SSH protocol for GitHub or Bitbucket, enter an SSH key only, do not enter a username (other than git). Additionally, GitHub and Bitbucket do not support password authentication when using SSH. GIT read only protocol (git://) does not use username or password information."]})}),a=(0,z.jsx)(I.x6,{i18nKey:"sourceControlRefspecHelp",children:(0,z.jsxs)("span",{children:["A refspec to fetch (passed to the Ansible git module). This parameter allows access to references via the branch field not otherwise available.",(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),'Note: This field assumes the remote name is "origin".',(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),"Examples include:",(0,z.jsxs)("ul",{style:{margin:"10px 0 10px 20px"},children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"refs/*:refs/remotes/origin/*"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"refs/pull/62/head:refs/remotes/origin/pull/62/head"})})]}),'The first fetches all references. The second fetches the Github pull request number 62, in this example the branch needs to be "pull/62/head".',(0,z.jsx)("br",{}),(0,z.jsx)("br",{}),e`For more information, refer to the`," ",(0,z.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:pc(t,"managePlaybooksSC"),children:e`Documentation.`})]})});return(0,z.jsx)(Kc,{watch:"scm_type",hidden:e=>"git"!==e,children:(0,z.jsxs)(_d,{title:e("Type Details"),children:[(0,z.jsx)(li,{name:"scm_url",label:e("Source control URL"),labelHelpTitle:e("Source control URL"),labelHelp:n,isRequired:!0}),(0,z.jsx)(li,{name:"scm_branch",label:e("Source control branch/tag/commit"),labelHelpTitle:e("Source control branch/tag/commit"),labelHelp:e("Branch to checkout. In addition to branches, you can input tags, commit hashes, and arbitrary refs. Some commit hashes and refs may not be available unless you also provide a custom refspec.")}),(0,z.jsx)(li,{name:"scm_refspec",label:e("Source control refspec"),labelHelpTitle:e("Source control refspec"),labelHelp:a}),(0,z.jsx)(Hp,{name:"credential",label:e("Source control credential"),queryParams:{credential_type__namespace:"scm"}}),(0,z.jsx)(yk,{})]})})}function _k(){const{t:e}=(0,I.Bd)();return(0,z.jsx)(Kc,{watch:"scm_type",hidden:e=>"insights"!==e,children:(0,z.jsxs)(_d,{title:e("Type Details"),children:[(0,z.jsx)(Hp,{name:"credential",label:e("Insights credential"),isRequired:!0,queryParams:{credential_type__namespace:"insights"}}),(0,z.jsx)(yk,{hideAllowOverride:!0})]})})}function vk(e){const{t}=(0,I.Bd)(),{data:n}=(0,_e.Ay)(xl`/config/`,(e=>fetch(e).then((e=>e.json())))),a=(0,z.jsxs)(I.x6,{i18nKey:"basePathHelpBlock",children:[(0,z.jsx)("p",{children:"Base path used for locating playbooks. Directories found inside this path will be listed in the playbook directory drop-down. Together the base path and selected playbook directory provide the full path used to locate playbooks."}),(0,z.jsx)("br",{}),(0,z.jsxs)("p",{children:["Change PROJECTS_ROOT when deploying ","AWX"," ","AWX"," to change this location."]})]}),s=(0,z.jsx)(I.x6,{i18nKey:"noPlaybookDirectoriesAlert",children:(0,z.jsxs)("p",{children:["There are no available playbook directories in ",n?.project_base_dir??"",'. Either that directory is empty, or all of the contents are already assigned to other projects. Create a new directory there and make sure the playbook files can be read by the "awx" system user, or have ',"AWX"," ","AWX"," directly retrieve your playbooks from source control using the Source Control Type option above."]})}),o=[...n?.project_local_paths?n?.project_local_paths.map((e=>({label:e,value:e}))):[],..."string"==typeof e.localPath&&e.localPath.length>0?[{label:e.localPath,value:e.localPath}]:[]];return(0,z.jsx)(Kc,{watch:"scm_type",hidden:e=>"manual"!==e,children:(0,z.jsxs)(_d,{title:t("Type Details"),children:[0===o.length&&(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(le.F,{title:t`WARNING: `,variant:"warning",isInline:!0,ouiaId:"project-manual-subform-alert",children:s})}),(0,z.jsx)(li,{name:"base_dir",label:t("Project base path"),placeholder:n?.project_base_dir??"",labelHelpTitle:t("Project base path"),labelHelp:a,isReadOnly:!0}),(0,z.jsx)(ti,{isRequired:!0,name:"local_path",id:"project_local_path",label:t("Playbook directory"),options:o,placeholderText:t("Choose a playbook directory"),labelHelpTitle:t("Playbook directory"),labelHelp:t("Select from the list of directories found in the project base path. Together the base path and the playbook directory provide the full path used to locate playbooks.")})]})})}function wk(){const{t:e}=(0,I.Bd)(),t=(0,z.jsx)(I.x6,{i18nKey:"svnSourceControlUrlHelp",children:(0,z.jsxs)("span",{children:["Example URLs for Subversion Source Control include:",(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"https://github.com/ansible/ansible"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"svn://servername.example.com/path"})}),(0,z.jsx)("li",{children:(0,z.jsx)("code",{children:"svn+ssh://servername.example.com/path"})})]})]})});return(0,z.jsx)(Kc,{watch:"scm_type",hidden:e=>"svn"!==e,children:(0,z.jsxs)(_d,{title:e("Type Details"),children:[(0,z.jsx)(li,{name:"scm_url",label:e("Source control URL"),labelHelpTitle:e("Source control URL"),labelHelp:t,isRequired:!0}),(0,z.jsx)(li,{name:"scm_branch",label:e("Revision number"),labelHelp:e("Branch to checkout. In addition to branches, you can input tags, commit hashes, and arbitrary refs. Some commit hashes and refs may not be available unless you also provide a custom refspec.")}),(0,z.jsx)(Hp,{name:"credential",label:e("Source control credential"),queryParams:{credential_type__namespace:"scm"}}),(0,z.jsx)(yk,{})]})})}const kk={base_dir:"",credential:null,local_path:"",scm_branch:"",scm_clean:!1,scm_delete_on_update:!1,scm_track_submodules:!1,scm_refspec:"",scm_type:"",scm_update_cache_timeout:0,scm_update_on_launch:!1,scm_url:"",signature_validation_credential:null,default_environment:null};function Sk(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.Zp)(),a=td(),s=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create project"),breadcrumbs:[{label:e("Projects"),to:s(fc.Projects)},{label:e("Create project")}]}),(0,z.jsx)(nd,{submitText:e("Create project"),onSubmit:async e=>{"manual"===e.scm_type&&(e.scm_type="");const n=await a(xl`/projects/`,e);t(fc.ProjectDetails,{params:{id:n.id}})},onCancel:()=>n(-1),defaultValue:kk,children:(0,z.jsx)(Ik,{})})]})}function Ck(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=(0,Re.g)(),s=Number(a.id),{data:o}=ec(xl`/projects/${s.toString()}/`);o&&""===o.scm_type&&(o.scm_type="manual");const i=gr();return o?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name?e("Edit {{projectName}}",{projectName:o?.name}):e("Project"),breadcrumbs:[{label:e("Projects"),to:i(fc.Projects)},{label:o?.name?e("Edit {{projectName}}",{projectName:o?.name}):e("Project")}]}),(0,z.jsx)(nd,{submitText:e("Save project"),onSubmit:async e=>{"manual"===e.scm_type&&(e.scm_type="");const t=await sl(xl`/projects/${s.toString()}/`,e);n(fc.ProjectDetails,{params:{id:t.id}})},onCancel:()=>t(-1),defaultValue:o,children:(0,z.jsx)(Ik,{project:o})})]}):(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{breadcrumbs:[{label:e("Projects"),to:i(fc.Projects)},{label:e("Edit Project")}]})})}const Tk={scm_url:"",scm_branch:"",scm_refspec:"",credential:null,signature_validation_credential:null,scm_clean:!1,scm_delete_on_update:!1,scm_track_submodules:!1,scm_update_on_launch:!1,allow_override:!1,scm_update_cache_timeout:0};function Ik(e){const{t}=(0,I.Bd)(),n=(0,oo.FH)({name:"organization"}),{data:a}=dd(xl`/projects/`),s=a?.actions?.GET?.scm_type?.choices,o=(0,oo.FH)({name:"scm_type"}),{project:i}=e,{setValue:r}=(0,oo.xW)();return(0,l.useEffect)((()=>{void 0!==i&&o&&o===i.scm_type?Object.keys(Tk).forEach((e=>{r(`${e}`,i[e])})):Object.keys(Tk).forEach((e=>{r(`${e}`,Tk[e])}))}),[i,o,r]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:t("Name"),placeholder:t("Enter name"),isRequired:!0}),(0,z.jsx)(li,{label:t("Description"),name:"description",placeholder:t("Enter description")}),(0,z.jsx)(sg,{name:"organization",isRequired:!0}),(0,z.jsx)(Wp,{name:"default_environment",organizationId:n,label:t("Execution environment"),isDisabled:void 0===n?t("Select an organization before editing the default execution environment."):void 0}),(0,z.jsx)(ti,{isRequired:!0,name:"scm_type",id:"source_control_type",label:t("Source control type"),options:s?s.map((([e,t])=>({label:t,value:""===e?"manual":e}))):[],placeholderText:t("Choose a Source Control Type")}),(0,z.jsx)(Hp,{id:"signature_validation_credential",name:"signature_validation_credential",label:t("Content signature validation credential"),labelHelp:t("Enable content signing to verify that the content has remained secure when a project is synced. If the content has been tampered with, the job will not run."),queryParams:{credential_type__namespace:"gpg_public_key"}}),(0,z.jsx)(vk,{localPath:e.project?.local_path?e.project?.local_path:void 0}),(0,z.jsx)(jk,{}),(0,z.jsx)(wk,{}),(0,z.jsx)(xk,{}),(0,z.jsx)(_k,{})]})}function Ak(){const{id:e=""}=(0,Re.g)();return(0,z.jsx)(Og,{url:xl`/job_templates/`,projectId:e})}function Dk(e){const{t}=(0,I.Bd)(),n=Sh({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=td();function r(e){return["pending","waiting","running"].includes(e)}const c=e=>e.summary_fields?.user_capabilities?.start?"":t("The project sync cannot be canceled due to insufficient permission"),d=e=>r(e.status??"")?"":t("The project sync cannot be canceled because it is not running");return a=>{const l=a.filter(d),u=a.filter((e=>r(e.status??""))).filter(c);o({title:t("Cancel project sync",{count:a.length}),confirmText:t("Yes, I confirm that I want to cancel these {{count}} project sync jobs.",{count:a.length-u.length-l.length}),actionButtonText:t("Cancel project sync",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length||u.length?[...l.length?[t("{{count}} of the selected project sync jobs cannot be canceled because they are not running.",{count:l.length})]:[],...u.length?[t("{{count}} of the selected project sync jobs cannot be cancelled due to insufficient permissions.",{count:u.length})]:[]]:void 0,isItemNonActionable:e=>d(e)?d(e):c(e),keyFn:ll,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:e=>i(xl`/project_updates/${e.summary_fields?.current_update?.id.toString()??""}/cancel/`,{})})}}function Ek(e){const{t}=(0,I.Bd)(),n=Sh({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc();return a=>{o({title:t("Permanently delete projects",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} projects.",{count:a.length}),actionButtonText:t("Delete projects",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/projects/${e.id.toString()}/`,t)})}}function Pk(e,t){const{t:n}=(0,I.Bd)(),a=yr(),i=Ek(e),r=Dk(),c=ue(),d=td();return(0,l.useMemo)((()=>{const e=e=>["pending","waiting","running"].includes(e.status??"")?"":n("The project sync cannot be canceled because it is not running");return[{type:s.Button,selection:o.Single,isPinned:!0,variant:g.Ak.secondary,icon:Nd.Kf,label:n("Cancel project sync"),isDisabled:t=>(e=>e?.summary_fields?.user_capabilities?.start?"":n("The project sync cannot be canceled due to insufficient permission"))(t)||e(t),isHidden:t=>Boolean(e(t)),onClick:e=>r([e])},{type:s.Button,selection:o.Single,isPinned:!0,variant:g.Ak.primary,icon:Tc.Fj,label:n("Sync project"),isDisabled:e=>""===e.scm_type?n("Cannot sync project"):e.scm_type&&!e?.summary_fields?.user_capabilities?.start?n("The project cannot be synced due to insufficient permission"):["pending","waiting","running"].includes(e.status??"")?n("The project cannot be synced because a sync job is currently running"):"",isHidden:t=>Boolean(!e(t)),onClick:e=>{const a={variant:"success",title:n(`Syncing ${e.name}.`),timeout:2e3};d(xl`/projects/${e?.id.toString()??""}/update/`,{id:e.id}).then((()=>{t&&c.addAlert(a)})).catch((e=>{c.addAlert({variant:"danger",title:n("Failed to sync project"),children:e instanceof Error&&e.message})}))}},{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:n("Edit project"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.edit?"":n("The project cannot be edited due to insufficient permission"))(e),onClick:e=>a(fc.EditProject,{params:{id:e.id}})},{type:s.Button,selection:o.Single,icon:yo.Td,label:n("Copy project"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.copy?"":n("The project cannot be copied due to insufficient permission"))(e),onClick:e=>{const t={variant:"success",title:n(`${e.name} copied.`),timeout:2e3};d(xl`/projects/${e?.id.toString()??""}/copy/`,{name:`${e.name} @ ${(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")}`}).then((()=>{c.addAlert(t)})).catch((e=>{c.replaceAlert(t,{variant:"danger",title:n("Failed to copy project"),children:e instanceof Error&&e.message})}))}},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete project"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.delete?"":n("The project cannot be deleted due to insufficient permission"))(e),onClick:e=>i([e]),isDanger:!0}]}),[c,r,i,t,a,d,n])}function Rk(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),n=Tg("project"),{error:a,data:s,refresh:o,isLoading:i}=ec(xl`/projects/${t.id??""}/`),r=yr(),c=Pk((()=>r(fc.Projects))),{activeAwxUser:d}=_l(),{data:u,error:m,refresh:p,isLoading:h}=ec(xl`/organizations/`,{role_level:"notification_admin_role"}),b=m||a,f=gr(),g=(0,l.useMemo)((()=>{const t=[{label:e("Details"),page:fc.ProjectDetails},{label:e("Schedules"),page:fc.ProjectSchedules},{label:e("Job Templates"),page:fc.ProjectJobTemplates},{label:e("User Access"),page:fc.ProjectUsers},{label:e("Team Access"),page:fc.ProjectTeams}];return(d?.is_system_auditor||u&&u.results.length>0)&&t.push({label:e("Notifications"),page:fc.ProjectNotifications}),t}),[e,d,u]);return b?(0,z.jsx)(Ic,{error:b,handleRefresh:o||p}):!s||i||h?(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.name,breadcrumbs:[{label:e("Projects"),to:f(fc.Projects)},{label:s?.name}],headerActions:(0,z.jsx)(oe,{actions:[...n,...c],position:te.nU.right,selectedItem:s})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Projects"),page:fc.Projects,persistentFilterKey:"projects"},tabs:g,params:{id:s.id}})]})}function Bk(){const{t:e}=(0,I.Bd)(),t=yr(),n=Ch(),a=Sh(),i=Uc({url:xl`/projects/`,toolbarFilters:n,tableColumns:a}),r=function(e){const{t}=(0,I.Bd)(),n=gr(),{data:a}=dd(xl`/projects/`),i=Boolean(a&&a.actions&&a.actions.POST),r=Ek(e),c=Dk(e);return(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Create project"),isDisabled:i?void 0:t("You do not have permission to create a project. Please contact your organization administrator if there is an issue with your access."),href:n(fc.CreateProject)},{type:s.Button,selection:o.Multiple,icon:eu.tP,label:t("Cancel projects"),onClick:c},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete projects"),onClick:r,isDanger:!0}]),[i,c,r,n,t])}(i.unselectItemsAndRefresh),c=Pk(i.unselectItemsAndRefresh,!0),{data:d}=dd(xl`/projects/`),u=Boolean(d&&d.actions&&d.actions.POST),{refresh:m}=i;Fc("projects"),dc({control:["limit_reached_1"],jobs:["status_changed"]},(0,l.useCallback)((e=>{if("jobs"===e?.group_name)switch(e?.type){case"job":case"workflow_job":case"project_update":m()}}),[m]));const p=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Projects"),titleHelpTitle:e("Projects"),titleHelp:e("A project is a logical collection of Ansible playbooks, represented in {{product}}. You can manage playbooks and playbook directories by either placing them manually under the Project Base Path on your {{product}} server, or by placing your playbooks into a source code management (SCM) system supported by {{product}}, including Git, Subversion, Mercurial, and Red Hat Insights.",{product:"AWX"}),titleDocLink:pc(p,"projects"),description:e("A project is a logical collection of Ansible playbooks, represented in {{product}}.",{product:"AWX"}),headerActions:(0,z.jsx)(cd,{type:"project"})}),(0,z.jsx)($s,{id:"awx-projects-table",toolbarFilters:n,toolbarActions:r,tableColumns:a,rowActions:c,errorStateTitle:e("Error loading projects"),emptyStateTitle:e(u?"There are currently no projects added to your organization.":"You do not have permission to create a project"),emptyStateDescription:e(u?"Please create a project by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:u?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:u?e("Create project"):void 0,emptyStateButtonClick:u?()=>t(fc.CreateProject):void 0,...i,defaultSubtitle:e("Project")})]})}function Fk(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"project",addRolesRoute:fc.ProjectAddTeams})}function Nk(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"project",addRolesRoute:fc.ProjectAddUsers})}function $k(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/projects/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{projectName}}.",{projectName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"project",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{projectName}}.",{projectName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Projects"),to:t(fc.Projects)},{label:a?.name,to:t(fc.ProjectDetails,{params:{id:a?.id}})},{label:e("Users "),to:t(fc.ProjectUsers,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"project",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.ProjectUsers,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.ProjectUsers,{params:{id:a?.id}})}})]})}function Mk(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/projects/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{projectName}}.",{projectName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"project",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{projectName}}.",{projectName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Projects"),to:t(fc.Projects)},{label:s?.name,to:t(fc.ProjectDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.ProjectTeams,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"project",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.ProjectTeams,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.ProjectTeams,{params:{id:s?.id}})}})]})}function Lk(e){const{t}=(0,I.Bd)(),n=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("Schedules"),titleHelpTitle:t("Schedules"),titleHelp:t("Schedules are used to launch jobs on a regular basis. They can be used to launch jobs against machines, synchronize with inventory sources, and import project content from a version control system."),titleDocLink:pc(n,"schedules"),description:t("Schedules are used to launch jobs on a regular basis. They can be used to launch jobs against machines, synchronize with inventory sources, and import project content from a version control system."),headerActions:(0,z.jsx)(cd,{type:"schedule"})}),(0,z.jsx)(lv,{createSchedulePageId:fc.CreateSchedule,sublistEndpoint:e.sublistEndpoint,url:xl`/schedules/`})]})}function Ok(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.Zp)(),a=td(),s=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create team"),breadcrumbs:[{label:e("Teams"),to:s(fc.Teams)},{label:e("Create team")}]}),(0,z.jsx)(nd,{submitText:e("Create team"),onSubmit:async e=>{const n=await a(xl`/teams/`,e);t(fc.TeamDetails,{params:{id:n.id}})},onCancel:()=>n(-1),children:(0,z.jsx)(Hk,{})})]})}function zk(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=(0,Re.g)(),a=Number(n.id),{data:s}=ec(xl`/teams/${a.toString()}/`),o=ed(),i=gr();return s?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.name?e("Edit {{teamName}}",{teamName:s?.name}):e("Team"),breadcrumbs:[{label:e("Teams"),to:i(fc.Teams)},{label:s?.name?e("Edit {{teamName}}",{teamName:s?.name}):e("Team")}]}),(0,z.jsx)(nd,{submitText:e("Save team"),onSubmit:async e=>{await o(xl`/teams/${a.toString()}/`,e),t(-1)},onCancel:()=>t(-1),defaultValue:s,children:(0,z.jsx)(Hk,{})})]}):(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{breadcrumbs:[{label:e("Teams"),to:i(fc.Teams)},{label:e("Edit Team")}]})})}function Hk(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:e("Name"),placeholder:e("Enter name"),isRequired:!0}),(0,z.jsx)(sg,{name:"organization",isRequired:!0}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(ii,{name:"description",label:e("Description"),placeholder:e("Enter description")})})]})}function qk(e){const{t}=(0,I.Bd)(),n=(0,Re.Zp)(),{team:a,organizationDetailsUrl:s,createdByUserDetailsUrl:o,modifiedByUserDetailsUrl:i}=e;return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("Name"),children:a.name}),a.description&&(0,z.jsx)(Ft,{label:t("Description"),children:a.description}),a.summary_fields?.organization&&(0,z.jsx)(Ft,{label:t("Organization"),children:s?(0,z.jsx)(Pe,{labelsWithLinks:[{name:a.summary_fields?.organization?.name,link:s}]}):(0,z.jsx)(Pe,{labels:[a.summary_fields?.organization?.name]})}),(a.created||a.created_on||a.created_at)&&(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{author:a.summary_fields?.created_by?.username,value:a.created??a.created_on??a.created_at,onClick:o?()=>{n(o)}:void 0})}),(a.modified||a.modified_on||a.modified_at)&&(0,z.jsx)(Xd,{author:a.summary_fields?.modified_by?.username,value:a.modified??a.modified_on??a.modified_at,onClick:i?()=>{n(i)}:void 0})]})}function Uk(){const e=(0,Re.g)(),{data:t}=tc(xl`/teams`,e.id),n=gr();return t?(0,z.jsx)(qk,{team:t,organizationDetailsUrl:n(fc.OrganizationDetails,{params:{id:(t.summary_fields?.organization?.id??"").toString()}}),createdByUserDetailsUrl:n(fc.UserDetails,{params:{id:(t.summary_fields?.created_by?.id??0).toString()}}),modifiedByUserDetailsUrl:n(fc.UserDetails,{params:{id:(t.summary_fields?.modified_by?.id??0).toString()}})}):null}function Wk(){const e=(0,Re.g)(),{t}=(0,I.Bd)();return(0,z.jsx)(by,{service:"awx",addRoleButtonText:t("Add users"),removeRoleText:t("Remove users"),removeConfirmationText:e=>t("Yes, I confirm that I want to remove these {{count}} users.",{count:e}),id:e.id||"",type:"team",addRolesRoute:fc.TeamAddMembers})}function Jk(e){const{t}=(0,I.Bd)(),n=Qf(),a=Gf();return(0,l.useCallback)((s=>{n(t("Add users to teams",{count:s.length}),(t=>{a(t,s,e)}))}),[a,e,n,t])}function Vk(e){const t=yr(),n=(0,l.useCallback)((e=>t(fc.TeamDetails,{params:{id:e.id}})),[t]),a=mu(),s=pu({...e,onClick:n}),o=hu(),i=gu(fc.OrganizationDetails,e),r=bu(e),c=fu(e);return(0,l.useMemo)((()=>[a,s,i,o,r,c]),[r,o,a,c,s,i])}function Gk(e){const{t}=(0,I.Bd)(),n=Vk({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=gu(fc.OrganizationDetails,{disableLinks:!0,disableSort:!0}),o=(0,l.useMemo)((()=>[a,s]),[a,s]),i=e=>e?.summary_fields?.user_capabilities?.delete?void 0:t("The team cannot be deleted due to insufficient permissions."),r=Lc();return a=>{const s=a.filter(i);r({title:t("Permanently delete teams",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} teams.",{count:a.length-s.length}),actionButtonText:t("Delete teams",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:s.length>0?[t("{{count}} of the selected teams cannot be deleted due to insufficient permissions.",{count:s.length})]:void 0,isItemNonActionable:i,keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:o,onComplete:e,actionFn:(e,t)=>ol(xl`/teams/${e.id.toString()}/`,t)})}}function Yk(e){const{onTeamsDeleted:t}=e,{t:n}=(0,I.Bd)(),a=yr(),i=Gk(t),r=Jk(),c=function(e){const{t}=(0,I.Bd)(),n=Qf(),a=function(){const{t:e}=(0,I.Bd)(),{activeAwxUser:t}=_l(),n=Kf(),a=Lc(),s=td();return(0,l.useCallback)(((o,i,r)=>{const l=t?.is_superuser||i?.summary_fields?.user_capabilities?.edit,c=t=>t.is_superuser?e("System administrators have unrestricted access to all resources."):t.is_system_auditor?e("System auditors have read access to all resources."):l?void 0:e("The user cannot be deleted due to insufficient permissions."),d=o.filter(c),u=i.type?{organization:"Remove user from organization",team:"Remove user from team"}[i.type]:"Remove user";a({title:e(u,{count:o.length}),confirmText:e("Yes, I confirm that I want to remove these {{count}} users.",{count:o.length-d.length}),actionButtonText:e("Remove user",{count:o.length}),items:o.sort(((e,t)=>Js(e.username,t.username))),keyFn:e=>e.id,alertPrompts:d.length>0?[e("{{count}} of the selected users cannot be deleted due to insufficient permissions.",{count:d.length})]:void 0,isItemNonActionable:c,isDanger:!0,confirmationColumns:n,actionColumns:[{header:"User",cell:e=>e.username}],onComplete:r,actionFn:async(e,t)=>{if(e.user_roles)for(const n of e.user_roles)await s(xl`/users/${e.id.toString()}/roles/`,{id:n.id,disassociate:!0},t)}})}),[t?.is_superuser,n,a,s,e])}();return(0,l.useCallback)((s=>{n(t("Remove users from team"),(t=>{a(t,s,e)}),t("Remove user(s)"),xl`/teams/${s.id.toString()}/access_list/`)}),[a,e,n,t])}(),{activeAwxUser:d}=_l();return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,variant:g.Ak.primary,isPinned:!0,icon:yc.oo,label:n("Edit team"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.edit?"":n("The team cannot be edited due to insufficient permissions."))(e),onClick:e=>a(fc.EditTeam,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:Za.GY,label:n("Add users to teams"),isDisabled:e=>(e=>d?.is_superuser||e?.summary_fields?.user_capabilities?.edit?"":n("You do not have permission to add users. Please contact your organization administrator if there is an issue with your access."))(e),onClick:e=>r([e])},{type:s.Button,selection:o.Single,icon:Nd.Kf,label:n("Remove users from teams"),isDisabled:e=>(e=>d?.is_superuser||e?.summary_fields?.user_capabilities?.edit?"":n("You do not have permission to remove users. Please contact your organization administrator if there is an issue with your access."))(e),onClick:e=>c(e)},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete team"),isDisabled:e=>(e=>e?.summary_fields?.user_capabilities?.delete?"":n("The team cannot be deleted due to insufficient permissions."))(e),onClick:e=>i([e]),isDanger:!0}]),[d?.is_superuser,i,a,c,r,n])}function Kk(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=tc(xl`/teams`,t.id),o=yr(),i=Yk({onTeamsDeleted:()=>o(fc.Teams),isDetailsPageAction:!0}),r=Tg("team"),l=gr();return n?(0,z.jsx)(Ic,{error:n,handleRefresh:s}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.name,breadcrumbs:[{label:e("Teams"),to:l(fc.Teams)},{label:a?.name}],headerActions:(0,z.jsx)(oe,{actions:[...r,...i],position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Teams"),page:fc.Teams,persistentFilterKey:"teams"},tabs:[{label:e("Details"),page:fc.TeamDetails},{label:e("Users"),page:fc.TeamMembers},{label:e("Roles"),page:fc.TeamRoles}],params:{id:a.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function Zk(){const{t:e}=(0,I.Bd)(),t=yr(),n=ny(),a=Vk(),i=Uc({url:xl`/teams/`,toolbarFilters:n,tableColumns:a}),r=function(e){const{t}=(0,I.Bd)(),n=gr(),a=Gk(e.unselectItemsAndRefresh),i=Jk(),{data:r}=dd(xl`/teams/`),c=Boolean(r&&r.actions&&r.actions.POST);return(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,isPinned:!0,variant:g.Ak.primary,icon:Za.GY,label:t("Create team"),isDisabled:c?void 0:t("You do not have permission to create a team. Please contact your organization administrator if there is an issue with your access."),href:n(fc.CreateTeam)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:Za.GY,label:t("Add users to teams"),onClick:()=>i(e.selectedItems)},{type:s.Button,selection:o.None,icon:Tc.Fj,label:t("Refresh"),onClick:()=>{e.refresh()}},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete teams"),onClick:a,isDanger:!0}]),[c,a,n,i,t,e])}(i),c=Yk({onTeamsDeleted:i.unselectItemsAndRefresh}),{data:d}=dd(xl`/teams/`),u=Boolean(d&&d.actions&&d.actions.POST);Fc("teams");const m=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Teams"),titleHelpTitle:e("Teams"),titleHelp:[e("A team is a subdivision of an organization with associated users, projects, credentials, and permissions."),e("Teams provide a means to implement role-based access control schemes and delegate responsibilities across organizations."),e("For instance, permissions may be granted to a whole team rather than each user on the team.")],titleDocLink:pc(m,"teams"),description:e("A team is a subdivision of an organization with associated users, projects, credentials, and permissions."),headerActions:(0,z.jsx)(cd,{type:"team"})}),(0,z.jsx)($s,{id:"awx-teams-table",toolbarFilters:n,toolbarActions:r,tableColumns:a,rowActions:c,errorStateTitle:e("Error loading teams"),emptyStateTitle:e(u?"There are currently no teams added to your organization.":"You do not have permission to create a team"),emptyStateDescription:e(u?"Please create a team by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:u?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:u?e("Create team"):void 0,emptyStateButtonClick:u?()=>t(fc.CreateTeam):void 0,...i,defaultSubtitle:e("Team")})]})}function Xk(){const{t:e}=(0,I.Bd)(),{wizardData:t,setStepData:n,setWizardData:a}=vr(),{data:s,isLoading:o}=dd(xl`/role_definitions/`);if(o||!s)return(0,z.jsx)(zr,{});const i=s?.actions?.GET?.content_type?.choices||[];return(0,z.jsx)(ti,{label:e("Resource type"),name:"resourceType",options:i.filter((([e,t])=>e?.startsWith("awx."))).map((([e,t])=>({value:e,label:t}))),onChange:e=>{t.resourceType!==e&&(a({}),n({}))},placeholderText:e("Select a resource type"),isRequired:!0})}const Qk={"awx.credential":xl`/credentials/`,"awx.executionenvironment":xl`/execution_environments/`,"awx.instancegroup":xl`/instance_groups/`,"awx.inventory":xl`/inventories/`,"awx.jobtemplate":xl`/job_templates/`,"awx.notificationtemplate":xl`/notification_templates/`,"awx.project":xl`/projects/`,"awx.workflowjobtemplate":xl`/workflow_job_templates/`},eS=(0,A.Ay)(Ge.h).withConfig({componentId:"ans__sc-lphqr3-0"})(["margin-bottom:1rem;"]);function tS(){const{wizardData:e}=vr(),{t}=(0,I.Bd)(),{resourceType:n}=e,a=(0,l.useMemo)((()=>({"awx.credential":t("Select credentials"),"awx.executionenvironment":t("Select execution environments"),"awx.instancegroup":t("Select instance groups"),"awx.inventory":t("Select inventories"),"awx.jobtemplate":t("Select job templates"),"awx.notificationtemplate":t("Select notification templates"),"awx.project":t("Select projects"),"awx.workflowjobtemplate":t("Select workflow job templates")})),[t]),s=(0,l.useMemo)((()=>[{header:t("Name"),type:"text",value:e=>e.name,sort:"name"}]),[t]),o=(0,l.useMemo)((()=>[{key:"name",label:t("Name"),type:Ia.MultiText,query:"name__contains",comparison:"contains"}]),[t]),i=Gg({url:Qk[n],queryParams:"awx.executionenvironment"===n?{not__organization:"null",managed:"false"}:void 0,toolbarFilters:o,tableColumns:s},"resources");return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(eS,{headingLevel:"h1",children:a[n]}),(0,z.jsx)("h2",{style:{marginTop:"1rem",marginBottom:"1rem"},children:t("Choose the resources that will be receiving new roles. You'll be able to select the roles to apply in the next step. Note that the resources chosen here will receive all roles chosen in the next step.")}),(0,z.jsx)(Zs,{view:i,tableColumns:s,toolbarFilters:o,labelForSelectedItems:t("Selected")})]})}function nS(e){const{t}=(0,I.Bd)(),n=Vf(),a=[{id:"resource-type",label:t("Select a resource type"),inputs:(0,z.jsx)(Xk,{})},{id:"resources",label:t("Select resources"),inputs:(0,z.jsx)(tS,{}),validate:(e,n)=>{const{resources:a}=e;if(!a?.length)throw new Error(t("Select at least one resource."))}},{id:"roles",label:t("Select roles to apply"),inputs:(0,z.jsx)(Xg,{fieldNameForPreviousStep:"resources"}),validate:(e,n)=>{const{awxRoles:a}=e;if(!a?.length)throw new Error(t("Select at least one role."))}},{id:"review",label:t("Review"),element:(0,z.jsx)(Jg,{})}];return(0,z.jsx)(Lr,{steps:a,onSubmit:a=>{const{resources:s,awxRoles:o,resourceType:i}=a,r=[];for(const e of s)for(const t of o)r.push({resource:e,role:t});return new Promise((a=>{n({title:t("Add roles"),keyFn:({resource:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:t("Resource name"),cell:({resource:e})=>e.name},{header:t("Role"),cell:({role:e})=>e.name}],actionFn:({resource:t,role:n})=>{const a={role_definition:n.id,content_type:i,object_id:t.id};return"user"===e.type?a.user=e.id:a.team=e.id,al(xl`/role_${e.type}_assignments/`,a)},onComplete:()=>{a()},onClose:e.onClose})}))},onCancel:e.onClose,disableGrid:!0})}function aS(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),a=gr(),s=yr(),{data:o,isLoading:i}=ec(xl`/teams/${e.id||n.id||""}/`);return i||!o?(0,z.jsx)(zr,{}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("Add roles"),breadcrumbs:[{label:t("Teams"),to:a(fc.Teams)},{label:o.name,to:a(fc.TeamDetails,{params:{id:1}})},{label:t("Roles"),to:a(fc.TeamRoles,{params:{id:1}})},{label:t("Add roles")}]}),(0,z.jsx)(nS,{id:o.id.toString(),type:"team",onClose:()=>{s(e.teamRolesRoute||fc.TeamRoles,{params:{id:o.id}})}})]})}let sS=function(e){return e.Eda="eda",e.Overview="eda-overview",e.RuleAudits="eda-rule-audits",e.RuleAuditPage="eda-rule-audit-page",e.RuleAuditDetails="eda-rule-audit-details",e.RuleAuditActions="eda-rule-audit-actions",e.RuleAuditEvents="eda-rule-audit-events",e.RulebookActivations="eda-rulebook-activations",e.CreateRulebookActivation="eda-create-rulebook-activation",e.RulebookActivationPage="eda-rulebook-activation-page",e.RulebookActivationDetails="eda-rulebook-activation-details",e.RulebookActivationHistory="eda-rulebook-activation-history",e.RulebookActivationInstancePage="eda-rulebook-activation-instance-page",e.RulebookActivationInstanceDetails="eda-rulebook-activation-instance-details",e.RulebookActivationTeamAccess="eda-rulebook-activation-team-access",e.RulebookActivationUserAccess="eda-rulebook-activation-user-access",e.RulebookActivationAddTeams="eda-rulebook-activation-add-teams",e.RulebookActivationAddUsers="eda-rulebook-activation-add-users",e.Projects="eda-projects",e.CreateProject="eda-create-project",e.EditProject="eda-edit-project",e.ProjectPage="eda-project-page",e.ProjectDetails="eda-project-details",e.ProjectTeamAccess="eda-project-project-team-access",e.ProjectUserAccess="eda-project-project-user-access",e.ProjectAddUsers="eda-project-add-users",e.ProjectAddTeams="eda-project-add-teams",e.DecisionEnvironments="eda-decision-environments",e.CreateDecisionEnvironment="eda-create-decision-environment",e.EditDecisionEnvironment="eda-edit-decision-environment",e.DecisionEnvironmentPage="eda-decision-environment-page",e.DecisionEnvironmentDetails="eda-decision-environment-details",e.DecisionEnvironmentTeamAccess="eda-decision-environments-team-access",e.DecisionEnvironmentUserAccess="eda-decision-environments-user-access",e.DecisionEnvironmentAddTeams="eda-decision-environments-add-teams",e.DecisionEnvironmentAddUsers="eda-decision-environments-add-users",e.Credentials="eda-credentials",e.CreateCredential="eda-create-credential",e.EditCredential="eda-edit-credential",e.CredentialPage="eda-credential-page",e.CredentialDetails="eda-credential-details",e.CredentialTeamAccess="eda-credential-team-access",e.CredentialUserAccess="eda-credential-user-access",e.CredentialAddTeams="eda-credential-add-teams",e.CredentialAddUsers="eda-credential-add-users",e.CredentialTypes="eda-credential-types",e.CreateCredentialType="eda-create-credential-type",e.EditCredentialType="eda-edit-credential-type",e.CredentialTypePage="eda-credential-type-page",e.CredentialTypeDetails="eda-credential-type-details",e.CredentialTypeCredentials="eda-credential-type-credentials",e.Access="eda-access",e.Users="eda-users",e.CreateUser="eda-create-user",e.EditUser="eda-edit-user",e.EditCurrentUser="eda-edit-current-user",e.UserPage="eda-user-page",e.MyPage="eda-me-page",e.MyDetails="eda-my-details",e.UserDetails="eda-user-details",e.UserRoles="eda-user-roles",e.UserAddRoles="eda-user-add-roles",e.Organizations="eda-organizations",e.CreateOrganization="eda-create-organization",e.EditOrganization="eda-edit-organization",e.OrganizationPage="eda-organization-page",e.OrganizationDetails="eda-organization-details",e.Roles="eda-roles",e.CreateRole="eda-create-role",e.EditRole="eda-edit-role",e.RolePage="eda-role-page",e.RoleDetails="eda-role-details",e.EventStreams="eda-event-streams",e.CreateEventStream="eda-create-event-stream",e.EditEventStream="eda-edit-event-stream",e.EventStreamPage="eda-event-stream-page",e.EventStreamDetails="eda-event-stream-details",e.EventStreamActivations="eda-event-stream-activations",e.EventStreamTeamAccess="eda-event-stream-team-access",e.EventStreamUserAccess="eda-event-stream-user-access",e.EventStreamAddTeams="eda-event-stream-add-teams",e.EventStreamAddUsers="eda-event-stream-add-users",e.Settings="eda-settings",e.SettingsPreferences="eda-settings-preferences",e.TeamAddRoles="eda-team-add-roles",e.TeamPage="eda-team-page",e.TeamRoles="eda-team-roles",e.Teams="eda-teams",e.CreateTeam="eda-create-team",e.EditTeam="eda-edit-team",e.TeamDetails="eda-team-details",e.Login="eda-login",e}({}),oS=function(e){return e.Hub="hub",e.Overview="hub-overview",e.Namespaces="hub-namespaces",e.CreateNamespace="hub-create-namespace",e.EditNamespace="hub-edit-namespace",e.NamespacePage="hub-namespace-page",e.NamespaceCollections="hub-namespace-collections",e.NamespaceDetails="hub-namespace-details",e.NamespaceCLI="hub-namespace-cli",e.NamespaceTeamAccess="hub-namespace-team-access",e.NamespaceUserAccess="hub-namespace-user-access",e.NamespaceAddUsers="hub-namespace-add-users",e.NamespaceAddTeams="hub-namespace-add-teams",e.CollectionSignatureUpload="hub-signature-upload",e.Collections="hub-collections",e.UploadCollection="hub-create-collection",e.CollectionPage="hub-collection-page",e.CollectionDetails="hub-collection-details",e.CollectionInstall="hub-collection-install",e.CollectionDocumentation="hub-collection-documentation",e.CollectionDocumentationContent="hub-collection-documentation-content",e.CollectionContents="hub-collection-contents",e.CollectionImportLog="hub-collection-page-import-log",e.CollectionDistributions="hub-collection-distributions",e.CollectionDependencies="hub-collection-dependencies",e.ExecutionEnvironments="hub-execution-environments",e.EditExecutionEnvironment="hub-edit-execution-environment",e.CreateExecutionEnvironment="hub-create-execution-environment",e.ExecutionEnvironmentPage="hub-execution-environment-page",e.ExecutionEnvironmentDetails="hub-create-execution-environment-details",e.ExecutionEnvironmentActivity="hub-create-execution-environment-activity",e.ExecutionEnvironmentImages="hub-create-execution-environment-images",e.ExecutionEnvironmentImagePage="hub-create-execution-environment-image-page",e.ExecutionEnvironmentImageDetails="hub-create-execution-environment-image-details",e.ExecutionEnvironmentAddTeams="hub-execution-environment-add-teams",e.ExecutionEnvironmentAddUsers="hub-execution-environment-add-users",e.ExecutionEnvironmentTeamAccess="hub-execution-environment-team-access",e.ExecutionEnvironmentUserAccess="hub-execution-environment-user-access",e.SignatureKeys="hub-signature-keys",e.Repositories="hub-repositories",e.CreateRepository="hub-create-repository",e.EditRepository="hub-edit-repository",e.RepositoryPage="hub-repository-page",e.RepositoryDetails="hub-repository-page-details",e.RepositoryCollectionVersion="hub-repository-page-collection-version",e.RepositoryVersions="hub-repository-page-versions",e.RepositoryVersionPage="hub-repository-page-version-page",e.RepositoryVersionDetails="hub-repository-page-version-page-details",e.RepositoryVersionCollections="hub-repository-page-version-page-collections",e.RepositoryDistributions="hub-repository-page-distributions",e.RepositoryAddTeams="hub-repository-add-teams",e.RepositoryAddUsers="hub-repository-add-users",e.RepositoryTeamAccess="hub-repository-team-access",e.RepositoryUserAccess="hub-repository-user-access",e.RemoteRegistries="hub-remote-registries",e.CreateRemoteRegistry="hub-create-remote-registry",e.EditRemoteRegistry="hub-edit-remote-registry",e.RemoteRegistryPage="hub-remote-registry-page",e.RemoteRegistryDetails="hub-remote-registry-details",e.Tasks="hub-tasks",e.TaskPage="hub-task-page",e.Approvals="hub-approvals",e.Remotes="hub-remotes",e.CreateRemote="hub-create-remote",e.EditRemote="hub-edit-remote",e.RemotePage="hub-remote-page",e.RemoteDetails="hub-remote-details",e.RemoteAddTeams="hub-remote-add-teams",e.RemoteAddUsers="hub-remote-add-users",e.RemoteTeamAccess="hub-remote-add-team-access",e.RemoteUserAccess="hub-remote-user-access",e.Access="hub-access",e.Organizations="hub-organizations",e.Teams="hub-teams",e.TeamPage="hub-team-page",e.TeamRoles="hub-team-roles",e.TeamAddRoles="hub-team-add-roles",e.TeamDetails="hub-team-details",e.Users="hub-users",e.UserPage="hub-user-page",e.UserRoles="hub-user-roles",e.UserAddRoles="hub-user-add-roles",e.UserDetails="hub-user-details",e.APIToken="hub-api-token",e.MyImports="hub-my-imports",e.Roles="hub-roles",e.CreateRole="hub-create-role",e.RolePage="hub-role-page",e.RoleDetails="hub-role-details",e.EditRole="hub-edit-role",e.Settings="hub-settings",e.SettingsPreferences="hub-settings-preferences",e.Login="hub-login",e}({});function iS(e){const{id:t,type:n,addRolesRoute:a,service:s}=e,{t:o}=(0,I.Bd)(),i=qg(),r="awx"===s?xl`/role_definitions/`:"eda"===s?ry`/role_definitions/`:gl`/_ui/v2/role_definitions/`,c="awx"===s?xl`/role_user_assignments/`:"eda"===s?ry`/role_user_assignments/`:gl`/_ui/v2/role_user_assignments/`,d="awx"===s?xl`/role_team_assignments/`:"eda"===s?ry`/role_team_assignments/`:gl`/_ui/v2/role_team_assignments/`,{data:u,isLoading:m}=dd(r),p=function(){const e=gr();return(0,l.useCallback)((t=>{const{contentType:n,objectId:a}=t;if(null!==n&&null!==a)return{"eda.edacredential":e(sS.CredentialDetails,{params:{id:a}}),"eda.project":e(sS.ProjectDetails,{params:{id:a}}),"eda.activation":e(sS.RulebookActivationDetails,{params:{id:a}}),"eda.rulebookprocess":e(sS.RulebookActivationInstanceDetails,{params:{id:a}}),"eda.credentialtype":e(sS.CredentialTypeDetails,{params:{id:a}}),"eda.decisionenvironment":e(sS.DecisionEnvironmentDetails,{params:{id:a}}),"eda.auditrule":e(sS.RuleAuditDetails,{params:{id:a}}),"awx.credential":e(fc.CredentialDetails,{params:{id:a}}),"awx.executionenvironment":e(fc.ExecutionEnvironmentDetails,{params:{id:a}}),"awx.instancegroup":e(fc.InstanceGroupDetails,{params:{id:a}}),"awx.inventory":e(fc.InventoryDetails,{params:{id:a}}),"awx.jobtemplate":e(fc.JobTemplateDetails,{params:{id:a}}),"awx.notificationtemplate":e(fc.NotificationTemplateDetails,{params:{id:a}}),"awx.workflowjobtemplate":e(fc.WorkflowJobTemplateDetails,{params:{id:a}}),"awx.project":e(fc.ProjectDetails,{params:{id:a}}),"galaxy.namespace":e(oS.NamespaceDetails,{params:{id:a}}),"galaxy.ansiblerepository":e(oS.RepositoryDetails,{params:{id:a}}),"galaxy.containernamespace":e(oS.ExecutionEnvironmentDetails,{params:{id:a}}),"galaxy.containerrepository":e(oS.ExecutionEnvironmentDetails,{params:{id:a}}),"galaxy.collectionremote":e(oS.RemoteDetails,{params:{id:a}})}[n]??void 0}),[e])}(),h=(0,l.useMemo)((()=>{const e=u?.actions?.POST?.content_type?.choices||[],t=[];return e?.forEach((e=>{e?.value?t.push({value:e.value.split(".").pop()||e.value,label:i(e.value,{isTitleCase:!0})}):e&&null!==e[0]&&t.push({value:e[0].split(".").pop()||e[0],label:i(e[0],{isTitleCase:!0})})})),t}),[u?.actions?.POST?.content_type?.choices,i]);return m||!u?(0,z.jsx)(zr,{}):(0,z.jsx)(my,{service:s,tableColumnFunctions:{name:{function:e=>e.summary_fields.content_object?.name,label:o("Resource name"),to:e=>p({contentType:e.content_type,objectId:"hub"===s?e.summary_fields?.content_object?.name:e.object_id})}},additionalTableColumns:[{header:o("Type"),type:"description",sort:"content_type",value:e=>i(e.content_type,{isTitleCase:!0}),priority:Jt.last}],additionalTableFilters:[{key:"content-type",label:o("Resource type"),type:Ia.MultiSelect,placeholder:o("Select type"),query:"content_type__model__contains",options:h,disableSortOptions:!0}],url:"user-roles"===n?c:d,id:t,addRolesRoute:a,accessListType:n})}function rS(e){const t=(0,Re.g)();return(0,z.jsx)(iS,{service:"awx",id:e.id||t.id||"",type:"team-roles",addRolesRoute:e.addRolesRoute||fc.AddRolesToTeam})}function lS(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=tc(xl`/teams/`,n.id),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{teamName}}.",{teamName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"awxRoles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"team",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{teamName}}.",{teamName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add users"),breadcrumbs:[{label:e("Teams"),to:t(fc.Teams)},{label:a?.name,to:t(fc.TeamDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.TeamMembers,{params:{id:a?.id}})},{label:e("Add users")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add users"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"awx.team",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.TeamMembers,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.TeamMembers,{params:{id:a?.id}})}})]})}function cS(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),{setValue:a,getValues:s,reset:o}=(0,oo.xW)(),i=(0,oo.FH)({name:"webhook_key"}),r=(0,oo.FH)({name:"webhook_service"}),c=(0,oo.FH)({name:"isWebhookEnabled"}),{templateType:d}=e,{pathname:u}=(0,Re.zy)(),m=ip();(0,l.useEffect)((()=>{u.endsWith("/create")||async function(){const e=await nl(xl`/${d}/${n.id??""}/webhook_key/`);o({...s(),webhook_key:e.webhook_key||i||s("webhook_key")})}()}),[]),(0,l.useEffect)((()=>{r&&a("related.webhook_receiver",u.endsWith("/create")?t`a new webhook url will be generated on save.`.toUpperCase():`${document.location.origin}${xl`/${d}/`}${n.id}/${r}/`),u.endsWith("/create")&&a("webhook_key",t`a new webhook key will be generated on save.`.toUpperCase())}),[r,a,u,n.id,t,d]);const p=(0,l.useCallback)((async()=>{if(c&&n.id){const{webhook_key:e}=await al(xl`/${d}/${n.id}/webhook_key/`,{});a("webhook_key",e)}}),[c,a,n,d]),h=u.endsWith("/create")||"A NEW WEBHOOK KEY WILL BE GENERATED ON SAVE."===i;return(0,z.jsxs)(_d,{title:t("Webhook details"),children:[(0,z.jsx)(ti,{name:"webhook_service",label:t("Webhook service"),options:m,isRequired:c,placeholderText:t("Select a webhook service")}),(0,z.jsx)(li,{name:"related.webhook_receiver",isDisabled:!n.id||!r,label:t("Webhook URL"),isReadOnly:!0,placeholder:t("Select a webhook service")}),(0,z.jsx)(li,{name:"webhook_key",label:t("Webhook key"),isReadOnly:!0,button:(0,z.jsx)(g.$n,{ouiaId:"update-webhook-key-button",isDisabled:h,variant:"tertiary","aria-label":t`Update webhook key`,onClick:()=>{p()},children:(0,z.jsx)($n.Ci,{})})}),r?(0,z.jsx)(Hp,{id:"webhook_credential",name:"webhook_credential",label:t("Webhook credential"),placeholder:t("Select webhook credential"),isDisabled:r?void 0:t("Disabled"),queryParams:{credential_type__namespace:`${r}_token`}}):null]})}const dS=["machine","cloud","net","ssh","vault","kubernetes","cryptography"];function uS(e){const{jobtemplate:t}=e,{t:n}=(0,I.Bd)(),{setValue:a,getValues:s,reset:o}=(0,oo.xW)(),[i,r]=(0,l.useState)(),c=(0,oo.FH)({name:"project"}),d=(0,oo.FH)({name:"isProvisioningCallbackEnabled"}),u=(0,oo.FH)({name:"isWebhookEnabled"}),m=(0,oo.FH)({name:"ask_inventory_on_launch"}),p=(0,oo.FH)({name:"ask_job_type_on_launch"}),h=(0,oo.FH)({name:"organization"})??c?.organization;return(0,l.useEffect)((()=>{o(s())}),[d,o,s]),(0,l.useEffect)((()=>{(async function(){if(c){const e=await nl(xl`/projects/${c.id.toString()}/playbooks/`);return r(e)}})().catch((()=>"there was an error"))}),[c,a]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:n("Name"),isRequired:!0,placeholder:n("Add a name for this job template")}),(0,z.jsx)(li,{name:"description",label:n("Description"),placeholder:n("Add a description for this job template")}),(0,z.jsx)(ti,{isRequired:!p,additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_job_type_on_launch"}),labelHelpTitle:n("Job type"),labelHelp:n("Select a job type for this job template."),name:"job_type",id:"job_type",label:n("Job type"),options:[{label:n("Check"),value:"check"},{label:n("Run"),value:"run"}],placeholderText:n("Select job type")}),(0,z.jsx)(ih,{additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_inventory_on_launch"}),name:"inventory",isRequired:!m}),(0,z.jsx)(Ih,{name:"project",isRequired:!0}),(0,z.jsx)(ti,{name:"playbook",id:"playbook",labelHelpTitle:n("Playbook"),labelHelp:n("Select the playbook to be executed by this job."),placeholderText:n("Add a project, then select a playbook"),label:n("Playbook"),isRequired:!0,isDisabled:!i?.length,options:i?.map((e=>({label:e,value:e})))??[]}),c?.allow_override?(0,z.jsx)(li,{name:"scm_branch",placeholder:n("Add a source control branch"),labelHelpTitle:n("Source control branch"),labelHelp:n("Branch to use in job run. Project default used if blank. Only allowed if project allow_override field is set to true."),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_scm_branch_on_launch"}),label:n("Source control branch")}):null,(0,z.jsx)(Wp,{name:"execution_environment.id",organizationId:h,additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_execution_environment_on_launch"})}),(0,z.jsx)(Hp,{name:"credentials",additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_credential_on_launch"}),label:n("Credentials"),placeholder:n("Select credentials"),labelHelp:n('Select credentials for accessing the nodes this job will be ran against. You can only select one credential of each type. For machine credentials (SSH), checking "Prompt on launch" without selecting credentials will require you to select a machine credential at run time. If you select credentials and check "Prompt on launch", the selected credential(s) become the defaults that can be updated at run time.'),isMultiple:!0,queryParams:{credential_type__kind__in:dS.join(",")}}),(0,z.jsx)(Qp,{labelHelpTitle:n("Labels"),labelHelp:n('Optional labels that describe this job template, such as "dev" or "test". Labels can be used to group and filter job templates and completed jobs.'),name:"labels",additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_labels_on_launch"})}),(0,z.jsx)(li,{placeholder:n("Add number of forks"),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_forks_on_launch"}),name:"forks",labelHelpTitle:n("Forks"),labelHelp:n("The number of parallel or simultaneous processes to use while executing the playbook. An empty value, or a value less than 1 will use the Ansible default which is usually 5. The default number of forks can be overwritten with a change to ansible.cfg. Refer to the Ansible documentation for details about the configuration file."),type:"number",label:n("Forks")}),(0,z.jsx)(li,{placeholder:n("Add a limit to reduce number of hosts."),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_limit_on_launch"}),name:"limit",labelHelpTitle:n("Limit"),labelHelp:n("Provide a host pattern to further constrain the list of hosts that will be managed or affected by the playbook. Multiple patterns are allowed. Refer to Ansible documentation for more information and examples on patterns."),label:n("Limit")}),(0,z.jsx)(li,{placeholder:n("Select a verbosity value"),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_verbosity_on_launch"}),name:"verbosity",type:"number",labelHelpTitle:n("Verbosity"),labelHelp:n("Control the level of output Ansible will produce as the playbook executes."),label:n("Verbosity")}),(0,z.jsx)(li,{placeholder:n("Add a job slicing value"),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_job_slice_count_on_launch"}),labelHelpTitle:n("Job slicing"),labelHelp:n("Divide the work done by this job template into the specified number of job slices, each running the same tasks against a portion of the inventory."),name:"job_slice_count",type:"number",label:n("Job slicing")}),(0,z.jsx)(li,{placeholder:n("Add a timeout value"),type:"number",labelHelpTitle:n("Timeout"),labelHelp:n("The amount of time (in seconds) to run before the job is canceled. Defaults to 0 for no job timeout."),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_timeout_on_launch"}),name:"timeout",label:n("Timeout")}),(0,z.jsx)(ni,{id:"show-changes",name:"diff_mode",label:n("Show changes"),labelHelpTitle:n("Show changes"),labelHelp:n("If enabled, show the changes made by Ansible tasks, where supported. This is equivalent to Ansible's --diff mode."),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_diff_mode_on_launch"})}),(0,z.jsx)(Xp,{additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_instance_groups_on_launch"}),name:"instance_groups",labelHelp:n("Select the instance groups for this job template to run on.")}),(0,z.jsx)(Sp,{labelHelpTitle:n("Job tags"),labelHelp:n("Tags are useful when you have a large playbook, and you want to run a specific part of a play or task. Use commas to separate multiple tags. Refer to the documentation for details on the usage of tags."),name:"job_tags",additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_tags_on_launch"}),placeholderText:n("Select or create job tags"),label:n("Job tags"),options:t?.job_tags??[{value:"",label:"",name:""}]}),(0,z.jsx)(Sp,{labelHelpTitle:n("Skip tags"),labelHelp:n("Skip tags are useful when you have a large playbook, and you want to skip specific parts of a play or task. Use commas to separate multiple tags. Refer to the documentation for details on the usage of tags."),additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_skip_tags_on_launch"}),name:"skip_tags",placeholderText:n("Select or create skip tags"),label:n("Skip tags"),options:t?.skip_tags??[{value:"",label:"",name:""}]}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{additionalControls:(0,z.jsx)(go,{label:n("Prompt on launch"),name:"ask_variables_on_launch"}),labelHelpTitle:n("Extra Variables"),labelHelp:n("Optional extra variables to be applied to job template."),format:"yaml",label:n("Extra variables"),name:"extra_vars"})}),(0,z.jsx)(go,{label:n("Privilege escalation"),name:"become_enabled"}),(0,z.jsx)(go,{label:n("Provisioning callback"),name:"isProvisioningCallbackEnabled"}),(0,z.jsx)(go,{label:n("Enable webhook"),name:"isWebhookEnabled"}),(0,z.jsx)(go,{label:n("Concurrent jobs"),name:"allow_simultaneous"}),(0,z.jsx)(go,{label:n("Enable fact storage"),name:"use_fact_cache"}),(0,z.jsx)(go,{label:n("Prevent instance group fallback"),name:"prevent_instance_group_fallback"}),d?(0,z.jsxs)(jd.y,{title:n("Provisioning callback details"),children:[t?.related.callback?(0,z.jsx)(li,{name:"related.callback",isDisabled:!0,placeholder:n("Add a callback URL"),label:n("Provisioning callback URL")}):null,(0,z.jsx)(li,{name:"host_config_key",placeholder:n("Add a host config key"),isRequired:!!d,label:n("Host config key")})]}):null,u?(0,z.jsx)(cS,{templateType:"job_templates"}):null]})}function mS(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.g)(),a=Number(n.id),{data:s,error:o,refresh:i,isLoading:r}=ec(xl`/job_templates/${a.toString()}/`),{data:c,error:d,isLoading:u,refresh:m}=ec(xl`/job_templates/${a.toString()}/instance_groups/`),p=(0,l.useMemo)((()=>ym(e,s,c?.results??[])),[e,s,c]),{cache:h}=(0,_e.iX)(),b=gr(),f=o||d;return f instanceof Error?(0,z.jsx)(Ic,{error:f,handleRefresh:o?i:m}):r||u?(0,z.jsx)(zr,{}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s?.name?e("Edit {{jobtemplateName}}",{jobtemplateName:s?.name}):e("Job Template"),breadcrumbs:[{label:e("Templates"),to:b(fc.Templates)},{label:s?.name?e("Edit {{jobtemplateName}}",{jobtemplateName:s?.name}):e("Job Template")}]}),(0,z.jsx)(nd,{submitText:e("Save job template"),onSubmit:async e=>{const{credentials:n,labels:o,instance_groups:i,webhook_key:r,webhook_url:l,isProvisioningCallbackEnabled:c,isWebhookEnabled:d,host_config_key:u,...m}=e,p={...m,project:e.project.id,execution_environment:e.execution_environment?.id||null,inventory:e.inventory?.id||null,job_tags:jm(e.job_tags)??"",skip_tags:jm(e.skip_tags)??"",webhook_credential:e.webhook_credential||null,webhook_service:d?e.webhook_service:null,host_config_key:c?u:null};await sl(xl`/job_templates/${a.toString()}/`,p),h.clear?.();const b=[];b.push(hS(s,n)),b.push(bS(s,o)),b.push(fS(a,i)),await Promise.all(b),t(fc.JobTemplateDetails,{params:{id:a}})},onCancel:()=>t(fc.JobTemplateDetails,{params:{id:a}}),defaultValue:p,children:(0,z.jsx)(uS,{jobtemplate:p})})]})}function pS(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=td(),s=(0,l.useMemo)((()=>ym(e,{})),[e]),o=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create job template"),breadcrumbs:[{label:e("Templates"),to:o(fc.Templates)},{label:e("Create job template")}]}),(0,z.jsx)(nd,{submitText:e("Create job template"),onSubmit:async e=>{const{credentials:t,labels:s,instance_groups:o,webhook_key:i,webhook_url:r,...l}=e,c={...l,project:e.project.id,execution_environment:e.execution_environment?.id?e.execution_environment?.id:null,inventory:e.inventory?.id||null,job_tags:jm(e.job_tags)??"",skip_tags:jm(e.skip_tags)??"",webhook_credential:e.webhook_credential||null},d=await a(xl`/job_templates/`,c),u=[];t?.length>0&&u.push(hS(d,t)),s&&s?.length>0&&u.push(bS(d,s)),o.length>0&&u.push(fS(d.id,o)),u.length>0&&await Promise.all(u),n(fc.JobTemplateDetails,{params:{id:d.id}})},onCancel:()=>t(-1),defaultValue:s,children:(0,z.jsx)(uS,{})})]})}async function hS(e,t){const{added:n,removed:a}=dm(e?.summary_fields?.credentials??[],t),s=a.map((t=>al(xl`/job_templates/${e?.id?.toString()}/credentials/`,{id:t.id,disassociate:!0}))),o=await Promise.all(s),i=n.map((t=>al(xl`/job_templates/${e?.id?.toString()}/credentials/`,{id:t.id}))),r=await Promise.all(i);return Promise.all([o,r])}async function bS(e,t){const{added:n,removed:a}=dm(e.summary_fields?.labels?.results||[],t??[]);let s=e.summary_fields?.organization?.id;if(!e.summary_fields?.organization?.id)try{const e=await nl(xl`/organizations/`);s=e.results[0].id}catch(e){throw e}const o=a.map((t=>al(xl`/job_templates/${e.id.toString()}/labels/`,{id:t.id,disassociate:!0}))),i=n.map((t=>al(xl`/job_templates/${e.id.toString()}/labels/`,{name:t.name,organization:s})));return await Promise.all([...o,...i])}async function fS(e,t){const n=await nl(xl`/job_templates/${e.toString()}/instance_groups/`);if(a=t,s=n.results,a.length!==s.length||!a.every(((e,t)=>e.id===s[t].id))){for(const t of n.results)await al(xl`/job_templates/${e.toString()}/instance_groups/`,{id:t.id,disassociate:!0});for(const n of t)await await al(xl`/job_templates/${e.toString()}/instance_groups/`,{id:n.id})}var a,s}const gS=A.Ay.span.withConfig({componentId:"ans__sc-d8iy9w-0"})(["color:",";"],E("danger")),yS=()=>{const{t:e}=(0,I.Bd)();return(0,z.jsx)(gS,{children:e`Deleted`})};function xS(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),s=e?.templateId?e.templateId:n.id,{error:o,data:i,refresh:r}=tc(xl`/job_templates`,s),l=function(e){const{data:t}=ec(xl`/job_templates/${e}/instance_groups/`);return t?.results??[]}(s||"0"),c=gr(),d=(0,Re.Zp)(),u=tp(i?.verbosity);if(o)return(0,z.jsx)(Ic,{error:o,handleRefresh:r});if(!i)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const{summary_fields:m,ask_inventory_on_launch:p}=i,h=i.become_enabled||i.host_config_key||i.allow_simultaneous||i.use_fact_cache||i.webhook_service||i.prevent_instance_group_fallback;return(0,z.jsxs)(Mt,{disableScroll:e.disableScroll,children:[(0,z.jsx)(Ft,{label:t("Name"),children:e.templateId?(0,z.jsx)(a.N_,{to:c(fc.JobTemplateDetails,{params:{id:e.templateId}}),children:i.name}):i.name}),(0,z.jsx)(Ft,{label:t("Description"),children:i.description}),(0,z.jsx)(Ft,{label:t("Job type"),helpText:t("For job templates, select run to execute the playbook. Select check to only check playbook syntax, test environment setup, and report problems without executing the playbook."),children:i.job_type}),(0,z.jsx)(Ft,{label:t("Organization"),children:m.organization?(0,z.jsx)(a.N_,{to:c(fc.OrganizationDetails,{params:{id:i.summary_fields?.organization?.id}}),children:m.organization?.name}):(0,z.jsx)(yS,{})}),(0,z.jsx)(Ft,{label:t("Inventory"),isEmpty:!m.inventory&&p,helpText:t("Select the inventory containing the hosts you want this job to manage."),children:m.inventory?(0,z.jsx)(a.N_,{to:c(fc.InventoryDetails,{params:{id:m.inventory?.id,inventory_type:{"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"}[m.inventory?.kind]}}),children:m.inventory?.name}):(0,z.jsx)(yS,{})}),(0,z.jsx)(Ft,{label:t`Project`,helpText:t("Select the project containing the playbook you want this job to execute."),children:m.project?(0,z.jsx)(a.N_,{to:c(fc.ProjectDetails,{params:{id:m.project?.id}}),children:m.project?.name}):(0,z.jsx)(yS,{})}),(0,z.jsx)(Ft,{label:t`Execution environment`,isEmpty:!m.resolved_environment,helpText:t("The execution environment that will be used when launching this job template. The resolved execution environment can be overridden by explicitly assigning a different one to this job template."),children:(0,z.jsx)(a.N_,{to:c(fc.ExecutionEnvironmentDetails,{params:{id:m.resolved_environment?.id}}),children:m.resolved_environment?.name})}),(0,z.jsx)(Ft,{label:t("Source control branch"),children:i.scm_branch}),(0,z.jsx)(Ft,{label:t("Playbook"),helpText:t("Select the playbook to be executed by this job."),children:i.playbook}),(0,z.jsx)(Ft,{label:t("Credentials"),isEmpty:!m.credentials?.length,children:(0,z.jsx)(De.o,{children:m.credentials?.map((e=>(0,z.jsx)(uu,{credential:e},e.id)))})}),(0,z.jsx)(Ft,{label:t`Instance groups`,helpText:t`The instance groups for this job template to run on.`,isEmpty:!l?.length,children:(0,z.jsx)(De.o,{children:l?.map((e=>(0,z.jsx)(Ee.J,{color:"blue",children:(0,z.jsx)(a.N_,{to:c(fc.InstanceGroupDetails,{params:{id:e.id}}),children:e.name})},e.id)))})}),(0,z.jsx)(Ft,{label:t("Forks"),helpText:(0,z.jsxs)("span",{children:[t("The number of parallel or simultaneous processes to use while executing the playbook. An empty value, or a value less than 1 will use the Ansible default which is usually 5. The default number of forks can be overwritten with a change to")," ",(0,z.jsx)("code",{children:"ansible.cfg"}),"."," ",t("Refer to the Ansible documentation for details about the configuration file.")]}),children:i.forks||0}),(0,z.jsx)(Ft,{label:t("Limit"),children:i.limit}),(0,z.jsx)(Ft,{label:t("Verbosity"),helpText:t("Control the level of output Ansible will produce as the playbook executes."),children:u}),(0,z.jsx)(Ft,{label:t("Timeout"),helpText:t("The amount of time (in seconds) to run before the job is canceled. Defaults to 0 for no job timeout."),children:i.timeout||0}),(0,z.jsx)(Ft,{label:t("Show changes"),helpText:t("If enabled, show the changes made by Ansible tasks, where supported. This is equivalent to Ansible's --diff mode."),children:i.diff_mode?t`On`:t`Off`}),(0,z.jsx)(Ft,{label:t("Job slicing"),helpText:t("Divide the work done by this job template into the specified number of job slices, each running the same tasks against a portion of the inventory."),children:i.job_slice_count}),(0,z.jsx)(Ft,{label:t("Host config key"),children:i.host_config_key}),(0,z.jsx)(Ft,{label:t("Provisioning callback URL"),isEmpty:!i.host_config_key,children:`${window.location.origin} ${i.url}callback/`}),(0,z.jsx)(Ft,{label:t("Webhook service"),isEmpty:!i.webhook_service,children:(0,z.jsx)(rp,{service:i.webhook_service})}),m.webhook_credential&&(0,z.jsx)(Ft,{label:t("Webhook credential"),isEmpty:!m.webhook_credential,children:(0,z.jsx)(uu,{credential:m?.webhook_credential})}),(0,z.jsx)(C_,{label:t("Created"),date:i.created,user:i.summary_fields.created_by}),(0,z.jsx)(Xd,{value:i.modified,author:i.summary_fields.modified_by?.username,onClick:()=>d(c(fc.UserDetails,{params:{id:(i.summary_fields?.modified_by?.id??0).toString()}}))}),(0,z.jsx)(Ft,{label:t("Labels"),isEmpty:!m.labels?.results?.length,children:(0,z.jsx)(De.o,{children:m.labels?.results?.map((e=>(0,z.jsx)(Ee.J,{children:e.name},e.id)))})}),(0,z.jsx)(Ft,{label:t("Job tags"),isEmpty:!i.job_tags,children:(0,z.jsx)(De.o,{children:i.job_tags.split(",")?.map((e=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{label:t("Skip tags"),isEmpty:!i.skip_tags,children:(0,z.jsx)(De.o,{children:i.skip_tags.split(",")?.map((e=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Wu,{label:t("Extra variables"),value:i.extra_vars,helpText:t("Pass extra command line variables to the playbook. This is the -e or --extra-vars command line parameter for ansible-playbook. Provide key/value pairs using either YAML or JSON. Refer to the documentation for example syntax.")}),(0,z.jsx)(Ft,{label:t("Enabled options"),isEmpty:!h,helpText:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{children:t`Concurrent jobs: If enabled, simultaneous runs of this job template will be allowed.`}),(0,z.jsx)("p",{children:t`Fact storage: If enabled, this will store gathered facts so they can be viewed at the host level. Facts are persisted and injected into the fact cache at runtime.`}),(0,z.jsx)("p",{children:t`Privilege escalation: If enabled, run this playbook as an administrator.`}),(0,z.jsx)("p",{children:t`Provisioning callbacks: Enables creation of a provisioning callback URL. Using the URL a host can contact Ansible AWX and request a configuration update using this job template.`}),(0,z.jsx)("p",{children:t`Webhooks: Enable webhook for this template.`}),(0,z.jsx)("p",{children:t`Prevent Instance Group Fallback: If enabled, the job template will prevent adding any inventory or organization instance groups to the list of preferred instances groups to run on.`})]}),children:(0,z.jsxs)(Yl.K,{component:Yl.C.ul,children:[i.become_enabled&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Privilege Escalation`}),i.host_config_key&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Provisioning Callbacks`}),i.allow_simultaneous&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Concurrent jobs`}),i.use_fact_cache&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Fact storage`}),i.webhook_service&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Webhooks`}),i.prevent_instance_group_fallback&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Prevent instance group fallback`})]})})]})}function jS(e){const{setWizardData:t}=vr();return(0,l.useEffect)((()=>{t((t=>{const n=t?.prompt&&Object.entries(t?.prompt)?.length;return{...e.defaultValues,prompt:n?t.prompt:e.defaultValues.prompt}}))}),[t,e.defaultValues]),(0,z.jsx)(ch,{})}const _S={job_type:"ask_job_type_on_launch",inventory:"ask_inventory_on_launch",credentials:"ask_credential_on_launch",execution_environment:"ask_execution_environment_on_launch",instance_groups:"ask_instance_groups_on_launch",scm_branch:"ask_scm_branch_on_launch",forks:"ask_forks_on_launch",diff_mode:"ask_diff_mode_on_launch",job_slice:"ask_job_slice_count_on_launch",labels:"ask_labels_on_launch",limit:"ask_limit_on_launch",skip_tags:"ask_skip_tags_on_launch",job_tags:"ask_tags_on_launch",timeout:"ask_timeout_on_launch",extra_vars:"ask_variables_on_launch",verbosity:"ask_verbosity_on_launch"};function vS({jobType:e}){const{t}=(0,I.Bd)(),n=td(),a=function(){const{t:e}=(0,I.Bd)(),t=ue(),n=td();return(0,l.useCallback)((async(a,s)=>{let o=[],i=s?.summary_fields?.organization?.id;const r=a.filter((e=>e.id)),l=a.filter((e=>!e.id));try{i||(i=(await nl(xl`/organizations/`)).results[0].id);const e=[];for(const t of l||[])e.push(n(xl`/labels/`,{name:t.name,organization:i}));o=await Promise.all(e)}catch(n){t.addAlert({variant:"danger",title:e("Failed to create new label"),children:n instanceof Error&&n.message})}return[...r,...o].map((e=>e.id)).filter((e=>"number"==typeof e&&!isNaN(e)))}),[e,t,n])}(),s=ue(),o=(0,Re.Zp)(),i=(0,Re.g)(),r=i.id?.toString()??"",{data:c,error:d,refresh:u}=ec(xl`/${e}/${r}/`),{data:m,error:p,refresh:h}=ec(xl`/${e}/${r}/launch/`),b=d||p,f=u||h,g=Ah();return b?(0,z.jsx)(Ic,{error:b,handleRefresh:f}):m&&c?(0,z.jsx)(wS,{template:c,config:m,handleSubmit:async i=>{if(i){const{credential_passwords:l={},prompt:d,survey:u}=i;try{const t=await a(d?.labels||[],c);let s={};const i=(t,n)=>{null!=n&&("workflow_job_templates"!==e||m[_S[t]]||m.survey_enabled)&&(s[t]=n)};if(void 0!==d&&(i("credentials",(d?.credentials||[]).map((e=>Number(e.id)))),i("credential_passwords",l),i("diff_mode",d.diff_mode),d?.execution_environment&&i("execution_environment",d.execution_environment),i("extra_vars",d?.extra_vars),i("forks",d?.forks),i("instance_groups",d.instance_groups?.map((({id:e})=>e))),d.inventory?.id&&i("inventory",d.inventory?.id),i("job_slice_count",d.job_slice_count),i("job_tags",d.job_tags?.map((e=>e.name)).join(",")),i("job_type",d.job_type),i("limit",d.limit),i("scm_branch",d.scm_branch),i("skip_tags",d.skip_tags?.map((e=>e.name)).join(",")),i("timeout",d.timeout),i("verbosity",d.verbosity)),t.length>0&&i("labels",t),m.survey_enabled&&"job_templates"===e&&i("extra_vars",{...d?.extra_vars?JSON.parse(im(d?.extra_vars)):{},...u}),"workflow_job_templates"===e){const e=d?.extra_vars?JSON.parse(im(d?.extra_vars)):{};s={...s,extra_vars:{...e,...u}}}const p=await n(xl`/${e}/${r}/launch/`,s);p&&o(g(p))}catch(e){s.addAlert({variant:"danger",title:t("Failure to launch"),children:e instanceof Error&&e.message})}}},jobType:e}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function wS({template:e,config:t,handleSubmit:n,jobType:a}){const{t:s}=(0,I.Bd)(),o=gr(),{defaults:i}=t,r=i?.labels?.map((e=>({...e,isReadOnly:!0}))),l={resource:e,credential_passwords:{},prompt:{inventory:i.inventory.id?i.inventory:null,credentials:i?.credentials,execution_environment:i.execution_environment?.id,instance_groups:i.instance_groups,diff_mode:i.diff_mode,scm_branch:i.scm_branch,extra_vars:i.extra_vars,forks:i.forks,job_slice_count:i.job_slice_count,job_tags:xm(i.job_tags),job_type:i.job_type,labels:r,limit:i.limit,skip_tags:xm(i.skip_tags),timeout:i.timeout,verbosity:i.verbosity},launch_config:t,survey:{}},c=function(e){return e&&"inputs"in e&&"vault_id"in e.inputs?e.inputs.vault_id:e&&"vault_id"in e?e.vault_id:void 0},d=[{id:"nodePromptsStep",label:s("Prompts"),inputs:(0,z.jsx)(jS,{defaultValues:l}),hidden:()=>km(t),validate:async t=>{const n=[];await nl(xl`/job_templates/${e.id?.toString()}/credentials/`).then((({results:e})=>{const{prompt:{credentials:a}}=t;if(e.length>0&&a&&e.forEach((e=>{a.find((t=>{const n=c(t),a=c(e);return t?.credential_type===e?.credential_type&&!n&&!a||a&&n===a}))||n.push(e?.inputs?.vault_id?`${e?.summary_fields.credential_type.name} | ${e.inputs.vault_id}`:e?.summary_fields.credential_type.name)})),n.length>0){const e={__all__:[s(`Job Template default credentials must be replaced with one of the same type.  Please select a credential for the following types in order to proceed: ${n.join(", ")}`)]};throw new Xr("","",400,"",e)}}))}},{id:"credential_passwords",label:s("Credential Passwords"),hidden:e=>{const{prompt:n={}}=e;if(!n&&!t)return!0;const a="credentials"in n?e?.prompt?.credentials:t.defaults.credentials,s=t.ask_credential_on_launch,o=t.passwords_needed_to_start?.length>0;if(!s&&o)return!1;const i=a?.some((e=>{if(!e.inputs){const n=t.defaults.credentials?.find((t=>JSON.stringify(t.id)===JSON.stringify(e.id)));return n&&n?.passwords_needed?.length>0}return["password","become_password","ssh_key_unlock","vault_password"].some((t=>"ASK"===e.inputs?.[t]))}));return!i},inputs:(0,z.jsx)(xw,{config:t})},{id:"survey",label:s("Survey"),hidden:()=>!t?.survey_enabled,inputs:(0,z.jsx)(Wh,{jobType:a,templateId:e.id.toString()})},{id:"review",label:s("Review"),element:(0,z.jsx)(jw,{template:e})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:s("Prompt on Launch"),breadcrumbs:[{label:s("Templates"),to:o(fc.Templates)},{label:e.name,to:o(fc.JobTemplateDetails,{params:{id:e.id}})}]}),(0,z.jsx)(Lr,{steps:d,defaultValue:l,onSubmit:n,errorAdapter:Mc})]})}function kS(){const{t:e}=(0,I.Bd)(),t=Tg("job_template+workflow_job_template+workflow_job_template_node"),{activeAwxUser:n}=_l(),a=(0,Re.g)(),{error:s,data:o,isLoading:i,refresh:r}=tc(xl`/job_templates`,a.id),{data:c,error:d,refresh:u,isLoading:m}=ec(xl`/organizations/?role_level=notification_admin_role`),p=gr(),h=yr(),b=Lg({onTemplatesDeleted:()=>h(fc.Templates)}),f=d||s,g=(0,l.useMemo)((()=>{const t=[{label:e("Details"),page:fc.JobTemplateDetails},{label:e("Team Access"),page:fc.JobTemplateTeamAccess},{label:e("User Access"),page:fc.JobTemplateUserAccess},{label:e("Schedules"),page:fc.JobTemplateSchedules},{label:e("Jobs"),page:fc.JobTemplateJobs},{label:e("Survey"),page:fc.JobTemplateSurvey}];return(n?.is_system_auditor||c&&c.results.length>0)&&t.push({label:e("Notifications"),page:fc.JobTemplateNotifications}),t}),[e,n,c]);return f?(0,z.jsx)(Ic,{error:f,handleRefresh:r||u}):i||m?(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name,breadcrumbs:[{label:e("Templates"),to:p(fc.Templates)},{label:o?.name}],headerActions:(0,z.jsx)(oe,{actions:[...t,...b],position:te.nU.right,selectedItem:o})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Templates"),page:fc.Templates,persistentFilterKey:"templates"},tabs:g,params:{id:o?.id},componentParams:{template:o}})]})}function SS(){const{t:e}=(0,I.Bd)();Fc("templates");const t=sc();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Templates"),titleHelpTitle:e("Templates"),titleHelp:e("A job template is a definition and set of parameters for running an Ansible job. Job templates are useful to execute the same job many times. Job templates also encourage the reuse of Ansible playbook content and collaboration between teams."),titleDocLink:pc(t,"templates"),description:e("A job template is a definition and set of parameters for running an Ansible job."),headerActions:(0,z.jsx)(cd,{type:"job_template+workflow_job_template+workflow_job_template_node"})}),(0,z.jsx)(Og,{url:xl`/unified_job_templates/`})]})}function CS(e){const{workflowJobTemplate:t}=e,{setValue:n}=(0,oo.xW)(),a=(0,oo.FH)({name:"isWebhookEnabled"});(0,l.useEffect)((()=>{a||(n("webhook_service",void 0),n("webhook_credential",null))}),[a,n]);const{t:s}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"name",label:s("Name"),isRequired:!0,placeholder:s("Add a name for this workflow job template")}),(0,z.jsx)(li,{name:"description",label:s("Description"),placeholder:s("Add a description for this workflow job template")}),(0,z.jsx)(sg,{name:"organization"}),(0,z.jsx)(ih,{additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_inventory_on_launch"}),name:"inventory"}),(0,z.jsx)(li,{placeholder:s("Add a limit to reduce number of hosts."),additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_limit_on_launch"}),name:"limit",labelHelpTitle:s("Limit"),labelHelp:s("Provide a host pattern to further constrain the list of hosts that will be managed or affected by the playbook. Multiple patterns are allowed. Refer to Ansible documentation for more information and examples on patterns."),label:s("Limit")}),(0,z.jsx)(li,{name:"scm_branch",placeholder:s("Add a source control branch"),labelHelpTitle:s("Source control branch"),labelHelp:s("Branch to use in job run. Project default used if blank. Only allowed if project allow_override field is set to true."),additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_scm_branch_on_launch"}),label:s("Source control branch")}),(0,z.jsx)(Qp,{labelHelpTitle:s("Labels"),labelHelp:s("Optional labels that describe this job template, such as 'dev' or 'test'. Labels can be used to group and filter job templates and completed jobs."),name:"labels",additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_labels_on_launch"})}),(0,z.jsx)(Sp,{labelHelpTitle:s("Job tags"),labelHelp:s("Tags are useful when you have a large playbook, and you want to run a specific part of a play or task. Use commas to separate multiple tags. Refer to the documentation for details on the usage of tags."),name:"job_tags",additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_tags_on_launch"}),placeholderText:s("Select or create job tags"),label:s("Job tags"),options:t?.job_tags??[{value:"",label:""}]}),(0,z.jsx)(Sp,{labelHelpTitle:s("Skip tags"),labelHelp:s("Skip tags are useful when you have a large playbook, and you want to skip specific parts of a play or task. Use commas to separate multiple tags. Refer to the documentation for details on the usage of tags."),additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_skip_tags_on_launch"}),name:"skip_tags",placeholderText:s("Select or create skip tags"),label:s("Skip tags"),options:t?.skip_tags??[{value:"",label:""}]}),(0,z.jsx)(_d,{singleColumn:!0,children:(0,z.jsx)(Go,{additionalControls:(0,z.jsx)(go,{label:s("Prompt on launch"),name:"ask_variables_on_launch"}),labelHelpTitle:s("Extra Variables"),labelHelp:s("Optional extra variables to be applied to job template."),format:"yaml",label:s("Extra variables"),name:"extra_vars"})}),(0,z.jsxs)(_d,{title:s("Options"),children:[(0,z.jsx)(go,{label:s("Enable webhook"),name:"isWebhookEnabled"}),(0,z.jsx)(go,{label:s("Enable concurrent jobs"),name:"allow_simultaneous"})]}),a?(0,z.jsx)(cS,{templateType:"workflow_job_templates"}):null]})}function TS(){const{t:e}=(0,I.Bd)(),t=yr(),n=gr(),a=(0,Re.g)(),s=Number(a.id),{data:o,error:i,refresh:r,isLoading:c}=ec(xl`/workflow_job_templates/${s.toString()}/`),d=(0,l.useMemo)((()=>{if(o)return{allow_simultaneous:o.allow_simultaneous||!1,ask_inventory_on_launch:o.ask_inventory_on_launch||!1,ask_labels_on_launch:o.ask_labels_on_launch||!1,ask_limit_on_launch:o.ask_limit_on_launch||!1,ask_scm_branch_on_launch:o.ask_scm_branch_on_launch||!1,ask_skip_tags_on_launch:o.ask_skip_tags_on_launch||!1,ask_tags_on_launch:o.ask_tags_on_launch||!1,ask_variables_on_launch:o.ask_variables_on_launch||!1,description:o.description||"",extra_vars:o.extra_vars||"---",inventory:o.summary_fields.inventory||null,isWebhookEnabled:Boolean(o.related?.webhook_receiver),job_tags:xm(o.job_tags||""),organization:o?.organization||null,labels:o.summary_fields?.labels?.results||[],limit:o.limit||"",name:o.name||"",scm_branch:o.scm_branch||"",skip_tags:xm(o.skip_tags||""),webhook_credential:o.summary_fields.webhook_credential||null,webhook_key:e("a new webhook key will be generated on save.").toUpperCase(),webhook_url:o.related?.webhook_receiver?`${document.location.origin}${o.related.webhook_receiver}`:e("a new webhook url will be generated on save.").toUpperCase(),webhook_receiver:o.related.webhook_receiver,webhook_service:o.webhook_service||""}}),[e,o]),{cache:u}=(0,_e.iX)();return i instanceof Error?(0,z.jsx)(Ic,{error:i,handleRefresh:r}):c?(0,z.jsx)(zr,{}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name?e("Edit {{workflowjobtemplateName}}",{workflowjobtemplateName:o?.name}):e("Workflow Job Template"),breadcrumbs:[{label:e("Templates"),to:n(fc.Templates)},{label:o?.name?e("Edit {{workflowjobtemplateName}}",{workflowjobtemplateName:o?.name}):e("Workflow Job Template")}]}),(0,z.jsx)(nd,{submitText:e("Save workflow job template"),onSubmit:async e=>{const{labels:n,...a}=e;await sl(xl`/workflow_job_templates/${s.toString()}/`,{...a,inventory:e.inventory?.id||null,job_tags:jm(e.job_tags)??"",organization:e?.organization,skip_tags:jm(e.skip_tags)??"",webhook_credential:e.webhook_credential?.id||null,webhook_service:e.webhook_service||""}),u.clear?.(),await AS(o,n),t(fc.WorkflowJobTemplateDetails,{params:{id:s.toString()}})},onCancel:()=>t(fc.WorkflowJobTemplateDetails,{params:{id:s}}),defaultValue:d,children:(0,z.jsx)(CS,{workflowJobTemplate:d})})]})}function IS(){const{t:e}=(0,I.Bd)(),t=yr(),n=td(),a=(0,l.useMemo)((()=>({job_tags:xm("")||[],skip_tags:xm("")||[],extra_vars:"---\n",webhook_key:e("a new webhook key will be generated on save.").toUpperCase(),webhook_url:e("a new webhook url will be generated on save.").toUpperCase()})),[e]),s=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create workflow job template"),breadcrumbs:[{label:e("Templates"),to:s(fc.Templates)},{label:e("Create workflow job template")}]}),(0,z.jsx)(nd,{submitText:e("Create workflow job template"),onSubmit:async e=>{const{labels:a,webhook_credential:s,...o}=e,i=await n(xl`/workflow_job_templates/`,{...o,inventory:e.inventory?.id,job_tags:jm(e.job_tags||""),organization:e?.organization||void 0,skip_tags:jm(e.skip_tags||""),webhook_credential:s?.id??null});await AS(i,a),t(fc.WorkflowVisualizer,{params:{id:i.id.toString()}})},onCancel:()=>t(fc.Templates),defaultValue:a,children:(0,z.jsx)(CS,{})})]})}async function AS(e,t){const{added:n,removed:a}=dm(e.summary_fields?.labels?.results||[],t??[]);let s=e?.organization;if(!e.summary_fields?.organization?.id)try{const e=await nl(xl`/organizations/`);s=e.results[0].id}catch(e){throw e}const o=a.map((t=>al(xl`/workflow_job_templates/${e.id.toString()}/labels/`,{id:t.id,disassociate:!0}))),i=n.map((t=>al(xl`/workflow_job_templates/${e.id.toString()}/labels/`,{name:t.name,organization:s})));return await Promise.all([...o,...i])}function DS(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),s=e?.templateId?e.templateId:n.id,{data:o,error:i,refresh:r}=tc(xl`/workflow_job_templates/`,s),l=gr(),c=(0,Re.Zp)();if(i)return(0,z.jsx)(Ic,{error:i,handleRefresh:r});if(!o)return(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0});const{summary_fields:d}=o,u=o.allow_simultaneous||o.webhook_service;return(0,z.jsxs)(Mt,{disableScroll:e.disableScroll,children:[(0,z.jsx)(Ft,{label:t("Name"),children:e.templateId?(0,z.jsx)(a.N_,{to:l(fc.WorkflowJobTemplateDetails,{params:{id:e.templateId}}),children:o.name}):o.name}),(0,z.jsx)(Ft,{label:t("Description"),children:o.description}),(0,z.jsx)(Ft,{label:t("Organization"),isEmpty:!d.organization,children:(0,z.jsx)(a.N_,{to:l(fc.OrganizationDetails,{params:{id:d.organization?.id}}),children:d.organization?.name})}),(0,z.jsx)(Ft,{label:t("Inventory"),isEmpty:!d.inventory,children:d.inventory?(0,z.jsx)(a.N_,{to:l(fc.InventoryDetails,{params:{id:d.inventory?.id,inventory_type:{"":"inventory",smart:"smart_inventory",constructed:"constructed_inventory"}[d.inventory.kind]}}),children:d.inventory?.name}):null}),(0,z.jsx)(Ft,{label:t("Webhook service"),isEmpty:!o.webhook_service,children:(0,z.jsx)(rp,{service:o.webhook_service})}),d.webhook_credential&&(0,z.jsx)(Ft,{label:t("Webhook credential"),isEmpty:!d.webhook_credential,children:(0,z.jsx)(uu,{credential:d?.webhook_credential})}),(0,z.jsx)(C_,{label:t("Created"),date:o.created,user:o.summary_fields.created_by}),(0,z.jsx)(Xd,{value:o.modified,author:o.summary_fields.modified_by?.username,onClick:()=>c(l(fc.UserDetails,{params:{id:(o.summary_fields?.modified_by?.id??0).toString()}}))}),(0,z.jsx)(Ft,{label:t("Labels"),isEmpty:!d.labels?.results?.length,children:(0,z.jsx)(De.o,{children:d.labels.results.map((e=>(0,z.jsx)(Ee.J,{children:e.name},e.id)))})}),(0,z.jsx)(Ft,{label:t("Job tags"),isEmpty:!o.job_tags,children:(0,z.jsx)(De.o,{children:o.job_tags?.split(",").map((e=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Ft,{label:t("Skip tags"),isEmpty:!o.skip_tags,children:(0,z.jsx)(De.o,{children:o.skip_tags?.split(",").map((e=>(0,z.jsx)(Ee.J,{children:e},e)))})}),(0,z.jsx)(Wu,{label:t("Extra vars"),value:o.extra_vars}),(0,z.jsx)(Ft,{label:t("Enabled options"),isEmpty:!u,children:(0,z.jsxs)(Yl.K,{component:Yl.C.ul,children:[o.allow_simultaneous&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Concurrent jobs`}),o.webhook_service&&(0,z.jsx)(Kl.L,{component:Kl.D.li,children:t`Webhooks`})]})})]})}function ES(){const{t:e}=(0,I.Bd)(),t=Tg("job_template+workflow_job_template+workflow_job_template_node"),n=(0,Re.g)(),{activeAwxUser:a}=_l(),{error:s,data:o,isLoading:i,refresh:r}=tc(xl`/workflow_job_templates`,n.id),{data:c,error:d,refresh:u,isLoading:m}=ec(xl`/organizations/?role_level=notification_admin_role`),p=gr(),h=yr(),b=Lg({onTemplatesDeleted:()=>h(fc.Templates)}),f=d||s,g=(0,l.useMemo)((()=>[{label:e("Details"),page:fc.WorkflowJobTemplateDetails},{label:e("Team Access"),page:fc.WorkflowJobTemplateTeamAccess},{label:e("User Access"),page:fc.WorkflowJobTemplateUserAccess},{label:e("Schedules"),page:fc.WorkflowJobTemplateSchedules},{label:e("Jobs"),page:fc.WorkflowJobTemplateJobs},{label:e("Survey"),page:fc.WorkflowJobTemplateSurvey},!!(a?.is_system_auditor||c&&c.results.length>0)&&{label:e("Notifications"),page:fc.WorkflowJobTemplateNotifications}]),[e,a,c]);return f?(0,z.jsx)(Ic,{error:f,handleRefresh:r||u}):!o||i||m?(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0}):(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.name,breadcrumbs:[{label:e("Templates"),to:p(fc.Templates)},{label:o?.name}],headerActions:(0,z.jsx)(oe,{actions:[...t,...b],position:te.nU.right,selectedItem:o})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Templates"),page:fc.Templates,persistentFilterKey:"templates"},tabs:g,params:{id:o.id},componentParams:{template:o}})]})}function PS(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"workflowjobtemplate",addRolesRoute:fc.WorkflowJobTemplateAddTeams})}function RS(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"workflowjobtemplate",addRolesRoute:fc.WorkflowJobTemplateAddUsers})}function BS(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/workflow_job_templates/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{templateName}}.",{templateName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"workflowjobtemplate",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{templateName}}.",{templateName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Templates"),to:t(fc.Templates)},{label:s?.name,to:t(fc.WorkflowJobTemplateDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.WorkflowJobTemplateTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"workflowjobtemplate",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.WorkflowJobTemplateTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.WorkflowJobTemplateTeamAccess,{params:{id:s?.id}})},errorAdapter:Mc})]})}function FS(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/workflow_job_templates/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{templateName}}.",{templateName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"workflowjobtemplate",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{templateName}}.",{templateName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Templates"),to:t(fc.Templates)},{label:a?.name,to:t(fc.WorkflowJobTemplateDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.WorkflowJobTemplateUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"workflowjobtemplate",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.WorkflowJobTemplateUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.WorkflowJobTemplateUserAccess,{params:{id:a?.id}})},errorAdapter:Mc})]})}function NS(){const e=function(){const e=Xu();return(0,l.useCallback)(((t,n)=>{const a=t.getController().toModel(),s=t.getController();if(!(0,Dd.Lln)(n))return;a.edges||(a.edges=[]);const o=e(t.getId(),n.getId(),Zu.info);a.edges.push(o),t.setState({modified:!0}),s.setState({...s.getState(),modified:!0}),s.fromModel(a,!0),s.getGraph().layout()}),[e])}(),t=(0,l.useCallback)((e=>[(0,z.jsx)(ep,{element:e},"nodeContext")]),[]),n=function(){const e=(0,l.useCallback)((e=>{if(!e?.getGraph?.())return;const t=e.getGraph().getNodes(),n=e.getGraph().getEdges(),a=[...t],s={},o=[];n.forEach((t=>{"startNode"!==t.getSource().getId()&&(t.getSource().getId()===e.getId()&&o.push(t.getTarget().getId()),s[t.getTarget().getId()]||(s[t.getTarget().getId()]={parents:[],traversed:!1}),s[t.getTarget().getId()].parents.push(t.getSource().getId()))}));const i=e=>{s[e]&&!s[e].traversed&&(s[e].parents.forEach((e=>{o.push(e),i(e)})),s[e].traversed=!0)};i(e.getId()),o.filter(((e,t,n)=>t===n.indexOf(e))).forEach((e=>{a.forEach((t=>{t.getId()===e&&(0,Dd.XId)((()=>{t.setNodeShape(Dd.AG_.hexagon),t.setNodeStatus(Dd.zIx.danger)}))()}))}))}),[]);return(0,l.useCallback)(((t,n)=>{const a=t.isDragging(),s=t.getDropResult(),o=s?.getNodeStatus()||Dd.zIx.default,i=t.getItem();if(!a){const e=n.element;(0,Dd.XId)((()=>{e.setNodeShape(Dd.AG_.circle),e.setNodeStatus(Dd.zIx.default)}))()}return a&&e(i),{...n,canDrop:o!==Dd.zIx.danger,edgeDragging:a}}),[e])}(),a=(0,l.useCallback)((e=>({accept:e||[Dd.Inm,Dd.yS],collect:n})),[n]);return(0,l.useCallback)((()=>(0,Dd.M9A)(((t,n)=>{if((0,Dd.Lln)(n)&&n.getNodeStatus()!==Dd.zIx.danger){if(1===n.getTargetEdges().length){const e=n.getTargetEdges()[0];e.getSource().getId()===nm&&e.setVisible(!1)}e(t,n)}}))((0,Dd.l3U)(t)((0,Dd.Oos)(a(["connector-src-drop","connector-target-drop",Dd.yS]))((0,Dd.xTQ)((0,Dd.ROE)("node",!0,!0))((0,Dd.VMe)()(Km)))))),[e,t,a])}const $S=(0,A.I4)(Dd.tgn).withConfig({componentId:"ans__sc-10qx5oz-0"})([".pf-v5-c-divider{display:none;}"]),MS={nodes:[],edges:[],graph:{id:em,type:"graph",layout:"Dagre",visible:!1}},LS=({data:{workflowNodes:e=[],template:t}})=>{const{t:n}=(0,I.Bd)(),a=(0,l.useCallback)((e=>{Object.keys(e?.elements).filter((e=>e.endsWith("-unsavedNode"))).forEach((t=>{const n=e.getElementById(t);n&&(0,Dd.XId)((()=>{n.setId(t),e.removeElement(n)}))()}))}),[]),s=Xu(),o=NS(),i=(0,l.useCallback)((t=>e.find((e=>e.id.toString()===t[0]))),[e]),r=(0,l.useCallback)((e=>[(0,z.jsx)(Zm,{element:e},"edgeContext")]),[]),c=(0,l.useCallback)(((e,t)=>{if("group"===t)return Dd.b7q;switch(e){case Dd.g9r.graph:return(0,Dd.LY3)()((0,Dd.VMe)()(Dd.uJG));case Dd.g9r.node:return o();case Dd.g9r.edge:return(0,Dd.l3U)(r)((0,Dd.VMe)()(qm));default:return}}),[o,r]),d=(0,l.useCallback)((()=>{const e=new Dd.Dib;return e.setFitToScreenOnLayout(!0),e.registerComponentFactory(c),e.registerLayoutFactory(((e,t)=>new Dd.mCS(t,{edgesep:100,marginx:20,marginy:20,rankdir:"LR",ranker:"network-simplex",ranksep:200}))),e.fromModel(MS,!1),e.addEventListener(Dd.oqJ,i),e}),[c,i]),u=(0,l.useRef)(d()).current;return(0,l.useEffect)((()=>{const t=[],o={id:nm,type:nm,label:n("Start"),width:tm,height:tm,data:{resource:{always_nodes:[]}}},i=e.map((e=>{const a=e.id.toString(),o=wm(e.summary_fields?.unified_job_template?.name||"",e.identifier)||n("Deleted");e.success_nodes.forEach((e=>{t.push(s(a,e.toString(),Zu.success))})),e.failure_nodes.forEach((e=>{t.push(s(a,e.toString(),Zu.danger))})),e.always_nodes.forEach((e=>{t.push(s(a,e.toString(),Zu.info))}));const i={id:a,type:"node",label:o,width:tm,height:tm,shape:Dd.AG_.circle,status:Dd.zIx.default,labelPosition:Dd.G5S.bottom,data:{resource:e}};return e.all_parents_must_converge?{...i,data:{...i.data,...ob}}:i})),r=t.map((e=>e.target)),l=i?.filter((e=>!r.includes(e.id)&&e.id!==nm));l.forEach((e=>{t.push(s(nm,e.id,Zu.info))}));const c={edges:t,nodes:[o,...i],graph:{id:em,type:"graph",layout:"Dagre",visible:!0}};a(u),u.fromModel(c,!0),u.getGraph().reset(),u.getGraph().layout()}),[n,u,s,e,a]),(0,z.jsx)(Dd.Uk6,{controller:u,children:(0,z.jsx)(Em,{children:(0,z.jsx)(Dm.Consumer,{children:({isFullScreen:e,isEmpty:a,isLegendOpen:s,toggleLegend:o,sidebarMode:i})=>(0,z.jsx)($S,{"data-cy":"workflow-visualizer",contextToolbar:e?null:(0,z.jsx)(gb,{}),viewToolbar:(0,z.jsx)(yb,{}),controlBar:!a&&(0,z.jsx)(Dd.Ug7,{controlButtons:(0,Dd.ks9)({...Dd.q7Z,zoomInCallback:(0,Dd.XId)((()=>{u.getGraph().scaleBy(4/3)})),zoomOutCallback:(0,Dd.XId)((()=>{u.getGraph().scaleBy(.75)})),fitToScreenCallback:(0,Dd.XId)((()=>{u.getGraph().fit(80)})),resetViewCallback:(0,Dd.XId)((()=>{u.getGraph().reset(),u.getGraph().layout()})),legend:!0,legendCallback:o})}),sideBarOpen:void 0!==i,sideBarResizable:!0,sideBar:(0,z.jsx)(db,{}),minSideBarSize:"50%",children:a?(0,z.jsx)("div",{style:{flex:"1 0 100%"},children:(0,z.jsx)(es,{button:(0,z.jsx)(Bm,{variant:"primary"}),title:n("There are currently no nodes in this workflow"),description:n("Add a node by clicking the button below")})}):(0,z.jsxs)(z.Fragment,{children:[s&&(0,z.jsx)(Qm,{}),(0,z.jsx)(Dd.AUs,{state:{workflowTemplate:t,RBAC:{edit:t.summary_fields.user_capabilities.edit,start:t.summary_fields.user_capabilities.start}}})]})})})})})};function OS(){const{t:e}=(0,I.Bd)(),{id:t}=(0,Re.g)(),{results:n,error:a,isLoading:s,refresh:o}=cm(xl`/workflow_job_templates/${t??""}/workflow_nodes/`),{data:i,error:r,refresh:l,isLoading:c}=tc(xl`/workflow_job_templates/`,t),d=r||a;return d?(0,z.jsx)(Ic,{error:d,handleRefresh:l||o}):c||s||!i||!n?(0,z.jsx)(Un.a,{children:(0,z.jsx)(rn.p,{children:(0,z.jsx)(ln.o,{titleText:e("Please wait until the Workflow Visualizer is populated."),headingLevel:"h4",icon:(0,z.jsx)(y.I,{size:"xl",style:{paddingBottom:"40px",color:E("grey")},children:(0,z.jsx)(Vm.KZ,{})}),children:(0,z.jsx)(Wn.y,{})})})}):(0,z.jsx)(LS,{data:{workflowNodes:n,template:i}})}function zS(){const e=(0,Re.g)();return(0,z.jsx)(py,{service:"awx",id:e.id||"",type:"jobtemplate",addRolesRoute:fc.JobTemplateAddTeams})}function HS(){const e=(0,Re.g)();return(0,z.jsx)(by,{service:"awx",id:e.id||"",type:"jobtemplate",addRolesRoute:fc.JobTemplateAddUsers})}function qS(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),a=yr(),{data:s,isLoading:o}=ec(xl`/job_templates/${n.id??""}/`),i=Vf();if(o||!s)return(0,z.jsx)(zr,{});const r=[{id:"teams",label:e("Select team(s)"),inputs:(0,z.jsx)(sy,{descriptionForTeamsSelection:e("Select the team(s) that you want to give access to {{templateName}}.",{templateName:s?.name})}),validate:(t,n)=>{const{teams:a}=t;if(!a?.length)throw new Error(e("Select at least one team."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"jobtemplate",fieldNameForPreviousStep:"teams",descriptionForRoleSelection:e("Choose roles to apply to {{templateName}}.",{templateName:s?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Templates"),to:t(fc.Templates)},{label:s?.name,to:t(fc.JobTemplateDetails,{params:{id:s?.id}})},{label:e("Team Access"),to:t(fc.JobTemplateTeamAccess,{params:{id:s?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:r,onSubmit:async t=>{const{teams:n,awxRoles:o}=t,r=[];for(const e of n)for(const t of o)r.push({team:e,role:t});return new Promise((t=>{i({title:e("Add roles"),keyFn:({team:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("Team"),cell:({team:e})=>e.name},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({team:e,role:t})=>al(xl`/role_team_assignments/`,{team:e.id,role_definition:t.id,content_type:"jobtemplate",object_id:s.id}),onComplete:()=>{t()},onClose:()=>{a(fc.JobTemplateTeamAccess,{params:{id:s.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{a(fc.JobTemplateTeamAccess,{params:{id:s?.id}})}})]})}function US(){const{t:e}=(0,I.Bd)(),t=gr(),n=(0,Re.g)(),{data:a,isLoading:s}=ec(xl`/job_templates/${n.id??""}/`),o=Vf(),i=yr();if(s||!a)return(0,z.jsx)(zr,{});const r=[{id:"users",label:e("Select user(s)"),inputs:(0,z.jsx)(ey,{descriptionForUsersSelection:e("Select the user(s) that you want to give access to {{templateName}}.",{templateName:a?.name})}),validate:(t,n)=>{const{users:a}=t;if(!a?.length)throw new Error(e("Select at least one user."))}},{id:"roles",label:e("Select roles to apply"),inputs:(0,z.jsx)(Xg,{contentType:"jobtemplate",fieldNameForPreviousStep:"users",descriptionForRoleSelection:e("Choose roles to apply to {{templateName}}.",{templateName:a?.name})}),validate:(t,n)=>{const{awxRoles:a}=t;if(!a?.length)throw new Error(e("Select at least one role."))}},{id:"review",label:e("Review"),inputs:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Add roles"),breadcrumbs:[{label:e("Templates"),to:t(fc.Templates)},{label:a?.name,to:t(fc.JobTemplateDetails,{params:{id:a?.id}})},{label:e("User Access"),to:t(fc.JobTemplateUserAccess,{params:{id:a?.id}})},{label:e("Add roles")}]}),(0,z.jsx)(Lr,{steps:r,onSubmit:t=>{const{users:n,awxRoles:s}=t,r=[];for(const e of n)for(const t of s)r.push({user:e,role:t});return new Promise((t=>{o({title:e("Add roles"),keyFn:({user:e,role:t})=>`${e.id}_${t.id}`,items:r,actionColumns:[{header:e("User"),cell:({user:e})=>e.username},{header:e("Role"),cell:({role:e})=>e.name}],actionFn:({user:e,role:t})=>al(xl`/role_user_assignments/`,{user:e.id,role_definition:t.id,content_type:"jobtemplate",object_id:a.id}),onComplete:()=>{t()},onClose:()=>{i(fc.JobTemplateUserAccess,{params:{id:a.id.toString()}})}})}))},disableGrid:!0,onCancel:()=>{i(fc.JobTemplateUserAccess,{params:{id:a?.id}})}})]})}function WS(e){const{resourceType:t}=e;Fc("inventories");const n=cx(),{id:a=""}=(0,Re.g)(),s={["job_templates"===t?"job__job_template":"workflow_job__workflow_job_template"]:a,not__launch_type:"sync"};return(0,z.jsx)(ax,{queryParams:s,columns:n})}var JS=n(28319);function VS(e){const{t}=(0,I.Bd)(),{templateType:n,id:a}=e??{},s=gr();return(0,l.useMemo)((()=>[{header:t("Name"),cell:e=>(0,z.jsx)(i.s,{flexWrap:{default:"nowrap"},children:(0,z.jsx)(Fe,{text:e?.question_name,iconAlign:"right",icon:e.required?(0,z.jsx)(x.m,{content:t("Required"),children:(0,z.jsx)(y.I,{status:"danger",iconSize:"sm","data-cy":"survey-question-required",children:(0,z.jsx)(JS.m8,{})})}):null,to:s("job_template"===n?fc.EditJobTemplateSurvey:fc.EditWorkflowJobTemplateSurvey,{params:{id:a},query:{question_variable:e.variable}})})}),card:"name",list:"name"},{header:t("Type"),cell:e=>(0,z.jsx)(Fe,{text:e?.type}),card:"subtitle",list:"subtitle"},{header:t("Default"),card:"subtitle",list:"subtitle",cell:e=>null===e.default||void 0===e.default||""===e.default?null:"multiselect"!==e.type?e.default:(0,z.jsx)(Ln.I,{children:e.default.toString().split("\n").map((t=>(0,z.jsx)(Mn.v,{isReadOnly:!0,ouiaId:`${e.variable}-${t}`,children:t},t)))})}]),[t,s,a,n])}const GS=A.Ay.div.withConfig({componentId:"ans__sc-vkt6k5-0"})(["display:flex;flex-direction:column;max-height:560px;overflow:hidden;border-top:thin solid var(--pf-v5-global--BorderColor--100);"]),YS=A.Ay.div.withConfig({componentId:"ans__sc-vkt6k5-1"})(["margin-left:32px;height:64px;display:flex;align-items:center;"]);function KS(e,t){const{t:n}=(0,I.Bd)(),[a,s]=ss(),o=ue(),{id:i}=(0,Re.g)(),r=e=>{const{genericErrors:t,fieldErrors:a}=Mc(e);o.addAlert({variant:"danger",title:n("Failed to delete survey questions"),children:(0,z.jsxs)(z.Fragment,{children:[t?.map((e=>e.message)),a?.map((e=>e.message))]})})};return n=>{s((0,z.jsx)(ZS,{questions:n,onClose:()=>s(void 0),onComplete:e,onError:r,id:i,templateType:t}))}}function ZS(e){const{questions:t,onClose:n,onComplete:a,onError:s,id:o,templateType:i}=e,{t:r}=(0,I.Bd)(),c=is(t),d=VS(),u=function(e){const{onClose:t,onComplete:n,onError:a,id:s,templateType:o}=e,i=td(),r=kd(),c=s?xl`/${"job_template"===o?"job_templates":"workflow_job_templates"}/${s}/survey_spec/`:"",{data:d}=ec(c);return(0,l.useCallback)((async e=>{try{if(d){const t={name:d?.name,description:d?.description,spec:d?.spec?.filter((t=>!e.includes(t)))};e.length===d.spec?.length?await r(c):await i(c,t)}}catch(e){a(e)}finally{n(e),t()}}),[d,r,a,i,t,n,c])}({onClose:n,onComplete:a,onError:s,id:o,templateType:i}),[m,p]=(0,l.useState)(!1);return(0,z.jsx)(Zt.a,{isOpen:!0,hasNoBodyWrapper:!0,titleIconVariant:"warning",title:r("Permanently delete survey questions"),"aria-label":r("Delete survey"),ouiaId:"delete-survey-dialog","data-cy":"delete-survey-dialog",variant:Zt.d.medium,onClose:e.onClose,actions:[(0,z.jsx)(g.$n,{"data-cy":"survey-modal-delete-button",ouiaId:"survey-modal-delete-button",variant:"danger",onClick:()=>{u(t)},"aria-label":r`Confirm delete`,isAriaDisabled:!m,children:r("Delete")},"delete"),(0,z.jsx)(g.$n,{ouiaId:"delete-survey-modal-cancel-button",variant:"link",onClick:n,children:r("Cancel")},"cancel")],children:t.length>0&&(0,z.jsxs)(Xt.H,{style:{paddingLeft:0,paddingRight:0},children:[(0,z.jsx)(GS,{children:(0,z.jsx)($s,{pageItems:c.paged,itemCount:t.length,tableColumns:d,keyFn:e=>e.variable,compact:!0,errorStateTitle:r`Error`,emptyStateTitle:r`No items`,autoHidePagination:!0,disableBodyPadding:!0,...c},"items")}),(0,z.jsx)(YS,{children:(0,z.jsx)(hs.S,{id:"confirm",ouiaId:"confirm",label:r("Yes, I confirm that I want to remove these {{count}} survey questions.",{count:t.length}),isChecked:m,onChange:(e,t)=>p(t)})})]})})}const XS=(0,A.Ay)(O.d).withConfig({componentId:"ans__sc-15g04z3-0"})(["margin:0 16px;align-self:center;"]);function QS({resourceType:e}){const t=(0,Re.g)(),{data:n,refresh:a}=tc(xl`/${e}/`,t.id),s=(0,l.useCallback)((async e=>{if(!n)return;const t="job_template"===n.type?xl`/job_templates/${n.id.toString()}/`:xl`/workflow_job_templates/${n.id.toString()}/`;await sl(t,{survey_enabled:e}),a()}),[n,a]);return n?(0,z.jsx)(eC,{template:n,onToggleSurvey:s}):null}function eC({template:e,onToggleSurvey:t}){const{t:n}=(0,I.Bd)(),a=yr(),i=function(e){const{url:t}=e,n=Ur({disableQueryString:!0}),a=(0,l.useRef)({itemCount:void 0}),s=rl(),o=(0,_e.Ay)(t,s,cl),{data:i,mutate:r}=o,c=(0,l.useCallback)((async()=>{await r().finally((()=>{}))}),[r]);(0,_e.Ay)(t,s,cl);let d=o.error;d instanceof Xr&&404===d.statusCode&&n.page>1&&(n.setPage(1),d=void 0);const u=os(i?.spec??[],(function(e){return e?.variable}));i&&void 0!==i.spec?a.current.itemCount=i.spec.length:i&&void 0===i.spec&&(a.current.itemCount=0);const m=(0,l.useCallback)((e=>{u.selectItems(e),c()}),[c,u]),p=(0,l.useCallback)((e=>{u.unselectItems(e),c()}),[c,u]),[h,b]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{b(i?.spec)}),[i?.spec]);const f=(0,l.useCallback)((e=>{if(!h)return;const t=h?.findIndex((t=>t.variable===e.variable));if(-1!==t){const n=[...h];n[t]=e,b(n)}}),[h]);return(0,l.useMemo)((()=>({error:d,refresh:c,itemCount:a.current.itemCount,pageItems:h,...n,...u,selectItemsAndRefresh:m,unselectItemsAndRefresh:p,updateItem:f})),[d,h,c,m,u,p,f,n])}({url:"job_template"===e.type?xl`/job_templates/${e.id.toString()}/survey_spec/`:xl`/workflow_job_templates/${e.id.toString()}/survey_spec/`}),r=e.summary_fields.user_capabilities.edit,c=e.summary_fields.user_capabilities.delete,d=VS({templateType:e.type,id:e.id.toString()}),u=function(e,t){const{t:n}=(0,I.Bd)(),a=yr(),{id:i}=(0,Re.g)(),r=KS(e.unselectItemsAndRefresh,t),c="job_template"===t,{openManageQuestionOrder:d}=function(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),a=td(),s=xl`/${e?"job_templates":"workflow_job_templates"}/${n.id?.toString()??""}/survey_spec/`,o=(0,l.useMemo)((()=>[{header:t("Name"),cell:e=>e.question_name},{header:t("Defaults"),cell:e=>e.default}]),[t]),{data:i,refresh:r}=ec(s),{openManageItems:c}=cs({id:`survey-question-template-${n.id}`,title:"Manage question order",description:t("To reorder the survey questions drag and drop them in the desired location."),items:i?.spec??[],keyFn:e=>e.question_name,columns:o,hideSelection:!0,onSubmit:e=>{(async()=>{await a(s,{...i,spec:e}),r()})()}});return(0,l.useMemo)((()=>({openManageQuestionOrder:c})),[c])}(c),{data:u}=dd(i?xl`/${c?"job_templates":"workflow_job_templates"}/${i.toString()}/`:""),m=Boolean(u&&u.actions&&u.actions.PUT);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:n("Create survey question"),isDisabled:m?void 0:n("You do not have permission to create a question. Please contact your system administrator if there is an issue with your access."),onClick:()=>{a(c?fc.AddJobTemplateSurvey:fc.AddWorkflowJobTemplateSurvey,{params:{id:i}})}},{type:s.Button,selection:o.None,icon:Jm.DP,label:n("Manage question order"),onClick:d,isDisabled:m?void 0:n("You do not have permission to reorder questions. Please contact your system administrator if there is an issue with your access.")},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:n("Delete survey questions"),onClick:r,isDanger:!0,isDisabled:m?void 0:n("You do not have permission to delete survey questions. Please contact your system administrator if there is an issue with your access.")}]),[n,d,r,m,i,a,c])}(i,e.type),m=KS(i.unselectItemsAndRefresh,e.type),p=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:n("Edit survey question"),isDisabled:()=>r?void 0:n("You do not have permission to edit this question."),onClick:t=>{a("job_template"===e.type?fc.EditJobTemplateSurvey:fc.EditWorkflowJobTemplateSurvey,{params:{id:e.id.toString()},query:{question_variable:t.variable}})}},{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete survey question"),isDisabled:()=>c?void 0:n("You do not have permission to delete this question."),onClick:e=>m([e]),isDanger:!0}]),[n,r,c,m,a,e.id,e.type]);return(0,z.jsx)($s,{id:"awx-survey-table",toolbarActions:u,tableColumns:d,rowActions:p,errorStateTitle:n("Error loading survey"),emptyStateTitle:n(r?"There are currently no survey questions.":"You do not have permission to create a survey."),emptyStateDescription:n(r?"Create a survey question by clicking the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:r?void 0:Xa.IN,emptyStateButtonText:r?n("Create survey question"):void 0,emptyStateButtonIcon:r?(0,z.jsx)(Za.GY,{}):void 0,emptyStateButtonClick:r?()=>{a("job_template"===e.type?fc.AddJobTemplateSurvey:fc.AddWorkflowJobTemplateSurvey,{params:{id:e.id.toString()}})}:void 0,...i,toolbarContent:(0,z.jsx)(XS,{label:n("Survey enabled"),labelOff:n("Survey disabled"),id:"survey-switch","data-cy":"survey-switch","aria-label":"Survey enabled",hasCheckIcon:!0,isChecked:e.survey_enabled??!1,onChange:(e,n)=>{t(n)}})})}var tC=n(78229);const nC=(0,A.Ay)(k.c).withConfig({componentId:"ans__sc-h2see6-0"})(["padding-top:var(--pf-v5-global--spacer--md);padding-bottom:var(--pf-v5-global--spacer--md);"]);function aC(e){const{t}=(0,I.Bd)(),n=sc(),{type:a}=e,s=pc(n,"jobTemplateSurveys"),o=t("Choice option cannot be empty."),c=t("Choice option already exists."),d=t("Default option"),{control:u,setValue:m,setError:p,clearErrors:h,getFieldState:b}=(0,oo.xW)(),{fields:f,append:y,remove:x,update:j,replace:_}=(0,oo.jz)({control:u,name:"formattedChoices"}),v=f,w=(0,oo.FH)({name:"formattedChoices"})??[],k=(0,oo.FH)({name:"add-choice"})??"",S=w.map((e=>e.name)),C=()=>{k.length<=0?p("add-choice",{message:o}):S.includes(k)?p("add-choice",{message:c}):(y({name:k,default:!1}),m("add-choice",""),h("add-choice"))};return(0,l.useEffect)((()=>{"multiplechoice"===a&&v.filter((e=>e.default)).length>1&&_(w.map((e=>({...e,default:!1}))))}),[a]),(0,z.jsxs)(Vo,{fieldId:"multiple-choice-options",label:t("Multiple Choice Options"),labelHelp:(0,z.jsxs)(I.x6,{children:["Refer to the"," ",(0,z.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information."]}),isRequired:!0,children:[(0,z.jsxs)(so.x,{hasGutter:!0,children:[(0,z.jsx)(xd.E,{span:10,children:(0,z.jsx)(oo.xI,{name:"add-choice",control:u,render:({field:e,fieldState:{error:n}})=>(0,z.jsxs)(Xe.B,{hasGutter:!0,children:[(0,z.jsx)(ri.ks,{id:"add-choice-input","data-cy":"add-choice-input","aria-label":t("Add choice input"),...e,placeholder:t("Enter multiple choice option"),onKeyUp:e=>{"Enter"===e.key&&C()}}),n?.message&&(0,z.jsx)(Uo.e,{children:(0,z.jsx)(Wo.E,{children:(0,z.jsx)(Jo.j,{variant:"error",children:n.message})})})]})})}),(0,z.jsx)(xd.E,{span:2,children:(0,z.jsx)(g.$n,{type:"button",variant:"plain","aria-label":t("Add choice"),"data-cy":"add-choice",onClick:C,isDisabled:S.includes(k)||0===k?.length,children:(0,z.jsx)(Za.GY,{})})})]}),(0,z.jsx)(nC,{}),v.map(((e,n)=>(0,z.jsxs)(i.s,{columnGap:{default:"columnGapNone"},alignContent:{default:"alignContentSpaceBetween"},style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:[(0,z.jsx)(r.Z,{flex:{default:"flex_1"},children:(0,z.jsx)(Xe.B,{children:(0,z.jsx)(oo.xI,{name:`formattedChoices[${n}].name`,control:u,rules:{validate:{required:e=>{const{isTouched:t}=b(`formattedChoices[${n}].name`);return e.length<=0?o:t&&S.filter((t=>t===e)).length>1?c:void 0}}},render:({field:e,fieldState:{error:a}})=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ri.ks,{validated:a?.message?tC.nh.error:void 0,id:`choice-option-${n}`,"data-cy":`choice-option-${n}`,"aria-label":t("Choice option"),...e}),a?.message&&(0,z.jsx)(Uo.e,{children:(0,z.jsx)(Wo.E,{children:(0,z.jsx)(Jo.j,{variant:"error",children:a.message})})})]})})})}),(0,z.jsx)(r.Z,{children:(0,z.jsxs)(i.s,{style:{maxWidth:"180px"},gap:{default:"gapNone"},children:[(0,z.jsx)(r.Z,{children:(0,z.jsx)(g.$n,{type:"button",variant:"plain","aria-label":t("Remove choice"),"data-cy":`remove-choice-${n}`,onClick:()=>{x(n)},children:(0,z.jsx)($c.uc,{})})}),(0,z.jsx)(r.Z,{children:(0,z.jsx)(oo.xI,{control:u,name:`formattedChoices[${n}].default`,render:({field:t})=>(0,z.jsx)(z.Fragment,{children:"multiplechoice"===a?(0,z.jsx)(Ax.s,{...t,"data-cy":`choice-radio-${n}`,id:`choice-radio-${n}`,label:d,onChange:()=>{_(w.map(((e,t)=>({...e,default:n===t}))))},onClick:()=>{!0===e.default&&j(n,{...e,default:!1})},isChecked:e.default,isDisabled:w[n]?.name.length<=0}):(0,z.jsx)(hs.S,{...t,"data-cy":`choice-checkbox-${n}`,id:`choice-checkbox-${n}`,label:d,isChecked:e.default,onClick:()=>j(n,{...e,default:!e.default}),isDisabled:w[n]?.name.length<=0})})})})]})})]},e.id)))]})}const sC=0,oC=1024;function iC({resourceType:e}){const[t]=jr(),n=t.get("question_variable");return(0,z.jsx)(lC,{mode:"edit",resourceType:e,questionVariable:n})}function rC({resourceType:e}){return(0,z.jsx)(lC,{mode:"add",resourceType:e})}function lC(e){const{t}=(0,I.Bd)(),{id:n}=(0,Re.g)(),a=yr(),s=td(),{resourceType:o,mode:i,questionVariable:r}=e,l=()=>a("job_templates"===o?fc.JobTemplateSurvey:fc.WorkflowJobTemplateSurvey,{params:{id:n}});r||"add"===i||l();const{error:c,data:d,isLoading:u,refresh:m}=ec(xl`/${o}/${n??""}/survey_spec/`);if(c)return(0,z.jsx)(Ic,{error:c,handleRefresh:m});if(u)return(0,z.jsx)(zr,{});let p;if("edit"===i&&r&&(p=d?.spec.find((e=>e.variable===r)),p||l()),"edit"===i&&!p)return null;const h=e=>"multiselect"===e||"multiplechoice"===e,b=(e,n)=>{n(t('Survey already contains a question with variable named "{{question}}".',{question:e.variable}))};let f;if(p&&h(p.type)){const e=Array.isArray(p.choices)?p.choices:p.choices.split("\n"),t=Array.isArray(p?.default)?p.default:p.default.toString().split("\n");f=e?.map(((e,n)=>({name:e,default:t?.includes(e)??!1,id:n.toString()})))}const g={question_name:p?.question_name||"",question_description:p?.question_description||"",required:!p||p?.required,type:p?.type??"text",variable:p?.variable||"",min:p?.min||sC,max:p?.max||oC,default:p?.default??"",choices:p?.choices??[],formattedChoices:f,new_question:!p};return(0,z.jsx)(nd,{onSubmit:async(e,a,r)=>{const c={name:d?.name??"",description:d?.description??"",spec:d?.spec??[]};if(["multiplechoice","multiselect"].includes(e.type)&&!e.formattedChoices?.length)return void r("add-choice",{message:t`Multiple choices require at least one answer.`});const u=e.default?"integer"===e.type?Number(e.default):"float"===e.type?parseFloat(e.default.toString()):e?.default?.toString():"";let m={max:Number(e.max),min:Number(e.min),new_question:e.new_question,type:e.type,default:u,required:e.required,variable:e.variable,question_name:e.question_name,question_description:e.question_description,choices:e.choices};const p=c.spec.some((t=>t.variable===e.variable));let f;if("add"===i&&p)return void b(m,a);if(Array.isArray(e.formattedChoices)&&h(m.type)){const t=e.formattedChoices?.map((e=>e.name))??[],n=e.formattedChoices?.filter((e=>e.default)).map((e=>e.name)).join("\n")??"";m={...m,choices:t,default:n}}if("add"===i)f=[...c.spec,m];else{f=[...c.spec];const e=f.findIndex((e=>e.variable===g.variable));if(g.variable!==m.variable&&p)return void b(m,a);-1===e&&a(t("Survey question not found.")),f[e]=m}const y={...c,spec:f};try{await s(xl`/${o}/${n??""}/survey_spec/`,y),l()}catch(e){a(t`Failed to create new survey question.`)}},onCancel:()=>l(),submitText:t("add"===i?"Create survey question":"Save survey question"),defaultValue:g,disableSubmitOnEnter:!0,children:(0,z.jsx)(cC,{})})}function cC(){const{t:e}=(0,I.Bd)(),t=(0,oo.FH)({name:"type"});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{id:"question-name",name:"question_name",type:"text",label:e`Question`,isRequired:!0}),(0,z.jsx)(li,{id:"question-description",name:"question_description",type:"text",label:e`Description`}),(0,z.jsx)(li,{id:"question-variable",name:"variable",type:"text",label:e`Answer variable name`,validate:t=>{if(/\s/.test(t))return e`This field must not contain spaces.`},isRequired:!0,labelHelp:e`The suggested format for variable names is lowercase and underscore-separated (for example, foo_bar, user_id, host_name, etc.). Variable names with spaces are not allowed.`}),(0,z.jsx)(ti,{name:"type",id:"question-type","data-cy":"question-type",label:e("Answer type"),placeholderText:e("Enter answer type"),options:[{value:"text",label:e("Text")},{value:"textarea",label:e("Textarea")},{value:"password",label:e("Password")},{value:"multiplechoice",label:e("Multiple Choice (single select)")},{value:"multiselect",label:e("Multiple Choice (multiple select)")},{value:"integer",label:e("Integer")},{value:"float",label:e("Float")}],isRequired:!0,labelHelp:e`Choose an answer type or format you want as the prompt for the user. Refer to the Ansible Controller Documentation for more additional information about each option.`}),(0,z.jsx)(Vo,{label:e("Options"),children:(0,z.jsx)(go,{id:"question-required","data-cy":"question-required",label:e`Required`,name:"required"})}),t&&(0,z.jsx)(dC,{answer:t})]})}function dC({answer:e}){const{t}=(0,I.Bd)(),{setValue:n,reset:a}=(0,oo.xW)();(0,l.useEffect)((()=>{n("min",sC),n("max",oC),a(void 0,{keepValues:!0,keepErrors:!1})}),[e,n,a]);const s=Number((0,oo.FH)({name:"min"})),o=Number((0,oo.FH)({name:"max"}));return(0,z.jsxs)(_d,{children:[["text","textarea","password"].includes(e)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{id:"question-min",name:"min",type:"number",label:t`Minimum length`}),(0,z.jsx)(li,{id:"question-max",name:"max",type:"number",label:t`Maximum length`})]}),["integer","float"].includes(e)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{id:"question-min",name:"min",type:"number",label:t`Minimum`}),(0,z.jsx)(li,{id:"question-max",name:"max",type:"number",label:t`Maximum`})]}),["text","integer","float"].includes(e)&&(0,z.jsx)(li,{id:"question-default",name:"default",min:s,max:o,maxLength:o,minLength:s,type:"text"===e?"text":"number",label:t`Default answer`,validate:n=>{if("integer"===e){const e=parseFloat(n);return!Number.isInteger(e)&&/[^0-9]/.test(n)?t`This field must be an integer.`:void 0}}}),"textarea"===e&&(0,z.jsx)(ii,{id:"question-default",name:"default",label:t`Default answer`}),"password"===e&&(0,z.jsx)(li,{id:"question-default",name:"default",label:t`Default answer`,type:"password"}),["multiplechoice","multiselect"].includes(e)&&(0,z.jsx)(aC,{type:e})]})}const uC={SystemAdministrator:"System administrator",SystemAuditor:"System auditor",NormalUser:"Normal user"};function mC(){const{t:e}=(0,I.Bd)(),t=yr(),n=(0,Re.Zp)(),a=td(),s=gr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Create user"),breadcrumbs:[{label:e("Users"),to:s(fc.Users)},{label:e("Create user")}]}),(0,z.jsx)(nd,{submitText:e("Create user"),onSubmit:async(n,s,o)=>{const{userType:i,confirmPassword:r,...l}=n;if(l.is_superuser=i===uC.SystemAdministrator,l.is_system_auditor=i===uC.SystemAuditor,r!==l.password)return o("confirmPassword",{message:e("Password does not match.")}),!1;const c=await a(xl`/organizations/${l.organization.toString()}/users/`,l);t(fc.UserDetails,{params:{id:c.id}})},cancelText:e("Cancel"),onCancel:()=>n(-1),defaultValue:{userType:uC.NormalUser},children:(0,z.jsx)(hC,{mode:"create"})})]})}function pC(){const{t:e}=(0,I.Bd)(),t=(0,Re.Zp)(),n=yr(),a=(0,Re.g)(),s=Number(a.id),{data:o}=(0,_e.Ay)(xl`/users/${s.toString()}/`,nl,cl),i=gr();if(!o)return(0,z.jsx)(Ui,{children:(0,z.jsx)(qi,{breadcrumbs:[{label:e("Users"),to:i(fc.Users)},{label:e("Edit User")}]})});const{password:r,...l}=o,c={...l,userType:o.is_superuser?uC.SystemAdministrator:o.is_system_auditor?uC.SystemAuditor:uC.NormalUser};return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:o?.username?e("Edit {{userName}}",{userName:o?.username}):e("User"),breadcrumbs:[{label:e("Users"),to:i(fc.Users)},{label:o?.username?e("Edit {{userName}}",{userName:o?.username}):e("User")}]}),(0,z.jsx)(nd,{submitText:e("Save user"),onSubmit:async(t,a,o)=>{const{userType:i,confirmPassword:r,...l}=t;if(l.is_superuser=i===uC.SystemAdministrator,l.is_system_auditor=i===uC.SystemAuditor,l.password&&r!==l.password)return o("confirmPassword",{message:e("Password does not match.")}),!1;const c=await sl(xl`/users/${s.toString()}/`,l);n(fc.UserDetails,{params:{id:c.id}})},cancelText:e("Cancel"),onCancel:()=>t(-1),defaultValue:c,children:(0,z.jsx)(hC,{mode:"edit"})})]})}function hC(e){const{mode:t}=e,{t:n}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(li,{name:"username",label:n("Username"),placeholder:n("Enter username"),isRequired:!0,maxLength:150,validate:e=>{for(const t of e)if(!"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890@.+-_".includes(t))return n("Username may contain only letters, numbers, and @.+-_ characters.")}}),(0,z.jsx)(vc,{name:"userType",label:n("User type"),placeholder:n("Select user type"),options:[{label:n("System administrator"),description:n("can edit, change, and update any inventory or automation definition"),value:uC.SystemAdministrator},{label:n("System auditor"),description:n("can see all aspects of the systems automation, but has no permission to run or change automation"),value:uC.SystemAuditor},{label:n("Normal user"),description:n("has read and write access limited to the resources (such as inventory, projects, and job templates) for which that user has been granted the appropriate roles and privileges"),value:uC.NormalUser}],isRequired:!0}),"create"===t&&(0,z.jsx)(sg,{name:"organization",isRequired:!0}),(0,z.jsxs)(_d,{children:[(0,z.jsx)(li,{name:"password",label:n("Password"),placeholder:n("Enter password"),type:"password",isRequired:"create"===t}),(0,z.jsx)(li,{name:"confirmPassword",label:n("Confirm password"),placeholder:n("Enter password"),type:"password",isRequired:"create"===t})]}),(0,z.jsx)(li,{name:"first_name",label:n("First name"),placeholder:n("Enter first name"),maxLength:150}),(0,z.jsx)(li,{name:"last_name",label:n("Last name"),placeholder:n("Enter last name"),maxLength:150}),(0,z.jsx)(li,{name:"email",label:n("Email"),placeholder:n("Enter email")})]})}function bC(e){const{user:t}=e,{t:n}=(0,I.Bd)();return t.ldap_dn?(0,z.jsx)(Ee.J,{children:n("LDAP")}):t.auth&&t.auth.length>0?(0,z.jsx)(Ee.J,{children:n("Social")}):(0,z.jsx)(Ee.J,{children:n("Local")})}function fC(e){const{t}=(0,I.Bd)(),{user:n,organizations:a,options:s}=e;return(0,z.jsxs)(Mt,{children:[(0,z.jsx)(Ft,{label:t("First name"),children:n.first_name}),(0,z.jsx)(Ft,{label:t("Last name"),children:n.last_name}),(0,z.jsx)(Ft,{label:t("Email"),children:n.email}),(0,z.jsx)(Ft,{label:t("Username"),children:n.username}),a&&a.length>0&&(0,z.jsx)(Ft,{label:t("Organization",{count:a.length}),children:(0,z.jsx)(Pe,{labelsWithLinks:a})}),n.last_login&&(0,z.jsx)(Ft,{label:t("Last login"),children:(0,z.jsx)(Ie,{value:n.last_login})}),s?.showAuthType&&(0,z.jsx)(Ft,{label:t("Authentication type"),children:(0,z.jsx)(bC,{user:n})})," ",s?.showUserType&&(0,z.jsx)(Ft,{label:t("User type"),children:(0,z.jsx)(Yf,{user:n})}),(0,z.jsx)(Ft,{label:t("Created"),children:(0,z.jsx)(Ie,{value:n.created??n.created_at??n.date_joined??n.created_on})}),(n.modified||n.modified_at||n.modified_on)&&(0,z.jsx)(Xd,{"data-cy":"modified",value:n.modified??n.modified_at??n.modified_on})]})}function gC(){const e=(0,Re.g)(),t=gr(),{data:n}=tc(xl`/users`,e.id),a=ec(n?.related?.organizations),s=(0,l.useMemo)((()=>a?.data?.results?a?.data?.results.map((e=>({name:e.name,link:t(fc.OrganizationDetails,{params:{id:e.id}})}))):[]),[t,a?.data?.results]);return n?(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(fC,{user:n,organizations:s,options:{showAuthType:!0,showUserType:!0}})}):null}function yC(e){const{title:t,description:n}=e;return(0,z.jsx)(Oe.d8,{variant:"light",children:(0,z.jsx)(le.F,{isInline:!0,isPlain:!0,variant:"info",title:t,children:n&&(0,z.jsx)("p",{children:n})})})}function xC(){const{t:e}=(0,I.Bd)(),t=Vf(),n=td();return(0,l.useCallback)(((a,s,o)=>{t({title:e("Removing user from organizations",{count:s.length}),keyFn:e=>e.id,items:s,actionColumns:[{header:e("Organization"),cell:e=>e.name}],actionFn:async(e,t)=>{for(const s of a)await n(xl`/users/${s.id.toString()}/roles/`,{id:e.summary_fields.object_roles.member_role.id,disassociate:!0},t)},processingText:e("Removing user from organizations...",{count:s.length}),onComplete:o})}),[t,n,e])}function jC(e){const t=ng(),n=ag({disableLinks:!0}),a=Uc({url:xl`/organizations/`,toolbarFilters:t,tableColumns:n,disableQueryString:!0});return(0,z.jsx)(Xs,{...e,toolbarFilters:t,tableColumns:n,view:a})}function _C(){const[e,t]=ss();return(0,l.useCallback)(((e,n)=>{t((0,z.jsx)(jC,{title:e,onSelect:n}))}),[t])}function vC(e){const{t}=(0,I.Bd)(),n=_C(),a=function(){const{t:e}=(0,I.Bd)(),t=Vf(),n=td();return(0,l.useCallback)(((a,s,o)=>{t({title:e("Adding users to organizations",{count:s.length}),keyFn:e=>e.id,items:s,actionColumns:[{header:e("Organization"),cell:e=>e.name}],actionFn:async(e,t)=>{for(const s of a)await n(xl`/users/${s.id.toString()}/roles/`,{id:e.summary_fields.object_roles.member_role.id},t)},processingText:e("Adding user to organizations...",{count:s.length}),onComplete:o})}),[t,n,e])}();return(0,l.useCallback)((s=>{n(t("Add users to organizations",{count:s.length}),(t=>{a(s,t,e)}))}),[a,e,n,t])}function wC(){const e=(0,Re.g)(),{data:t}=tc(xl`/users`,e.id);return t?(0,z.jsx)(kC,{user:t}):null}function kC(e){const{t}=(0,I.Bd)(),{user:n}=e,a=ng(),i=ag(),r=Uc({url:xl`/users/${n.id.toString()}/organizations/`,toolbarFilters:a,disableQueryString:!0}),c=vC(r.selectItemsAndRefresh),d=xC(),u=(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:t("Add users to organizations"),onClick:()=>c([n])},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:Nd.Kf,label:t("Remove users from organizations"),onClick:()=>d([n],r.selectedItems,r.unselectItemsAndRefresh),isDanger:!0}]),[d,c,t,n,r.selectedItems,r.unselectItemsAndRefresh]),m=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:Nd.Kf,label:t("Remove user from organization"),onClick:e=>d([n],[e],r.unselectItemsAndRefresh),isDanger:!0}]),[d,t,n,r.unselectItemsAndRefresh]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(yC,{title:t("Adding a user to an organization adds them as a member only. Permissions can be granted using teams and user roles.")}),(0,z.jsx)($s,{id:"awx-organizations-table",toolbarFilters:a,tableColumns:i,toolbarActions:u,rowActions:m,errorStateTitle:t("Error loading organizations"),emptyStateTitle:t("User is not a member of any organizations."),emptyStateDescription:t("To get started, add the user to an organization."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:t("Add user to organization"),emptyStateButtonClick:()=>c([n]),...r})]})}function SC(e){const{t}=(0,I.Bd)(),n=Kf({disableLinks:!0,disableSort:!0}),a=(0,l.useMemo)((()=>({header:t("Username"),cell:e=>(0,z.jsx)(Fe,{text:e.username}),sort:"username",maxWidth:200})),[t]),s=(0,l.useMemo)((()=>[a]),[a]),o=e=>e?.summary_fields?.user_capabilities?.delete?void 0:t("The user cannot be deleted due to insufficient permissions."),i=Lc();return a=>{const r=a.filter(o);i({title:t("Permanently delete users",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} users.",{count:a.length-r.length}),actionButtonText:t("Delete users",{count:a.length}),items:a.sort(((e,t)=>Js(e.username,t.username))),alertPrompts:r.length>0?[t("{{count}} of the selected users cannot be deleted due to insufficient permissions.",{count:r.length})]:void 0,isItemNonActionable:o,keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/users/${e.id.toString()}/`,t)})}}function CC(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:i}=tc(xl`/users`,t.id),r=yr(),{activeAwxUser:c}=_l(),d=SC((e=>{e.length>0&&r(fc.Users)})),u=Tg("user"),m=(0,l.useMemo)((()=>{const t=[...u,{type:s.Button,selection:o.Single,variant:g.Ak.primary,isPinned:!0,icon:yc.oo,label:e("Edit user"),onClick:e=>r(fc.EditUser,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:e("Delete user"),onClick:e=>d([e]),isDanger:!0}];return t}),[e,r,d,u]),p=gr(),h=[{label:e("Details"),page:fc.UserDetails},{label:e("Organizations"),page:fc.UserOrganizations},{label:e("Teams"),page:fc.UserTeams},{label:e("Roles"),page:fc.UserRoles}];return void 0!==c?.id&&c?.id.toString()===t.id&&h.push({label:e("Tokens"),page:fc.UserTokens}),n?(0,z.jsx)(Ic,{error:n,handleRefresh:i}):a?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a.username,breadcrumbs:[{label:e("Users"),to:p(fc.Users)},{label:a.username}],headerActions:(0,z.jsx)(oe,{actions:m,position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Users"),page:fc.Users,persistentFilterKey:"users"},tabs:h,params:{id:a.id}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function TC(e){const t=(0,Re.g)();return(0,z.jsx)(iS,{service:"awx",id:e.id||t.id||"",type:"user-roles",addRolesRoute:e.addRolesRoute||fc.AddRolesToUser})}function IC(e){const{t}=(0,I.Bd)(),n=Vf(),a=td();return(0,l.useCallback)(((s,o)=>{n({title:t("Removing user from teams",{count:o.length}),keyFn:e=>e.id,items:o,actionColumns:[{header:t("Team"),cell:e=>e.name}],actionFn:async(e,t)=>{for(const n of s)await a(xl`/users/${n.id.toString()}/roles/`,{id:e.summary_fields.object_roles.member_role.id,disassociate:!0},t)},processingText:t("Removing user from teams...",{count:o.length}),onComplete:e})}),[n,t,e,a])}function AC(e){const t=ny(),n=Vk({disableLinks:!0}),a=Uc({url:xl`/teams/`,toolbarFilters:t,tableColumns:n,disableQueryString:!0});return(0,z.jsx)(Xs,{...e,toolbarFilters:t,tableColumns:n,view:a})}function DC(){const[e,t]=ss();return(0,l.useCallback)(((e,n)=>{t((0,z.jsx)(AC,{title:e,onSelect:n}))}),[t])}function EC(e){const{t}=(0,I.Bd)(),n=DC(),a=function(){const{t:e}=(0,I.Bd)(),t=Vf(),n=td();return(0,l.useCallback)(((a,s,o)=>{t({title:e("Adding user to teams",{count:a.length}),keyFn:e=>e.id,items:a,actionColumns:[{header:e("Team"),cell:e=>e.name}],actionFn:async(e,t)=>{for(const a of s)await n(xl`/users/${a.id.toString()}/roles/`,{id:e.summary_fields.object_roles.member_role.id},t)},processingText:e("Adding user to teams...",{count:a.length}),onComplete:o})}),[t,e,n])}();return(0,l.useCallback)((s=>{n(t("Add users to teams",{count:s.length}),(t=>{a(t,s,e)}))}),[a,e,n,t])}function PC(){const e=(0,Re.g)(),{data:t}=tc(xl`/users`,e.id);return t?(0,z.jsx)(RC,{user:t}):null}function RC(e){const{user:t}=e,{t:n}=(0,I.Bd)(),a=ny(),i=Vk(),r=Uc({url:xl`/users/${t.id.toString()}/teams/`,toolbarFilters:a,disableQueryString:!0}),c=EC(r.selectItemsAndRefresh),d=IC(r.unselectItemsAndRefresh),{data:u}=dd(xl`/users/`),m=Boolean(u&&u.actions&&u.actions.POST),p=(0,l.useMemo)((()=>[{type:s.Button,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:n("Add users to teams"),isDisabled:m?void 0:n("You do not have permissions to add this user to a team. Please contact your organization administrator if there is an issue with your access."),onClick:()=>c([t])},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:Nd.Kf,label:n("Remove users from teams"),onClick:()=>d([t],r.selectedItems),isDanger:!0}]),[n,m,c,t,d,r.selectedItems]),h=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:Nd.Kf,label:n("Remove user from team"),onClick:e=>d([t],[e]),isDanger:!0}]),[d,n,t]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(yC,{title:n("Being a team member grants the user all the permissions of the team.")}),(0,z.jsx)($s,{id:"awx-teams-table",toolbarFilters:a,tableColumns:i,toolbarActions:p,rowActions:h,errorStateTitle:n("Error loading teams"),emptyStateTitle:n(m?"This user currently does not belong to any teams.":"You do not have permissions to add this user to a team."),emptyStateDescription:n(m?"Please add a team by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:m?void 0:Xa.IN,emptyStateButtonText:m?n("Add team"):void 0,emptyStateButtonIcon:m?(0,z.jsx)(Za.GY,{}):null,emptyStateButtonClick:m?()=>c([t]):void 0,...r})]})}function BC(e){const{t}=(0,I.Bd)(),n=gr(),a=bu(e),s=fu(e);return(0,l.useMemo)((()=>[{header:t("Application name"),cell:a=>(0,z.jsx)(Fe,{text:a.summary_fields?.application?.name?a.summary_fields.application.name:t("Personal access token"),to:e?.disableLinks?void 0:n(fc.UserTokenDetails,{params:{id:a.summary_fields.user.id,tokenid:a.id.toString()}})}),maxWidth:120,defaultSort:!0,defaultSortDirection:"asc",sort:e?.disableSort?void 0:"id"},{header:t("Description"),type:"text",value:e=>e.description,sort:e?.disableSort?void 0:"description"},{header:t("Scope"),type:"text",value:e=>e.scope,sort:e?.disableSort?void 0:"scope"},{header:t("Expires"),type:"datetime",value:e=>e.expires,sort:e?.disableSort?void 0:"expires"},a,s]),[a,n,s,e?.disableLinks,e?.disableSort,t])}function FC(e){const{t}=(0,I.Bd)(),n=BC({disableLinks:!0,disableSort:!0}),a=Lc();return s=>{a({title:1===s.length?t("Permanently delete token"):t("Permanently delete tokens"),confirmText:1===s.length?t("Yes, I confirm that I want to delete this token."):t("Yes, I confirm that I want to delete these {{count}} tokens.",{count:s.length}),actionButtonText:t("Delete token",{count:s.length}),items:s.sort(((e,t)=>Js(e.summary_fields.user.username,t.summary_fields.user.username))),keyFn:ll,isDanger:!0,confirmationColumns:n,actionColumns:n,onComplete:e,actionFn:(e,t)=>ol(xl`/tokens/${e.id.toString()}/`,t)})}}function NC(e){const t=(0,Re.g)(),n=e.id||t.id,{activeAwxUser:a}=_l(),s=yr();return(0,l.useEffect)((()=>{void 0!==a&&a?.id.toString()===n||s(fc.UserDetails,{params:{id:a?.id}})}),[a,n,s]),a?a?.id.toString()===n?(0,z.jsx)($C,{user:a,infoMessage:e.infoMessage,createRoute:e.createTokenRoute||fc.CreateUserToken}):(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function $C(e){const{user:t}=e,{t:n}=(0,I.Bd)(),a=gr(),i=BC(),r=Pp({optionsPath:"tokens",preSortedKeys:["description","scope","id"],preFilledValueKeys:{id:{apiPath:"tokens"}}}),c=Uc({url:xl`/users/${t.id.toString()}/tokens/`,toolbarFilters:r,tableColumns:i}),d=FC(c.unselectItemsAndRefresh),u=(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:n("Create token"),href:a(e.createRoute,{params:{id:t.id}})},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:n("Delete tokens"),isDanger:!0,onClick:d}]),[d,a,n,t.id,e.createRoute]),m=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:$c.uc,label:n("Delete token"),isDanger:!0,isPinned:!0,onClick:e=>{d([e])}}]),[d,n]);return(0,z.jsxs)(Ui,{children:[e.infoMessage&&(0,z.jsx)(yC,{title:n(e.infoMessage)}),(0,z.jsx)($s,{id:"awx-user-tokens",errorStateTitle:n("Error loading tokens"),emptyStateTitle:n("There are currently no tokens."),emptyStateDescription:n("Create tokens by clicking the button below."),emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateActions:u.slice(0,1),tableColumns:i,toolbarFilters:r,toolbarActions:u,rowActions:m,...c})]})}function MC(){const e=(0,Re.g)(),{error:t,data:n,refresh:a}=tc(xl`/users`,e.id),{error:s,data:o,refresh:i}=tc(xl`/tokens`,e.tokenid);return t?(0,z.jsx)(Ic,{error:t,handleRefresh:a}):s?(0,z.jsx)(Ic,{error:s,handleRefresh:i}):n&&o?(0,z.jsx)(LC,{token:o}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function LC(e){const{token:t}=e,n=BC({disableLinks:!0});return(0,z.jsx)(Mt,{children:(0,z.jsx)(Kt,{columns:n,item:t})})}function OC(){const{t:e}=(0,I.Bd)(),t=yr(),n=gr();Fc("users");const a=sc(),i=Zf(),r=Kf(),c=Uc({url:xl`/users/`,toolbarFilters:i,tableColumns:r}),d=SC(c.unselectItemsAndRefresh),u=vC(),m=EC(),p=function(e){const{t}=(0,I.Bd)(),n=_C(),a=xC();return(0,l.useCallback)((s=>{n(t("Remove users from organizations",{count:s.length}),(t=>{a(s,t,e)}))}),[n,t,a,e])}(),h=function(e){const{t}=(0,I.Bd)(),n=DC(),a=IC(void 0);return(0,l.useCallback)((e=>{n(t("Remove users from teams",{count:e.length}),(t=>{a(e,t)}))}),[n,a,t])}(),{data:b}=dd(xl`/users/`),f=Boolean(b&&b.actions&&b.actions.POST),y=(0,l.useMemo)((()=>[{type:s.Link,selection:o.None,variant:g.Ak.primary,isPinned:!0,icon:Za.GY,label:e("Create user"),isDisabled:f?void 0:e("You do not have permission to create a user. Please contact your system administrator if there is an issue with your access."),href:n(fc.CreateUser)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:Za.GY,label:e("Add users to teams"),onClick:()=>m(c.selectedItems)},{type:s.Button,selection:o.Multiple,icon:Nd.Kf,label:e("Remove users from teams"),onClick:()=>h(c.selectedItems)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:Za.GY,label:e("Add users to organizations"),onClick:()=>u(c.selectedItems)},{type:s.Button,selection:o.Multiple,icon:Nd.Kf,label:e("Remove users from organizations"),onClick:()=>p(c.selectedItems)},{type:s.Seperator},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:e("Delete users"),onClick:d,isDanger:!0}]),[e,f,n,d,m,c.selectedItems,h,u,p]),x=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,isPinned:!0,icon:yc.oo,label:e("Edit user"),isDisabled:t=>(t=>t?.summary_fields?.user_capabilities?.edit?"":e("The user cannot be edited due to insufficient permissions."))(t),onClick:e=>t(fc.EditUser,{params:{id:e.id}})},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:Za.GY,label:e("Add user to teams"),onClick:e=>m([e])},{type:s.Button,selection:o.Single,icon:Nd.Kf,label:e("Remove user from teams"),onClick:e=>h([e])},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:Za.GY,label:e("Add user to organizations"),onClick:e=>u([e])},{type:s.Button,selection:o.Single,icon:Nd.Kf,label:e("Remove user from organizations"),onClick:e=>p([e])},{type:s.Seperator},{type:s.Button,selection:o.Single,icon:$c.uc,label:e("Delete user"),isDisabled:t=>(t=>t?.summary_fields?.user_capabilities?.delete?"":e("The user cannot be deleted due to insufficient permissions."))(t),onClick:e=>d([e]),isDanger:!0}]),[d,t,u,p,m,h,e]);return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Users"),titleHelpTitle:e("Users"),titleHelp:e("A user is someone who has access to {{product}} with associated permissions and credentials.",{product:"AWX"}),titleDocLink:pc(a,"users"),description:e("A user is someone who has access to {{product}} with associated permissions and credentials.",{product:"AWX"}),headerActions:(0,z.jsx)(cd,{type:"user"})}),(0,z.jsx)($s,{id:"awx-users-table",toolbarFilters:i,toolbarActions:y,tableColumns:r,rowActions:x,errorStateTitle:e("Error loading users"),emptyStateTitle:e(f?"There are currently no users added.":"You do not have permission to create a user"),emptyStateDescription:e(f?"Please create a user by using the button below.":"Please contact your organization administrator if there is an issue with your access."),emptyStateIcon:f?void 0:Xa.IN,emptyStateButtonIcon:(0,z.jsx)(Za.GY,{}),emptyStateButtonText:f?e("Create user"):void 0,emptyStateButtonClick:f?()=>t(fc.CreateUser):void 0,...c})]})}function zC(e){const{t}=(0,I.Bd)(),n=(0,Re.g)(),a=gr(),s=yr(),o=Vf(),{data:i,isLoading:r}=ec(xl`/users/${e.id||n.id||""}/`);if(r||!i)return(0,z.jsx)(zr,{});const l=[{id:"resource-type",label:t("Select a resource type"),inputs:(0,z.jsx)(Xk,{})},{id:"resources",label:t("Select resources"),inputs:(0,z.jsx)(tS,{}),validate:(e,n)=>{const{resources:a}=e;if(!a?.length)throw new Error(t("Select at least one resource."))}},{id:"roles",label:t("Select roles to apply"),inputs:(0,z.jsx)(Xg,{fieldNameForPreviousStep:"resources"}),validate:(e,n)=>{const{awxRoles:a}=e;if(!a?.length)throw new Error(t("Select at least one role."))}},{id:"review",label:t("Review"),element:(0,z.jsx)(Jg,{})}];return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("Add roles"),breadcrumbs:[{label:t("Users"),to:a(fc.Users)},{label:i?.username,to:a(fc.UserDetails,{params:{id:i?.id}})},{label:t("Roles"),to:a(fc.UserRoles,{params:{id:i?.id}})},{label:t("Add roles")}]}),(0,z.jsx)(Lr,{errorAdapter:Mc,steps:l,onSubmit:a=>{const{resources:r,awxRoles:l,resourceType:c}=a,d=[];for(const e of r)for(const t of l)d.push({resource:e,role:t});return new Promise((a=>{o({title:t("Add roles"),keyFn:({resource:e,role:t})=>`${e.id}_${t.id}`,items:d,actionColumns:[{header:t("Resource name"),cell:({resource:e})=>e.name},{header:t("Role"),cell:({role:e})=>e.name}],actionFn:({resource:e,role:t})=>al(xl`/role_user_assignments/`,{user:i.id,role_definition:t.id,content_type:c,object_id:e.id}),onComplete:()=>{a()},onClose:()=>{s(e.userRolesRoute||fc.UserRoles,{params:{id:n.id}})}})}))},onCancel:()=>{s(e.userRolesRoute||fc.UserRoles,{params:{id:n.id}})},disableGrid:!0})]})}function HC(e){const{t}=(0,I.Bd)(),n=gr(),a=yr(),i=(0,Re.g)(),{error:r,data:c,refresh:d}=tc(xl`/tokens`,i.tokenid),u=FC((e=>{e.length>0&&a(fc.UserTokens,{params:{id:i.id}})})),m=(0,l.useMemo)((()=>[{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete token"),onClick:e=>u([e]),isDanger:!0,isPinned:!0}]),[u,t]);return r?(0,z.jsx)(Ic,{error:r,handleRefresh:d}):c?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:t("Token"),breadcrumbs:[{label:e.breadcrumbLabelForPreviousPage||t("Tokens"),to:n(fc.UserTokens,{params:{id:i.id,tokenid:i.tokenid}})},{label:c.summary_fields?.application?.name||t("Personal access token")}],headerActions:(0,z.jsx)(oe,{actions:m,position:te.nU.right,selectedItem:c})}),(0,z.jsx)(Nc,{backTab:{label:e.backTabLabel||t("Back to User Tokens"),page:fc.UserTokens,persistentFilterKey:"user tokens"},tabs:[{label:t("Details"),page:fc.UserTokenDetails}],params:{id:i.id,tokenid:i.tokenid}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function qC(e){const{t}=(0,I.Bd)(),n=function(e){const t=pu({...e}),n=hu(),a=gu(fc.OrganizationDetails,e),s=bu(e),o=fu({...e,disableSort:!0});return(0,l.useMemo)((()=>[t,n,a,s,o]),[t,n,a,s,o])}({disableLinks:!0}),a=Pp({optionsPath:"applications",preFilledValueKeys:{name:{apiPath:"applications"},id:{apiPath:"applications"}},preSortedKeys:["name","id","description"]});return(0,z.jsx)(Ap,{name:e.name,id:"application",label:t("Application"),placeholder:t("Select application"),queryPlaceholder:t("Loading applications..."),queryErrorText:t("Error loading applications"),isRequired:e.isRequired,isDisabled:e.isDisabled,helperText:e.helperText,url:xl`/applications/`,tableColumns:n,toolbarFilters:a})}function UC(e){const t=(0,Re.g)(),{activeAwxUser:n}=_l(),a=yr();return(0,l.useEffect)((()=>{void 0!==n&&n?.id.toString()===t.id||a(fc.UserDetails,{params:{id:n?.id}})}),[n,t.id,a]),n?n?.id.toString()===t.id?(0,z.jsx)(WC,{user:n,onCreate:e.onSuccessfulCreate}):(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function WC(e){const{user:t}=e,{t:n}=(0,I.Bd)(),a=gr(),s=(0,Re.Zp)(),o=td(),i=yr();return(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:n("Create Token"),breadcrumbs:[{label:n("Users"),to:a(fc.Users)},{label:t.username,to:a(fc.UserDetails,{params:{id:t.id}})},{label:n("Tokens"),to:a(fc.UserTokens,{params:{id:t.id}})}]}),(0,z.jsx)(nd,{submitText:n("Create token"),onSubmit:async n=>{const a=await o(xl`/tokens/`,n);e.onCreate(a),i(fc.UserTokenDetails,{params:{id:t.id,tokenid:a.id}})},cancelText:n("Cancel"),onCancel:()=>s(-1),children:(0,z.jsx)(JC,{})})]})}function JC(){const{t:e}=(0,I.Bd)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(qC,{name:"application",isRequired:!1}),(0,z.jsx)(li,{name:"description",label:e("Description"),placeholder:e("Enter token description"),isRequired:!1}),(0,z.jsx)(ti,{name:"scope",label:e("Scope"),placeholderText:e("Select a scope"),options:[{label:e("Read"),value:"read"},{label:e("Write"),value:"write"}],isRequired:!0})]})}function VC(e){const{token:t,refresh_token:n}=e.newToken;return(0,z.jsx)(Zt.a,{"aria-label":po.t`Token information`,isOpen:!0,variant:"medium",position:"top",title:(0,po.t)("Token information"),onClose:()=>{e.onClose(void 0)},hasNoBodyWrapper:!0,children:(0,z.jsxs)(Mt,{alertPrompts:[po.t`This is the only time the token will be shown.`],numberOfColumns:"single",children:[(0,z.jsx)(Ft,{label:po.t`Token`,children:(0,z.jsx)(be.Ck,{isReadOnly:!0,variant:be.$X.expansion,children:t})}),n&&(0,z.jsx)(Ft,{label:po.t`Refresh Token`,children:(0,z.jsx)(be.Ck,{isReadOnly:!0,variant:be.$X.expansion,children:n})}),(0,z.jsx)(Ft,{label:po.t`Expires`,children:Se(e.newToken.expires)})]})})}function GC(e){const{t}=(0,I.Bd)(),n=(0,l.useMemo)((()=>new Date(e.approval_expiration??0).valueOf()),[e.approval_expiration]),[a,s]=(0,l.useState)(Math.max(0,n-Date.now().valueOf()));(0,l.useEffect)((()=>{if(0===a)return;const e=setInterval((()=>{s(Math.max(0,n-Date.now().valueOf()))}),1e3);return()=>clearTimeout(e)}),[n,a]);const o=Math.floor(a/1e3),c=Math.floor(o%60),d=Math.floor(o/60%60),u=Math.floor(o/60/60%24),m=Math.floor(o/60/60/24),p=t(`${m}d`),h=t(`${u}h`),b=t(`${d}m`),f=t(`${c}s`);return 0===o?(0,z.jsx)(Fe,{text:t`Timed out`,color:"red",iconColor:"danger",icon:(0,z.jsx)(an.$Q,{})}):(0,z.jsxs)(i.s,{spaceItems:{default:"spaceItemsNone"},flexWrap:{default:"nowrap"},alignItems:{default:"alignItemsBaseline"},children:[(0,z.jsx)(r.Z,{alignSelf:{default:"alignSelfCenter"},children:(0,z.jsx)(Be,{size:"sm",color:"blue",padRight:!0,children:(0,z.jsx)($d.O4,{})})}),(0,z.jsx)(r.Z,{style:{maxWidth:"100%"},children:(0,z.jsx)("div",{style:{minWidth:200,maxWidth:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:E("blue")},children:(0,z.jsx)(I.x6,{children:(0,z.jsxs)(ee.B,{children:[(0,z.jsx)(xe.o,{children:"Expires in "}),0!==m&&(0,z.jsxs)(xe.o,{children:[p," "]}),0!==u&&(0,z.jsxs)(xe.o,{children:[h," "]}),0!==d&&(0,z.jsxs)(xe.o,{children:[b," "]}),(0,z.jsxs)(xe.o,{children:[f," "]})]})})})})]})}function YC(e){const{t}=(0,I.Bd)();if(e.workflow_approval.timed_out)return(0,z.jsx)(Fe,{text:t`Timed out`,color:"red",iconColor:"danger",icon:(0,z.jsx)(an.$Q,{})});if(e.workflow_approval.canceled_on)return(0,z.jsx)(Fe,{text:t`Canceled`,color:"orange",iconColor:"warning",icon:(0,z.jsx)(Ws.Pi,{})});switch(e.workflow_approval.status){case"new":case"pending":case"waiting":case"running":return e.workflow_approval.approval_expiration?(0,z.jsx)(GC,{approval_expiration:e.workflow_approval.approval_expiration}):(0,z.jsx)(Fe,{text:t`Never expires`,color:"blue",iconColor:"info",icon:(0,z.jsx)($d.O4,{})});case"successful":return(0,z.jsx)(Fe,{text:t`Approved`,color:"green",iconColor:"success",icon:(0,z.jsx)(nn.C1,{})});case"failed":return(0,z.jsx)(Fe,{text:t`Denied`,color:"red",iconColor:"danger",icon:(0,z.jsx)(an.$Q,{})});case"error":return(0,z.jsx)(Fe,{text:t`Error`,color:"red",iconColor:"danger",icon:(0,z.jsx)(an.$Q,{})});default:return(0,z.jsx)(Fe,{text:t`Unknown`,color:"yellow",iconColor:"warning",icon:(0,z.jsx)(Ws.Pi,{})})}}function KC(e){const{t}=(0,I.Bd)(),n=yr(),a=mu(!1),s=pu({...e,onClick:(0,l.useCallback)((e=>n(fc.WorkflowApprovalDetails,{params:{id:e.id}})),[n])});return(0,l.useMemo)((()=>[a,s,{header:t("Started"),cell:e=>e.started&&(0,z.jsx)(Ie,{value:e.started}),sort:"started",list:"secondary",defaultSortDirection:"desc",modal:Ut.hidden},{header:t("Status"),cell:e=>(0,z.jsx)(YC,{workflow_approval:e}),sort:"status",defaultSortDirection:"desc"}]),[a,s,t])}function ZC(){const e=(0,Re.g)(),{data:t}=tc(xl`/workflow_approvals`,e.id),n=KC();return t?(0,z.jsx)(Mt,{children:(0,z.jsx)(Kt,{item:t,columns:n})}):null}var XC=n(38412),QC=n(90499);function eT(e){const{t}=(0,I.Bd)(),n=KC({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=td(),r=e=>{if(e.timed_out)return t("The workflow approval cannot be approved because it has timed out");switch(e.status){case"canceled":return t("The workflow approval cannot be approved because the workflow has been canceled");case"successful":return t("The workflow approval cannot be approved because it has already been approved");case"failed":return t("The workflow approval cannot be approved because it has already been denied");case"error":return t("The workflow approval cannot be approved because it is in an error state");default:return e.can_approve_or_deny?"":t("The workflow approval cannot be approved due to insufficient permissions")}};return a=>{const l=a.filter(r);o({title:t("Approve workflow approvals",{count:a.length}),confirmText:t("Yes, I confirm that I want to approve these {{count}} workflow approvals.",{count:a.length-l.length}),actionButtonText:t("Approve workflow approvals",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length?[...l.length?[t("{{count}} of the selected workflow approvals cannot be approved.",{count:l.length})]:[]]:void 0,isItemNonActionable:e=>r(e),keyFn:ll,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:e=>i(xl`/workflow_approvals/${e.id.toString()}/approve/`,{})})}}function tT(e){const{t}=(0,I.Bd)(),n=KC({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=e=>e.summary_fields.user_capabilities.delete?"":t("The workflow approval cannot be deleted due to insufficient permission");return a=>{const r=a.filter(i);o({title:t("Delete workflow approvals",{count:a.length}),confirmText:t("Yes, I confirm that I want to delete these {{count}} workflow approvals.",{count:a.length-r.length}),actionButtonText:t("Delete workflow approvals",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:r.length?[...r.length?[t("{{count}} of the selected workflow approvals cannot be deleted due to insufficient permissions.",{count:r.length})]:[]]:void 0,isItemNonActionable:e=>i(e),keyFn:ll,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:(e,t)=>ol(xl`/workflow_approvals/${e.id.toString()}/`,t)})}}function nT(e){const{t}=(0,I.Bd)(),n=KC({disableLinks:!0,disableSort:!0}),a=pu({disableLinks:!0,disableSort:!0}),s=(0,l.useMemo)((()=>[a]),[a]),o=Lc(),i=td(),r=e=>{if(e.timed_out)return t("The workflow approval cannot be denied because it has timed out");switch(e.status){case"canceled":return t("The workflow approval cannot be denied because the workflow has been canceled");case"successful":return t("The workflow approval cannot be denied because it has already been approved");case"failed":return t("The workflow approval cannot be denied because it has already been denied");case"error":return t("The workflow approval cannot be denied because it is in an error state");default:return e.can_approve_or_deny?"":t("The workflow approval cannot be denied due to insufficient permissions")}};return a=>{const l=a.filter(r);o({title:t("Deny workflow approvals",{count:a.length}),confirmText:t("Yes, I confirm that I want to deny these {{count}} workflow approvals.",{count:a.length-l.length}),actionButtonText:t("Deny workflow approvals",{count:a.length}),items:a.sort(((e,t)=>Js(e.name,t.name))),alertPrompts:l.length?[...l.length?[t("{{count}} of the selected workflow approvals cannot be denied.",{count:l.length})]:[]]:void 0,isItemNonActionable:e=>r(e),keyFn:ll,confirmationColumns:n,actionColumns:s,onComplete:e,actionFn:e=>i(xl`/workflow_approvals/${e.id.toString()}/deny/`,{})})}}function aT(e){const{t}=(0,I.Bd)(),n=eT(e),a=tT(e),i=nT(e),r=td();return(0,l.useMemo)((()=>{const e=e=>e.can_approve_or_deny?"":t("The workflow approval cannot be denied due to insufficient permissions");return[{type:s.Button,selection:o.Single,variant:g.Ak.primary,isPinned:!0,icon:XC.Ge,label:t("Approve"),isDisabled:e=>(e=>e.can_approve_or_deny?"":t("The workflow approval cannot be approved due to insufficient permissions"))(e),isHidden:e=>["successful","failed","error","canceled"].includes(e.status),onClick:e=>n([e])},{type:s.Button,selection:o.Single,variant:g.Ak.secondary,isPinned:!0,icon:QC.d2,isDanger:!0,label:t("Deny"),isDisabled:t=>e(t),isHidden:e=>["successful","failed","error","canceled"].includes(e.status),onClick:e=>i([e])},{type:s.Button,selection:o.Single,variant:g.Ak.secondary,isPinned:!0,icon:Nd.Kf,label:t("Cancel"),isDisabled:t=>e(t),isHidden:e=>["successful","failed","error","canceled"].includes(e.status),onClick:e=>r(xl`/workflow_jobs/${e?.summary_fields?.workflow_job?.id.toString()}/cancel/`,{})},{type:s.Button,selection:o.Single,icon:$c.uc,label:t("Delete workflow approval"),isDisabled:e=>(e=>["successful","failed","error","canceled"].includes(e.status)?e.summary_fields.user_capabilities.delete?"":t("The workflow approval cannot be deleted due to insufficient permissions"):t("The workflow approval cannot be deleted because the workflow job is still running"))(e),onClick:e=>a([e]),isDanger:!0}]}),[t,n,i,r,a])}function sT(){const{t:e}=(0,I.Bd)(),t=(0,Re.g)(),{error:n,data:a,refresh:s}=tc(xl`/workflow_approvals`,t.id),o=a?.summary_fields?.source_workflow_job?.id,{data:i,error:r}=ec(o?xl`/workflow_jobs/${o.toString()}/`:""),l=gr(),c=Tg("workflow_approval"),d=aT(s),u=n||r;return u?(0,z.jsx)(Ic,{error:u,handleRefresh:s}):a&&i?(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:a?.name,breadcrumbs:[{label:e("Workflow Approvals"),to:l(fc.WorkflowApprovals)},{label:a?.name}],headerActions:(0,z.jsx)(oe,{actions:[...c,...d],position:te.nU.right,selectedItem:a})}),(0,z.jsx)(Nc,{backTab:{label:e("Back to Workflow Approvals"),page:fc.WorkflowApprovals,persistentFilterKey:"workflow-approvals"},tabs:[{label:e("Details"),page:fc.WorkflowApprovalDetails},{label:e("Workflow Job Details"),page:fc.WorkflowApprovalWorkflowJobDetails}],params:{id:t.id||0,job_id:a?.summary_fields?.workflow_job?.id,job_type:"workflow"},componentParams:{job:i}})]}):(0,z.jsx)(zr,{breadcrumbs:!0,tabs:!0})}function oT(){const{t:e}=(0,I.Bd)(),t=Pp({optionsPath:"workflow_approvals",preFilledValueKeys:{name:{apiPath:"workflow_approvals"},id:{apiPath:"workflow_approvals"}},preSortedKeys:["name","id"]}),n=KC(),a=Uc({url:xl`/workflow_approvals/`,toolbarFilters:t,tableColumns:n}),i=function(e){const{t}=(0,I.Bd)(),n=eT(e.unselectItemsAndRefresh),a=nT(e.unselectItemsAndRefresh),i=tT(e.unselectItemsAndRefresh);return(0,l.useMemo)((()=>[{type:s.Button,selection:o.Multiple,icon:XC.Ge,label:t("Approve"),onClick:n,isPinned:!0,isDisabled:0===e.selectedItems.length?t("Select at least one item from the list"):void 0},{type:s.Button,selection:o.Multiple,icon:QC.d2,label:t("Deny"),onClick:a,isDanger:!0,isPinned:!0,isDisabled:0===e.selectedItems.length?t("Select at least one item from the list"):void 0},{type:s.Button,selection:o.Multiple,icon:$c.uc,label:t("Delete workflow approvals"),onClick:i,isDanger:!0}]),[t,n,e.selectedItems.length,a,i])}(a),r=aT(a.unselectItemsAndRefresh);Fc("jobs");const c=sc(),{refresh:d}=a;return dc({control:["limit_reached_1"],jobs:["status_changed"]},(0,l.useCallback)((e=>{"jobs"===e?.group_name&&"workflow_approval"===e?.type&&d()}),[d])),(0,z.jsxs)(Ui,{children:[(0,z.jsx)(qi,{title:e("Workflow Approvals"),titleHelpTitle:e("Workflow Approvals"),titleHelp:e("A workflow approval represents a pause in a workflow where approval is needed before the workflow continues executing.",{product:"AWX"}),titleDocLink:pc(c,"workflows"),description:e("A workflow approval represents a pause in a workflow where approval is needed before the workflow continues executing.",{product:"AWX"}),headerActions:(0,z.jsx)(cd,{type:"workflow_approval"})}),(0,z.jsx)($s,{toolbarFilters:t,tableColumns:n,toolbarActions:i,rowActions:r,errorStateTitle:e("Error loading workflow approvals"),emptyStateTitle:e("There are currently no workflow approvals"),emptyStateDescription:e("Past and pending workflow approvals will appear here when available"),...a,defaultSubtitle:e("Workflow Approval")})]})}function iT(){const e=function(){const{t:e}=(0,I.Bd)(),t=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Inventories,label:e("Inventories"),path:"inventories",children:[{id:fc.InventorySourceSchedulePage,path:":inventory_type/:id/sources/:source_id/schedules/:schedule_id/",element:(0,z.jsx)(E_,{resourceEndPoint:xl`/inventory_sources/`,initialBreadCrumbs:[{label:e("Inventories"),to:fc.Inventories},{id:"inventory",to:fc.InventoryDetails},{id:"inventory_sources",label:e("Inventory Sources"),to:fc.InventorySources},{id:"data",to:fc.InventorySourceDetail},{label:e("Schedules"),id:"schedules",to:fc.InventorySourceSchedules}],backTab:{label:e("Back to Schedules"),page:fc.InventorySourceSchedules,persistentFilterKey:"inventory-schedules"},tabs:[{label:e("Details"),page:fc.InventorySourceScheduleDetails}]}),children:[{id:fc.InventorySourceScheduleDetails,path:"details",element:(0,z.jsx)(T_,{})}]},{id:fc.InventorySourceScheduleCreate,path:":inventory_type/:id/sources/:source_id/schedules/create",element:(0,z.jsx)(S_,{resourceEndPoint:xl`/inventory_sources/`})},{id:fc.InventorySourceScheduleEdit,path:":inventory_type/:id/sources/:source_id/schedules/:schedule_id/edit",element:(0,z.jsx)(bv,{resourceEndPoint:xl`/inventory_sources/`})},{id:fc.InventorySourcePage,path:":inventory_type/:id/sources/:source_id",element:(0,z.jsx)(Gj,{}),children:[{id:fc.InventorySourceDetail,path:"details",element:(0,z.jsx)(Hj,{})},{id:fc.InventorySourceNotifications,path:"notifications",element:(0,z.jsx)(rv,{resourceType:"inventory_sources"})},{id:fc.InventorySourceSchedules,path:"schedules",element:(0,z.jsx)(lv,{createSchedulePageId:fc.InventorySourceScheduleCreate,resourceType:"inventory-sources",sublistEndpoint:xl`/inventory_sources`})}]},{id:fc.InventoryHostAdd,path:":inventory_type/:id/add",element:(0,z.jsx)(fx,{})},{id:fc.InventoryHostEdit,path:":inventory_type/:id/host/:host_id/edit",element:(0,z.jsx)(yx,{})},{id:fc.InventoryGroupRelatedGroupsCreate,path:":inventory_type/:id/groups/:group_id/nested-groups/add",element:(0,z.jsx)(G_,{})},{id:fc.InventoryRunCommand,path:":inventory_type/:id/run_command",element:(0,z.jsx)(hv,{})},{id:fc.InventoryGroupPage,path:":inventory_type/:id/groups/:group_id",element:(0,z.jsx)(z_,{}),children:[{id:fc.InventoryGroupDetails,path:"details",element:(0,z.jsx)(ev,{})},{id:fc.InventoryGroupRelatedGroups,path:"nested-groups",element:(0,z.jsx)(iv,{})},{id:fc.InventoryGroupHost,path:"nested-hosts",element:(0,z.jsx)(av,{})}]},{id:fc.InventoryGroupHostAdd,path:":inventory_type/:id/group/:group_id/nested-hosts/add",element:(0,z.jsx)(fx,{})},{id:fc.InventoryGroupEdit,path:":inventory_type/:id/group/:group_id/edit",element:(0,z.jsx)(V_,{})},{id:fc.InventoryGroupCreate,path:":inventory_type/:id/group/add",element:(0,z.jsx)(J_,{})},{id:fc.InventoryPage,path:":inventory_type/:id/",element:(0,z.jsx)(hx,{}),children:[{id:fc.InventoryDetails,path:"details",element:(0,z.jsx)(Uj,{})},{id:fc.InventoryGroups,path:"groups",element:(0,z.jsx)(O_,{})},{id:fc.InventoryHosts,path:"hosts",element:(0,z.jsx)(F_,{})},{id:fc.InventorySources,path:"sources",element:(0,z.jsx)($_,{})},{id:fc.InventoryJobs,path:"jobs",element:(0,z.jsx)(cv,{})},{id:fc.InventoryJobTemplates,path:"templates",element:(0,z.jsx)(P_,{})},{id:fc.InventoryTeamAccess,path:"team-access",element:(0,z.jsx)(fv,{})},{id:fc.InventoryUserAccess,path:"user-access",element:(0,z.jsx)(gv,{})}]},{id:fc.InventoryHostPage,path:":inventory_type/:id/hosts/:host_id",element:(0,z.jsx)(H_,{}),children:[{id:fc.InventoryHostDetails,path:"details",element:(0,z.jsx)(_x,{})},{id:fc.InventoryHostGroups,path:"groups",element:(0,z.jsx)(Rx,{page:"inventory"})},{id:fc.InventoryHostJobs,path:"jobs",element:(0,z.jsx)(tv,{})},{id:fc.InventoryHostFacts,path:"facts",element:(0,z.jsx)(Bx,{page:"inventory"})}]},{id:fc.EditInventory,path:":inventory_type/:id/edit",element:(0,z.jsx)(Ej,{})},{id:fc.CreateInventory,path:"inventory/create",element:(0,z.jsx)(Dj,{inventoryKind:""})},{id:fc.CreateSmartInventory,path:"smart-inventory/create",element:(0,z.jsx)(Dj,{inventoryKind:"smart"})},{id:fc.CreateConstructedInventory,path:"constructed-inventory/create",element:(0,z.jsx)(Dj,{inventoryKind:"constructed"})},{id:fc.InventoryAddUsers,path:":id/user-access/add",element:(0,z.jsx)(yv,{})},{id:fc.InventoryAddTeams,path:":id/team-access/add",element:(0,z.jsx)(xv,{})},{path:"",element:(0,z.jsx)(yj,{})},{id:fc.InventorySourceEdit,path:":inventory_type/:id/sources/:source_id/edit",element:(0,z.jsx)(X_,{})},{id:fc.InventorySourcesAdd,path:":inventory_type/:id/sources/add",element:(0,z.jsx)(Z_,{})}]})),[e])}(),n=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Hosts,label:e("Hosts"),path:"hosts",children:[{id:fc.HostPage,path:":id",element:(0,z.jsx)(Gy,{}),children:[{id:fc.HostDetails,path:"details",element:(0,z.jsx)(_x,{})},{id:fc.HostFacts,path:"facts",element:(0,z.jsx)(Bx,{page:"host"})},{id:fc.HostGroups,path:"groups",element:(0,z.jsx)(Rx,{page:"host"})},{id:fc.HostJobs,path:"jobs",element:(0,z.jsx)(dx,{})}]},{id:fc.EditHost,path:":id/edit",element:(0,z.jsx)(yx,{})},{id:fc.CreateHost,path:"create",element:(0,z.jsx)(fx,{})},{path:"",element:(0,z.jsx)(Ky,{})}]})),[e])}(),a=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Projects,label:e("Projects"),path:"projects",children:[{id:fc.CreateProject,path:"create",element:(0,z.jsx)(Sk,{})},{id:fc.EditProject,path:":id/edit",element:(0,z.jsx)(Ck,{})},{id:fc.ProjectScheduleCreate,path:":id/schedules/create",element:(0,z.jsx)(S_,{resourceEndPoint:xl`/projects/`})},{id:fc.ProjectScheduleEdit,path:":id/schedules/:schedule_id/edit",element:(0,z.jsx)(bv,{resourceEndPoint:xl`/projects/`})},{id:fc.ProjectSchedulePage,path:":id/schedules/:schedule_id",element:(0,z.jsx)(E_,{resourceEndPoint:xl`/projects/`,initialBreadCrumbs:[{label:e("Projects"),to:fc.Projects},{id:"data",to:fc.ProjectPage},{label:e("Schedules"),id:"schedules",to:fc.ProjectSchedules}],backTab:{label:e("Back to Schedules"),page:fc.ProjectSchedules,persistentFilterKey:"project-schedules"},tabs:[{label:e("Details"),page:fc.ProjectScheduleDetails}]}),children:[{id:fc.ProjectScheduleDetails,path:"details",element:(0,z.jsx)(T_,{})}]},{id:fc.ProjectPage,path:":id",element:(0,z.jsx)(Rk,{}),children:[{id:fc.ProjectDetails,path:"details",element:(0,z.jsx)(gk,{})},{id:fc.ProjectJobTemplates,path:"job-templates",element:(0,z.jsx)(Ak,{})},{id:fc.ProjectNotifications,path:"notifications",element:(0,z.jsx)(rv,{resourceType:"projects"})},{id:fc.ProjectSchedules,path:"schedules",element:(0,z.jsx)(lv,{createSchedulePageId:fc.ProjectScheduleCreate,resourceType:"projects",sublistEndpoint:xl`/projects`})},{id:fc.ProjectUsers,path:"user-access",element:(0,z.jsx)(Nk,{})},{id:fc.ProjectTeams,path:"team-access",element:(0,z.jsx)(Fk,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.ProjectAddUsers,path:":id/user-access/add-users",element:(0,z.jsx)($k,{})},{id:fc.ProjectAddTeams,path:":id/team-access/add-teams",element:(0,z.jsx)(Mk,{})},{path:"",element:(0,z.jsx)(Bk,{})}]})),[e])}(),s=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Credentials,label:e("Credentials"),path:"credentials",children:[{id:fc.CreateCredential,path:"create",element:(0,z.jsx)(gg,{})},{id:fc.EditCredential,path:":id/edit",element:(0,z.jsx)(yg,{})},{id:fc.CredentialPage,path:":id",element:(0,z.jsx)(Bg,{}),children:[{id:fc.CredentialDetails,path:"details",element:(0,z.jsx)(Sg,{})},{id:fc.CredentialJobTemplates,path:"templates",element:(0,z.jsx)(zg,{})},{id:fc.CredentialTeamAccess,path:"team-access",element:(0,z.jsx)(hy,{})},{id:fc.CredentialUserAccess,path:"user-access",element:(0,z.jsx)(fy,{})}]},{id:fc.CredentialAddUsers,path:":id/user-access/add",element:(0,z.jsx)(ty,{})},{id:fc.CredentialAddTeams,path:":id/team-access/add",element:(0,z.jsx)(oy,{})},{path:"",element:(0,z.jsx)(Ng,{})}]})),[e])}(),o=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({label:e("Templates"),path:"templates",children:[{path:"job-template",children:[{id:fc.CreateJobTemplate,path:"create",element:(0,z.jsx)(pS,{})},{id:fc.EditJobTemplate,path:":id/edit",element:(0,z.jsx)(mS,{})},{id:fc.JobTemplateScheduleCreate,path:":id/schedules/create",element:(0,z.jsx)(S_,{resourceEndPoint:xl`/job_templates/`})},{id:fc.JobTemplateScheduleEdit,path:":id/schedules/:schedule_id/edit",element:(0,z.jsx)(bv,{resourceEndPoint:xl`/job_templates/`})},{id:fc.JobTemplateSchedulePage,path:":id/schedules/:schedule_id",element:(0,z.jsx)(E_,{resourceEndPoint:xl`/job_templates/`,initialBreadCrumbs:[{label:e("Templates"),to:fc.Templates},{id:"data",to:fc.JobTemplatePage},{label:e("Schedules"),id:"schedules",to:fc.JobTemplateSchedules}],backTab:{label:e("Back to Schedules"),page:fc.JobTemplateSchedules,persistentFilterKey:"job_template-schedules"},tabs:[{label:e("Details"),page:fc.JobTemplateScheduleDetails}]}),children:[{id:fc.JobTemplateScheduleDetails,path:"details",element:(0,z.jsx)(T_,{})}]},{id:fc.JobTemplatePage,path:":id",element:(0,z.jsx)(kS,{}),children:[{id:fc.JobTemplateDetails,path:"details",element:(0,z.jsx)(xS,{})},{id:fc.JobTemplateTeamAccess,path:"team-access",element:(0,z.jsx)(zS,{})},{id:fc.JobTemplateUserAccess,path:"user-access",element:(0,z.jsx)(HS,{})},{id:fc.JobTemplateJobs,path:"job",element:(0,z.jsx)(WS,{resourceType:"job_templates"})},{id:fc.JobTemplateNotifications,path:"notifications",element:(0,z.jsx)(rv,{resourceType:"job_templates"})},{id:fc.JobTemplateSurvey,path:"survey",element:(0,z.jsx)(QS,{resourceType:"job_templates"})},{id:fc.AddJobTemplateSurvey,path:"survey/add",element:(0,z.jsx)(rC,{resourceType:"job_templates"})},{id:fc.EditJobTemplateSurvey,path:"survey/edit",element:(0,z.jsx)(iC,{resourceType:"job_templates"})},{id:fc.JobTemplateSchedules,path:"schedules",element:(0,z.jsx)(lv,{createSchedulePageId:fc.JobTemplateScheduleCreate,resourceType:"job-template",sublistEndpoint:xl`/job_templates`})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.JobTemplateAddTeams,path:":id/team-access/add",element:(0,z.jsx)(qS,{})},{id:fc.JobTemplateAddUsers,path:":id/user-access/add",element:(0,z.jsx)(US,{})},{id:fc.TemplateLaunchWizard,path:":id/launch",element:(0,z.jsx)(vS,{jobType:"job_templates"})}]},{path:"workflow-job-template",children:[{id:fc.CreateWorkflowJobTemplate,path:"create",element:(0,z.jsx)(IS,{})},{id:fc.EditWorkflowJobTemplate,path:":id/edit",element:(0,z.jsx)(TS,{})},{id:fc.WorkflowJobTemplateScheduleCreate,path:":id/schedules/create",element:(0,z.jsx)(S_,{resourceEndPoint:xl`/workflow_job_templates/`})},{id:fc.WorkflowJobTemplateScheduleEdit,path:":id/schedules/:schedule_id/edit",element:(0,z.jsx)(bv,{resourceEndPoint:xl`/workflow_job_templates/`})},{id:fc.WorkflowJobTemplateSchedulePage,path:":id/schedules/:schedule_id",element:(0,z.jsx)(E_,{resourceEndPoint:xl`/workflow_job_templates/`,initialBreadCrumbs:[{label:e("Templates"),to:fc.Templates},{id:"data",to:fc.WorkflowJobTemplatePage},{label:e("Schedules"),id:"schedules",to:fc.WorkflowJobTemplateSchedules}],backTab:{label:e("Back to Schedules"),page:fc.WorkflowJobTemplateSchedules,persistentFilterKey:"workflow_job_template-schedules"},tabs:[{label:e("Details"),page:fc.WorkflowJobTemplateScheduleDetails}]}),children:[{id:fc.WorkflowJobTemplateScheduleDetails,path:"details",element:(0,z.jsx)(T_,{})}]},{id:fc.WorkflowVisualizer,path:":id/visualizer",element:(0,z.jsx)(OS,{})},{id:fc.WorkflowJobTemplatePage,path:":id",element:(0,z.jsx)(ES,{}),children:[{id:fc.WorkflowJobTemplateDetails,path:"details",element:(0,z.jsx)(DS,{})},{id:fc.WorkflowJobTemplateTeamAccess,path:"team-access",element:(0,z.jsx)(PS,{})},{id:fc.WorkflowJobTemplateUserAccess,path:"user-access",element:(0,z.jsx)(RS,{})},{id:fc.WorkflowJobTemplateJobs,path:"workflow-jobs",element:(0,z.jsx)(WS,{resourceType:"workflow_job_templates"})},{id:fc.WorkflowJobTemplateSurvey,path:"survey",element:(0,z.jsx)(QS,{resourceType:"workflow_job_templates"})},{id:fc.AddWorkflowJobTemplateSurvey,path:"survey/add",element:(0,z.jsx)(rC,{resourceType:"workflow_job_templates"})},{id:fc.EditWorkflowJobTemplateSurvey,path:"survey/edit",element:(0,z.jsx)(iC,{resourceType:"workflow_job_templates"})},{id:fc.WorkflowJobTemplateSchedules,path:"schedules",element:(0,z.jsx)(lv,{createSchedulePageId:fc.WorkflowJobTemplateScheduleCreate,resourceType:"workflow-job-template",sublistEndpoint:xl`/workflow_job_templates`})},{id:fc.WorkflowJobTemplateNotifications,path:"notifications",element:(0,z.jsx)(rv,{resourceType:"workflow_job_templates"})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.WorkflowJobTemplateAddTeams,path:":id/team-access/add",element:(0,z.jsx)(BS,{})},{id:fc.WorkflowJobTemplateAddUsers,path:":id/user-access/add",element:(0,z.jsx)(FS,{})},{id:fc.WorkflowJobTemplateLaunchWizard,path:":id/launch",element:(0,z.jsx)(vS,{jobType:"workflow_job_templates"})}]},{id:fc.Templates,path:"",element:(0,z.jsx)(SS,{})}]})),[e])}(),i=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.WorkflowApprovals,label:e("Workflow Approvals"),path:"workflow-approvals",children:[{id:fc.WorkflowApprovalPage,path:":id/",element:(0,z.jsx)(sT,{}),children:[{id:fc.WorkflowApprovalDetails,path:"details",element:(0,z.jsx)(ZC,{})},{id:fc.WorkflowApprovalWorkflowJobDetails,path:":job_type/:job_id/job-details",element:(0,z.jsx)(jv,{})}]},{path:"",element:(0,z.jsx)(oT,{})}]})),[e])}(),r=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Schedules,label:e("Schedules"),path:"schedules",children:[{id:fc.CreateSchedule,path:"create",element:(0,z.jsx)(S_,{isTopLevelSchedule:!0})},{path:"",element:(0,z.jsx)(Lk,{})}]})),[e])}(),c=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Jobs,label:e("Jobs"),path:"jobs",children:[{id:fc.TemplateLaunchWithPasswordsWizard,path:":job_type/:id/relaunch-with-passwords",element:(0,z.jsx)(ww,{})},{id:fc.JobPage,path:":job_type/:id",element:(0,z.jsx)(wv,{}),children:[{id:fc.JobOutput,path:"output",element:(0,z.jsx)(fw,{})},{id:fc.JobDetails,path:"details",element:(0,z.jsx)(jv,{})}]},{path:"",element:(0,z.jsx)(yw,{})}]})),[e])}(),d=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.ActivityStream,label:e("Activity Stream"),path:"activity-stream",element:(0,z.jsx)(Wf,{})})),[e])}(),u=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Organizations,label:e("Organizations"),path:"organizations",children:[{id:fc.CreateOrganization,path:"create",element:(0,z.jsx)(ik,{})},{id:fc.EditOrganization,path:":id/edit",element:(0,z.jsx)(rk,{})},{id:fc.OrganizationPage,path:":id",element:(0,z.jsx)(uk,{}),children:[{id:fc.OrganizationDetails,path:"details",element:(0,z.jsx)(dk,{})},{id:fc.OrganizationUsersAccess,path:"user-access",element:(0,z.jsx)(ck,{})},{id:fc.OrganizationTeamsAccess,path:"team-access",element:(0,z.jsx)(pk,{})},{id:fc.OrganizationExecutionEnvironments,path:"execution-environments",element:(0,z.jsx)(hk,{})},{id:fc.OrganizationNotifications,path:"notifications",element:(0,z.jsx)(rv,{resourceType:"organizations"})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.OrganizationAddUsers,path:":id/user-access/add",element:(0,z.jsx)(bk,{})},{id:fc.OrganizationAddTeams,path:":id/team-access/add",element:(0,z.jsx)(fk,{})},{path:"",element:(0,z.jsx)(tg,{})}]})),[e])}(),m=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Teams,label:e("Teams"),path:"teams",children:[{id:fc.CreateTeam,path:"create",element:(0,z.jsx)(Ok,{})},{id:fc.EditTeam,path:":id/edit",element:(0,z.jsx)(zk,{})},{id:fc.AddRolesToTeam,path:":id/roles/add",element:(0,z.jsx)(aS,{})},{id:fc.TeamPage,path:":id",element:(0,z.jsx)(Kk,{}),children:[{id:fc.TeamDetails,path:"details",element:(0,z.jsx)(Uk,{})},{id:fc.TeamMembers,path:"access",element:(0,z.jsx)(Wk,{})},{id:fc.TeamRoles,path:"roles",element:(0,z.jsx)(rS,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.TeamAddMembers,path:":id/user-access/add",element:(0,z.jsx)(lS,{})},{path:"",element:(0,z.jsx)(Zk,{})}]})),[e])}(),p=function(){const{t:e}=(0,I.Bd)(),[t,n]=(0,l.useState)();return(0,l.useMemo)((()=>({id:fc.Users,label:e("Users"),path:"users",children:[{id:fc.CreateUser,path:"create",element:(0,z.jsx)(mC,{})},{id:fc.EditUser,path:":id/edit",element:(0,z.jsx)(pC,{})},{id:fc.UserPage,path:":id",element:(0,z.jsx)(CC,{}),children:[{id:fc.UserDetails,path:"details",element:(0,z.jsx)(gC,{})},{id:fc.UserOrganizations,path:"organizations",element:(0,z.jsx)(wC,{})},{id:fc.UserTeams,path:"teams",element:(0,z.jsx)(PC,{})},{id:fc.UserRoles,path:"roles",element:(0,z.jsx)(TC,{})},{id:fc.UserTokens,path:"tokens",element:(0,z.jsx)(NC,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.AddRolesToUser,path:":id/roles/add-roles",element:(0,z.jsx)(zC,{})},{id:fc.CreateUserToken,path:":id/tokens/create",element:(0,z.jsx)(UC,{onSuccessfulCreate:e=>n(e)})},{id:fc.UserTokenPage,path:":id/tokens/:tokenid",element:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(HC,{}),t&&(0,z.jsx)(VC,{onClose:n,newToken:t})]}),children:[{id:fc.UserTokenDetails,path:"details",element:(0,z.jsx)(MC,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details"})}]},{path:"",element:(0,z.jsx)(OC,{})}]})),[t,e])}(),h=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.NotificationTemplates,label:e("Notifiers"),path:"notifiers",children:[{id:fc.NotificationTemplatePage,path:":id/",element:(0,z.jsx)(tk,{}),children:[{id:fc.NotificationTemplateDetails,path:"details",element:(0,z.jsx)(Xw,{})},{id:fc.NotificationTemplateTeamAccess,path:"team-access",element:(0,z.jsx)(nk,{})},{id:fc.NotificationTemplateUserAccess,path:"user-access",element:(0,z.jsx)(ak,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.EditNotificationTemplate,path:":id/edit",element:(0,z.jsx)(Gw,{})},{id:fc.NotificationAddUsers,path:":id/user-access/add",element:(0,z.jsx)(sk,{})},{id:fc.NotificationAddTeams,path:":id/team-access/add",element:(0,z.jsx)(ok,{})},{id:fc.AddNotificationTemplate,path:"create",element:(0,z.jsx)(Yw,{})},{path:"",element:(0,z.jsx)(Pw,{})}]})),[e])}(),b=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.ManagementJobs,label:e("Management Jobs"),path:"management-jobs",children:[{id:fc.ManagementJobSchedulePage,path:":id/schedules/:schedule_id/",element:(0,z.jsx)(E_,{resourceEndPoint:xl`/system_job_templates/`,initialBreadCrumbs:[{label:e("Management Jobs"),to:fc.ManagementJobs},{id:"data",to:fc.ManagementJobPage},{label:e("Schedules"),id:"schedules",to:fc.ManagementJobSchedules}],backTab:{label:e("Back to Schedules"),page:fc.ManagementJobSchedules,persistentFilterKey:"management-jobs-schedules"},tabs:[{label:e("Details"),page:fc.ManagementJobScheduleDetails}]}),children:[{id:fc.ManagementJobScheduleDetails,path:"details",element:(0,z.jsx)(T_,{isSystemJobTemplateSchedule:!0})}]},{id:fc.ManagementJobScheduleEdit,path:":id/schedules/:schedule_id/edit",element:(0,z.jsx)(bv,{resourceEndPoint:xl`/system_job_templates/`})},{id:fc.ManagementJobScheduleCreate,path:":id/schedules/create",element:(0,z.jsx)(S_,{resourceEndPoint:xl`/system_job_templates/`})},{id:fc.ManagementJobPage,path:":id",element:(0,z.jsx)(kw,{}),children:[{id:fc.ManagementJobSchedules,path:"schedules",element:(0,z.jsx)(lv,{createSchedulePageId:fc.ManagementJobScheduleCreate,sublistEndpoint:xl`/system_job_templates`,resourceType:"management-jobs"})},{id:fc.ManagementJobNotifications,path:"notifications",element:(0,z.jsx)(rv,{resourceType:"system_job_templates"})},{path:"",element:(0,z.jsx)(Re.C5,{to:"schedules",replace:!0})}]},{path:"",element:(0,z.jsx)(Cw,{})}]})),[e])}(),f=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.InstanceGroups,label:e("Instance Groups"),path:"instance-groups",children:[{id:fc.CreateContainerGroup,path:"container-group/create",element:(0,z.jsx)(nj,{})},{id:fc.EditContainerGroup,path:"container-group/:id/edit",element:(0,z.jsx)(aj,{})},{id:fc.CreateInstanceGroup,path:"instance-group/create",element:(0,z.jsx)(Gx,{})},{id:fc.EditInstanceGroup,path:"instance-group/:id/edit",element:(0,z.jsx)(Yx,{})},{id:fc.InstanceGroupPage,path:":id",element:(0,z.jsx)(oj,{}),children:[{id:fc.InstanceGroupDetails,path:"details",element:(0,z.jsx)(Qx,{})},{id:fc.InstanceGroupInstances,path:"instances",element:(0,z.jsx)(Ux,{})},{id:fc.InstanceGroupTeamAccess,path:"team-access",element:(0,z.jsx)(Jx,{})},{id:fc.InstanceGroupUserAccess,path:"user-access",element:(0,z.jsx)(Vx,{})},{id:fc.InstanceGroupJobs,path:"jobs",element:(0,z.jsx)(tj,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{id:fc.InstanceGroupInstancesPage,path:":id/instances/:instance_id/",element:(0,z.jsx)(Wx,{}),children:[{id:fc.InstanceGroupInstanceDetails,path:"details",element:(0,z.jsx)(Vu,{})}]},{id:fc.InstanceGroupAddTeams,path:":id/instance-groups/teams/add-teams",element:(0,z.jsx)(Zx,{})},{id:fc.InstanceGroupAddUsers,path:":id/instance-groups/users/add-users",element:(0,z.jsx)(Xx,{})},{path:"",element:(0,z.jsx)(Kp,{})}]})),[e])}(),g=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.Instances,label:e("Instances"),path:"instances",children:[{id:fc.AddInstance,path:"add",element:(0,z.jsx)(ij,{})},{id:fc.EditInstance,path:":id/edit",element:(0,z.jsx)(rj,{})},{id:fc.InstancePage,path:":id",element:(0,z.jsx)(uj,{}),children:[{id:fc.InstanceDetails,path:"details",element:(0,z.jsx)(Vu,{})},{id:fc.InstanceListenerAddresses,path:"listener-addresses",element:(0,z.jsx)(gj,{})},{id:fc.InstancePeers,path:"peers",element:(0,z.jsx)(hj,{})}]},{path:"",element:(0,z.jsx)(cj,{})}]})),[e])}(),y=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.ExecutionEnvironments,label:e("Execution Environments"),path:"execution-environments",children:[{id:fc.ExecutionEnvironmentPage,path:":id",element:(0,z.jsx)(Dy,{}),children:[{id:fc.ExecutionEnvironmentDetails,path:"details",element:(0,z.jsx)(Ry,{})},{id:fc.ExecutionEnvironmentTemplates,path:"templates",element:(0,z.jsx)(Ly,{})},{id:fc.ExecutionEnvironmentTeamAccess,path:"team-access",element:(0,z.jsx)(Hy,{})},{id:fc.ExecutionEnvironmentUserAccess,path:"user-access",element:(0,z.jsx)(qy,{})}]},{path:"",element:(0,z.jsx)(Py,{})},{id:fc.CreateExecutionEnvironment,path:"add",element:(0,z.jsx)(Ny,{})},{id:fc.EditExecutionEnvironment,path:":id/edit",element:(0,z.jsx)($y,{})},{id:fc.ExecutionEnvironmentAddUsers,path:":id/user-access/add",element:(0,z.jsx)(zy,{})},{id:fc.ExecutionEnvironmentAddTeams,path:":id/team-access/add",element:(0,z.jsx)(Oy,{})}]})),[e])}(),x=function(){const{t:e}=(0,I.Bd)();return(0,l.useMemo)((()=>({id:fc.CredentialTypes,label:e("Credential Types"),path:"credential-types",children:[{id:fc.CreateCredentialType,path:"create",element:(0,z.jsx)(gy,{})},{id:fc.EditCredentialType,path:":id/edit",element:(0,z.jsx)(yy,{})},{id:fc.CredentialTypePage,path:":id/",element:(0,z.jsx)(Cy,{}),children:[{id:fc.CredentialTypeDetails,path:"details",element:(0,z.jsx)(vy,{})},{id:fc.CredentialTypeCredentials,path:"credentials",element:(0,z.jsx)(_y,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{path:"",element:(0,z.jsx)(Ty,{})}]})),[e])}(),{activeAwxUser:j}=_l(),_=[{id:fc.Overview,label:e("Overview"),path:"overview",element:(0,z.jsx)(Pf,{})}],v=[{id:fc.Infrastructure,label:e("Infrastructure"),path:"infrastructure",children:j?.is_superuser?[{id:fc.TopologyView,label:e("Topology View"),path:"topology",element:(0,z.jsx)(Db,{})},t,n,f,g,y]:[t,n,f,g,y]}],w=[{id:fc.Analytics,label:e("Analytics"),path:"analytics",children:[{id:fc.AutomationCalculator,label:e("Automation Calculator"),path:"automation-calculator",element:(0,z.jsx)(mf,{})},{id:fc.HostMetrics,label:e("Host Metrics"),path:"host-metrics",element:(0,z.jsx)(Nf,{})},{id:fc.SubscriptionUsage,label:e("Subscription Usage"),path:"subscription-usage",element:(0,z.jsx)(ff,{})}]}],k=[{id:fc.Administration,label:e("Administration"),path:"administration",children:j?.is_superuser?[d,i,h,b]:[d,i]}],S=[{id:fc.Access,label:e("Access Management"),path:"access",children:[{id:fc.SettingsAuthentication,label:e("Authentication Methods"),path:"authentication",children:[{id:fc.SettingsCategory,path:":category/edit",element:(0,z.jsx)(Id,{})},{path:"",element:(0,z.jsx)(hd,{})}]},u,m,p,{id:fc.Roles,label:e("Roles"),path:"roles",children:[{id:fc.CreateRole,path:"create",element:(0,z.jsx)(ad,{})},{id:fc.EditRole,path:":id/edit",element:(0,z.jsx)(sd,{})},{id:fc.RolePage,path:":id",element:(0,z.jsx)(qc,{}),children:[{id:fc.RoleDetails,path:"details",element:(0,z.jsx)(Ac,{})},{path:"",element:(0,z.jsx)(Re.C5,{to:"details",replace:!0})}]},{path:"",element:(0,z.jsx)(Vc,{})}]},s,x]}],C=[{id:fc.Settings,label:e("Settings"),path:"settings",children:[{id:fc.SettingsPreferences,label:e("User Preferences"),path:"preferences",children:[{path:"edit",element:(0,z.jsx)(wc,{})},{path:"",element:(0,z.jsx)(jc,{})}]},{id:fc.SettingsSystem,label:e("System"),path:"system",children:[{path:"edit",element:(0,z.jsx)(Ad,{categoryId:"system"},"system")},{path:"",element:(0,z.jsx)(fd,{categoryId:"system"},"system")}]},{id:fc.SettingsJobs,label:e("Job"),path:"job-settings",children:[{path:"edit",element:(0,z.jsx)(Ad,{categoryId:"jobs"},"jobs")},{path:"",element:(0,z.jsx)(fd,{categoryId:"jobs"},"jobs")}]},{id:fc.SettingsLogging,label:e("Logging"),path:"logging",children:[{path:"edit",element:(0,z.jsx)(Ad,{categoryId:"logging"},"logging")},{path:"",element:(0,z.jsx)(fd,{categoryId:"logging"},"logging")}]},{id:fc.SettingsTroubleshooting,label:e("Troubleshooting"),path:"troubleshooting",children:[{path:"edit",element:(0,z.jsx)(Ad,{categoryId:"debug"},"debug")},{path:"",element:(0,z.jsx)(fd,{categoryId:"debug"},"debug")}]},{path:"",element:(0,z.jsx)(Re.C5,{to:"..",replace:!0})}]}];return[..._,c,o,r,a,...v,...j?.is_superuser||j?.is_system_auditor?w:[],...k,...S,...C,{path:"",element:(0,z.jsx)(Re.C5,{to:"./overview",replace:!0})}]}();return(0,z.jsx)(br,{masthead:(0,z.jsx)(gc,{}),navigation:e,basename:"/",defaultRefreshInterval:30})}var rT=n(57093),lT=n(70554),cT=n(28691),dT=n(7018),uT=n(79817),mT=n(54850),pT=n(48095),hT=n(81176),bT=n(25716),fT=n(83294),gT=n(65562),yT=n(19322);const xT=(0,A.Ay)(g.$n).withConfig({componentId:"ans__sc-4qwjso-0"})(["overflow:hidden;text-overflow:ellipsis;"]);function jT(e){const{options:t}=e,{t:n}=(0,I.Bd)();return t&&Object.keys(t).length?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ge.h,{headingLevel:"h3",children:n`Log in with`}),(0,z.jsx)(Xe.B,{style:{width:"100%"},hasGutter:!0,children:t.map((e=>(0,z.jsx)(vT,{option:e},e.login_url)))})]}):null}const _T={"azuread-oauth2":fT.vv,github:gT.Nb,"github-org":gT.Nb,"github-team":gT.Nb,"github-enterprise":gT.Nb,"github-enterprise-org":gT.Nb,"github-enterprise-team":gT.Nb,"google-oauth2":yT.NR,oidc:ql.rM,saml:ql.rM};function vT(e){const{option:t}=e,{t:n}=(0,I.Bd)(),a={"azuread-oauth2":n("Azure AD"),github:n("GitHub"),"github-org":n("GitHub Organizations"),"github-team":n("Github Teams"),"github-enterprise":n("GitHub Enterprise"),"github-enterprise-org":n("GitHub Enterprise Organizations"),"github-enterprise-team":n("GitHub Enterprise Teams"),"google-oauth2":n("Google"),oidc:n("OIDC"),saml:n("SAML")},s=_T[t.type]??ql.rM;return(0,z.jsx)(xT,{"data-cy":`social-auth-${t.type}`,component:"a",href:t.login_url,variant:"secondary",icon:(0,z.jsx)(s,{}),children:t.name||a[t.type]||""})}function wT(e){const{t}=(0,I.Bd)(),[n]=W(),[a,s]=(0,l.useState)(""),[o,i]=(0,l.useState)(""),[r,c]=(0,l.useState)(""),d=(0,Re.zy)(),{loginApiUrl:u}=e,m=new URLSearchParams(d.search).get("next"),p=(0,l.useCallback)((async()=>{try{const n=await fetch(u,{credentials:"include",headers:{Accept:"application/json,text/*"}});if(!n.ok)throw await Zr(n);const s=new URLSearchParams;s.set("username",a),s.set("password",o);const i={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-Csrftoken":el("csrftoken")||""};try{const e=await fetch(u,{credentials:"include",method:"POST",headers:i,body:s,redirect:"manual"});if(!e.ok)throw await Zr(e)}catch(e){if(!(e instanceof Xr))throw e;if(401===e.statusCode||403===e.statusCode)throw new Error(t("Invalid username or password. Please try again."));if(0!==e.statusCode)throw e}m?window.location.href=m:e.onSuccess?.()}catch(e){e instanceof Error?c((0,z.jsx)(kT,{children:e.message})):c((0,z.jsx)(kT,{children:t("Invalid username or password. Please try again.")}))}}),[u,o,e,t,a,m]),h=d.search.includes("auth_failed");return(0,l.useEffect)((()=>{h&&c((0,z.jsx)(kT,{children:t("Unable to complete social auth login")}))}),[h,t]),(0,z.jsxs)(pe,{message:n.errorText,children:[e.backgroundImgSrc&&(0,z.jsx)(rT.o,{src:e.backgroundImgSrc}),(0,z.jsxs)(lT.a,{header:(0,z.jsx)(cT.F,{headerBrand:"string"==typeof e.brandImg?(0,z.jsx)(dT.m,{src:e.brandImg,alt:e.brandImgAlt}):(0,z.jsx)(CT,{children:e.brandImg})}),footer:e.textContent&&(0,z.jsx)(uT.V,{children:(0,z.jsx)("p",{children:e.textContent})}),children:[(0,z.jsx)(mT.q,{title:e.loginTitle??t("Log in to your account"),subtitle:e.loginSubtitle}),(0,z.jsx)(pT.T,{children:(0,z.jsx)(hT.Q,{showHelperText:!!r,helperText:r,helperTextIcon:(0,z.jsx)(ST,{}),usernameLabel:t("Username"),usernameValue:a,onChangeUsername:(e,t)=>{c(""),s(t)},isValidUsername:!r||!!a,passwordLabel:t("Password"),passwordValue:o,onChangePassword:(e,t)=>{c(""),i(t)},isValidPassword:!r||!!o,isShowPasswordEnabled:!0,showPasswordAriaLabel:t("Show password"),hidePasswordAriaLabel:t("Hide password"),loginButtonLabel:t("Log in"),onLoginButtonClick:e=>{e.preventDefault(),a?o?p():c(t("Password is required")):c(t("Username is required"))}})}),e.authOptions&&(0,z.jsx)(bT.u,{socialMediaLoginContent:e.authOptions?(0,z.jsx)(jT,{options:e.authOptions}):void 0,socialMediaLoginAriaLabel:t("Log in with authentication provider")})]})]})}const kT=A.Ay.span.withConfig({componentId:"ans__sc-b684ek-0"})(["color:var(--pf-v5-global--danger-color--200);"]),ST=(0,A.Ay)(an.$Q).withConfig({componentId:"ans__sc-b684ek-1"})(["color:var(--pf-v5-global--danger-color--100);"]),CT=A.Ay.div.withConfig({componentId:"ans__sc-b684ek-2"})(["margin-bottom:16px;"]);function TT(e){const{data:t}=(0,_e.Ay)(xl`/auth/`,nl),n=[];t&&"object"==typeof t&&Object.keys(t).forEach((e=>{n.push({login_url:t[e].login_url,type:e})}));const{activeAwxUser:a,refreshActiveAwxUser:s}=_l();return void 0===a?(0,z.jsx)(or.Y,{children:(0,z.jsx)(Or,{})}):a?(0,z.jsx)(mc,{version:void 0,children:(0,z.jsx)(cc,{children:(0,z.jsx)(oc,{children:e.children})})}):(0,z.jsx)(wT,{authOptions:n,loginApiUrl:"/api/login/",onSuccess:()=>{s?.(),(0,_e.Tk)((()=>!0))},brandImg:"/assets/awx-logo.svg",brandImgAlt:"AWX"})}function IT(){return(0,z.jsx)(a.Kd,{children:(0,z.jsx)(Li,{defaultRefreshInterval:10,children:(0,z.jsx)(vl,{children:(0,z.jsx)(TT,{children:(0,z.jsx)(iT,{})})})})})}}}]);
//# sourceMappingURL=37e48d959d5a1a390685.js.map